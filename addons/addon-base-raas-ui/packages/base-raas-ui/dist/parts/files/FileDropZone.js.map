{"version":3,"sources":["../../../src/parts/files/FileDropZone.js"],"names":["ReusableFileInput","React","forwardRef","ref","onChange","props","useState","inputKey","setInputKey","event","FileDropZone","highlighted","isHighlighted","fileInputRef","createRef","enabled","state","dataTransfer","types","includes","preventDefault","setHighlight","fileList","files","onSelectFiles","currentTarget","current","click","Component","propTypes","PropTypes","oneOf","isRequired","func","defaultProps","observable"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { decorate, observable, runInAction } from 'mobx';\nimport { observer } from 'mobx-react';\nimport PropTypes from 'prop-types';\n\nimport { Segment, Header, Divider, Button, Icon } from 'semantic-ui-react';\nimport uuidv4 from 'uuid/v4';\n\n/**\n * A reusable file input component.\n * Motivation: <input type=\"file\" /> components are stateful and behave unexpectedly\n * when attempting to reuse them to upload multiple files.\n */\nconst ReusableFileInput = React.forwardRef(({ onChange, ...props }, ref) => {\n  const [inputKey, setInputKey] = React.useState(uuidv4());\n  return (\n    <input\n      key={inputKey}\n      ref={ref}\n      type=\"file\"\n      onChange={event => {\n        onChange(event);\n        setInputKey(uuidv4());\n      }}\n      {...props}\n    />\n  );\n});\n\nclass FileDropZone extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.highlighted = false;\n    });\n  }\n\n  setHighlight(isHighlighted) {\n    runInAction(() => {\n      this.highlighted = isHighlighted;\n    });\n  }\n\n  render() {\n    const fileInputRef = React.createRef();\n    const enabled = this.props.state === 'PENDING';\n    return (\n      <Segment\n        tertiary={this.highlighted}\n        placeholder\n        onDragEnter={event => {\n          if (enabled) {\n            if (event.dataTransfer.types.includes('Files')) {\n              event.preventDefault();\n              this.setHighlight(true);\n            }\n          }\n        }}\n        onDragOver={event => {\n          if (enabled) {\n            if (event.dataTransfer.types.includes('Files')) {\n              event.preventDefault();\n              this.setHighlight(true);\n            }\n          }\n        }}\n        onDragLeave={() => {\n          this.setHighlight(false);\n        }}\n        onDragEnd={() => {\n          this.setHighlight(false);\n        }}\n        onDrop={event => {\n          if (enabled) {\n            if (event.dataTransfer.types.includes('Files')) {\n              event.preventDefault();\n              this.setHighlight(false);\n              const fileList = event.dataTransfer.files || [];\n              this.props.onSelectFiles([...fileList]);\n            }\n          }\n        }}\n      >\n        <Header icon color=\"grey\">\n          <ReusableFileInput\n            ref={fileInputRef}\n            hidden\n            multiple\n            onChange={event => {\n              if (this.props.onSelectFiles) {\n                const fileList = event.currentTarget.files || [];\n                this.props.onSelectFiles([...fileList]);\n              }\n            }}\n          />\n          {this.props.state === 'PENDING' ? (\n            <>\n              <Icon name=\"upload\" className=\"mb2\" />\n              Drag and drop\n              <Divider horizontal>Or</Divider>\n              <Button\n                basic\n                color=\"blue\"\n                onClick={() => {\n                  if (fileInputRef.current) {\n                    fileInputRef.current.click();\n                  }\n                }}\n              >\n                Browse Files\n              </Button>\n            </>\n          ) : this.props.state === 'UPLOADING' ? (\n            <>\n              <Icon loading name=\"circle notch\" className=\"mb2\" />\n              Uploading\n            </>\n          ) : this.props.state === 'COMPLETE' ? (\n            <>\n              <Icon name=\"check\" className=\"mb2\" />\n              Upload Complete\n            </>\n          ) : null}\n        </Header>\n      </Segment>\n    );\n  }\n}\nFileDropZone.propTypes = {\n  state: PropTypes.oneOf(['PENDING', 'UPLOADING', 'COMPLETE']).isRequired,\n  onSelectFiles: PropTypes.func,\n};\nFileDropZone.defaultProps = {\n  onSelectFiles: null,\n};\n\ndecorate(FileDropZone, {\n  setHighlight: observable,\n});\nexport default observer(FileDropZone);\n"],"file":"FileDropZone.js"}