{"version":3,"sources":["../../../../src/parts/environments-sc/setup/SelectConfigurationCards.js"],"names":["SelectConfigurationCards","handleSelectConfigurationId","configId","formField","sync","resetValidation","field","error","hasError","_","isEmpty","isDisabled","disabled","disabledClass","errorClass","renderCards","configurations","isSelected","config","id","configurationId","getAttrs","attrs","color","onClick","map","name","__html","descHtml","renderEstimatedCostInfo","hasCost","estimatedCostInfoHtml","content","priceTitle","item","isSpot","get","region","price","perDay","pricePerDay","isUndefined","isString","displayProps","property","propertyIndex","key","value","props","React","Component","computed","action"],"mappings":";;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;IACMA,wB;;;;;;;;;;;;;;;;UAaJC,2B,GAA8B,UAAAC,QAAQ,EAAI;AACxC,YAAKC,SAAL,CAAeC,IAAf,CAAoBF,QAApB;;AACA,YAAKC,SAAL,CAAeE,eAAf;AACD,K;;;;;;;6BAEQ;AACP,UAAMC,KAAK,GAAG,KAAKH,SAAnB;AADO,yBAEgBG,KAFhB,CAECC,KAFD;AAAA,UAECA,KAFD,6BAES,EAFT;AAGP,UAAMC,QAAQ,GAAG,CAACC,mBAAEC,OAAF,CAAUH,KAAV,CAAlB,CAHO,CAG6B;;AACpC,UAAMI,UAAU,GAAGL,KAAK,CAACM,QAAzB;AACA,UAAMC,aAAa,GAAGF,UAAU,GAAG,UAAH,GAAgB,EAAhD;AACA,UAAMG,UAAU,GAAGN,QAAQ,GAAG,OAAH,GAAa,EAAxC;AAEA,0BACE;AAAK,QAAA,SAAS,EAAE,4BAAE,KAAF,EAASM,UAAT,EAAqBD,aAArB;AAAhB,sBACE,gCAAC,kBAAD;AAAQ,QAAA,KAAK,EAAEP;AAAf,QADF,eAEE,gCAAC,uBAAD;AAAa,QAAA,KAAK,EAAEA;AAApB,QAFF,eAGE,gCAAC,wBAAD;AAAc,QAAA,KAAK,EAAEA,KAArB;AAA4B,QAAA,SAAS,EAAC;AAAtC,QAHF,EAIG,KAAKS,WAAL,EAJH,CADF;AAQD;;;kCAEa;AAAA;;AACZ,UAAMH,QAAQ,GAAG,KAAKT,SAAL,CAAeS,QAAhC;AACA,UAAMI,cAAc,GAAG,KAAKA,cAA5B;;AACA,UAAMC,UAAU,GAAG,SAAbA,UAAa,CAAAC,MAAM;AAAA,eAAIA,MAAM,CAACC,EAAP,KAAc,MAAI,CAACC,eAAvB;AAAA,OAAzB;;AACA,UAAMC,QAAQ,GAAG,SAAXA,QAAW,CAAAH,MAAM,EAAI;AACzB,YAAMI,KAAK,GAAG,EAAd;AACA,YAAIL,UAAU,CAACC,MAAD,CAAd,EAAwBI,KAAK,CAACC,KAAN,GAAc,MAAd;AACxB,YAAI,CAACX,QAAL,EAAeU,KAAK,CAACE,OAAN,GAAgB;AAAA,iBAAM,MAAI,CAACvB,2BAAL,CAAiCiB,MAAM,CAACC,EAAxC,CAAN;AAAA,SAAhB;AAEf,eAAOG,KAAP;AACD,OAND;;AAQA,0BACE,gCAAC,qBAAD,CAAM,KAAN;AAAY,QAAA,SAAS,MAArB;AAAsB,QAAA,WAAW,EAAE,CAAnC;AAAsC,QAAA,SAAS,EAAC;AAAhD,SACGb,mBAAEgB,GAAF,CAAMT,cAAN,EAAsB,UAAAE,MAAM;AAAA,4BAC3B,gCAAC,qBAAD;AACE,yBAAY,oBADd;AAEE,UAAA,GAAG,EAAEA,MAAM,CAACC,EAFd;AAGE,UAAA,SAAS,EAAE,4BAAE,KAAF,EAAS;AAAE,8BAAkB,CAACP;AAArB,WAAT;AAHb,WAIMS,QAAQ,CAACH,MAAD,CAJd,gBAME,gCAAC,qBAAD,CAAM,OAAN,qBACE,gCAAC,qBAAD,CAAM,MAAN,qBACE;AAAK,UAAA,SAAS,EAAC;AAAf,wBACE,gCAAC,sBAAD;AAAO,UAAA,SAAS,EAAC,KAAjB;AAAuB,UAAA,OAAO,EAAED,UAAU,CAACC,MAAD,CAA1C;AAAoD,UAAA,QAAQ,EAAEN;AAA9D,UADF,eAEE,gCAAC,uBAAD;AAAgB,UAAA,EAAE,EAAC,IAAnB;AAAwB,UAAA,SAAS,EAAC;AAAlC,WACGM,MAAM,CAACQ,IADV,CAFF,CADF,eAOE,gCAAC,wBAAD,OAPF,CADF,eAUE,gCAAC,qBAAD,CAAM,WAAN,qBACE;AAAK,UAAA,SAAS,EAAC;AAAf,wBAGE;AAAK,UAAA,uBAAuB,EAAE;AAAEC,YAAAA,MAAM,EAAET,MAAM,CAACU;AAAjB;AAA9B,UAHF,CADF,eAME,gCAAC,wBAAD,OANF,EAOG,MAAI,CAACC,uBAAL,CAA6BX,MAA7B,CAPH,CAVF,CANF,CAD2B;AAAA,OAA5B,CADH,CADF;AAiCD;;;4CAEuBA,M,EAAQ;AAC9B,UAAMY,OAAO,GAAG,CAACrB,mBAAEC,OAAF,CAAUQ,MAAM,CAACa,qBAAjB,CAAjB;;AACA,UAAIC,OAAO,gBACT;AAAK,QAAA,SAAS,EAAC;AAAf,sBACE;AAAK,QAAA,SAAS,EAAC;AAAf,0BADF,eAEE;AAAK,QAAA,SAAS,EAAC;AAAf,eAFF,CADF;;AAMA,UAAIF,OAAJ,EAAa;AACXE,QAAAA,OAAO,gBACL;AAAK,UAAA,SAAS,EAAC;AAAf,wBACE;AAAK,UAAA,SAAS,EAAC;AAAf,4BADF,eAGE;AAAK,UAAA,uBAAuB,EAAE;AAAEL,YAAAA,MAAM,EAAET,MAAM,CAACa;AAAjB;AAA9B,UAHF,CADF;AAOD;;AAED,aAAOC,OAAP;AACD;;;oCAEed,M,EAAQ;AACtB;AACA,UAAMe,UAAU,GAAG,SAAbA,UAAa,CAAAC,IAAI,EAAI;AACzB,YAAMC,MAAM,GAAG1B,mBAAE2B,GAAF,CAAMF,IAAN,EAAY,gBAAZ,MAAkC,MAAjD;AACA,eAAOC,MAAM,GAAG,uBAAH,GAA6B,eAA1C;AACD,OAHD;;AAIA,UAAME,MAAM,GAAG,SAATA,MAAS,CAAAH,IAAI;AAAA,eAAIzB,mBAAE2B,GAAF,CAAMF,IAAN,EAAY,kBAAZ,CAAJ;AAAA,OAAnB;;AACA,UAAMI,KAAK,GAAG,SAARA,KAAQ,CAAAJ,IAAI,EAAI;AACpB,YAAMK,MAAM,GAAGL,IAAI,CAACM,WAApB;AACA,YAAI/B,mBAAEgC,WAAF,CAAcF,MAAd,KAA0B9B,mBAAEiC,QAAF,CAAWH,MAAX,KAAsB9B,mBAAEC,OAAF,CAAU6B,MAAV,CAApD,EAAwE,OAAO,KAAP;AACxE,0BAAW,sBAAUA,MAAV,CAAX;AACD,OAJD;;AAMA,0BACE,gCAAC,sBAAD;AAAO,QAAA,KAAK,EAAC,MAAb;AAAoB,QAAA,IAAI,EAAC;AAAzB,sBACE,gCAAC,sBAAD,CAAO,IAAP,QACG9B,mBAAEgB,GAAF,CAAMP,MAAM,CAACyB,YAAb,EAA2BlB,GAA3B,CAA+B,UAACmB,QAAD,EAAWC,aAAX,EAA6B;AAC3D;AAAA;AACE;AACA,0CAAC,sBAAD,CAAO,GAAP;AAAW,YAAA,GAAG,EAAEA,aAAhB;AAA+B,YAAA,SAAS,EAAC;AAAzC,0BACE,gCAAC,sBAAD,CAAO,IAAP,QAAaD,QAAQ,CAACE,GAAtB,CADF,eAEE,gCAAC,sBAAD,CAAO,IAAP,QAAaF,QAAQ,CAACG,KAAtB,CAFF;AAFF;AAOD,OARA,CADH,eAUE,gCAAC,sBAAD,CAAO,GAAP;AAAW,QAAA,SAAS,EAAC;AAArB,sBACE,gCAAC,sBAAD,CAAO,IAAP,QACGd,UAAU,CAACf,MAAD,CADb,eAEE;AAAK,QAAA,SAAS,EAAC;AAAf,SAAkCmB,MAAM,CAACnB,MAAD,CAAxC,CAFF,CADF,eAKE,gCAAC,sBAAD,CAAO,IAAP;AAAY,QAAA,aAAa,EAAC;AAA1B,SAAiCoB,KAAK,CAACpB,MAAD,CAAtC,CALF,CAVF,CADF,CADF;AAsBD;;;wBA1IoB;AACnB,aAAO,KAAK8B,KAAL,CAAWhC,cAAlB;AACD;;;wBAEqB;AACpB,aAAO,KAAKb,SAAL,CAAe4C,KAAtB;AACD;;;wBAEe;AACd,aAAO,KAAKC,KAAL,CAAW7C,SAAlB;AACD;;;;EAXoC8C,kBAAMC,S,GA8I7C;;;AACA,oBAASlD,wBAAT,EAAmC;AACjCgB,EAAAA,cAAc,EAAEmC,cADiB;AAEjC/B,EAAAA,eAAe,EAAE+B,cAFgB;AAGjChD,EAAAA,SAAS,EAAEgD,cAHsB;AAIjClD,EAAAA,2BAA2B,EAAEmD;AAJI,CAAnC;;eAOe,yBAAS,yBAASpD,wBAAT,CAAT,C","sourcesContent":["import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { Card, Radio, Divider, Table, Header as SemanticHeader } from 'semantic-ui-react';\nimport c from 'classnames';\nimport Header from '@aws-ee/base-ui/dist/parts/helpers/fields/Header';\nimport Description from '@aws-ee/base-ui/dist/parts/helpers/fields/Description';\nimport ErrorPointer from '@aws-ee/base-ui/dist/parts/helpers/fields/ErrorPointer';\nimport { nicePrice } from '@aws-ee/base-ui/dist/helpers/utils';\n\n// expected props\n// - configurations (via props) and array of the env type configurations MST\n// - formField (via props) an instance of the mobx form field\nclass SelectConfigurationCards extends React.Component {\n  get configurations() {\n    return this.props.configurations;\n  }\n\n  get configurationId() {\n    return this.formField.value;\n  }\n\n  get formField() {\n    return this.props.formField;\n  }\n\n  handleSelectConfigurationId = configId => {\n    this.formField.sync(configId);\n    this.formField.resetValidation();\n  };\n\n  render() {\n    const field = this.formField;\n    const { error = '' } = field;\n    const hasError = !_.isEmpty(error); // IMPORTANT do NOT use field.hasError\n    const isDisabled = field.disabled;\n    const disabledClass = isDisabled ? 'disabled' : '';\n    const errorClass = hasError ? 'error' : '';\n\n    return (\n      <div className={c('mb4', errorClass, disabledClass)}>\n        <Header field={field} />\n        <Description field={field} />\n        <ErrorPointer field={field} className=\"mb1\" />\n        {this.renderCards()}\n      </div>\n    );\n  }\n\n  renderCards() {\n    const disabled = this.formField.disabled;\n    const configurations = this.configurations;\n    const isSelected = config => config.id === this.configurationId;\n    const getAttrs = config => {\n      const attrs = {};\n      if (isSelected(config)) attrs.color = 'blue';\n      if (!disabled) attrs.onClick = () => this.handleSelectConfigurationId(config.id);\n\n      return attrs;\n    };\n\n    return (\n      <Card.Group stackable itemsPerRow={3} className=\"mt1\">\n        {_.map(configurations, config => (\n          <Card\n            data-testid=\"configuration-card\"\n            key={config.id}\n            className={c('mb3', { 'cursor-pointer': !disabled })}\n            {...getAttrs(config)}\n          >\n            <Card.Content>\n              <Card.Header>\n                <div className=\"flex mt1\">\n                  <Radio className=\"mr2\" checked={isSelected(config)} disabled={disabled} />\n                  <SemanticHeader as=\"h4\" className=\"flex-auto mt0 pt0\">\n                    {config.name}\n                  </SemanticHeader>\n                </div>\n                <Divider />\n              </Card.Header>\n              <Card.Description>\n                <div className=\"pr1 pl1 pb1\">\n                  {/* Yes, we are doing dangerouslySetInnerHTML, the content was already sanitized by showdownjs */}\n                  {/* eslint-disable-next-line react/no-danger */}\n                  <div dangerouslySetInnerHTML={{ __html: config.descHtml }} />\n                </div>\n                <Divider />\n                {this.renderEstimatedCostInfo(config)}\n              </Card.Description>\n            </Card.Content>\n          </Card>\n        ))}\n      </Card.Group>\n    );\n  }\n\n  renderEstimatedCostInfo(config) {\n    const hasCost = !_.isEmpty(config.estimatedCostInfoHtml);\n    let content = (\n      <div className=\"flex p1\">\n        <div className=\"bold flex-auto\">Estimated Cost</div>\n        <div className=\"pr1\">N/A</div>\n      </div>\n    );\n    if (hasCost) {\n      content = (\n        <div className=\"p1\">\n          <div className=\"mb2 bold\">Estimated Cost</div>\n          {/* eslint-disable-next-line react/no-danger */}\n          <div dangerouslySetInnerHTML={{ __html: config.estimatedCostInfoHtml }} />\n        </div>\n      );\n    }\n\n    return content;\n  }\n\n  renderTableInfo(config) {\n    // estimatedCostInfo\n    const priceTitle = item => {\n      const isSpot = _.get(item, 'priceInfo.type') === 'spot';\n      return isSpot ? 'Maximum price per day' : 'Price per day';\n    };\n    const region = item => _.get(item, 'priceInfo.region');\n    const price = item => {\n      const perDay = item.pricePerDay;\n      if (_.isUndefined(perDay) || (_.isString(perDay) && _.isEmpty(perDay))) return 'N/A';\n      return `$${nicePrice(perDay)}`;\n    };\n\n    return (\n      <Table basic=\"very\" size=\"small\">\n        <Table.Body>\n          {_.map(config.displayProps).map((property, propertyIndex) => {\n            return (\n              // eslint-disable-next-line react/no-array-index-key\n              <Table.Row key={propertyIndex} textAlign=\"center\">\n                <Table.Cell>{property.key}</Table.Cell>\n                <Table.Cell>{property.value}</Table.Cell>\n              </Table.Row>\n            );\n          })}\n          <Table.Row textAlign=\"center\">\n            <Table.Cell>\n              {priceTitle(config)}\n              <div className=\"color-grey fs-9\">{region(config)}</div>\n            </Table.Cell>\n            <Table.Cell verticalAlign=\"top\">{price(config)}</Table.Cell>\n          </Table.Row>\n        </Table.Body>\n      </Table>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(SelectConfigurationCards, {\n  configurations: computed,\n  configurationId: computed,\n  formField: computed,\n  handleSelectConfigurationId: action,\n});\n\nexport default inject()(observer(SelectConfigurationCards));\n"],"file":"SelectConfigurationCards.js"}