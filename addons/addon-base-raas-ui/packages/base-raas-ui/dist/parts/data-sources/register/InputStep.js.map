{"version":3,"sources":["../../../../src/parts/data-sources/register/InputStep.js"],"names":["fieldRuleKey","container","name","key","InputStep","props","handleSave","form","data","values","wizard","submit","handleCancel","goto","reset","handleAccountChange","accountId","account","getAccount","accountExists","_","isEmpty","getFields","accountField","bucketField","$","resetValidation","resetFields","enableFields","syncKmsArnField","set","mainRegion","contactInfo","disableFields","handleBucketChange","bucketName","value","bucket","getBucket","bucketExists","field","region","sse","kmsArn","handleEncryptionChange","handleAddStudy","event","preventDefault","stopPropagation","studies","newField","add","handleDeleteStudy","del","handleStudyTypeChange","studyField","fieldRulesMap","rememberFieldsRules","names","map","forEach","rules","showKmsArn","renderForm","accountOptions","dropdownAccountOptions","accountIdValid","isValid","bucketOptions","getDropdownBucketOptions","studiesSize","size","addButtonLabel","processing","onCancel","regionOptions","encryptionOptions","renderStudyField","myStudies","projectIdOptions","userIdOptions","userStore","projectIdDropdown","list","usersStore","result","user","isActive","isRootUser","isAdmin","isInternalResearcher","userRole","push","id","text","longDisplayName","React","Component","action","computed","observable"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, runInAction, observable, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Button, Segment, Header, Divider, Label } from 'semantic-ui-react';\n\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport DropDown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\nimport SelectionButtons from '@aws-ee/base-ui/dist/parts/helpers/fields/SelectionButtons';\nimport YesNo from '@aws-ee/base-ui/dist/parts/helpers/fields/YesNo';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\n\nimport { regionOptions } from '../../../models/constants/aws-regions';\nimport { encryptionOptions } from '../../../models/constants/bucket';\nimport { getRegisterStudyForm } from '../../../models/forms/RegisterStudyForm';\n\nconst fieldRuleKey = (container, name) => `${container.key}-${name}`;\n\n// expected props\n// - wizard (via prop)\n// - userStore (via injection)\n// - usersStore (via injection)\nclass InputStep extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.form = getRegisterStudyForm();\n      // We keep the field 'rules' in this map to help when we disable and then enable them. For example, if we disable\n      // a required a field, then even if the field has a value, the validation will fail. So, if we disable a required\n      // field, we need to also remove its rules but we need to bring the rules back if we enable the field again\n      this.fieldRulesMap = {};\n      // lets add the existing field rules to the map\n      const [accountField] = this.getFields(['account']);\n      const [bucketField] = this.getFields(['bucket']);\n\n      this.rememberFieldsRules(accountField, ['name', 'mainRegion', 'contactInfo']);\n      this.rememberFieldsRules(bucketField, ['name', 'region', 'sse', 'kmsArn']);\n    });\n  }\n\n  get wizard() {\n    return this.props.wizard;\n  }\n\n  get projectIdOptions() {\n    return this.props.userStore.projectIdDropdown;\n  }\n\n  get userIdOptions() {\n    // We want to filter out certain user types\n    const list = this.props.usersStore.list;\n    const result = [];\n    _.forEach(list, user => {\n      if (!user.isActive) return;\n      if (user.isRootUser) return;\n      if (user.isAdmin || user.isInternalResearcher || user.userRole === 'admin') {\n        result.push({\n          key: user.id,\n          value: user.id,\n          text: user.longDisplayName,\n        });\n      }\n    });\n\n    return result;\n  }\n\n  getFields(names, container) {\n    const form = container || this.form;\n    return _.map(names, name => form.$(name));\n  }\n\n  disableFields(container, names) {\n    _.forEach(names, name => {\n      const field = container.$(name);\n      field.set('rules', null);\n      field.set('disabled', true);\n      field.resetValidation();\n    });\n  }\n\n  enableFields(container, names) {\n    _.forEach(names, name => {\n      const field = container.$(name);\n      field.set('rules', this.fieldRulesMap[fieldRuleKey(container, name)]);\n      field.set('disabled', false);\n      field.resetValidation();\n    });\n  }\n\n  resetFields(container, names) {\n    _.forEach(names, name => {\n      const field = container.$(name);\n      field.reset();\n    });\n  }\n\n  rememberFieldsRules(container, names) {\n    _.forEach(names, name => {\n      const field = container.$(name);\n      this.fieldRulesMap[fieldRuleKey(container, name)] = field.rules || {};\n    });\n  }\n\n  syncKmsArnField() {\n    const [field] = this.getFields(['bucket']);\n    const showKmsArn = field.$('sse').value === 'kms';\n    const kmsArn = field.$('kmsArn').value;\n\n    if (showKmsArn) {\n      field.$('kmsArn').set(kmsArn);\n      this.enableFields(field, ['kmsArn']);\n    } else {\n      this.resetFields(field, ['kmsArn']);\n      this.disableFields(field, ['kmsArn']);\n    }\n  }\n\n  handleSave = async form => {\n    const data = form.values();\n    swallowError(this.wizard.submit(data));\n  };\n\n  handleCancel = () => {\n    const goto = gotoFn(this);\n    this.wizard.reset();\n\n    goto('/data-sources');\n  };\n\n  handleAccountChange = accountId => {\n    const wizard = this.wizard;\n    const account = wizard.getAccount(accountId);\n    const accountExists = !_.isEmpty(account);\n    const [accountField] = this.getFields(['account']);\n    const [bucketField] = this.getFields(['bucket']);\n\n    accountField.$('id').resetValidation();\n\n    this.resetFields(bucketField, ['name', 'region', 'sse']);\n    this.enableFields(bucketField, ['name', 'region', 'sse']);\n    this.syncKmsArnField();\n\n    if (!accountExists) {\n      this.resetFields(accountField, ['name', 'mainRegion', 'contactInfo']);\n      this.enableFields(accountField, ['name', 'mainRegion', 'contactInfo']);\n\n      return;\n    }\n\n    accountField.$('mainRegion').set(account.mainRegion);\n    accountField.$('name').set(account.name);\n    accountField.$('contactInfo').set(account.contactInfo || '');\n    this.disableFields(accountField, ['name', 'mainRegion', 'contactInfo']);\n  };\n\n  handleBucketChange = bucketName => {\n    const wizard = this.wizard;\n    const [accountField] = this.getFields(['account']);\n    const accountId = accountField.$('id').value;\n    const bucket = wizard.getBucket({ accountId, bucketName });\n    const bucketExists = !_.isEmpty(bucket);\n    const [field] = this.getFields(['bucket']);\n\n    field.$('name').resetValidation();\n\n    if (!bucketExists) {\n      this.resetFields(field, ['region', 'sse', 'kmsArn']);\n      this.enableFields(field, ['region', 'sse']);\n      this.syncKmsArnField();\n      return;\n    }\n\n    field.$('region').set(bucket.region);\n    field.$('sse').set(bucket.sse);\n    field.$('kmsArn').set(bucket.kmsArn);\n    this.syncKmsArnField();\n    this.disableFields(field, ['region', 'sse', 'kmsArn']);\n  };\n\n  handleEncryptionChange = () => {\n    this.syncKmsArnField();\n  };\n\n  handleAddStudy = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    const [studies] = this.getFields(['studies']);\n    const newField = studies.add();\n\n    newField.$('category').set('Organization'); // Set the default\n    newField.$('accessType').set('readonly'); // Set the default\n    newField.$('adminUsers').set([]);\n  };\n\n  handleDeleteStudy = key =>\n    action(event => {\n      event.preventDefault();\n      event.stopPropagation();\n      this.form.$('studies').del(key);\n    });\n\n  handleStudyTypeChange = studyField =>\n    action(value => {\n      if (value === 'My Studies') {\n        studyField.$('adminUsers').set('');\n      } else {\n        studyField.$('adminUsers').set([]);\n      }\n    });\n\n  render() {\n    return (\n      <>\n        <Header as=\"h3\" icon textAlign=\"center\" className=\"mt2\" color=\"grey\">\n          Register Studies\n        </Header>\n        <Segment clearing className=\"p3\">\n          {this.renderForm()}\n        </Segment>\n      </>\n    );\n  }\n\n  renderForm() {\n    const wizard = this.wizard;\n    const form = this.form;\n    const [accountField, bucketField, studies] = this.getFields(['account', 'bucket', 'studies']);\n    const accountOptions = wizard.dropdownAccountOptions;\n    const accountId = accountField.$('id').value;\n    const accountIdValid = accountField.$('id').isValid;\n    const bucketOptions = wizard.getDropdownBucketOptions(accountId);\n    const showKmsArn = bucketField.$('sse').value === 'kms';\n    const studiesSize = studies.size;\n    const addButtonLabel = studiesSize > 0 ? 'Add Another Study' : 'Add Study';\n\n    return (\n      <Form form={form} onCancel={this.handleCancel} onSuccess={this.handleSave}>\n        {({ processing, /* onSubmit, */ onCancel }) => (\n          <>\n            <div className=\"clearfix\">\n              <DropDown\n                field={accountField.$('id')}\n                options={accountOptions}\n                search\n                selection\n                fluid\n                allowAdditions\n                clearable\n                additionLabel=\"\"\n                className=\"mb3 mt0 col col-6 pr2\"\n                onChange={this.handleAccountChange}\n              />\n              <DropDown\n                field={accountField.$('mainRegion')}\n                options={regionOptions}\n                search\n                selection\n                fluid\n                className=\"mb3 mt0 col col-6 pl2\"\n              />\n            </div>\n            <Input field={accountField.$('name')} className=\"mb3\" />\n            <TextArea field={accountField.$('contactInfo')} className=\"mb3\" />\n\n            <Divider horizontal className=\"mt4 mb4\">\n              Bucket Information\n            </Divider>\n\n            <div className=\"clearfix\">\n              <DropDown\n                field={bucketField.$('name')}\n                options={bucketOptions}\n                search\n                selection\n                fluid\n                allowAdditions\n                clearable\n                additionLabel=\"\"\n                className=\"mb3 mt0 col col-6 pr2\"\n                onChange={this.handleBucketChange}\n              />\n              <DropDown\n                field={bucketField.$('region')}\n                options={regionOptions}\n                search\n                selection\n                fluid\n                className=\"mb3 mt0 col col-6 pl2\"\n              />\n            </div>\n            <SelectionButtons field={bucketField.$('sse')} show=\"headerOnly\" className=\"mb0\" />\n            <SelectionButtons\n              field={bucketField.$('sse')}\n              options={encryptionOptions}\n              show=\"buttonsOnly\"\n              className=\"mb3\"\n              onChange={this.handleEncryptionChange}\n            />\n            {showKmsArn && <Input field={bucketField.$('kmsArn')} className=\"mb3\" />}\n\n            <Divider horizontal className=\"mt4 mb4\">\n              Studies\n            </Divider>\n\n            {studies.map(field => this.renderStudyField({ field }))}\n\n            <Button basic primary content={addButtonLabel} className=\"mt3\" fluid onClick={this.handleAddStudy} />\n            <Divider className=\"mt3 mb3\" />\n\n            <Button\n              floated=\"right\"\n              className=\"ml2\"\n              primary\n              icon=\"right arrow\"\n              labelPosition=\"right\"\n              content=\"Save &amp; Continue\"\n              disabled={processing || !accountIdValid}\n              type=\"submit\"\n            />\n            <Button floated=\"right\" className=\"ml2\" content=\"Cancel\" disabled={processing} onClick={onCancel} />\n          </>\n        )}\n      </Form>\n    );\n  }\n\n  renderStudyField({ field }) {\n    const myStudies = field.$('category').value === 'My Studies';\n\n    return (\n      <Segment key={field.key} clearing className=\"mt3 p3\">\n        <Label floating size=\"tiny\" className=\"cursor-pointer\" onClick={this.handleDeleteStudy(field.key)}>\n          X\n        </Label>\n        <div className=\"clearfix\">\n          <Input field={field.$('id')} className=\"mb3 mt0 col col-6 pr2\" />\n          <Input field={field.$('name')} className=\"mb3 mt0 col col-6 pl2\" />\n        </div>\n\n        <div className=\"clearfix\">\n          <Input field={field.$('folder')} className=\"mb3 mt0 col col-6 pr2\" />\n          <DropDown\n            field={field.$('projectId')}\n            options={this.projectIdOptions}\n            search\n            fluid\n            selection\n            clearable\n            className=\"mb3 mt0 col col-6 pl2\"\n          />\n        </div>\n\n        <div className=\"clearfix\">\n          <div className=\"mb3 mt0 col col-6 pr2\">\n            <YesNo field={field.$('category')} className=\"mt3 mb3\" onClick={this.handleStudyTypeChange(field)} />\n            <YesNo field={field.$('accessType')} className=\"mt2 mb2\" />\n          </div>\n          <TextArea field={field.$('description')} className=\"mb3 mt0 col col-6 pl2\" />\n        </div>\n\n        <Input field={field.$('kmsArn')} className=\"mb3\" />\n        <DropDown\n          field={field.$('adminUsers')}\n          selection\n          fluid\n          multiple={!myStudies}\n          search\n          options={this.userIdOptions}\n          className=\"mb0\"\n        />\n      </Segment>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(InputStep, {\n  handleCancel: action,\n  handleSave: action,\n  handleAccountChange: action,\n  handleBucketChange: action,\n  handleEncryptionChange: action,\n  handleAddStudy: action,\n  handleDeleteStudy: action,\n  handleStudyTypeChange: action,\n  projectIdOptions: computed,\n  wizard: computed,\n  userIdOptions: computed,\n  form: observable,\n});\n\nexport default inject('userStore', 'usersStore')(withRouter(observer(InputStep)));\n"],"file":"InputStep.js"}