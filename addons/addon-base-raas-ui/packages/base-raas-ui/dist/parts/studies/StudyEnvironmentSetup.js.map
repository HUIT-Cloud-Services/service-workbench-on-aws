{"version":3,"sources":["../../../src/parts/studies/StudyEnvironmentSetup.js"],"names":["StudyEnvironmentSetup","props","handlePrevious","envTypeId","encodeURIComponent","handleCompleted","environment","filesSelection","cleanup","step","enableBuiltInWorkspaces","currentStep","CurrentStep","create","window","scrollTo","pathname","goto","renderTitle","renderStepsProgress","renderContent","studyIds","_","isEmpty","renderEmpty","content","renderButtons","fileNames","match","params","React","Component","action","computed","observable"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, runInAction, observable, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Icon, Container, Header, Segment, Button } from 'semantic-ui-react';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\n\nimport { enableBuiltInWorkspaces } from '../../helpers/settings';\nimport { CurrentStep } from '../compute/helpers/CurrentStep';\nimport ComputePlatformSetup from '../compute/ComputePlatformSetup';\nimport StudyStepsProgress from './StudyStepsProgress';\nimport ScEnvironmentSetup from '../environments-sc/setup/ScEnvironmentSetup';\n\n// expected props\n// - filesSelection (via injection)\nclass StudyEnvironmentSetup extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      const step = enableBuiltInWorkspaces\n        ? 'selectComputePlatform'\n        : this.envTypeId\n        ? 'selectEnvConfig' // If envTypeId id is passed then jump to env config step\n        : 'selectEnvType';\n      this.currentStep = CurrentStep.create({ step });\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  goto(pathname) {\n    const goto = gotoFn(this);\n    goto(pathname);\n  }\n\n  handlePrevious = () => {\n    if (this.envTypeId) {\n      this.goto(`/studies/workspace-type/${encodeURIComponent(this.envTypeId)}`);\n    } else {\n      this.goto('/studies');\n    }\n  };\n\n  // eslint-disable-next-line no-unused-vars\n  handleCompleted = async environment => {\n    this.props.filesSelection.cleanup();\n    displaySuccess('The research workspace is being provisioned');\n    this.goto('/workspaces');\n  };\n\n  get studyIds() {\n    return this.props.filesSelection.fileNames; // TODO - yes this is confusing, we should refactor the filesSelection to studiesSelection\n  }\n\n  render() {\n    return (\n      <Container className=\"mt3\">\n        {this.renderTitle()}\n        {this.renderStepsProgress()}\n        {this.renderContent()}\n      </Container>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div className=\"flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"book\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Studies</Header.Content>\n        </Header>\n      </div>\n    );\n  }\n\n  renderStepsProgress() {\n    return <StudyStepsProgress currentStep={this.currentStep} envTypeImmutable={!!this.envTypeId} />;\n  }\n\n  renderContent() {\n    const studyIds = this.studyIds;\n\n    if (_.isEmpty(studyIds)) {\n      return this.renderEmpty();\n    }\n\n    let content = null;\n    if (enableBuiltInWorkspaces) {\n      content = (\n        <ComputePlatformSetup\n          currentStep={this.currentStep}\n          studyIds={this.studyIds}\n          onPrevious={this.handlePrevious}\n          onCompleted={this.handleCompleted}\n        />\n      );\n    } else {\n      content = (\n        <ScEnvironmentSetup\n          currentStep={this.currentStep}\n          studyIds={this.studyIds}\n          onPrevious={this.handlePrevious}\n          onCompleted={this.handleCompleted}\n          envTypeId={this.envTypeId}\n          envTypeImmutable={!!this.envTypeId} // If envTypeId is passed already then do not allow selecting it\n        />\n      );\n    }\n\n    return content;\n  }\n\n  renderEmpty() {\n    return (\n      <>\n        <Segment placeholder className=\"mt2\">\n          <Header icon className=\"color-grey\">\n            <Icon name=\"clipboard outline\" />\n            No studies selected\n            <Header.Subheader>\n              Before you can create a workspace, you need to select one or more studies.\n            </Header.Subheader>\n          </Header>\n        </Segment>\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderButtons() {\n    return (\n      <div className=\"mt3\">\n        <Button\n          floated=\"right\"\n          icon=\"right arrow\"\n          labelPosition=\"right\"\n          className=\"ml2\"\n          primary\n          content=\"Next\"\n          disabled\n        />\n        <Button\n          floated=\"right\"\n          icon=\"left arrow\"\n          labelPosition=\"left\"\n          className=\"ml2\"\n          content=\"Previous\"\n          onClick={this.handlePrevious}\n        />\n      </div>\n    );\n  }\n\n  get envTypeId() {\n    return (this.props.match.params || {}).envTypeId;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(StudyEnvironmentSetup, {\n  handlePrevious: action,\n  handleCompleted: action,\n  studyIds: computed,\n  currentStep: observable,\n});\n\nexport default inject('filesSelection')(withRouter(observer(StudyEnvironmentSetup)));\n"],"file":"StudyEnvironmentSetup.js"}