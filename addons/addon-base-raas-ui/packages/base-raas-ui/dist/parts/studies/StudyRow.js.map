{"version":3,"sources":["../../../src/parts/studies/StudyRow.js"],"names":["StudyRow","props","handleFileSelection","study","selection","filesSelection","hasFile","id","deleteFile","name","description","setFile","accessStatus","handleFilesExpanded","filesExpanded","handlePermissionsExpanded","permissionsExpanded","isSelectable","isSelected","attrs","onClickAttr","color","onClick","marginTop","renderHeader","renderDescription","renderFilesAccordion","renderPermissionsAccordion","uploadLocationEnabled","canUpload","projectId","isOpenDataStudy","expanded","isOrganizationStudy","React","Component","action","computed","observable"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { decorate, action, computed, runInAction, observable } from 'mobx';\nimport { inject, observer } from 'mobx-react';\nimport { Header, Checkbox, Segment, Accordion, Icon } from 'semantic-ui-react';\nimport c from 'classnames';\n\nimport StudyFilesTable from './StudyFilesTable';\nimport StudyPermissionsTable from './StudyPermissionsTable';\nimport UploadStudyFiles from './UploadStudyFiles';\n\n// expected props\n// - study (via props)\n// - isSelectable (via props)\n// - filesSelection (via injection)\nclass StudyRow extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.filesExpanded = false;\n      this.permissionsExpanded = false;\n    });\n  }\n\n  get study() {\n    return this.props.study;\n  }\n\n  get isSelectable() {\n    return this.props.isSelectable;\n  }\n\n  handleFileSelection = study => {\n    const selection = this.props.filesSelection;\n    if (selection.hasFile(study.id)) {\n      selection.deleteFile(study.id);\n    } else {\n      const { id, name, description } = study;\n      // TODO: actually do different statuses?\n      selection.setFile({ id, name, description, accessStatus: 'approved' });\n    }\n  };\n\n  handleFilesExpanded = () => {\n    this.filesExpanded = !this.filesExpanded;\n  };\n\n  handlePermissionsExpanded = () => {\n    this.permissionsExpanded = !this.permissionsExpanded;\n  };\n\n  render() {\n    const isSelectable = this.isSelectable; // Internal and external guests can't select studies\n    const study = this.study;\n    const selection = this.props.filesSelection;\n    const isSelected = selection.hasFile(study.id);\n    const attrs = {};\n    const onClickAttr = {};\n\n    if (isSelected) attrs.color = 'blue';\n    if (isSelectable) onClickAttr.onClick = () => this.handleFileSelection(study);\n\n    return (\n      <Segment clearing padded raised className=\"mb3\" {...attrs}>\n        <div className=\"flex\">\n          <div className=\"mr2\" {...onClickAttr}>\n            {isSelectable && <Checkbox checked={isSelected} style={{ marginTop: '3px' }} />}\n          </div>\n          <div className=\"flex-auto mb1\">\n            {this.renderHeader(study)}\n            {this.renderDescription(study)}\n            {this.renderFilesAccordion(study)}\n            {this.renderPermissionsAccordion(study)}\n          </div>\n        </div>\n      </Segment>\n    );\n  }\n\n  renderHeader(study) {\n    const isSelectable = this.isSelectable; // Internal and external guests can't select studies\n    const onClickAttr = {};\n\n    if (isSelectable) onClickAttr.onClick = () => this.handleFileSelection(study);\n\n    return (\n      <>\n        {study.uploadLocationEnabled && study.canUpload && <UploadStudyFiles studyId={study.id} />}\n        <Header as=\"h3\" color=\"blue\" className={c('mt0', isSelectable ? 'cursor-pointer' : '')} {...onClickAttr}>\n          {study.name}\n          <Header.Subheader>\n            <span className=\"pt1 fs-8 color-grey\">{study.id}</span>\n            {study.projectId && <span className=\"fs-8 color-grey\"> &middot; {study.projectId}</span>}\n          </Header.Subheader>\n        </Header>\n      </>\n    );\n  }\n\n  renderDescription(study) {\n    return <div>{study.description}</div>;\n  }\n\n  renderFilesAccordion(study) {\n    if (study.isOpenDataStudy) return null;\n    if (!study.uploadLocationEnabled) return null;\n    const expanded = this.filesExpanded;\n\n    return (\n      <Accordion className=\"mt2\">\n        <Accordion.Title active={expanded} index={0} onClick={this.handleFilesExpanded}>\n          <Icon name=\"dropdown\" />\n          <b>Files</b>\n        </Accordion.Title>\n        <Accordion.Content active={expanded}>\n          {expanded && study.uploadLocationEnabled && (\n            <div className=\"mb2\">\n              <StudyFilesTable study={study} />\n            </div>\n          )}\n        </Accordion.Content>\n      </Accordion>\n    );\n  }\n\n  renderPermissionsAccordion(study) {\n    if (!study.isOrganizationStudy) return null;\n    const expanded = this.permissionsExpanded;\n\n    return (\n      <Accordion className=\"mt0\">\n        <Accordion.Title active={expanded} index={0} onClick={this.handlePermissionsExpanded}>\n          <Icon name=\"dropdown\" />\n          <b>Permissions</b>\n        </Accordion.Title>\n        <Accordion.Content active={expanded}>{expanded && <StudyPermissionsTable study={study} />}</Accordion.Content>\n      </Accordion>\n    );\n  }\n}\n\ndecorate(StudyRow, {\n  handleFileSelection: action,\n  handleFilesExpanded: action,\n  handlePermissionsExpanded: action,\n  study: computed,\n  filesExpanded: observable,\n  permissionsExpanded: observable,\n  isSelectable: computed,\n});\n\nexport default inject('filesSelection')(observer(StudyRow));\n"],"file":"StudyRow.js"}