{"version":3,"sources":["../../../src/parts/accounts/AwsAccountsList.js"],"names":["AwsAccountsList","props","handleAddAwsAccount","handleCreateAwsAccount","state","mapOfUsersBeingEdited","accountsStore","awsAccountsStore","load","startHeartbeat","stopHeartbeat","store","getAwsAccountsStore","list","awsAccountsData","getAwsAccounts","pageSize","showPagination","length","filter","row","columnValue","String","id","toLowerCase","filterValue","value","indexOf","Header","accessor","filterable","Cell","cell","handleBudgetConfiguration","original","pathname","location","link","history","push","awsAccountId","renderTotal","removeItem","componentDidMount","pendingAccount","listCreatingAccount","errorAccounts","listErrorAccount","map","account","handleDismiss","content","error","renderMain","renderHeader","renderCreatingAccountNotification","React","Component","observable"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { Button, Container, Header, Icon, Label, Message } from 'semantic-ui-react';\nimport { withRouter } from 'react-router-dom';\nimport { decorate, observable, runInAction } from 'mobx';\nimport { inject, observer } from 'mobx-react';\nimport ReactTable from 'react-table';\n\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreError, isStoreLoading } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\nclass AwsAccountsList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n    runInAction(() => {\n      // An object that keeps track of which user is being edited\n      // Each key in the object below has key as user's unique id (i.e., uid)\n      // and value as flag indicating whether to show the editor for the user\n      this.mapOfUsersBeingEdited = {};\n    });\n  }\n\n  componentDidMount() {\n    const accountsStore = this.props.accountsStore;\n    const awsAccountsStore = this.props.awsAccountsStore;\n    swallowError(accountsStore.load());\n    swallowError(awsAccountsStore.load());\n    accountsStore.startHeartbeat();\n    awsAccountsStore.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const accountsStore = this.props.accountsStore;\n    const awsAccountsStore = this.props.awsAccountsStore;\n    accountsStore.stopHeartbeat();\n    awsAccountsStore.stopHeartbeat();\n  }\n\n  getAwsAccountsStore() {\n    const store = this.props.awsAccountsStore;\n    return store;\n  }\n\n  getAwsAccounts() {\n    const store = this.getAwsAccountsStore();\n    return store.list;\n  }\n\n  renderMain() {\n    const awsAccountsData = this.getAwsAccounts();\n    const pageSize = 5;\n    const showPagination = awsAccountsData.length > pageSize;\n    return (\n      <div>\n        <ReactTable\n          data={awsAccountsData}\n          showPagination={showPagination}\n          defaultPageSize={pageSize}\n          className=\"-striped -highlight\"\n          filterable\n          defaultFilterMethod={(filter, row) => {\n            const columnValue = String(row[filter.id]).toLowerCase();\n            const filterValue = filter.value.toLowerCase();\n            return columnValue.indexOf(filterValue) >= 0;\n          }}\n          columns={[\n            {\n              Header: 'Account Name',\n              accessor: 'name',\n            },\n            {\n              Header: 'AWS Account ID',\n              accessor: 'accountId',\n            },\n            {\n              Header: 'Description',\n              accessor: 'description',\n            },\n            {\n              Header: 'Role ARN',\n              accessor: 'roleArn',\n            },\n            {\n              Header: 'External ID',\n              accessor: 'externalId',\n            },\n            {\n              Header: 'VPC ID',\n              accessor: 'vpcId',\n            },\n            {\n              Header: 'Subnet ID',\n              accessor: 'subnetId',\n            },\n            {\n              Header: 'Encryption Key Arn',\n              accessor: 'encryptionKeyArn',\n            },\n            {\n              Header: 'Budget Configuration',\n              filterable: false,\n              Cell: observer(cell => (\n                <Button primary compact size=\"mini\" onClick={() => this.handleBudgetConfiguration(cell.original.id)}>\n                  Budget Detail\n                </Button>\n              )),\n            },\n          ]}\n        />\n      </div>\n    );\n  }\n\n  goto(pathname) {\n    const location = this.props.location;\n    const link = createLink({ location, pathname });\n    this.props.history.push(link);\n  }\n\n  handleAddAwsAccount = () => {\n    this.goto('/aws-accounts/add');\n  };\n\n  handleCreateAwsAccount = () => {\n    this.goto('/aws-accounts/create');\n  };\n\n  handleBudgetConfiguration(awsAccountId) {\n    this.goto(`/aws-accounts/budget/${awsAccountId}`);\n  }\n\n  renderHeader() {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"amazon\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">\n            AWS Accounts\n            {this.renderTotal()}\n          </Header.Content>\n        </Header>\n        <Button color=\"blue\" size=\"medium\" basic onClick={this.handleCreateAwsAccount}>\n          Create AWS Account\n        </Button>\n        <Button className=\"ml2\" color=\"blue\" size=\"medium\" basic onClick={this.handleAddAwsAccount}>\n          Add AWS Account\n        </Button>\n      </div>\n    );\n  }\n\n  renderTotal() {\n    return <Label circular>{this.getAwsAccounts().length}</Label>;\n  }\n\n  handleDismiss(id) {\n    const accountsStore = this.props.accountsStore;\n    accountsStore.removeItem(id);\n    this.componentDidMount();\n  }\n\n  renderCreatingAccountNotification() {\n    const accountsStore = this.props.accountsStore;\n    const pendingAccount = accountsStore.listCreatingAccount;\n    const errorAccounts = accountsStore.listErrorAccount;\n    return (\n      <div className=\"mt3 mb3 animated fadeIn\">\n        {pendingAccount.map(account => (\n          <Message>\n            <Icon name=\"circle notched\" loading />\n            Trying to create accountID: {account.id}\n          </Message>\n        ))}\n        {errorAccounts.map(account => (\n          <Message onDismiss={() => this.handleDismiss(account.id)}>\n            <Icon name=\"times\" color=\"red\" />\n            Error happended in creating accountID: {account.id}. If the account is created, please contact follow{' '}\n            <a\n              href=\"https://aws.amazon.com/blogs/security/aws-organizations-now-supports-self-service-removal-of-accounts-from-an-organization/\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              instruction\n            </a>{' '}\n            to remove it. You may close this message after you make sure the account is removed.\n          </Message>\n        ))}\n      </div>\n    );\n  }\n\n  render() {\n    const store = this.getAwsAccountsStore();\n    let content;\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder segmentCount={3} />;\n    } else {\n      content = this.renderMain();\n    }\n    return (\n      <Container className=\"mt3 animated fadeIn\">\n        {this.renderHeader()}\n        {this.renderCreatingAccountNotification()}\n        {content}\n      </Container>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(AwsAccountsList, {\n  mapOfUsersBeingEdited: observable,\n});\n\nexport default inject('awsAccountsStore', 'accountsStore')(withRouter(observer(AwsAccountsList)));\n"],"file":"AwsAccountsList.js"}