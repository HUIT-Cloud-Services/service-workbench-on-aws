{"version":3,"sources":["../../src/parts/UserApplication.js"],"names":["UserApplication","props","handleLogout","event","logoutProcessing","preventDefault","stopPropagation","authentication","logout","handleSubmit","form","user","values","currentUser","firstName","lastName","applyReason","status","getStore","updateUserApplication","updatedUser","state","userStore","cloneUser","$","value","username","content","renderFormSubmittedMessage","renderAddUserPage","renderAddUserForm","processing","usersStore","React","Component","observable"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { decorate, observable, action, runInAction } from 'mobx';\nimport { Button, Header, Container, Message } from 'semantic-ui-react';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\n\nimport { getAddUserApplicationForm } from '../models/forms/AddUserApplicationForm';\n\nclass UserApplication extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n\n    runInAction(() => {\n      this.logoutProcessing = false;\n      this.currentUser = props.userStore.cloneUser;\n    });\n    this.form = getAddUserApplicationForm();\n    this.form.$('email').value = this.currentUser.username;\n  }\n\n  handleLogout = action(async event => {\n    this.logoutProcessing = true;\n    event.preventDefault();\n    event.stopPropagation();\n\n    try {\n      await this.props.authentication.logout();\n      runInAction(() => {\n        this.logoutProcessing = false;\n      });\n    } catch (error) {\n      displayError(error);\n      runInAction(() => {\n        this.logoutProcessing = false;\n      });\n    }\n  });\n\n  render() {\n    let content = null;\n    if (this.currentUser.status === 'pending') {\n      content = this.renderFormSubmittedMessage();\n    } else {\n      content = this.renderAddUserPage();\n    }\n    return content;\n  }\n\n  renderAddUserPage() {\n    return (\n      <Container className=\"pt4\">\n        <div className=\"mt2 animated fadeIn\">\n          <Header as=\"h2\" icon textAlign=\"center\" className=\"mt3\" color=\"grey\">\n            Research Portal Application\n          </Header>\n          <div className=\"mt3 ml3 mr3 animated fadeIn\">{this.renderAddUserForm()}</div>\n        </div>\n      </Container>\n    );\n  }\n\n  renderFormSubmittedMessage() {\n    const processing = this.logoutProcessing;\n    return (\n      <Container text className=\"pt4\">\n        <Message icon>\n          <Message.Content>\n            <Message.Header>We have received your application</Message.Header>\n            You will not have access to the portal until an administrator reviews and approves your application.\n            <div className=\"mt2\">\n              We recommend you logout and login when you have received access.\n              <Button\n                floated=\"right\"\n                color=\"blue\"\n                icon\n                disabled={processing}\n                className=\"ml2\"\n                onClick={this.handleLogout}\n              >\n                Logout\n              </Button>\n            </div>\n          </Message.Content>\n        </Message>\n      </Container>\n    );\n  }\n\n  renderAddUserForm() {\n    const form = this.form;\n\n    return (\n      <Form form={form} onSuccess={this.handleSubmit}>\n        {({ processing }) => (\n          <>\n            <Input field={form.$('email')} disabled className=\"mt3 mb4\" />\n            <Input field={form.$('firstName')} className=\"mt3 mb4\" />\n            <Input field={form.$('lastName')} />\n            <TextArea field={form.$('applyReason')} />\n\n            <Button className=\"ml2 mb3\" floated=\"right\" color=\"blue\" icon disabled={processing} type=\"submit\">\n              Submit Application\n            </Button>\n          </>\n        )}\n      </Form>\n    );\n  }\n\n  handleSubmit = async form => {\n    try {\n      const user = form.values();\n\n      this.currentUser.firstName = user.firstName;\n      this.currentUser.lastName = user.lastName;\n      this.currentUser.applyReason = user.applyReason;\n      this.currentUser.status = 'pending';\n      const updatedUser = await this.getStore().updateUserApplication(this.currentUser);\n      runInAction(() => {\n        this.currentUser.status = updatedUser.status;\n      });\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  getStore() {\n    return this.props.usersStore;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(UserApplication, {\n  logoutProcessing: observable,\n  currentUser: observable,\n});\n\nexport default inject(\n  'userStore',\n  'usersStore',\n  'userRolesStore',\n  'awsAccountsStore',\n  'indexesStore',\n  'authentication',\n)(withRouter(observer(UserApplication)));\n"],"file":"UserApplication.js"}