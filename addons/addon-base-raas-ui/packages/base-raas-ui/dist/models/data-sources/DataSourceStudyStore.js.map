{"version":3,"sources":["../../../src/models/data-sources/DataSourceStudyStore.js"],"names":["DataSourceStudyStore","BaseStore","named","props","accountId","studyId","tickPeriod","actions","self","superCleanup","cleanup","doLoad","study","permissions","_","isUndefined","setPermissions","views","account","parent","a","getStudy"],"mappings":";;;;;;;AAeA;;AACA;;AACA;;AAEA;;;;;;;;AAEA;AACA;AACA;AACA,IAAMA,oBAAoB,GAAGC,qBAAUC,KAAV,CAAgB,sBAAhB,EAC1BC,KAD0B,CACpB;AACLC,EAAAA,SAAS,EAAE,EADN;AAELC,EAAAA,OAAO,EAAE,EAFJ;AAGLC,EAAAA,UAAU,EAAE,IAAI,EAAJ,GAAS,IAHhB,CAGsB;;AAHtB,CADoB,EAO1BC,OAP0B,CAOlB,UAAAC,IAAI,EAAI;AACf;AACA,MAAMC,YAAY,GAAGD,IAAI,CAACE,OAA1B;AAEA,SAAO;AACCC,IAAAA,MADD,oBACU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACPC,gBAAAA,KADO,GACCJ,IAAI,CAACI,KADN;AAAA;AAAA,uBAEa,8BAAoBJ,IAAI,CAACH,OAAzB,CAFb;;AAAA;AAEPQ,gBAAAA,WAFO;;AAAA,qBAGTC,mBAAEC,WAAF,CAAcH,KAAd,CAHS;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAIbA,gBAAAA,KAAK,CAACI,cAAN,CAAqBH,WAArB;;AAJa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKd,KANI;AAQLH,IAAAA,OAAO,EAAE,mBAAM;AACbF,MAAAA,IAAI,CAACJ,SAAL,GAAiB,EAAjB;AACAI,MAAAA,IAAI,CAACH,OAAL,GAAe,EAAf;AACAI,MAAAA,YAAY;AACb;AAZI,GAAP;AAcD,CAzB0B,EA2B1BQ,KA3B0B,CA2BpB,UAAAT,IAAI;AAAA,SAAK;AACd,QAAIU,OAAJ,GAAc;AACZ,UAAMC,MAAM,GAAG,8BAAUX,IAAV,EAAgB,CAAhB,CAAf;AACA,UAAMY,CAAC,GAAGD,MAAM,CAACD,OAAjB;AACA,aAAOE,CAAP;AACD,KALa;;AAMd,QAAIR,KAAJ,GAAY;AACV,aAAOJ,IAAI,CAACU,OAAL,CAAaG,QAAb,CAAsBb,IAAI,CAACH,OAA3B,CAAP;AACD;;AARa,GAAL;AAAA,CA3BgB,CAA7B,C,CAsCA;AACA;AACA","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { getParent } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getStudyPermissions } from '../../helpers/api';\n\n// ==================================================================\n// DataSourceStudyStore\n// ==================================================================\nconst DataSourceStudyStore = BaseStore.named('DataSourceStudyStore')\n  .props({\n    accountId: '',\n    studyId: '',\n    tickPeriod: 1 * 60 * 1000, // 1 minute\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const study = self.study;\n        const permissions = await getStudyPermissions(self.studyId);\n        if (_.isUndefined(study)) return;\n        study.setPermissions(permissions);\n      },\n\n      cleanup: () => {\n        self.accountId = '';\n        self.studyId = '';\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get account() {\n      const parent = getParent(self, 2);\n      const a = parent.account;\n      return a;\n    },\n    get study() {\n      return self.account.getStudy(self.studyId);\n    },\n  }));\n\n// Note: Do NOT register this in the global context, if you want to gain access to an instance\n//       use dataSourceAccountsStore.getDataSourceStudyStore()\n// eslint-disable-next-line import/prefer-default-export\nexport { DataSourceStudyStore };\n"],"file":"DataSourceStudyStore.js"}