{"version":3,"sources":["../../src/models/App.js"],"names":["createAppType","appContext","ParentApp","app","AppType","named","props","userRegistered","actions","self","superInit","init","superCleanup","cleanup","payload","runInAction","userStore","_","get","setUserRegistered","flag","registerContextItems","App","create"],"mappings":";;;;;;;AAgBA;;AACA;;;;;;;;AAEA,SAASA,aAAT,CAAuBC,UAAvB,EAAmC;AACjC,MAAMC,SAAS,GAAG,4BAAQD,UAAU,CAACE,GAAnB,CAAlB;AAEA,MAAMC,OAAO,GAAGF,SAAS,CAACG,KAAV,CAAgB,SAAhB,EACbC,KADa,CACP;AACLC,IAAAA,cAAc,EAAE;AADX,GADO,EAIbC,OAJa,CAIL,UAAAC,IAAI,EAAI;AACf;AACA,QAAMC,SAAS,GAAGD,IAAI,CAACE,IAAvB;AACA,QAAMC,YAAY,GAAGH,IAAI,CAACI,OAA1B;AAEA,WAAO;AACLF,MAAAA,IAAI;AAAA,4EAAE,iBAAMG,OAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBACEJ,SAAS,CAACI,OAAD,CADX;;AAAA;AAEJL,kBAAAA,IAAI,CAACM,WAAL,CAAiB,YAAM;AACrB,wBAAMC,SAAS,GAAG,2BAAOP,IAAP,EAAaO,SAA/B;;AACA,wBAAIC,mBAAEC,GAAF,CAAMF,SAAN,EAAiB,aAAjB,MAAoC,QAAxC,EAAkD;AAChDP,sBAAAA,IAAI,CAACU,iBAAL,CAAuB,IAAvB;AACD;AACF,mBALD;;AAFI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF;;AAAA;AAAA;AAAA;;AAAA;AAAA,SADC;AAWLA,MAAAA,iBAXK,6BAWaC,IAXb,EAWmB;AACtBX,QAAAA,IAAI,CAACF,cAAL,GAAsBa,IAAtB;AACD,OAbI;AAeL;AACAP,MAAAA,OAhBK,qBAgBK;AACRJ,QAAAA,IAAI,CAACU,iBAAL,CAAuB,KAAvB;AACAP,QAAAA,YAAY;AACb;AAnBI,KAAP;AAqBD,GA9Ba,CAAhB;AAgCA,SAAOR,OAAP;AACD;;AAED,SAASiB,oBAAT,CAA8BpB,UAA9B,EAA0C;AACxC,MAAMqB,GAAG,GAAGtB,aAAa,CAACC,UAAD,CAAzB;AACAA,EAAAA,UAAU,CAACE,GAAX,GAAiBmB,GAAG,CAACC,MAAJ,CAAW,EAAX,EAAetB,UAAf,CAAjB;AACD","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable import/prefer-default-export */\nimport _ from 'lodash';\nimport { getEnv, getType } from 'mobx-state-tree';\n\nfunction createAppType(appContext) {\n  const ParentApp = getType(appContext.app);\n\n  const AppType = ParentApp.named('RaasApp')\n    .props({\n      userRegistered: false,\n    })\n    .actions(self => {\n      // save the base implementations of the parent app\n      const superInit = self.init;\n      const superCleanup = self.cleanup;\n\n      return {\n        init: async payload => {\n          await superInit(payload);\n          self.runInAction(() => {\n            const userStore = getEnv(self).userStore;\n            if (_.get(userStore, 'user.status') === 'active') {\n              self.setUserRegistered(true);\n            }\n          });\n        },\n\n        setUserRegistered(flag) {\n          self.userRegistered = flag;\n        },\n\n        // this method is called by the Cleaner\n        cleanup() {\n          self.setUserRegistered(false);\n          superCleanup();\n        },\n      };\n    });\n\n  return AppType;\n}\n\nfunction registerContextItems(appContext) {\n  const App = createAppType(appContext);\n  appContext.app = App.create({}, appContext);\n}\n\nexport { registerContextItems };\n"],"file":"App.js"}