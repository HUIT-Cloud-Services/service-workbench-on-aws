{"version":3,"sources":["../../../src/parts/api-keys/ApiKeysList.js"],"names":["ApiKeysList","handleCreateApiKey","getStore","createNewApiKey","handleRevokeApiKey","apiKeyId","revokeApiKey","props","userApiKeysStore","getCurrentUserApiKeysStore","store","load","content","error","renderEmpty","renderMain","apiKeys","_","orderBy","list","renderTotal","count","length","renderRow","rowNum","apiKey","panels","key","title","minWidth","createdAt","effectiveStatus","capitalize","isActive","id","renderTableBody","map","Component"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React, { Component } from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Container, Header, Icon, Accordion, Table, Button, Label } from 'semantic-ui-react';\n\nimport TimeAgo from 'react-timeago';\nimport _ from 'lodash';\nimport { swallowError } from '../../helpers/utils';\nimport { isStoreEmpty, isStoreError, isStoreLoading, isStoreNotEmpty, isStoreReady } from '../../models/BaseStore';\nimport Progress from '../helpers/Progress';\nimport ErrorBox from '../helpers/ErrorBox';\nimport { displayError } from '../../helpers/notification';\n\n// expected props\n// - userApiKeysStore (via injection)\nclass ApiKeysList extends Component {\n  getStore() {\n    return this.props.userApiKeysStore.getCurrentUserApiKeysStore();\n  }\n\n  componentDidMount() {\n    const store = this.getStore();\n    swallowError(store.load());\n  }\n\n  render() {\n    const store = this.getStore();\n    let content;\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} />;\n    } else if (isStoreLoading(store)) {\n      content = (\n        <div className=\"m3\">\n          <Progress />\n        </div>\n      );\n    } else if (isStoreReady(store) && isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (isStoreReady(store) && isStoreNotEmpty(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n    return <div className=\"mt3 ml3 mr3 animated fadeIn\">{content}</div>;\n  }\n\n  renderEmpty() {\n    return (\n      <Container text className=\"mt4 center\">\n        <Header as=\"h2\" icon textAlign=\"center\" className=\"mt3\" color=\"grey\">\n          <Icon name=\"key\" circular />\n          <div className=\"mt3 ml3 mr3 animated fadeIn\">You do not have any API Keys.</div>\n          <div className=\"mt3 ml3 mr3 animated fadeIn\">\n            <Button color=\"blue\" size=\"medium\" basic onClick={this.handleCreateApiKey}>\n              Create New API Key\n            </Button>\n          </div>\n        </Header>\n      </Container>\n    );\n  }\n\n  handleCreateApiKey = async () => {\n    try {\n      await this.getStore().createNewApiKey();\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  handleRevokeApiKey = async apiKeyId => {\n    try {\n      await this.getStore().revokeApiKey(apiKeyId);\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  renderMain() {\n    const apiKeys = _.orderBy(this.getStore().list, ['createdAt', 'status'], ['desc', 'asc']);\n    const renderTotal = () => {\n      const count = apiKeys.length;\n      return (\n        <div className=\"flex mb3\">\n          <Header as=\"h2\" color=\"grey\" className=\"flex-auto ml3\">\n            You have{' '}\n            <Label circular size=\"huge\">\n              {count}\n            </Label>{' '}\n            API Keys\n          </Header>\n          <Button color=\"blue\" size=\"medium\" basic onClick={this.handleCreateApiKey}>\n            Create New API Key\n          </Button>\n        </div>\n      );\n    };\n    const renderRow = (rowNum, apiKey) => {\n      const panels = [\n        {\n          key: `panel-${rowNum}`,\n          title: {\n            content: <Label color=\"blue\" content={`Key ${rowNum}`} />,\n          },\n          content: {\n            content: (\n              <div>\n                <textarea style={{ minWidth: '400px' }} rows={7} disabled value={apiKey.key} />\n              </div>\n            ),\n          },\n        },\n      ];\n      return (\n        <Table.Row key={rowNum} className=\"fit animated fadeIn\">\n          <Table.Cell textAlign=\"left\" collapsing>\n            {rowNum}\n          </Table.Cell>\n          <Table.Cell textAlign=\"left\">\n            <Accordion defaultActiveIndex={1} panels={panels} />\n          </Table.Cell>\n          <Table.Cell textAlign=\"center\" collapsing>\n            <TimeAgo date={apiKey.createdAt} />\n          </Table.Cell>\n          <Table.Cell textAlign=\"center\" collapsing>\n            <Label color={apiKey.effectiveStatus === 'active' ? 'green' : 'red'} size=\"small\">\n              {_.capitalize(apiKey.effectiveStatus)}\n            </Label>\n          </Table.Cell>\n          <Table.Cell textAlign=\"center\" collapsing>\n            <Button\n              size=\"small\"\n              color=\"red\"\n              disabled={!apiKey.isActive}\n              onClick={() => this.handleRevokeApiKey(apiKey.id)}\n            >\n              Revoke\n            </Button>\n          </Table.Cell>\n        </Table.Row>\n      );\n    };\n    const renderTableBody = () => {\n      let rowNum = 0;\n      return _.map(apiKeys, apiKey => {\n        ++rowNum;\n        return renderRow(rowNum, apiKey);\n      });\n    };\n    return (\n      <Container text className=\"mt4 center\">\n        {renderTotal()}\n        <div>\n          <Table celled striped stackable selectable size=\"small\">\n            <Table.Header>\n              <Table.Row>\n                <Table.HeaderCell textAlign=\"left\" collapsing>\n                  #\n                </Table.HeaderCell>\n                <Table.HeaderCell textAlign=\"left\">Key</Table.HeaderCell>\n                <Table.HeaderCell textAlign=\"center\" collapsing>\n                  Issued\n                </Table.HeaderCell>\n                <Table.HeaderCell textAlign=\"center\" collapsing>\n                  Status\n                </Table.HeaderCell>\n                <Table.HeaderCell textAlign=\"center\" collapsing />\n              </Table.Row>\n            </Table.Header>\n            <Table.Body>{renderTableBody()}</Table.Body>\n          </Table>\n        </div>\n      </Container>\n    );\n  }\n}\n\nexport default inject('userApiKeysStore')(withRouter(observer(ApiKeysList)));\n"],"file":"ApiKeysList.js"}