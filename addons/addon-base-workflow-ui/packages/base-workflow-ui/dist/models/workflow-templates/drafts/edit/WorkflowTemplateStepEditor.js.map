{"version":3,"sources":["../../../../../src/models/workflow-templates/drafts/edit/WorkflowTemplateStepEditor.js"],"names":["_","types","getParent","getEnv","clone","getSnapshot","getWorkflowStepDescForm","getWorkflowStepPropsForm","getWorkflowStepConfigOverrideForm","getWorkflowStepPropsOverrideForm","ConfigurationEditor","WorkflowTemplateStepEditor","model","stepId","contentExpanded","configEdit","configOverrideEdit","descEdit","propsEdit","propsOverrideEdit","volatile","_self","configurationEditor","undefined","stepDescForm","stepConfigOverrideForm","stepPropsForm","stepPropsOverrideForm","actions","self","runInAction","fn","afterAttach","step","inputManifest","get","defaults","create","isUndefined","configuration","setContentExpanded","flag","setConfigEdit","setConfigOverrideEdit","setDescEdit","setPropsEdit","setPropsOverrideEdit","applyDefaults","configs","setDefaults","applyConfigOverrides","configOverrides","setConfigOverrideOption","allowed","applyPropsOverrides","propsOverrides","setPropsOverrideOption","applyDescAndTitle","desc","title","setDesc","setTitle","applySkippable","skippable","setSkippable","views","version","getStep","parentEditor","configOverrideForm","descForm","propsForm","propsOverrideForm","editing"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getParent, getEnv, clone, getSnapshot } from 'mobx-state-tree';\n\nimport getWorkflowStepDescForm from '../../../forms/WorkflowStepDescForm';\nimport getWorkflowStepPropsForm from '../../../forms/WorkflowStepPropsForm';\nimport getWorkflowStepConfigOverrideForm from '../../../forms/WorkflowStepConfigOverrideForm';\nimport getWorkflowStepPropsOverrideForm from '../../../forms/WorkflowStepPropsOverrideForm';\nimport ConfigurationEditor from '../../../configuration/ConfigurationEditor';\n\n// ==================================================================\n// WorkflowTemplateStepEditor\n// ==================================================================\nconst WorkflowTemplateStepEditor = types\n  .model('WorkflowTemplateStepEditor', {\n    stepId: '', // The step Id for the workflow template step\n    contentExpanded: false,\n    configEdit: false, // If we are editing mode or not for the configuration section\n    configOverrideEdit: false, // If we are editing mode or not for the configuration override section\n    descEdit: false, // If we are editing mode or not for the description section\n    propsEdit: false, // If we are editing mode or not for the props section\n    propsOverrideEdit: false, // If we are editing mode or not for the props override section\n  })\n\n  .volatile(_self => ({\n    configurationEditor: undefined,\n    stepDescForm: undefined,\n    stepConfigOverrideForm: undefined,\n    stepPropsForm: undefined,\n    stepPropsOverrideForm: undefined,\n  }))\n\n  .actions(self => {\n    return {\n      // I had issues using runInAction from mobx\n      // the issue is discussed here https://github.com/mobxjs/mobx-state-tree/issues/915\n      runInAction(fn) {\n        return fn();\n      },\n\n      afterAttach() {\n        if (self.configurationEditor !== undefined) return;\n        const step = self.step;\n        const inputManifest = _.get(step, 'stepTemplate.adminInputManifest');\n        const defaults = getSnapshot(step.defaults);\n\n        self.configurationEditor = ConfigurationEditor.create(\n          {\n            inputManifest: _.isUndefined(inputManifest) ? undefined : clone(inputManifest),\n            configuration: defaults,\n          },\n          getEnv(self),\n        );\n\n        self.stepConfigOverrideForm = getWorkflowStepConfigOverrideForm(step);\n        self.stepDescForm = getWorkflowStepDescForm(step);\n        self.stepPropsForm = getWorkflowStepPropsForm(step);\n        self.stepPropsOverrideForm = getWorkflowStepPropsOverrideForm(step);\n      },\n\n      setContentExpanded(flag) {\n        self.contentExpanded = !!flag; // !! will simply turn any type to a boolean type\n      },\n\n      setConfigEdit(flag) {\n        self.configEdit = flag;\n      },\n\n      setConfigOverrideEdit(flag) {\n        self.configOverrideEdit = flag;\n      },\n\n      setDescEdit(flag) {\n        self.descEdit = flag;\n      },\n\n      setPropsEdit(flag) {\n        self.propsEdit = flag;\n      },\n\n      setPropsOverrideEdit(flag) {\n        self.propsOverrideEdit = flag;\n      },\n\n      applyDefaults(configs = {}) {\n        self.step.setDefaults(configs);\n      },\n\n      applyConfigOverrides(configOverrides = []) {\n        self.step.setConfigOverrideOption({\n          allowed: configOverrides,\n        });\n        self.stepConfigOverrideForm = getWorkflowStepConfigOverrideForm(self.step);\n      },\n\n      applyPropsOverrides(propsOverrides = []) {\n        self.step.setPropsOverrideOption({\n          allowed: propsOverrides,\n        });\n        self.stepPropsOverrideForm = getWorkflowStepPropsOverrideForm(self.step);\n      },\n\n      applyDescAndTitle(desc, title) {\n        self.step.setDesc(desc);\n        self.step.setTitle(title);\n        self.stepDescForm = getWorkflowStepDescForm(self.step);\n      },\n\n      applySkippable(skippable) {\n        self.step.setSkippable(skippable);\n        self.stepPropsForm = getWorkflowStepPropsForm(self.step);\n      },\n    };\n  })\n\n  .views(self => ({\n    get step() {\n      const version = self.version;\n      return version.getStep(self.stepId);\n    },\n\n    get version() {\n      const parentEditor = getParent(self, 2);\n      return parentEditor.version;\n    },\n\n    get configOverrideForm() {\n      return self.stepConfigOverrideForm;\n    },\n\n    get descForm() {\n      return self.stepDescForm;\n    },\n\n    get propsForm() {\n      return self.stepPropsForm;\n    },\n\n    get propsOverrideForm() {\n      return self.stepPropsOverrideForm;\n    },\n\n    get editing() {\n      return self.configEdit || self.descEdit || self.propsEdit || self.configOverrideEdit || self.propsOverrideEdit;\n    },\n  }));\n\nexport default WorkflowTemplateStepEditor;\n"],"file":"WorkflowTemplateStepEditor.js"}