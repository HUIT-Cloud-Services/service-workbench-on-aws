{"version":3,"sources":["../../../../../src/parts/workflow-common/drafts/edit/WorkflowCommonStepDescEditor.js"],"names":["_","React","observer","inject","decorate","action","computed","Icon","Divider","Header","Button","Form","Input","TextArea","WorkflowCommonStepDescEditor","Component","handleEditOn","event","preventDefault","stopPropagation","stepEditorModel","getStepEditor","setDescEdit","handleEditOff","handleSave","form","onSave","props","noop","stepTitle","stepDesc","values","applyDescAndTitle","stepEditor","getStep","step","getDescForm","descForm","editing","descEdit","render","canEdit","className","renderEditingContent","renderReadOnlyContent","__html","descHtml","stepTitleField","$","stepDescField","processing","_onSubmit","onCancel"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, computed } from 'mobx';\nimport { Icon, Divider, Header, Button } from 'semantic-ui-react';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\n\n// expected props\n// - stepEditor - a WorkflowStepEditor or a WorkflowTemplateStepEditor model instance (via props)\n// - onSave - called when the desc/title are saved (via props)\n// - className (via props)\nclass WorkflowCommonStepDescEditor extends React.Component {\n  getStepEditor() {\n    return this.props.stepEditor;\n  }\n\n  getStep() {\n    return this.getStepEditor().step;\n  }\n\n  getDescForm() {\n    return this.getStepEditor().descForm;\n  }\n\n  get editing() {\n    return this.getStepEditor().descEdit;\n  }\n\n  handleEditOn = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setDescEdit(true);\n  };\n\n  handleEditOff = () => {\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setDescEdit(false);\n  };\n\n  handleSave = async form => {\n    const onSave = this.props.onSave || _.noop;\n    const stepEditorModel = this.getStepEditor();\n    const { stepTitle, stepDesc } = form.values();\n\n    stepEditorModel.applyDescAndTitle(stepDesc, stepTitle);\n\n    await onSave();\n    stepEditorModel.setDescEdit(false);\n  };\n\n  render() {\n    const editing = this.editing;\n    const canEdit = !editing;\n\n    return (\n      <div className={this.props.className}>\n        {!editing && (\n          <div className=\"flex animated\">\n            <div className=\"flex-auto\">\n              <Icon name=\"file alternate outline\" className=\"mr1 color-grey\" />\n              <b>Description</b>\n            </div>\n            {canEdit && (\n              <div className=\"pl1 pr0\" onClick={this.handleEditOn}>\n                <Icon name=\"edit\" color=\"grey\" className=\"cursor-pointer\" />\n              </div>\n            )}\n          </div>\n        )}\n        <Divider className=\"mt1 mb2\" />\n        {editing && this.renderEditingContent()}\n        {!editing && this.renderReadOnlyContent()}\n      </div>\n    );\n  }\n\n  renderReadOnlyContent() {\n    const step = this.getStep();\n\n    return <div className=\"animated\" dangerouslySetInnerHTML={{ __html: step.descHtml }} />; // eslint-disable-line react/no-danger\n  }\n\n  renderEditingContent() {\n    const form = this.getDescForm();\n    const stepTitleField = form.$('stepTitle');\n    const stepDescField = form.$('stepDesc');\n\n    return (\n      <>\n        <Header textAlign=\"center\" as=\"h2\" color=\"grey\" className=\"mt1 mb3\">\n          Change Title &amp; Description\n        </Header>\n        <Form form={form} dimmer={false} onCancel={this.handleEditOff} onSuccess={this.handleSave}>\n          {({ processing, _onSubmit, onCancel }) => (\n            <>\n              <Input field={stepTitleField} disabled={processing} />\n              <TextArea field={stepDescField} rows={6} disabled={processing} />\n              <div className=\"mt3 clearfix\">\n                <Button\n                  floated=\"right\"\n                  color=\"blue\"\n                  icon=\"save\"\n                  labelPosition=\"left\"\n                  disabled={processing}\n                  className=\"ml2\"\n                  type=\"submit\"\n                  content=\"Save\"\n                />\n                <Button floated=\"left\" disabled={processing} onClick={onCancel}>\n                  Cancel\n                </Button>\n              </div>\n            </>\n          )}\n        </Form>\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowCommonStepDescEditor, {\n  editing: computed,\n  handleEditOn: action,\n  handleEditOff: action,\n  handleSave: action,\n});\n\nexport default inject()(observer(WorkflowCommonStepDescEditor));\n"],"file":"WorkflowCommonStepDescEditor.js"}