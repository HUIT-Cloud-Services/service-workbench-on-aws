{"version":3,"sources":["../../../../../src/parts/workflow-common/drafts/edit/WorkflowCommonStepConfigEditor.js"],"names":["_","React","observer","inject","decorate","action","computed","Segment","Icon","Divider","Header","ConfigTable","ConfigurationEditor","ConfigurationReview","WorkflowCommonStepConfigEditor","Component","handleEditOn","event","preventDefault","stopPropagation","stepEditorModel","getStepEditor","setConfigEdit","handleEditOff","handleSave","configs","onSave","props","noop","stepEditor","getStep","step","editing","configEdit","render","configRows","configSummaryRows","hasConfigRows","length","canEdit","className","renderConfigEditingContent","renderConfigContent","model","configurationEditor","review"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, computed } from 'mobx';\nimport { Segment, Icon, Divider, Header } from 'semantic-ui-react';\nimport ConfigTable from '@aws-ee/base-ui/dist/parts/configuration/ConfigTable';\nimport ConfigurationEditor from '@aws-ee/base-ui/dist/parts/configuration/ConfigurationEditor';\nimport ConfigurationReview from '@aws-ee/base-ui/dist/parts/configuration/ConfigurationReview';\n\n// expected props\n// - stepEditor - a WorkflowStepEditor or a WorkflowTemplateStepEditor model instance (via props)\n// - onSave - called when the configuration is saved (via props)\n// - className (via props)\nclass WorkflowCommonStepConfigEditor extends React.Component {\n  getStepEditor() {\n    return this.props.stepEditor;\n  }\n\n  getStep() {\n    return this.getStepEditor().step;\n  }\n\n  get editing() {\n    return this.getStepEditor().configEdit;\n  }\n\n  handleEditOn = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setConfigEdit(true);\n  };\n\n  handleEditOff = () => {\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setConfigEdit(false);\n  };\n\n  handleSave = async configs => {\n    const onSave = this.props.onSave || _.noop;\n    const stepEditorModel = this.getStepEditor();\n\n    await onSave(configs);\n    stepEditorModel.setConfigEdit(false);\n  };\n\n  render() {\n    const editing = this.editing;\n    const step = this.getStep();\n    const configRows = step.configSummaryRows || [];\n    const hasConfigRows = configRows.length > 0;\n    const canEdit = !editing && hasConfigRows;\n\n    return (\n      <div className={this.props.className}>\n        {!editing && (\n          <div className=\"flex animated\">\n            <div className=\"flex-auto\">\n              <Icon name=\"cog\" className=\"mr1 color-grey\" />\n              <b>Configuration</b>\n            </div>\n            {canEdit && (\n              <div className=\"pl1 pr0\" onClick={this.handleEditOn}>\n                <Icon name=\"edit\" color=\"grey\" className=\"cursor-pointer\" />\n              </div>\n            )}\n          </div>\n        )}\n        <Divider className=\"mt1 mb2\" />\n        {editing && this.renderConfigEditingContent()}\n        {!editing && this.renderConfigContent()}\n      </div>\n    );\n  }\n\n  renderConfigContent() {\n    const step = this.getStep();\n    const configRows = step.configSummaryRows || [];\n    const hasConfigRows = configRows.length > 0;\n\n    return (\n      <>\n        {hasConfigRows && (\n          <Segment padded className=\"animated\">\n            <ConfigTable rows={configRows} />\n          </Segment>\n        )}\n        {!hasConfigRows && <div>No configuration entries are available</div>}\n      </>\n    );\n  }\n\n  renderConfigEditingContent() {\n    const model = this.getStepEditor().configurationEditor;\n    const review = model.review;\n\n    if (review) {\n      return (\n        <>\n          <Header textAlign=\"center\" as=\"h2\" color=\"grey\" className=\"mt1 mb3\">\n            Review Configuration Changes\n          </Header>\n          <ConfigurationReview model={model} onCancel={this.handleEditOff} onSave={this.handleSave} dimmer={false} />\n        </>\n      );\n    }\n\n    return (\n      <>\n        <Header textAlign=\"center\" as=\"h2\" color=\"grey\" className=\"mt1 mb3\">\n          Change Configuration\n        </Header>\n        <ConfigurationEditor model={model} onCancel={this.handleEditOff} />\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowCommonStepConfigEditor, {\n  editing: computed,\n  handleEditOn: action,\n  handleEditOff: action,\n  handleSave: action,\n});\n\nexport default inject()(observer(WorkflowCommonStepConfigEditor));\n"],"file":"WorkflowCommonStepConfigEditor.js"}