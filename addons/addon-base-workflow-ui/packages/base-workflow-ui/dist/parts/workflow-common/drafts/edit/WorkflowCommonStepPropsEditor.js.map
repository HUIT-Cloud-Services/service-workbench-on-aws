{"version":3,"sources":["../../../../../src/parts/workflow-common/drafts/edit/WorkflowCommonStepPropsEditor.js"],"names":["_","React","observer","inject","decorate","action","computed","Icon","Divider","Button","Segment","Header","Form","Toggle","PropertyTable","WorkflowCommonStepPropsEditor","Component","handleEditOn","event","preventDefault","stopPropagation","stepEditorModel","getStepEditor","setPropsEdit","handleEditOff","handleSave","form","onSave","props","noop","skippable","values","applySkippable","stepEditor","getStep","step","getPropsForm","propsForm","editing","propsEdit","render","canEdit","className","renderEditingContent","renderReadOnlyContent","propertyRows","propertySummaryRows","skippableField","$","processing","_onSubmit","onCancel"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, computed } from 'mobx';\nimport { Icon, Divider, Button, Segment, Header } from 'semantic-ui-react';\n\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport Toggle from '@aws-ee/base-ui/dist/parts/helpers/fields/Toggle';\nimport PropertyTable from '../../../workflow-templates/PropertyTable';\n\n// expected props\n// - stepEditor - a WorkflowStepEditor or aWorkflowTemplateStepEditor model instance (via props)\n// - onSave - called when the props are saved (via props)\n// - className (via props)\nclass WorkflowCommonStepPropsEditor extends React.Component {\n  getStepEditor() {\n    return this.props.stepEditor;\n  }\n\n  getStep() {\n    return this.getStepEditor().step;\n  }\n\n  getPropsForm() {\n    return this.getStepEditor().propsForm;\n  }\n\n  get editing() {\n    return this.getStepEditor().propsEdit;\n  }\n\n  handleEditOn = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setPropsEdit(true);\n  };\n\n  handleEditOff = () => {\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setPropsEdit(false);\n  };\n\n  handleSave = async form => {\n    const onSave = this.props.onSave || _.noop;\n    const stepEditorModel = this.getStepEditor();\n    const { skippable } = form.values();\n\n    stepEditorModel.applySkippable(skippable);\n\n    await onSave();\n    stepEditorModel.setPropsEdit(false);\n  };\n\n  render() {\n    const editing = this.editing;\n    const canEdit = !editing;\n\n    return (\n      <div className={this.props.className}>\n        {!editing && (\n          <div className=\"flex animated\">\n            <div className=\"flex-auto\">\n              <Icon name=\"file alternate outline\" className=\"mr1 color-grey\" />\n              <b>Properties</b>\n            </div>\n            {canEdit && (\n              <div className=\"pl1 pr0\" onClick={this.handleEditOn}>\n                <Icon name=\"edit\" color=\"grey\" className=\"cursor-pointer\" />\n              </div>\n            )}\n          </div>\n        )}\n        <Divider className=\"mt1 mb2\" />\n        {editing && this.renderEditingContent()}\n        {!editing && this.renderReadOnlyContent()}\n      </div>\n    );\n  }\n\n  renderReadOnlyContent() {\n    const step = this.getStep();\n    const propertyRows = step.propertySummaryRows || [];\n    return (\n      <Segment padded className=\"animated\">\n        <PropertyTable rows={propertyRows} />\n      </Segment>\n    );\n  }\n\n  renderEditingContent() {\n    const form = this.getPropsForm();\n    const skippableField = form.$('skippable');\n\n    return (\n      <>\n        <Header textAlign=\"center\" as=\"h2\" color=\"grey\" className=\"mt1 mb3\">\n          Change Properties\n        </Header>\n        <Form form={form} dimmer={false} onCancel={this.handleEditOff} onSuccess={this.handleSave}>\n          {({ processing, _onSubmit, onCancel }) => (\n            <div className=\"mt3\">\n              <Toggle field={skippableField} disabled={processing} />\n              <div className=\"mt3 clearfix\">\n                <Button\n                  floated=\"right\"\n                  color=\"blue\"\n                  icon=\"save\"\n                  labelPosition=\"left\"\n                  disabled={processing}\n                  className=\"ml2\"\n                  type=\"submit\"\n                  content=\"Save\"\n                />\n                <Button floated=\"left\" disabled={processing} onClick={onCancel}>\n                  Cancel\n                </Button>\n              </div>\n            </div>\n          )}\n        </Form>\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowCommonStepPropsEditor, {\n  editing: computed,\n  handleEditOn: action,\n  handleEditOff: action,\n  handleSave: action,\n});\n\nexport default inject()(observer(WorkflowCommonStepPropsEditor));\n"],"file":"WorkflowCommonStepPropsEditor.js"}