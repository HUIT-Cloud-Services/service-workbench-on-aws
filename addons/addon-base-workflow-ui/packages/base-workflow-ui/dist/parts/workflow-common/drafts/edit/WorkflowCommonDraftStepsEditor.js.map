{"version":3,"sources":["../../../../../src/parts/workflow-common/drafts/edit/WorkflowCommonDraftStepsEditor.js"],"names":["_","React","observer","inject","Observer","decorate","action","runInAction","observable","Button","Header","Dimmer","Loader","Message","DragDropContext","Droppable","Draggable","c","displayError","displaySuccess","AddStepDropDown","WorkflowCommonDraftStepsEditor","Component","constructor","props","handleAddStep","step","getEditor","addStep","handleCancel","event","preventDefault","stopPropagation","clickedOnNext","processing","onCancel","noop","handleDelete","editor","version","getVersion","id","removeStep","setTimeout","removeStepEditor","handleNext","handleSave","handlePrevious","previousPage","draft","update","nextPage","error","handleStepSave","onDragEnd","result","canRearrangeSteps","draggableId","destination","source","isSource","droppableId","isDestination","isStep","getStep","index","reinsertStep","componentDidMount","window","scrollTo","getStepEditorComponent","stepEditor","getSelectedSteps","selectedSteps","render","editing","stepEditorsEditing","hasPrevious","hasPreviousPage","canRearrange","provided","snapshot","droppableProps","innerRef","isDraggingOver","renderSelectedSteps","placeholder","size","length","getStepEditor","StepEditorComponent","map","_snapshot","dragHandleProps","draggableProps"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject, Observer } from 'mobx-react';\nimport { decorate, action, runInAction, observable } from 'mobx';\nimport { Button, Header, Dimmer, Loader, Message } from 'semantic-ui-react';\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\nimport c from 'classnames';\nimport { displayError, displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\n\nimport AddStepDropDown from '../../../workflow-step-templates/AddStepDropDown';\n\n// expected props\n// - editor (via prop) an instance of the WorkflowTemplateDraftEditor model or WorkflowDraftEditor model\n// - stepEditor (vai props) an instance of the WorkflowTemplateStepEditor react component or WorkflowStepEditor reactComponent\nclass WorkflowCommonDraftStepsEditor extends React.Component {\n  constructor(props) {\n    super(props);\n\n    runInAction(() => {\n      this.processing = false;\n      this.clickedOnNext = false;\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  getEditor() {\n    return this.props.editor;\n  }\n\n  getStepEditorComponent() {\n    return this.props.stepEditor;\n  }\n\n  getVersion() {\n    return this.getEditor().version;\n  }\n\n  getSelectedSteps() {\n    return this.getVersion().selectedSteps;\n  }\n\n  handleAddStep = step => {\n    if (!step) return;\n    this.getEditor().addStep(step);\n  };\n\n  handleCancel = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.clickedOnNext = false;\n    this.processing = false;\n    const onCancel = this.props.onCancel || _.noop;\n    onCancel();\n  };\n\n  handleDelete = step => {\n    const editor = this.getEditor();\n    const version = this.getVersion();\n    const id = step.id;\n\n    version.removeStep(step);\n    setTimeout(() => {\n      editor.removeStepEditor(id);\n    }, 150);\n  };\n\n  handleNext = async event => {\n    this.clickedOnNext = true;\n    return this.handleSave(event);\n  };\n\n  handlePrevious = event => {\n    // we don't save the form in this case\n    event.preventDefault();\n    event.stopPropagation();\n    this.clickedOnNext = false;\n    this.getEditor().previousPage();\n  };\n\n  handleSave = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const editor = this.getEditor();\n    const { draft } = editor;\n\n    this.processing = true;\n\n    try {\n      await editor.update(draft);\n      runInAction(() => {\n        this.processing = false;\n      });\n      if (this.clickedOnNext) {\n        this.getEditor().nextPage();\n        return;\n      }\n      displaySuccess('Saved successfully');\n    } catch (error) {\n      runInAction(() => {\n        this.processing = false;\n        this.clickedOnNext = false;\n      });\n      displayError(error);\n    }\n  };\n\n  handleStepSave = async () => {\n    const editor = this.getEditor();\n    const { draft } = editor;\n\n    this.processing = true;\n\n    try {\n      await editor.update(draft);\n      runInAction(() => {\n        this.processing = false;\n      });\n      displaySuccess('Saved successfully');\n    } catch (error) {\n      runInAction(() => {\n        this.processing = false;\n      });\n      displayError(error);\n    }\n  };\n\n  onDragEnd = result => {\n    const version = this.getVersion();\n    if (!version.canRearrangeSteps) return;\n\n    // see https://egghead.io/lessons/react-persist-list-reordering-with-react-beautiful-dnd-using-the-ondragend-callback\n    const { draggableId, destination, source } = result;\n    const isSource = source.droppableId === 'selected-steps';\n    const isDestination = destination && destination.droppableId === 'selected-steps';\n    const isStep = !!version.getStep(draggableId);\n\n    if (!destination) {\n      // we don't support removal of a step by dragging it out of its container\n      return;\n    }\n\n    if (destination.droppableId === source.droppableId && destination.index === source.index) {\n      // we don't need to do anything here\n      return;\n    }\n\n    if (isSource && isDestination && isStep) {\n      // we are dealing with reordering of the steps\n      version.reinsertStep(source.index, destination.index);\n    }\n  };\n\n  render() {\n    const processing = this.processing;\n    const editor = this.getEditor();\n    const editing = editor.stepEditorsEditing;\n    const hasPrevious = editor.hasPreviousPage;\n    const version = this.getVersion();\n    const canRearrange = version.canRearrangeSteps;\n\n    return (\n      <>\n        <Dimmer.Dimmable dimmed={processing}>\n          <Dimmer active={processing} inverted>\n            <Loader inverted>Processing</Loader>\n          </Dimmer>\n          <Header as=\"h3\" color=\"grey\" className=\"mt0\">\n            Steps\n          </Header>\n          {!canRearrange && (\n            <Message warning>\n              <b className=\"mr1\">Warning</b> The workflow template used by this workflow does <b>not</b> allow for steps\n              to be deleted, added or rearranged\n            </Message>\n          )}\n          {canRearrange && (\n            <DragDropContext onDragEnd={this.onDragEnd}>\n              <Droppable droppableId=\"selected-steps\">\n                {(provided, snapshot) => (\n                  <Observer>\n                    {() => (\n                      <div\n                        {...provided.droppableProps}\n                        ref={provided.innerRef}\n                        className={c('mb3', snapshot.isDraggingOver ? 'bg-lightgreen' : '')}\n                      >\n                        {this.renderSelectedSteps()}\n                        {provided.placeholder}\n                      </div>\n                    )}\n                  </Observer>\n                )}\n              </Droppable>\n            </DragDropContext>\n          )}\n          {!canRearrange && <div className=\"mb3\">{this.renderSelectedSteps()}</div>}\n          <AddStepDropDown className=\"mb3\" onSelected={this.handleAddStep} disabled={!canRearrange} />\n        </Dimmer.Dimmable>\n        {!editing && (\n          <div>\n            <Button\n              floated=\"right\"\n              color=\"teal\"\n              icon=\"right arrow\"\n              labelPosition=\"right\"\n              disabled={processing}\n              className=\"ml2\"\n              content=\"Next\"\n              onClick={this.handleNext}\n            />\n            {hasPrevious && (\n              <Button\n                floated=\"right\"\n                icon=\"left arrow\"\n                labelPosition=\"left\"\n                disabled={processing}\n                className=\"ml3\"\n                content=\"previous\"\n                onClick={this.handlePrevious}\n              />\n            )}\n            <Button\n              floated=\"right\"\n              color=\"blue\"\n              icon=\"save\"\n              labelPosition=\"left\"\n              disabled={processing}\n              className=\"ml2\"\n              content=\"Save\"\n              onClick={this.handleSave}\n            />\n            <Button floated=\"left\" disabled={processing} onClick={this.handleCancel}>\n              Cancel\n            </Button>\n          </div>\n        )}\n      </>\n    );\n  }\n\n  renderSelectedSteps() {\n    const selectedSteps = this.getSelectedSteps();\n    const size = selectedSteps.length;\n\n    if (size === 0) {\n      return null;\n    }\n\n    const version = this.getVersion();\n    const canRearrange = version.canRearrangeSteps;\n    const editor = this.getEditor();\n    const getStepEditor = step => editor.getStepEditor(step);\n    const StepEditorComponent = this.getStepEditorComponent();\n\n    if (!canRearrange)\n      return _.map(selectedSteps, step => (\n        <div key={step.id} className=\"mb3\">\n          <Observer>\n            {() => (\n              <StepEditorComponent\n                stepEditor={getStepEditor(step)}\n                onDelete={this.handleDelete}\n                onSave={this.handleStepSave}\n                canMove={canRearrange}\n                canDelete={canRearrange}\n              />\n            )}\n          </Observer>\n        </div>\n      ));\n\n    return _.map(selectedSteps, (step, index) => (\n      <Draggable key={step.id} draggableId={step.id} index={index}>\n        {(provided, _snapshot) => (\n          <div {...provided.dragHandleProps} ref={provided.innerRef} {...provided.draggableProps} className=\"mb3\">\n            <StepEditorComponent\n              stepEditor={getStepEditor(step)}\n              onDelete={this.handleDelete}\n              onSave={this.handleStepSave}\n              canMove={canRearrange}\n              canDelete={canRearrange}\n            />\n          </div>\n        )}\n      </Draggable>\n    ));\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowCommonDraftStepsEditor, {\n  onDragEnd: action,\n  handleAddStep: action,\n  handleCancel: action,\n  handleDelete: action,\n  handleSave: action,\n  handleStepSave: action,\n  handleNext: action,\n  handlePrevious: action,\n  clickedOnNext: observable,\n  processing: observable,\n});\n\nexport default inject()(observer(WorkflowCommonDraftStepsEditor));\n"],"file":"WorkflowCommonDraftStepsEditor.js"}