{"version":3,"sources":["../../../../src/parts/workflows/drafts/WorkflowDraftsList.js"],"names":["_","React","observer","inject","decorate","action","runInAction","observable","withRouter","Header","Icon","Segment","Button","gotoFn","swallowError","isStoreEmpty","isStoreNotEmpty","Stores","ErrorBox","WorkflowCommonDraftCard","ProgressPlaceHolder","CreateDraftWizard","WorkflowTemplateCardTabs","WorkflowDraftsList","Component","constructor","props","handleEditDraft","draft","goto","encodeURIComponent","id","showCreateDraftWizard","stores","getStore","stepTemplatesStore","componentDidMount","getStores","load","store","startHeartbeat","componentWillUnmount","stopHeartbeat","workflowDraftsStore","handleCreateDraftClick","handleCreateDraftCancel","render","content","hasError","error","loading","ready","renderEmpty","renderMain","renderTitle","renderWizard","show","disabled","list","map","uiState","version"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, runInAction, observable } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport { Header, Icon, Segment, Button } from 'semantic-ui-react';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreEmpty, isStoreNotEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\nimport WorkflowCommonDraftCard from '../../workflow-common/drafts/WorkflowCommonDraftCard';\nimport ProgressPlaceHolder from '../../workflow-common/ProgressPlaceholder';\nimport CreateDraftWizard from './CreateWorkflowDraft';\nimport WorkflowTemplateCardTabs from '../../workflow-templates/WorkflowTemplateCardTabs';\n\n// expected props\n// - workflowDraftsStore (via injection)\n// - stepTemplatesStore (via injection)\n// - location (from react router)\nclass WorkflowDraftsList extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.showCreateDraftWizard = false;\n      this.stores = new Stores([this.getStore(), this.props.stepTemplatesStore]);\n    });\n  }\n\n  componentDidMount() {\n    this.getStores().load();\n    const store = this.getStore();\n    swallowError(store.load());\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.getStore();\n    store.stopHeartbeat();\n  }\n\n  getStores() {\n    return this.stores;\n  }\n\n  getStore() {\n    return this.props.workflowDraftsStore;\n  }\n\n  handleCreateDraftClick() {\n    this.showCreateDraftWizard = true;\n  }\n\n  handleCreateDraftCancel() {\n    this.showCreateDraftWizard = false;\n  }\n\n  handleEditDraft = async draft => {\n    const goto = gotoFn(this);\n    goto(`/workflows/drafts/edit/${encodeURIComponent(draft.id)}`);\n  };\n\n  render() {\n    const stores = this.getStores();\n    const store = this.getStore();\n    let content = null;\n\n    if (stores.hasError) {\n      content = <ErrorBox error={stores.error} className=\"p0\" />;\n    } else if (stores.loading) {\n      content = <ProgressPlaceHolder />;\n    } else if (stores.ready && isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (stores.ready && isStoreNotEmpty(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <div className=\"mb4\">\n        {this.renderTitle()}\n        {this.renderWizard()}\n        {content}\n      </div>\n    );\n  }\n\n  renderEmpty() {\n    const show = this.showCreateDraftWizard;\n    if (show) return null;\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"edit outline\" />\n          No workflow drafts\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderTitle() {\n    const disabled = this.showCreateDraftWizard;\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"edit outline\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Workflow Drafts</Header.Content>\n        </Header>\n        <div>\n          <Button basic color=\"blue\" disabled={disabled} onClick={() => this.handleCreateDraftClick()}>\n            Create Draft\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  renderWizard() {\n    const show = this.showCreateDraftWizard;\n    if (!show) return null;\n    return <CreateDraftWizard onCancel={() => this.handleCreateDraftCancel()} />;\n  }\n\n  renderMain() {\n    const store = this.getStore();\n    const list = store.list;\n\n    return (\n      <div>\n        {_.map(list, draft => (\n          <Segment className=\"mb2\" clearing key={draft.id}>\n            <WorkflowCommonDraftCard\n              draft={draft}\n              draftsStore={store}\n              onEdit={this.handleEditDraft}\n              className=\"pt0 pl2 pr2 pb2\"\n            >\n              {({ uiState, version }) => <WorkflowTemplateCardTabs template={version} uiState={uiState} />}\n            </WorkflowCommonDraftCard>\n          </Segment>\n        ))}\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowDraftsList, {\n  handleCreateDraftClick: action,\n  handleCreateDraftCancel: action,\n  handleEditDraft: action,\n  showCreateDraftWizard: observable,\n});\n\nexport default inject('workflowDraftsStore', 'stepTemplatesStore')(withRouter(observer(WorkflowDraftsList)));\n"],"file":"WorkflowDraftsList.js"}