{"version":3,"sources":["../../../../src/parts/workflow-templates/drafts/WorkflowTemplateDraftsList.js"],"names":["_","React","observer","inject","decorate","action","runInAction","observable","withRouter","Header","Icon","Segment","Button","gotoFn","swallowError","ErrorBox","isStoreLoading","isStoreReady","isStoreEmpty","isStoreNotEmpty","isStoreError","WorkflowCommonDraftCard","ProgressPlaceHolder","CreateDraftWizard","WorkflowTemplateCardTabs","WorkflowTemplateDraftsList","Component","constructor","props","handleEditDraft","draft","goto","encodeURIComponent","id","showCreateDraftWizard","componentDidMount","store","getStore","load","startHeartbeat","componentWillUnmount","stopHeartbeat","workflowTemplateDraftsStore","handleCreateDraftClick","handleCreateDraftCancel","render","content","error","renderEmpty","renderMain","renderTitle","renderWizard","show","disabled","list","map","uiState","version"],"mappings":"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","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, runInAction, observable } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport { Header, Icon, Segment, Button } from 'semantic-ui-react';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport {\n  isStoreLoading,\n  isStoreReady,\n  isStoreEmpty,\n  isStoreNotEmpty,\n  isStoreError,\n} from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport WorkflowCommonDraftCard from '../../workflow-common/drafts/WorkflowCommonDraftCard';\nimport ProgressPlaceHolder from '../../workflow-common/ProgressPlaceholder';\nimport CreateDraftWizard from './CreateWorkflowTemplateDraft';\nimport WorkflowTemplateCardTabs from '../WorkflowTemplateCardTabs';\n\n// expected props\n// - workflowTemplateDraftsStore (via injection)\n// - location (from react router)\nclass WorkflowTemplateDraftsList extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.showCreateDraftWizard = false;\n    });\n  }\n\n  componentDidMount() {\n    const store = this.getStore();\n    swallowError(store.load());\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.getStore();\n    store.stopHeartbeat();\n  }\n\n  getStore() {\n    return this.props.workflowTemplateDraftsStore;\n  }\n\n  handleCreateDraftClick() {\n    this.showCreateDraftWizard = true;\n  }\n\n  handleCreateDraftCancel() {\n    this.showCreateDraftWizard = false;\n  }\n\n  handleEditDraft = async draft => {\n    const goto = gotoFn(this);\n    goto(`/workflow-templates/drafts/edit/${encodeURIComponent(draft.id)}`);\n  };\n\n  render() {\n    const store = this.getStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder />;\n    } else if (isStoreReady(store) && isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (isStoreReady(store) && isStoreNotEmpty(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <div className=\"mb4\">\n        {this.renderTitle()}\n        {this.renderWizard()}\n        {content}\n      </div>\n    );\n  }\n\n  renderEmpty() {\n    const show = this.showCreateDraftWizard;\n    if (show) return null;\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"edit outline\" />\n          No workflow template drafts\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderTitle() {\n    const disabled = this.showCreateDraftWizard;\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"edit outline\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Workflow Template Drafts</Header.Content>\n        </Header>\n        <div>\n          <Button basic color=\"blue\" disabled={disabled} onClick={() => this.handleCreateDraftClick()}>\n            Create Draft\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  renderWizard() {\n    const show = this.showCreateDraftWizard;\n    if (!show) return null;\n    return <CreateDraftWizard onCancel={() => this.handleCreateDraftCancel()} />;\n  }\n\n  renderMain() {\n    const store = this.getStore();\n    const list = store.list;\n\n    return (\n      <div>\n        {_.map(list, draft => (\n          <Segment className=\"mb2\" clearing key={draft.id}>\n            <WorkflowCommonDraftCard\n              draft={draft}\n              draftsStore={store}\n              onEdit={this.handleEditDraft}\n              className=\"pt0 pl2 pr2 pb2\"\n            >\n              {({ uiState, version }) => <WorkflowTemplateCardTabs template={version} uiState={uiState} />}\n            </WorkflowCommonDraftCard>\n          </Segment>\n        ))}\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowTemplateDraftsList, {\n  handleCreateDraftClick: action,\n  handleCreateDraftCancel: action,\n  handleEditDraft: action,\n  showCreateDraftWizard: observable,\n});\n\nexport default inject('workflowTemplateDraftsStore')(withRouter(observer(WorkflowTemplateDraftsList)));\n"],"file":"WorkflowTemplateDraftsList.js"}