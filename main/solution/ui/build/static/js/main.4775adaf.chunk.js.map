{"version":3,"sources":["../../../../src/models/authentication/AuthenticationProviderConfigEditor.js","../../../../src/models/authentication/AuthenticationProviderPublicConfigsStore.js","../../../../src/models/authentication/AuthenticationProviderPublicConfig.js","../../../../src/models/users/UserDisplayName.js","../../../../src/models/users/UsersStore.js","../../../../src/models/users/UserStore.js","../../../../addons/addon-base-ui/packages/base-ui/images/favicon.ico","../../../../addons/addon-base-ui/packages/base-ui/images/favicon-32x32.png","../../../../addons/addon-base-ui/packages/base-ui/images/login-image.gif","../../../../addons/addon-base-ui/packages/base-ui/images/logo-image.png","../../src/App.js","../../../src/parts/Login.js","../../../src/helpers/plugins-util.js","../../../src/parts/MainLayout.js","../../../src/parts/AutoLogout.js","../../../../src/parts/dashboard/Dashboard.js","../../../../../src/parts/dashboard/graphs/BarGraph.js","../../../../src/parts/authentication-providers/AddAuthenticationProvider.js","../../../../src/parts/authentication-providers/EditAuthenticationProvider.js","../../../../src/parts/configuration/InputEntriesRenderer.js","../../../../src/parts/configuration/InputEntryRenderer.js","../../../../src/parts/authentication-providers/AuthenticationProvidersList.js","../../../../src/parts/authentication-providers/AuthenticationProviderCard.js","../../../../src/parts/users/AddUser.js","../../../../src/models/forms/AddUserForm.js","../../../../src/parts/users/UsersList.js","../../../src/models/App.js","../../../src/helpers/crypto.js","../../../../src/models/accounts/AccountsStore.js","../../../../src/models/accounts/Account.js","../../../../src/models/accounts/AccountStore.js","../../../../src/models/aws-accounts/AwsAccountsStore.js","../../../../src/models/aws-accounts/AwsAccount.js","../../../../src/models/aws-accounts/BudgetStore.js","../../../../src/models/client-info/ClientInformationStore.js","../../../../src/models/client-info/ClientInformation.js","../../../../src/models/environments/InstanceInfo.js","../../../src/helpers/sage-maker-service.js","../../../../src/models/environments/EnvironmentConfiguration.js","../../../../src/models/environments/EnvironmentsStore.js","../../../../addons/addon-base/packages/services/lib/helpers/utils.js","../../../../src/models/environments/EnvironmentStore.js","../../../src/helpers/settings.js","../../../src/models/BaseStore.js","../../../src/helpers/externalKeypairService.js","../../../src/helpers/externalVpcService.js","../../../../../src/parts/helpers/fields/Header.js","../../../src/helpers/externalAccountDetails.js","../../../../src/models/files/FileUploadsStore.js","../../../../src/models/files/FileUploadGroup.js","../../../../src/models/indexes/IndexesStore.js","../../../../src/models/indexes/Index.js","../../../../src/models/projects/ProjectsStore.js","../../../../src/models/projects/Project.js","../../../../src/models/projects/ProjectStore.js","../../../../../src/parts/helpers/fields/Description.js","../../../../src/models/selections/FilesSelection.js","../../../../src/models/studies/StudiesStore.js","../../../../src/models/studies/Study.js","../../../../src/models/studies/StudyFilesStore.js","../../../../src/models/studies/StudyPermissionsStore.js","../../../../src/models/studies/StudyPermissions.js","../../../../src/models/studies/StudyStore.js","../../../../src/models/user-roles/UserRolesStore.js","../../../../src/models/user-roles/UserRole.js","../../../../src/models/compute/ComputePlatformsStore.js","../../../../../src/parts/helpers/fields/ErrorPointer.js","../../../../src/models/compute/ComputePlatform.js","../../../../src/models/compute/ComputeConfiguration.js","../../../../src/models/compute/ComputePlatformStore.js","../../../../src/models/environments-sc/ScEnvironment.js","../../../../src/models/environments-sc/ScEnvironmentStore.js","../../../../src/models/environments-sc/ScEnvConnectionStore.js","../../../../src/models/environments-sc/ScEnvironmentCostsStore.js","../../../../src/models/environments-sc/ScEnvironmentCost.js","../../../../src/models/environments-sc/ScEnvironmentCostStore.js","../../../src/parts/UserApplication.js","../../../../src/models/forms/AddUserApplicationForm.js","../../../../src/parts/users/User.js","../../../../src/parts/users/RolesList.js","../../../../src/parts/users/UpdateUser.js","../../../../src/models/forms/UpdateUserConfig.js","../../../../src/parts/accounts/Accounts.js","../../../../src/parts/accounts/AwsAccountsList.js","../../../../src/parts/accounts/IndexesList.js","../../../../src/parts/projects/ProjectsList.js","../../../../src/parts/projects/ProjectConfigure.js","../../../../src/parts/users/DragDrop.js","../../../../src/parts/users/UserTable.js","../../../../src/parts/users/AddSingleUser.js","../../../../src/parts/accounts/AddIndex.js","../../../../src/models/forms/AddIndexForm.js","../../../../src/parts/studies/StudiesPage.js","../../../../src/parts/studies/StudiesTab.js","../../../../src/parts/studies/StudyRow.js","../../../../src/parts/studies/StudyFilesTable.js","../../../../src/parts/studies/StudyPermissionsTable.js","../../../../src/parts/helpers/UserLabels.js","../../../../src/parts/studies/UploadStudyFiles.js","../../../../src/parts/files/FileUpload.js","../../../../src/parts/files/FileDropZone.js","../../../../src/parts/files/FileUploadTable.js","../../../src/helpers/xhr-upload.js","../../../../src/parts/studies/CreateStudy.js","../../../../src/models/forms/CreateStudy.js","../../../../src/parts/studies/StudyEnvironmentSetup.js","../../../../src/models/studies/categories.js","../../../../../src/parts/helpers/fields/Toggle.js","../../../../src/models/forms/ExternalUserPinForm.js","../../../../src/parts/helpers/PinInput.js","../../../../src/parts/compute/SelectComputePlatformStep.js","../../../../src/parts/compute/ConfigureComputePlatformStep.js","../../../../../src/parts/compute/parts/CreateInternalPlatformForm.js","../../../../src/models/forms/CreateInternalPlatformForm.js","../../../../../src/parts/compute/parts/CreateExternalPlatformForm.js","../../../../src/models/forms/CreateExternalPlatformForm.js","../../../../../src/parts/environments-sc/setup/SelectEnvTypeStep.js","../../../../../src/parts/environments-sc/setup/ConfigureEnvTypeStep.js","../../../../../src/parts/environments-sc/setup/CreateInternalEnvForm.js","../../../../src/models/forms/CreateInternalEnvForm.js","../../../../../src/parts/environments-sc/setup/SelectConfigurationCards.js","../../../../src/parts/environments/EnvironmentsList.js","../../../../src/parts/environments-builtin/EnvironmentsList.js","../../../../src/parts/environments-builtin/EnvironmentCard.js","../../../../addons/addon-base-raas-ui/packages/base-raas-ui/images/marketplace/sagemaker-notebook-icon.svg","../../../../addons/addon-base-raas-ui/packages/base-raas-ui/images/marketplace/emr-icon.svg","../../../../addons/addon-base-raas-ui/packages/base-raas-ui/images/marketplace/ec2-icon.svg","../../../../addons/addon-base-raas-ui/packages/base-raas-ui/images/marketplace/rstudio-icon.svg","../../../../src/parts/users/UserPinModal.js","../../../../src/parts/environments-sc/ScEnvironmentsList.js","../../../../src/parts/environments-sc/ScEnvironmentCard.js","../../../../../src/parts/environments-sc/parts/ScEnvironmentConnections.js","../../../../../src/parts/environments-sc/parts/ScEnvironmentHttpConnections.js","../../../../../src/parts/environments-sc/parts/ScEnvironmentSshConnections.js","../../../../../src/parts/environments-sc/parts/ScEnvironmentSshConnectionRow.js","../../../../../src/parts/environments-sc/parts/ScEnvSshConnRowExpanded.js","../../../../../src/parts/environments-sc/parts/ScEnvironmentRdpConnections.js","../../../../../src/parts/environments-sc/parts/ScEnvironmentRdpConnectionRow.js","../../../../../src/parts/environments-sc/parts/ScEnvironmentsFilterButtons.js","../../../../src/parts/environments/EnvironmentDetailPage.js","../../../../src/parts/environments-builtin/EnvironmentDetailPage.js","../../../../src/parts/environments-sc/ScEnvironmentDetailPage.js","../../../../../src/parts/environments-sc/parts/ScEnvironmentTypeName.js","../../../../../src/parts/environments-sc/parts/ScEnvironmentCostTable.js","../../../../src/parts/accounts/AddAwsAccount.js","../../../../src/models/forms/AddAwsAccountForm.js","../../../../src/parts/accounts/CreateAwsAccount.js","../../../../src/models/forms/CreateAwsAccountForm.js","../../../../src/parts/accounts/UpdateBudget.js","../../../../src/models/forms/AddBudgetForm.js","../../../../src/parts/environments/EnvironmentSetup.js","../../../../src/parts/environments-builtin/SetupStepsProgress.js","../../../../src/parts/projects/AddProject.js","../../../../src/parts/users/AddSingleLocalUser.js","../../../../src/models/forms/AddLocalUserForm.js","../../../../src/parts/environment-type-mgmt/EnvTypeCardMetaActions.js","../../../../addons/addon-base-ui/packages/base-ui/src/helpers/routing.js","../../../../src/parts/environment-types/EnvTypesManagement.js","../../../../src/parts/environment-types/EnvTypeCandidatesList.js","../../../../addons/addon-environment-sc-ui/packages/environment-type-mgmt-ui/images/AWS-Service-Catalog.svg","../../../../src/parts/environment-types/EnvTypesList.js","../../../../src/parts/environment-types/EnvTypeCard.js","../../../../src/parts/environment-types/EnvTypeEditor.js","../../../../../src/parts/environment-types/env-type-editor-steps/BasicInfoStep.js","../../../../src/models/forms/EnvTypeBasicInfoForm.js","../../../../../src/parts/environment-types/env-type-editor-steps/ConfigStep.js","../../../../../src/parts/environment-types/env-type-config/EnvTypeConfigCard.js","../../../../src/models/forms/EnvTypeConfigForm.js","../../../../../../src/parts/environment-types/env-type-config/env-type-config-steps/BasicInfoStep.js","../../../../../../src/parts/environment-types/env-type-config/env-type-config-steps/AccessControlStep.js","../../../../../../src/parts/environment-types/env-type-config/env-type-config-steps/InputParamsStep.js","../../../../src/models/forms/CfnParamsForm.js","../../../../../../src/parts/environment-types/env-type-config/env-type-config-steps/TagsStep.js","../../../../../src/parts/helpers/fields/NameValuesEditor.js","../../../../../src/parts/helpers/fields/EditableNameValueRow.js","../../../../src/models/forms/NameValueForm.js","../../../../../src/parts/helpers/fields/EditableField.js","../../../../src/models/environment-types/EnvTypesStore.js","../../../../src/models/environment-types/EnvType.js","../../../../src/models/environment-types/EnvTypeConfigsStore.js","../../../../src/models/environment-types/EnvTypeConfig.js","../../../../src/models/environment-types/EnvTypeConfigVar.js","../../../../src/models/environment-types/EnvTypeStore.js","../../../../src/models/environment-types/EnvTypeCandidatesStore.js","../../../src/helpers/api.js","../../../../src/models/workflow-step-templates/StepTemplate.js","../../../../src/models/workflow-step-templates/StepTemplatesStore.js","../../../../src/models/forms/EditWorkflowTemplateDraftMetaForm.js","../../../../src/models/forms/WorkflowStepDescForm.js","../../../../src/models/forms/WorkflowStepPropsForm.js","../../../../src/models/forms/WorkflowStepConfigOverrideForm.js","../../../../src/models/forms/WorkflowStepPropsOverrideForm.js","../../../../../../src/models/workflow-templates/drafts/edit/WorkflowTemplateDraftEditor.js","../../../../src/models/configuration/ConfigurationEditor.js","../../../../../../src/models/workflow-templates/drafts/edit/WorkflowTemplateStepEditor.js","../../../../src/models/workflow-templates/WorkflowTemplateStep.js","../../../../src/models/workflow-templates/WorkflowTemplate.js","../../../../../src/models/workflow-templates/drafts/WorkflowTemplateDraft.js","../../../../../src/models/workflow-templates/drafts/WorkflowTemplateDraftsStore.js","../../../../src/models/workflow-templates/WorkflowTemplatesStore.js","../../../../src/models/forms/EditWorkflowDraftMetaForm.js","../../../../../../src/models/workflows/drafts/edit/WorkflowStepEditor.js","../../../../../../src/models/workflows/drafts/edit/WorkflowDraftEditor.js","../../../../src/models/workflows/WorkflowStep.js","../../../../src/models/workflows/Workflow.js","../../../../../src/models/workflows/drafts/WorkflowDraft.js","../../../../../src/models/workflows/drafts/WorkflowDraftsStore.js","../../../../src/models/workflows/WorkflowInstancesStore.js","../../../../src/models/workflows/WorkflowInstanceStore.js","../../../../src/models/workflows/WorkflowAssignmentsStore.js","../../../../src/models/workflows/WorkflowStore.js","../../../../src/models/workflows/WorkflowsStore.js","../../../src/plugins/app-context-items-plugin.js","../../../src/plugins/menu-items-plugin.js","../../../../../src/parts/workflow-common/component-states/WorkflowCommonCardState.js","../../../../src/parts/workflow-templates/PropertyTable.js","../../../../src/parts/workflow-templates/PropertyOverrideTable.js","../../../../src/parts/workflow-templates/PropertySection.js","../../../../src/parts/workflow-templates/ConfigOverrideTable.js","../../../../src/parts/workflow-templates/ConfigSection.js","../../../../src/parts/workflow-templates/WorkflowTemplateStep.js","../../../../src/parts/workflow-templates/WorkflowTemplateCardTabs.js","../../../../src/parts/workflow-templates/WorkflowTemplateCard.js","../../../../src/parts/workflow-common/ProgressPlaceholder.js","../../../../../src/parts/workflow-templates/published/WorkflowPublishedTemplatesList.js","../../../../../src/parts/workflow-common/drafts/WorkflowCommonDraftCard.js","../../../../src/models/forms/CreateWorkflowTemplateDraftForm.js","../../../../../src/parts/workflow-templates/drafts/CreateWorkflowTemplateDraft.js","../../../../../src/parts/workflow-templates/drafts/WorkflowTemplateDraftsList.js","../../../../src/parts/workflow-templates/WorkflowTemplatesList.js","../../../../../../src/parts/workflow-templates/drafts/edit/WorkflowTemplateDraftMetaEditor.js","../../../../src/parts/workflow-step-templates/AddStepDropDown.js","../../../../../../src/parts/workflow-common/drafts/edit/WorkflowCommonDraftStepsEditor.js","../../../../../../src/parts/workflow-common/drafts/edit/WorkflowCommonStepEditorCard.js","../../../../../../src/parts/workflow-common/drafts/edit/WorkflowCommonStepConfigEditor.js","../../../../../../src/parts/workflow-common/drafts/edit/WorkflowCommonStepDescEditor.js","../../../../../../src/parts/workflow-common/drafts/edit/WorkflowCommonStepPropsEditor.js","../../../../../../src/parts/workflow-templates/drafts/edit/WorkflowTemplateStepConfigOverrideEditor.js","../../../../../../src/parts/workflow-templates/drafts/edit/WorkflowTemplateStepPropsOverrideEditor.js","../../../../../../src/parts/workflow-templates/drafts/edit/WorkflowTemplateStepEditor.js","../../../../../../src/parts/workflow-templates/drafts/edit/WorkflowTemplateDraftPublisher.js","../../../../../../src/parts/workflow-templates/drafts/edit/WorkflowTemplateDraftEditor.js","../../../../../src/parts/workflows/published/WorkflowPublishedList.js","../../../../src/models/forms/CreateWorkflowDraftForm.js","../../../../../src/parts/workflows/drafts/CreateWorkflowDraft.js","../../../../../src/parts/workflows/drafts/WorkflowDraftsList.js","../../../../src/parts/workflows/WorkflowsList.js","../../../../../../src/parts/workflows/drafts/edit/WorkflowStepEditor.js","../../../../../../src/parts/workflows/drafts/edit/WorkflowDraftMetaEditor.js","../../../../../../src/parts/workflows/drafts/edit/WorkflowDraftPublisher.js","../../../../../../src/parts/workflows/drafts/edit/WorkflowDraftEditor.js","../../../../src/models/forms/TriggerWorkflowForm.js","../../../../../src/parts/workflows/published/WorkflowInstancesList.js","../../../../../src/parts/workflows/published/WorkflowAssignmentsList.js","../../../../../src/parts/workflows/published/WorkflowDetailTabs.js","../../../../../src/parts/workflows/published/WorkflowDetailPage.js","../../../../../src/parts/workflows/published/WorkflowInstanceDetailPage.js","../../../src/plugins/routes-plugin.js","../../../../src/models/key-pairs/KeyPair.js","../../../../src/models/key-pairs/KeyPairsStore.js","../../../../../src/parts/key-pairs/parts/KeyPairButtons.js","../../../../src/parts/key-pairs/KeyPairCard.js","../../../../src/parts/key-pairs/KeyPairsList.js","../../../../src/parts/key-pairs/KeyPairCreate.js","models/hello/Hello.js","models/hello/HelloStore.js","helpers/api.js","plugins/app-context-items-plugin.js","plugins/initialization-plugin.js","plugins/menu-items-plugin.js","parts/hello/HelloPage.js","plugins/routes-plugin.js","plugins/plugin-registry.js","index.js","../../../../../src/parts/helpers/fields/YesNo.js","../../../../src/models/forms/Validate.js","../../../../src/models/constants/local-storage-keys.js","../../../../src/parts/configuration/ConfigTable.js","../../../src/helpers/utils.js","../../../../src/models/forms/UserFormUtils.js","../../../../src/parts/helpers/By.js","../../../../src/models/environment-types/EnvTypeStatusEnum.js","../../../../../../src/parts/environment-types/env-type-config/env-type-config-steps/BaseEnvTypeConfigStep.js","../../../src/helpers/notification.js","../../src/render-utils.js","../../../src/helpers/routing.js","../../../../src/parts/helpers/ErrorBox.js","../../../../src/models/environments-sc/ScEnvironmentsStore.js","../../../../src/parts/users/UserOnboarding.js","../../../../src/parts/configuration/ConfigurationEditor.js","../../../../src/parts/helpers/BasicProgressPlaceholder.js","../../../../src/parts/configuration/ConfigurationReview.js","../../../../../src/parts/key-pairs/parts/KeyPairCreateForm.js","../../../../src/models/forms/KeyPairCreateForm.js","../../../../../src/parts/helpers/fields/Form.js","../../../../../src/parts/helpers/fields/Input.js","../../../src/helpers/errors.js","../../../src/helpers/form.js","../../../../src/models/authentication/AuthenticationProviderConfigsStore.js","../../../../src/models/users/User.js","../../../../../src/parts/dashboard/graphs/graph-options.js","../../../../src/models/aws-accounts/Budget.js","../../../../src/models/environments/Environment.js","../../../../../src/parts/helpers/fields/DropDown.js","../../../../src/models/environments/EnvironmentConfigurationsStore.js","../../../src/models/SessionStore.js","../../../src/helpers/externalCostUtil.js","../../../src/helpers/cfn-service.js","../../../src/models/Stores.js","../../../../src/models/forms/AddProjectForm.js","../../../../src/parts/studies/StudyStepsProgress.js","../../../../../src/parts/compute/helpers/CurrentStep.js","../../../../src/parts/compute/ComputePlatformSetup.js","../../../../../src/parts/compute/parts/SelectConfigurationCards.js","../../../../../src/parts/environments-sc/setup/ScEnvironmentSetup.js","../../../../src/parts/environments-builtin/EnvironmentStatusIcon.js","../../../../src/parts/environments-builtin/EnvironmentConnectButton.js","../../../../../src/parts/environments-sc/parts/ScEnvironmentButtons.js","../../../../src/parts/helpers/CopyToClipboard.js","../../../../../src/parts/environments-sc/parts/ScEnvironmentCost.js","../../../src/models/Wizard.js","../../../../../src/parts/environment-types/env-type-config/EnvTypeConfigEditor.js","../../../../src/models/environment-types/EnvTypeCandidate.js","../../src/bootstrap-app.js","../../../../../src/parts/helpers/fields/TextArea.js","../../../src/plugins/initialization-plugin.js","../../../src/plugins/authentication-plugin.js","../../../src/plugins/app-component-plugin.js","../../../../addons/addon-base-workflow-ui/packages/base-workflow-ui/src/images/white-gradient.png","../../../src/plugins/env-type-mgmt-plugin.js","../../src/withAuth.js","../../../src/app-context/app-context.js","../../../src/models/PluginRegistry.js","../../src/service-worker.js","../../src/AppContainer.js","../../../src/models/AppRunner.js","../../../src/models/Cleaner.js","../../../src/models/Showdown.js","../../../../src/models/api-keys/UserApiKeysStore.js","../../../src/models/Err.js","../../../../src/models/forms/InputManifest.js","../../../../src/models/api-keys/ApiKeysStore.js","../../../../src/models/api-keys/ApiKey.js","../../../../src/models/authentication/Authentication.js","../../../../node_modules/.pnpm/validatorjs@3.18.1/node_modules/validatorjs/src/lang sync /^/.//.*$"],"names":["types","id","configEditor","ConfigurationEditor","self","setConfigEditor","_self","appContext","AuthenticationProviderPublicConfigsStore","BaseStore","authenticationProviderPublicConfigs","AuthenticationProviderPublicConfig","doLoad","configs","authentication","getEnv","selected","_","entry","key","text","value","result","config","toAuthenticationProviderFromId","authenticationProviderId","toAbsoluteUrl","uri","isAbsoluteUrl","adjustRedirectUri","redirectType","redirectParamName","preservePath","initialRedirectUri","getQueryParam","adjustedUri","websiteUrl","removeQueryParams","addQueryParams","window","title","type","credentialHandlingType","signInUri","signOutUri","enableNativeUserPoolUsers","cleanup","login","username","password","pluginRegistry","handleException","err","code","isBoom","boom","authenticate","loginResult","explicitLogin","logout","autoLogout","cleaner","explicitLogout","UserDisplayName","getDisplayName","uid","userStore","user","getLongDisplayName","identifier","usersStore","isSystem","object","UsersStore","users","User","superCleanup","map","addUser","addedUser","addedUserModel","updateUser","updatedUser","userModel","previousUser","nonRootAdmins","asSelectOptions","nonClearables","label","clearableValue","asDropDownOptions","status","longDisplayName","asUserObject","userIdentifier","ns","asUserObjects","userIdentifiers","UserStore","module","exports","App","location","this","getRoutes","getMenuItems","getDefaultRouteLocation","defaultLocation","menuItems","exact","from","to","props","React","Component","decorate","computed","inject","withRouter","observer","Login","name","action","event","selectedAuthenticationProviderId","error","Promise","displayError","runInAction","usernameError","authenticationProviderOptions","collectUserNamePassword","renderBrandingLogo","centered","src","assets","images","loginImage","className","textAlign","style","height","verticalAlign","maxWidth","size","loading","onSubmit","e","stacked","as","branding","required","placeholder","options","defaultValue","onChange","handleAuthenticationProviderChange","basic","color","pointing","fluid","icon","iconPosition","data-testid","handleChange","passwordError","onClick","handleLogin","params","URL","document","showInternal","store","observable","authenticationProviderError","authProviderOptions","plugins","initial","routesMap","plugin","entries","Array","routeIdx","routePath","reactComponent","path","component","itemsMap","url","defaultRoute","MainLayout","pathname","link","createLink","handleLogout","currentUser","displayName","is","itemsArr","vertical","inverted","fixed","overflowY","item","active","width","paddingLeft","position","paddingTop","paddingBottom","AutoLogout","setInterval","clearInterval","app","timeout","autoLogoutTimeoutInMinutes","onIdle","startDialogCountDown","open","closeOnEscape","closeOnDimmerClick","floated","primary","content","cancelDialogCountDown","dialogCountDown","modalOpen","intervalId","doLogout","Dashboard","fontSize","lineHeight","data","labels","datasets","barOptions","AddAuthenticationProvider","EditAuthenticationProvider","handleCancel","gotoFn","goto","handleSave","authenticationProviderConfigToUpdate","fromConfiguration","original","typeObj","providerTypeId","providerConfig","displaySuccess","swallowError","isStoreError","isStoreLoading","segmentCount","isStoreReady","authenticationProviderConfig","renderTitle","renderDetails","authenticationProviderConfigId","model","getStore","getUpdateAuthenticationProviderConfigEditor","onCancel","onSave","decodeURIComponent","match","getAuthenticationProviderConfig","InputEntriesRenderer","processing","form","inputEntry","InputEntryRenderer","field","renderDivider","divider","hasIcon","horizontal","disabled","selection","AuthenticationProvidersList","handleAddAuthenticationProviderClick","_event","showCount","isStoreNotEmpty","list","circular","renderCount","clearing","authNProviderConfig","pos","idx","AuthenticationProviderCard","handleEditModeClick","encodeURIComponent","renderStatus","isActive","ribbon","AddUser","validationResult","fields","toEditableInput","toRadioGroupInput","attributeName","radioOptions","defaultSelected","isBooleanInput","trueValue","count","radioOption","handleSubmit","explain","hasExplain","fieldErrors","hasError","formProcessing","validationErrors","dvr","Validator","MobxReactForm","addUserFormFields","rules","email","firstName","lastName","isAdmin","UsersList","history","handleAddUser","handleAddAuthenticationProvider","usersBeingEditedMap","nonRootUsers","pageSize","Math","showPagination","displayEditableInput","row","userBeingEdited","handleCheckboxChange","checked","handleRadioChange","booleanColumnValueFilter","trueString","falseString","columnValueBoolean","filter","columnValueStr","filterValue","String","desc","columnValue","Header","accessor","Cell","filterMethod","minWidth","filterable","cell","mapOfUsersBeingEdited","userRegistered","superInit","init","setUserRegistered","createAppType","identityProviderName","userRole","rev","projectId","pwUtf8","TextEncoder","encode","crypto","pwHash","iv","Uint8Array","alg","ptUtf8","ctBuffer","ctArray","ctStr","ctBase64","btoa","ivHex","b","ciphertext","parseInt","atob","ctUint8","ch","plainBuffer","plaintext","TextDecoder","decode","tickPeriod","previous","applySnapshot","addUsers","updateUserApplication","res","deleteUser","deletedUser","detach","getSnapshot","AccountsStore","accounts","Account","accountStores","AccountStore","consolidateToMap","exiting","addAccount","rawAccount","removeItem","account","removeAccountInfo","getAccountStore","accountId","hasAccount","getAccount","CfnInfo","crossAccountExecutionRoleArn","crossAccountEnvMgmtRoleArn","subnetId","vpcId","stackId","accountName","accountArn","cfnInfo","createdAt","createdBy","updatedAt","updatedBy","setAccount","parent","getParent","AwsAccountsStore","awsAccounts","AwsAccount","budgetStores","BudgetStore","awsAccount","awsAccountsModel","addAwsAccount","addedAwsAccount","addedAwsAccountModel","createAwsAccount","getBudgetStore","awsAccountUUID","addBudget","Budget","getNameForAccountId","getAwsAccount","description","externalId","roleArn","encryptionKeyArn","budget","setAwsAccounts","rawAwsAccounts","getAwsAccountBudget","rawBudget","createOrUpdateBudget","existingBudget","Error","val","requestData","budgetConfiguration","createAwsAccountBudget","updateAwsAccountBudget","ClientInformationStore","clientInformation","ClientInformation","info","ipAddress","fetch","answer","origin","InstanceInfo","Ec2WorkspaceDnsName","JupyterUrl","NotebookInstanceName","s3Mounts","iamPolicyDocument","environmentInstanceFiles","JSON","SageMaker","require","SageMakerService","region","accessKeyId","secretAccessKey","sslEnabled","notebookInstanceName","sm","createPresignedNotebookInstanceUrl","promise","SpotPriceHistoryItem","availabilityZone","spotPrice","number","EnvironmentConfiguration","price","defaultCidr","properties","spotBidMultiplier","spotPriceHistory","emrConfiguration","setEnvironmentConfiguration","fetchingSpotPriceHistory","getSpotPriceHistory","spotInstance","getEnvironmentSpotPriceHistory","prices","setSpotPriceHistory","isOnDemandPricing","workerInstanceOnDemandPrice","workerInstanceCount","EnvironmentsStore","environments","Environment","environmentStores","EnvironmentStore","costPromises","env","getEstimatedCost","getEnvironmentCost","costInfo","i","displayWarning","addEnvironment","rawEnvironment","getEnvironmentStore","environmentId","stopEnvironment","uiEventBus","environment","startEnvironment","markAsTerminating","updateExternalEnvironment","storage","localStorageKeys","creds","cfn","CfnService","request","response","message","updateEnvironment","convertCfnResponse","output","instanceInfo","deleteEnvironment","deleteExternalEnvironment","externalKeypairService","ExternalKeypairService","createEnvironment","createExternalEnvironment","platformId","configurationId","configuration","Date","randomString","getExternalTemplate","StackId","getExternalParams","cidr","amiImage","cfnParams","addParam","v","ParameterKey","ParameterValue","externalVpcService","ExternalVpcService","isOnDemand","spotBidPrice","keyName","getEnvironment","getComputeConfiguration","platform","nanoIdSync","nanoid","fn","handler","exponentialInterval","attemptCount","baseInterval","maxAttempts","intervalFn","caughtError","sleep","processInBatches","items","batchSize","processorFn","itemBatches","chunk","results","length","itemsInThisBatch","all","resultsFromThisBatch","concat","paginatedList","listingFn","pageToken","nextPageToken","paginatedFind","predicate","found","find","isUndefined","ms","resolve","setTimeout","prefix","toVersionString","num","padStart","parseVersionString","str","substring","runAndCatch","linearInterval","retry","processSequentially","fuzz","baseNumber","fuzzing","round","random","strLength","toString","join","generateId","generateIdSync","createHash","strData","hash","update","digest","envCreatedAt","now","diffTime","numberOfDaysBetweenDateCreatedAndToday","numberDaysInPast","environmentCost","process","subtitle","main","page","state","Err","heartbeatInterval","load","args","loadingPromise","toErr","reject","startHeartbeat","shouldHeartbeat","stopHeartbeat","changeTickPeriod","beating","obj","EC2","SSM","EnvironmentKeypairService","ec2","createKeyPair","KeyName","keyPair","parameterName","ssm","Name","Type","Value","Description","Overwrite","WithDecryption","privateKey","deleteKeyPair","Filters","Values","vpcs","Vpcs","VpcId","subnets","Subnets","publicSubnets","subnet","SubnetId","htmlFor","STS","sts","FileUploadsStore","fileUploadGroups","FileUploadGroup","getFileUploadGroup","group","resourceId","resetFileUploadGroup","FileUpload","uploaded","file","cancel","undefined","getFile","updateProgress","updateStatusToUploading","updateStatusToComplete","updateStatusToFailed","setFile","setCancel","doCancel","fileUploads","getFileUpload","start","fileUpload","fileUploadHandler","remove","add","setStateToComplete","setStateToUploading","IndexesStore","indexes","Index","addIndex","addedIndex","addedIndexModel","getIndexesStore","indexesId","getIndex","index","proj","hasIndexes","getIndexes","awsAccountId","setIndex","ProjectsStore","projects","Project","projectStores","ProjectStore","addProject","rawProject","getProjectStore","deleteProject","updateProject","updatedProject","project","hasProject","getProject","indexId","projectAdmins","setProject","extra","warn","hasWarn","dangerouslySetInnerHTML","__html","FilesSelection","File","accessStatus","files","deleteFile","setFiles","hasFile","studyIdMap","studiesCountByStatus","studiesCountByNotStatus","names","groupByStudy","values","groupNotApprovedByStudy","countByStatus","counter","categories","StudiesStore","category","studies","Study","studyStores","StudyStore","getStudies","addStudy","rawStudy","getStudyStore","studyId","createStudy","uploadLocationEnabled","resultStudy","study","hasStudy","getStudy","access","resources","arn","string","filesStore","StudyFilesStore","permissionsStore","StudyPermissionsStore","setStudy","getFilesStore","getPermissionsStore","StudyFile","filename","lastModified","listStudyFiles","comparator","fileA","fileB","removed","added","studyPermissions","StudyPermissions","getStudyPermissions","newPermissions","updateRequest","usersToAdd","usersToRemove","userToRequestFormat","permissionLevel","selectedUserIds","updateStudyPermissions","adminUsers","readonlyUsers","readwriteUsers","UserRolesStore","userRoles","UserRole","role","isInternalUser","isInternalGuest","getUserType","userType","setUserRole","ComputePlatformsStore","platforms","ComputePlatform","platformsStores","ComputePlatformStore","computePlatforms","getComputePlatformStore","getComputePlatform","displayOrder","configurations","ComputeConfiguration","setComputePlatform","setConfigurations","showdown","getConfiguration","priceInfo","displayProps","setComputeConfiguration","isMutable","getParam","getComputeConfigurations","states","display","tip","spinner","canTerminate","canConnect","canStop","canStart","ScEnvironment","envTypeId","connections","hasConnections","studyIds","outputs","setScEnvironment","raw","setStatus","setConnections","getConnections","filterFn","ScEnvironmentStore","envId","getScEnvironment","rawEnv","ScEnvConnectionStore","getScEnvironmentConnections","createConnectionUrl","createScEnvironmentConnectionUrl","urlObj","sendSshKey","getWindowsRdpInfo","getWindowsRpInfo","ScEnvironmentCostsStore","costs","ScEnvironmentCost","costStores","ScEnvironmentCostStore","scEnvironmentsStore","getCost","rawEntity","getScEnvironmentCost","addScEnvironmentCost","rawCost","getScEnvironmentCostStore","setScEnvironmentCost","getAmount","date","amount","unit","UserApplication","onSuccess","logoutProcessing","createForm","addUserApplicationFormFields","applyReason","panes","menuItem","render","RolesList","userRolesData","defaultPageSize","defaultFilterMethod","columns","getUserRoles","selectedRole","isIdentityProviderNameChanged","unchangedIdentityProviderName","handleAddLocalUser","usersList","defaultSorted","whiteSpace","lable","trigger","adminMode","userRolesStore","awsAccountsStore","projectsStore","UpdateUser","identityProviderNameField","userToUpdate","idpOptionValue","toIdpFromValue","getUpdateUserConfigForm","Stores","getStores","stores","closeIcon","onClose","handleClose","view","toRow","fieldName","displayValue","collapsing","getFieldLabel","celled","getCurrentUser","isRootUser","makeButton","attrs","cancelButton","deleteButton","activeButton","deactiveButton","editButton","firstNameField","lastNameField","emailField","userRoleField","projectIdField","statusField","identityProviderOptions","userRoleOptions","projectIdOptions","showProjectField","isAdminMode","onError","handleFormError","multiple","clearable","compact","handleOpen","toIdpOptions","authenticationProviderConfigsStore","handleEditClick","handleDeleteClick","handleApproveDisapproveClick","handleFormSubmission","existingUser","getUpdateUserConfigFormFields","toValueFromIdp","yesLabel","noLabel","yesValue","noValue","Accounts","AwsAccountsList","accountsStore","awsAccountsData","handleCreateAwsAccount","handleAddAwsAccount","getAwsAccounts","pendingAccount","errorAccounts","onDismiss","href","target","rel","IndexesList","indexesData","pagination","handleAddIndex","ProjectsList","projectsData","projectAdminUsers","u","handleAddProject","getProjects","ProjectConfigure","handleModalOpen","handleModalClose","renderField","handleClickEditButton","saveButton","handleClickSubmitButton","handleDeleteConfirmOpen","onConfirm","handleClickDeleteButton","makeConfirmDeleteButton","handleClickCancelButton","projectAdminsOption","currentProjectAdminUsers","currentProject","x","handleProjectAdminsSelection","contentRenderer","confirmDeleteOpen","attached","defaultActiveIndex","menu","secondary","DragDrop","reader","console","binaryStr","jsonArray","jsonArrayContent","fileContent","userArr","csv","lines","headers","currentline","j","promises","provider","userData","onDrop","minSize","maxSize","getRootProps","getInputProps","rejectedFiles","isFileTooLarge","UserTable","AddSingleUser","AddIndex","awsAccountIdOption","handleAwsAccountSelection","get","fieldError","addIndexFormFields","totalCost","projNameToTotalCost","projNameToUserTotalCost","envNameToCostInfo","isLoading","getCosts","getAccumulatedEnvCost","envNameToIndex","Object","envName","projName","currentUserCost","indexCost","enableBuiltInWorkspaces","getEnvironments","getScEnvironments","envIdToName","envIds","envCostPromises","envCostResults","pastMonthCostByUserArray","costResult","createdByToCost","costDate","cost","yesterdayCostArray","yesterdayCost","arrayOfCosts","pastMonthCostByUser","dataPoints","blueDatasets","pastMonthCostTotalArray","total","projCostData","colors","backgroundColor","hoverBackgroundColor","TabPaneWrapper","StudiesPage","handleNext","handlePrevious","studiesStoresMap","canSelectStudy","canCreateStudy","hasProjects","envTypeImmutable","isExternalUser","getMenuItemLabel","isStoreNew","niceNumber","applicableCategories","studyPanes","renderActiveOnly","empty","renderWarningWithButton","renderWarning","header","visible","labelPosition","warning","getStudiesStore","StudiesTab","studiesStore","isStoreEmpty","isSelectable","categoryId","isOpenData","isOrgData","subheader","can","StudyRow","isSelected","onClickAttr","padded","raised","marginTop","renderHeader","renderDescription","renderFilesAccordion","renderPermissionsAccordion","expanded","handleFilesExpanded","handlePermissionsExpanded","handleFileSelection","filesExpanded","permissionsExpanded","StudyFilesTable","striped","formatBytes","StudyPermissionsTable","isEditable","dimmed","isProcessing","enableEditMode","userTypes","uids","textTransform","editModeOn","dropdownOnChange","search","resetForm","submitUpdate","image","UploadStudyFiles","getPresignedStudyUploadRequests","presignResult","uploadRequest","errMessage","uploadHandle","done","onCancelSelectFiles","onCancelUpload","onClickStartUpload","onClickUploadMore","onSelectFiles","onClickRemoveFile","onClickCancelFile","PropTypes","func","ConnectedFileUpload","success","errors","prevProps","fileUploadGroup","handleCancelFileUpload","fileUploadsStore","MobXPropTypes","isRequired","ReusableFileInput","inputKey","setInputKey","ref","FileDropZone","isHighlighted","fileInputRef","enabled","tertiary","onDragEnter","onDragOver","onDragLeave","onDragEnd","fileList","hidden","setHighlight","FileUploadStatus","indicating","autoSuccess","progress","percent","FileUploadToolbar","onClickRemove","onClickCancel","FileUploadRow","req","uploadProgressListeners","uploadProgressCallback","uploadedBytes","formData","onProgress","CreateStudy","studyValues","categoryName","getCategoryById","cleanModal","projectIds","createStudyFields","showHeader","StudyEnvironmentSetup","step","CurrentStep","currentStep","onPrevious","onCompleted","handleCompleted","filesSelection","myStudies","organization","openData","show","sync","isDisabled","disabledClass","errorClass","yesSelected","cursor","handleClick","toAssign","showErrors","yesAttributes","noAttributes","headerOrHeaderAndToggle","headerOnly","toggleOnly","toggleButton","getExternalUserPinFormFields","PinInput","pin","$","PureComponent","SelectComputePlatformStep","typeId","computePlatformsStore","nextDisabled","renderButtons","computeTypes","stackable","itemsPerRow","getAttrs","descHtml","handleSelectedComputeType","selectedPlatformId","ConfigureComputePlatformStep","handleCreate","isExternal","onNext","clientInformationStore","platformTitle","environmentsStore","CreateInternalPlatformForm","getCreateInternalPlatformForm","askForCidr","formField","getFields","CreateExternalPlatformForm","askForCredentials","credentials","awsRegion","adjustedData","addRequired","getCreateExternalPlatformForm","handleForgotPin","rulesPrefix","SelectEnvTypeStep","envTypesStore","envTypes","listApproved","handleSelectedEnvType","selectedEnvTypeId","ConfigureEnvTypeStep","envTypeConfigsStore","getEnvType","getEnvTypeConfigsStore","envTypeTitle","CreateInternalEnvForm","getCreateInternalEnvForm","dataTestId","envTypeConfigId","SelectConfigurationCards","handleSelectConfigurationId","configId","hasCost","estimatedCostInfoHtml","property","perDay","nicePrice","EnvironmentsList","instanceId","getEnvironmentsStore","onboardingOpen","onclose","needsAWSCredentials","handleConfigureCredentials","handleCreateEnvironment","hideModal","data-instance","handleDetailClick","setOnboarding","hidePinModal","pinModalOpen","EnvironmentCard","cleanTerminationState","shouldShowTerminateDialog","hideTerminateDialog","handleTerminateEnvironment","sagemakerNotebookIcon","emrIcon","rstudioIcon","ec2Icon","renderLeftCard","renderRightCard","renderTerminateDialog","fetchingUrl","getIcon","maxHeight","border","Label","clamp","getCostInPastDay","costsForLatestDate","service","userDisplayName","sharedWithUsers","sharedWithUsernames","renderStopButton","renderStartButton","renderTerminateButton","terminateButton","data-id","showTerminateDialog","stopButton","handleStopEnvironment","startButton","handleStartEnvironment","terminationInProgress","UserPinModal","Form","errorMsg","ScEnvironmentsList","storageKeys","filterNames","typesStore","selectedFilter","isEmpty","onSelectedFilter","scEnvironment","envsStore","handleSelectedFilter","ScEnvironmentCard","renderError","stretched","renderDetailTable","studyCount","envType","renderRow","definition","skipPrefix","showDetailButton","negative","ScEnvironmentConnections","getScEnvConnectionStore","hasHttp","scheme","hasSsh","hasRdp","openWindow","windowFeatures","ScEnvironmentHttpConnections","connectInfo","newTab","processingId","colSpan","ScEnvironmentSshConnections","showCreateKey","toggleCreateKey","connectionId","keyPairsStore","ScEnvironmentSshConnectionRow","keyId","changed","emptyKeys","networkInterfaces","selectedKeyId","selectedKeyName","rows","upward","processingSendKey","getKeyPair","connection","keyPairOptions","handleActivate","handleKeyChange","ScEnvSshConnRowExpanded","interfaces","example","moreThanOne","bulleted","network","expired","countDown","scope","startCountDown","ScEnvironmentRdpConnections","ScEnvironmentRdpConnectionRow","windowsRdpInfo","handleGetInfo","showPassword","renderUsernameLabel","renderPasswordLabel","toggleShowPassword","processingGetInfo","filterColorMap","ScEnvironmentsFilterButtons","handleSelected","ErrorInfo","setVisible","s","EnvironmentDetailPage","updateSharedWithUsers","downloadLink","passwordData","padding","RSA_PKCS1_PADDING","Buffer","instance","sharedWithUsersDropDownOptions","handleSharedWithUsersSelection","handleSubmitSharedWithUsersClick","costHeadings","costItemGivenADate","headings","rowValues","heading","handleKeyPairRequest","passRevealDisabled","windowsPassword","passRevealStyle","renderCopyToClipboard","animated","renderConnectBtn","msg","Button","ScEnvironmentDetailPage","renderTabs","ScEnvironmentTypeName","rawMessage","ScEnvironmentCostTable","costStore","costsStore","AddAwsAccount","addAwsAccountFormFields","xAccEnvMgmtRoleArn","CreateAwsAccount","createAwsAccountFormFields","accountEmail","masterRoleArn","UpdateBudget","budgetStore","thresholdsOptions","addBudgetFormFields","budgetLimit","startDate","endDate","thresholds","notificationEmail","EnvironmentSetup","activeIndex","widths","AddProject","indexIdOption","indexesStore","handleIndexSelection","AddSingleLocalUser","passwordField","showProjectWarning","EnvTypeCardMetaActions","handleTestClick","handleTestWithDataClick","createLinkWithSearch","reload","push","bind","EnvTypeCandidatesList","envTypeCandidatesStore","awsServiceCatalogIcon","toggle","showAllVersions","envMgmtRoleName","envTypeCandidate","envTypeCandidatesList","handleShowAllVersionsToggle","handleImportButtonClick","EnvTypesList","EnvTypeStatusEnum","statusFilter","envTypesList","handleStatusFilterChange","EnvTypeCard","revoking","isApproved","metaActions","payload","defaultMgmtActions","renderDeleteConfirmation","mgmtActions","c","shouldShowDeleteDialog","hideDeleteDialog","handleApproveRevokeClick","showDeleteDialog","EnvTypeEditor","ordered","stepAttribs","completed","stepPanes","createWizard","isComplete","stepKey","wizardModel","workspaceTypeAction","onEnvTypeSaveComplete","handleDone","getAction","getEnvTypeCandidate","steps","currentStepNo","BasicInfoStep","product","provisioningArtifact","savedEnvType","getAddEnvTypeBasicInfoForm","isEditing","nameField","descField","addEnvTypeBasicInfoFormFields","ConfigStep","showEnvTypeConfigDialog","shouldShowEnvTypeConfigDialog","renderActionButtons","onEnvTypeConfigSaveComplete","envTypeConfig","hideEnvTypeConfigDialog","EnvTypeConfigCard","renderEditorPopup","shouldShowEditorDialog","mode","cloning","envTypeConfigForEditor","showCloneDialog","showEditorDialog","hideEditorDialog","estimatedCostInfo","allowRoleIds","denyRoleIds","tags","isUpdating","idField","estimatedCostInfoField","BaseEnvTypeConfigStep","AccessControlStep","allowRoleIdsField","denyRoleIdsField","r","InputParamsStep","cfnParamsForm","paramsField","existingParamValues","keyPrefix","sessionStore","getCfnParamsForm","handleCfnParamsFormSubmit","configVarOptions","envTypeConfigVars","allowAdditions","DefaultValue","existingValue","TagsStep","renderFormFields","tagsField","onEnterEditMode","onExitEditMode","emptyRenderer","submitButtonTitle","hasNext","disableActionButtons","enableActionButtons","shouldEnableActionButtons","NameValuesEditor","rowKey","handleNameValueChange","rowIdx","nameValueForm","valueField","handleNameValueDelete","hideShowAddRowButton","showAddRowButton","hideCreateRow","showCreateRow","syncField","keyValues","keyValue","nameHeader","valueHeader","actionHeader","nameValues","editorOn","onDelete","emptyMessage","fullWidth","shouldShowAddRowButton","shouldShowCreateRow","EditableNameValueRow","getNameValueForm","handlerFnToNotify","handlerFn","showDimmer","showErrorPanel","renderFormAs","formContent","renderFieldForView","onClickEdit","renderFieldForEdit","submit","nameLabel","namePlaceholder","valueLabel","valuePlaceholder","EditableField","dimmer","onEditorOn","handleEditorOn","EnvTypesStore","EnvType","envTypeStores","EnvTypeStore","envTypeConfigsStores","EnvTypeConfigsStore","addEnvType","rawEnvType","createEnvType","createdEnvType","createdEnvTypeModel","deleteEnvType","updateEnvType","updatedEnvType","previousEnvType","approveEnvType","updated","revokeEnvType","getEnvTypeStore","mapToArray","EnvTypeCandidate","setEnvType","isNotApproved","envTypeConfigs","EnvTypeConfig","EnvTypeConfigVar","getAllEnvTypeConfigs","getEnvTypeConfigVars","createEnvTypeConfig","createdEnvTypeConfig","createdEnvTypeConfigModel","updateEnvTypeConfig","updatedEnvTypeConfig","deleteEnvTypeConfig","arr","getEnvTypeConfig","KeyValuePair","allowedToUse","setEnvTypeConfig","setEnvTypeConfigVar","EnvTypeCandidatesStore","envTypeCandidates","onEnvTypeCandidateImport","envTypeCandidateImported","httpApiGet","templateTitle","httpApiPost","httpApiPut","draft","httpApiDelete","templateId","workflowVer","templateVer","StepTemplateVersion","skippable","inputManifest","adminInputManifest","applyMarkdown","afterCreate","transformManifest","admin","visitFn","sections","section","visit","children","deriveAdminInputManifest","setStepTemplateVersion","template","StepTemplate","versions","setStepTemplate","mapOfExisting","version","processed","templateVersion","existing","largestVersion","getVersion","StepTemplatesStore","templates","getStepTemplates","toTemplates","previousKeys","hasPrevious","addTemplate","rawTemplate","getTemplate","runSpec","propertyOverrideSummaryRows","propsOverrideFields","allowed","default","editWorkflowTemplateDraftMetaFields","isTemplate","derivedTitle","derivedDesc","propsOverrideOption","warnMessage","canOverride","prop","warnIfCanNotOverride","stepTitle","stepDesc","workflowStepDescFields","workflowStepPropsFields","workflowStepConfigOverrideFields","workflowStepPropsOverrideFields","currentSectionIndex","review","originalConfig","originalSectionConfig","getSectionConfig","inputManifestSection","flattened","resetOriginalSectionConfig","next","keysAfter","keys","configKeys","configKeysAfter","nextSectionIndex","before","after","_form","previousSectionIndex","clearConfigs","clearSectionConfigs","applyChanges","restart","inputEntries","configMap","input","toMobxFormFields","merged","isConditionTrue","stepId","contentExpanded","configEdit","configOverrideEdit","descEdit","propsEdit","propsOverrideEdit","configurationEditor","stepDescForm","stepConfigOverrideForm","stepPropsForm","stepPropsOverrideForm","afterAttach","defaults","clone","getWorkflowStepConfigOverrideForm","getWorkflowStepDescForm","getWorkflowStepPropsForm","getWorkflowStepPropsOverrideForm","setContentExpanded","flag","setConfigEdit","setConfigOverrideEdit","setDescEdit","setPropsEdit","setPropsOverrideEdit","applyDefaults","applyConfigOverrides","configOverrides","applyPropsOverrides","propsOverrides","applyDescAndTitle","applySkippable","WorkflowTemplateDraftEditor","draftId","currentPage","numPages","stepEditors","draftCopy","draftMetaForm","getEditWorkflowTemplateDraftMetaForm","makeDraftCopy","nextPage","previousPage","getStepEditor","removeStepEditor","addStep","updatedDraft","encodeId","removeWizard","globals","titles","supportedPropsOverrideKeys","PropsOverrideOption","setAllowed","ConfigOverrideOption","WorkflowTemplateStep","stepTemplateId","stepTemplateVer","configOverrideOption","stepTemplate","setDesc","setTitle","setDefaults","setSkippable","setConfigOverrideOption","option","setPropsOverrideOption","additional","k","instanceTtl","runSpecSize","runSpecTarget","RunSpec","WorkflowTemplateVersion","selectedSteps","setWorkflowTemplateVersion","setDescription","setInstanceTtl","parsed","setRunSpec","reinsertStep","currentIndex","targetIndex","current","removeStep","idOrStep","workflowStep","getStep","canWorkflowOverrideProp","WorkflowTemplate","setWorkflowTemplate","setWorkflowTemplateDraft","setRev","WorkflowTemplateDraftsStore","drafts","normalizedDraft","getWorkflowTemplateDrafts","addDraft","rawDraft","updateWorkflowTemplateDraft","normalizeForSubmission","createWorkflowTemplateDraft","publishWorkflowTemplateDraft","publishResult","deleteWorkflowTemplateDraft","hasTemplate","hasDraft","getDraft","WorkflowTemplatesStore","getWorkflowTemplates","editWorkflowDraftMetaFields","prepareInputManifest","rawDefaults","copy","applyConfigs","workflowVersion","workflowTemplateVersion","workflowTemplateStep","WorkflowDraftEditor","getEditWorkflowDraftMetaForm","removeEditor","setConfigs","makeNew","stepTemplatesStore","statusColorMap","in_progress","WorkflowAssignment","wf","triggerType","triggerTypeData","setWorkflowAssignment","assignment","WorkflowInstance","wfId","wfVer","ttl","wfStatus","stStatuses","workflow","setWorkflowInstance","workflowsStore","stepSummary","statusLabel","statusColor","spread","statusMsg","stepsSummary","msgSpread","strip","pre","msgObj","parse","stepStatus","startTime","endTime","WorkflowVersion","stepsOrderChanged","instancesMap","workflowTemplateId","workflowTemplateVer","setWorkflowVersion","setInstances","instances","setInstance","getInstance","templatesStore","canOverrideProp","Workflow","assignments","setWorkflow","setAssignments","toWorkflows","workflowId","setWorkflowDraft","WorkflowDraftsStore","getWorkflowDrafts","updateWorkflowDraft","createWorkflowDraft","publishWorkflowDraft","deleteWorkflowDraft","hasWorkflow","getWorkflowInstances","triggerWorkflow","setSlowTickPeriod","setFastTickPeriod","hasInstance","getWorkflowInstance","instanceMst","getWorkflowAssignments","instancesStores","instanceStores","assignmentsStore","getWorkflow","workflowRaw","getInstancesStore","encodedId","getInstanceStore","getAssignmentsStore","WorkflowsStore","workflows","workflowStores","getWorkflows","addWorkflow","rawWorkflow","getWorkflowStore","latestWfVersion","wfv","wid","wrv","listener","a","workflowTemplateDraftEditor","workflowTemplateDraftsStore","workflowTemplatesStore","workflowDraftEditor","workflowDraftsStore","postRegisterAppContextItems","registerMenuItems","shouldShow","WorkflowCommonUIState","versionNumber","mainTabIndex","setVersionNumber","setMainTabIndex","idSuffix","Table","editable","getTitle","propertyRows","hasPropertyRows","propertyOverrideRows","hasPropertyOverrideRows","renderKey","configRows","hasConfigRows","configOverrideRows","hasConfigOverrideRows","constructor","getWorkflowTemplateStep","Accordion","handleOnExpand","renderDescriptionSection","renderConfigurationSection","renderPropertiesSection","getState","Tab","onTabChange","handleOnTabChange","Grid","getUIState","renderVersionDropdown","renderMainTabs","inline","uiState","handleOnVersionChange","Placeholder","segment","clean","draftsStore","renderDeleteDialog","Modal","handleDeleteDraft","handleEditDraft","deletingInProgress","createWorkflowTemplateDraftFields","draftFor","templateIdField","templateTitleField","clear","set","isNewTemplate","getCreateDraftForm","dropDownOptions","dropDownField","isNew","handleSelectionChange","onEdit","handleCreateDraftClick","handleCreateDraftCancel","showCreateDraftWizard","editor","toPropsOverride","getEditor","templateDescField","instanceTtlField","runSpecSizeField","runSpecTargetField","getWorkflowTemplate","handleFormErrors","handleOnSubmitNext","resetFlags","clickedOnNext","onSelected","button","labeled","selectedStep","source","isSource","isDestination","destination","isStep","editing","canRearrange","Dimmer","droppableId","provided","snapshot","StepEditorComponent","draggableId","innerRef","stepEditor","canMove","canDelete","handleAddStep","handleDelete","handleStepSave","renderContent","opened","handleExpandContent","stepEditorModel","canEdit","handleEditOn","handleEditOff","stepTitleField","stepDescField","skippableField","hasRows","editorModel","handleConfigSave","eventBus","handlePublish","getWorkflowTemplateDraftEditor","Breadcrumb","renderMetaContent","renderStepsContent","renderPublishContent","forceLoad","selectable","singleLine","latest","data-workflow","data-version","handleWorkflowClick","alt","bottom","createWorkflowDraftFields","workflowIdField","draftForValue","isNewWorkflow","hasWorkflows","hasTemplates","draftForDropDownOptions","workflowDropDownOptions","templatesDropDownOptions","isExistingWorkflow","emptyWorkflowTemplates","handleDraftForSelectionChange","Message","emptyWorkflows","titleField","draftEditor","getWorkflowDraftEditor","triggerWorkflowFields","workflowInputStr","getTriggerWorkflowForm","disposer","autorun","workflowStore","statusSummary","handleInstanceClick","Statistic","showTriggerDialog","workflowInputField","triggerDialogShown","cancelTriggerDialog","renderAssignmentsTable","handleTabChange","currentVersion","handleVersionChange","displayInstanceStatusMsg","renderSteps","registerRoutes","withAuth","statuses","inactive","KeyPair","owner","publicKey","setKeyPair","KeyPairsStore","keyPairs","addKeyPair","actions","processingButton","onCopy","handleCreateKeyPair","Hello","views","HelloStore","named","hellos","optional","array","replace","sortBy","slice","registerAppContextItems","helloStore","create","postInit","Map","HelloPage","scrollTo","renderEmpty","Group","Subheader","Content","extensionPoints","baseAppContextItemsPlugin","workflowAppContextItemsPlugin","envMgmtAppContextItemsPlugin","keyPairAppContextItemsPlugin","raasAppContextItemsPlugin","appContextItemsPlugin","baseInitializationPlugin","raasInitializationPlugin","initializationPlugin","baseAuthenticationPlugin","baseAppComponentPlugin","raasAppComponentPlugin","baseMenuItemsPlugin","workflowMenuItemsPlugin","envMgmtMenuItemsPlugin","keyPairMenuItemsPlugin","raasMenuItemsPlugin","menuItemsPlugin","baseRoutesPlugin","workflowRoutesPlugin","envMgmtRoutesPlugin","keyPairRoutesPlugin","raasRoutesPlugin","routesPlugin","raasEnvTypeMgmtPlugin","registry","getPlugins","extensionPoint","bootstrapApp","renderAppContainer","renderProgress","noSelected","fieldsToValidationRules","fieldsConfig","validationRules","validation","appIdToken","pinToken","workspacesFilterName","isNil","renderValue","requestId","seconds","singleStr","pluralStr","queryParams","newUrl","fragmentParams","hashKeyValues","param","keyValueArr","currentKey","keyNamesToRemove","hashStr","removeNulls","end","test","idGeneratorCount","itemsArray","mergeExistingFn","idFieldName","unprocessedKeys","hasExisting","flattenObject","accum","flattenedKey","element","toFlattenedKey","keyValuePairs","formRules","rule","bytes","decimals","dm","sizes","parseFloat","localStorage","sessionStorage","getItem","setItem","n","providerConfigs","idp","authNProviderId","idpName","By","notApproved","approved","getValidStatuses","productId","timeOut","toastr","toMessage","isPlural","messages","toasterErrorOptions","closeButton","debug","newestOnTop","progressBar","positionClass","preventDuplicates","extendedTimeOut","toasterWarningOptions","toasterSuccessOptions","AppContainer","ReactDOM","progressContent","ErrorBox","handleRetry","_err","shouldRetry","ScEnvironmentsStore","ALL","AVAILABLE","STOPPED","PENDING","ERRORED","TERMINATED","filters","connectionStores","addScEnvironment","createScEnvironment","terminateScEnvironment","deleteScEnvironment","startScEnvironment","stopScEnvironment","getScEnvironmentStore","filtered","canChangeState","OnboardingSteps","generateDefaultIAMPolicy","mapCredentialsColumns","ListOnboardingIAMUser","ListOnboardingEncrypt","UserOnboarding","navigator","rc","onboardingStep","onboardingClose","onboardingPrev","onboardingSteps","onboardingNext","onboardingSave","showHide","activePolicy","togglePolicy","language","docco","credentialsValid","handleCredentialsReset","ii","jj","isDragActive","renderOnboardingStep","resetOnboarding","handleCopyPolicy","onCredentialsDrop","onRegionChange","copiedPolicy","token","decodedIdToken","fetchJson","method","authHeader","body","authenticationProvider","expiresAt","isTokenExpired","revoked","apiPath","fetchMode","maxRetryCount","Authorization","retryCount","isOk","cache","redirect","retryOptions","paramKeys","paramKeysToPass","query","backoff","httpStatus","json","handleClear","totalSections","showSectionTitles","sectionTitles","ConfigurationReview","buttons","handleDownload","errorMap","renderer","autoFocus","friendly","friendlyOrErr","codes","fieldsObj","fieldOfInterest","fieldWithValue","formPlugins","validatorjs","formOptions","showErrorsOnReset","pluginsParam","optionsParam","AuthenticationProviderConfigsStore","flatObj","opaqueKey","fromOpaqueKey","unFlattenObject","authenticationProviderConfigs","authenticationProviderConfigEditors","AuthenticationProviderConfigEditor","authenticationProviderConfigEditor","getConfigEditorForUpdate","inputManifestForUpdate","filteredSections","filteredChildren","child","toOpaqueKey","toConfiguration","updateAuthenticationProvider","updateAuthenticationProviderConfig","getCreateAuthenticationProviderConfigEditor","getAuthenticationProviderConfigByIdpName","authNProvider","idps","InputManifest","normalizeForm","accountUUID","filenames","groupByService","groupByUser","keyPairId","fullName","isSame","isSamePrincipal","borderColor","borderWidth","legend","maintainAspectRatio","scales","xAxes","gridLines","yAxes","principalStr","encryptedCreds","setEncryptedCreds","unencryptedCreds","aesGcmEncrypt","clearEncryptedCreds","setUser","rawUser","aesGcmDecrypt","external","externalGuest","internalGuest","canCreateWorkspace","canViewDashboard","setBudget","serviceCost","setEnvironment","getEnvironmentUrl","setFetchingUrl","markAsStopping","markAsStarting","getEnvironmentKeypair","getWindowsPassword","getEnvironmentPasswordData","DEFAULT_ADDITION_LABEL","DropDown","additionLabel","mergeOptions","getValue","attribName","attribValue","defaultAttribValue","fromExtra","toUse","onAddItem","optionsInState","EnvironmentConfigurationsStore","getEnvironmentConfigurations","environmentConfigurations","channel","listenersMap","envConfig","allEnvConfigs","conf","allCost","day","costForDay","aws","STACK_FAIL","STACK_SUCCESS","stackName","StackName","describeStacks","stack","statusReason","outputsNormalized","exportName","ExportName","isDone","isFailed","templateUrl","Parameters","Capabilities","TemplateURL","Tags","Key","createStack","deleteStack","ready","addProjectFormFields","setStep","ComputePlatformSetup","platformsStore","platformStore","isExternalResearcher","hasCredentials","handleSelectComputePlatform","ScEnvironmentSetup","configurationStore","handleSelectEnvType","selectedTypeId","EnvironmentStatusIcon","EnvironmentConnectButton","getUrl","AuthorizedUrl","handleConnectClick","As","ScEnvironmentButtons","connectionsButtonActive","minHeight","handleTerminate","handleToggle","handleViewDetail","handleAction","iconAttrs","envCost","isError","previousCost","renderErrorPopup","currentIdx","Wizard","Step","setComplete","goTo","stepIdx","isStepActive","stepComponent","clearState","EnvTypeConfigEditor","envTypConfig","existingEnvTypeConfig","paramsJsonStr","tagsJsonStr","existingParams","existingTags","updatedTags","fromNameValueToKeyValue","nameValue","savedEnvTypeConfig","getEnvTypeConfigForm","StepComponentClass","wizardTempStoreKeyPrefix","Product","ProvisioningArtifact","createdTime","guidance","ParamConstraint","AllowedValues","CfnParam","ParameterType","IsNoEcho","ParameterConstraints","isLatest","setEnvTypeCandidate","serviceWorker","configure","enforceActions","initializeAppContext","appRunner","appStore","userApiKeysStore","authenticationProviderPublicConfigsStore","faviconIcon","faviconImage","logoImage","tokenInfo","idToken","loginInitiated","loginDetected","logoutInitiated","logoutDetected","getAppComponent","getAutoLogoutComponent","environmentConfigurationsStore","scEnvironmentCostsStore","canCreateWorkspaces","isExternalGuest","getEnvTypeCardMetaActions","payloadSoFar","showEnvTypeManagement","EnvTypesManagement","Wrapper","Comp","getWrappedCompProps","authenticated","additionalProps","WrapperComp","loginComp","dvrRules","validatorFn","baseFormHelper","package","extend","validator","createSingleFieldForm","PluginRegistry","appContextHolder","disposers","intervalIds","methodName","getPluginsWithMethod","continueOnError","pluginInvokerFn","publicUrl","swUrl","contentType","registration","registerValidSW","checkValidServiceWorker","isLocalhost","Boolean","installingWorker","AppRunner","initPlugins","externalRedirectUrl","postInitPlugins","userAuthenticated","setUserAuthenticated","Cleaner","forgetIdToken","Showdown","classMap","h1","h2","ul","li","p","img","bindings","regex","RegExp","extensions","markdown","extended","converter","makeHtml","UserApiKeysStore","userApiKeysStores","ApiKeysStore","currentUserApiKeyStore","getApiKeysStore","getCurrentUserApiKeysStore","parseError","queue","isInteractive","toMobxFormFieldProps","transform","findEntries","getSectionFlattened","condition","apiKeys","ApiKey","getApiKeys","apiKey","apiKeyModel","createNewApiKey","revokeApiKey","isStoreForCurrentUser","expiryTime","Authentication","removeTokensFromUrl","removeFragmentParams","clearTokens","setSelectedAuthenticationProviderId","getIdToken","idTokenFromUrl","getFragmentParam","idTokenFromLocal","getIdTokenInfo","tokenStatus","saveIdToken","setIdToken","selectedAuthenticationProvider","webpackContext","webpackContextResolve","__webpack_require__","o"],"mappings":"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","file":"static/js/main.4775adaf.chunk.js","sourcesContent":["/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\n\nimport ConfigurationEditor from '../configuration/ConfigurationEditor';\n\nconst AuthenticationProviderConfigEditor = types\n  .model('AuthenticationProviderPublicConfig', {\n    id: types.identifier,\n    configEditor: types.optional(ConfigurationEditor, {}),\n  })\n  .actions(self => ({\n    setConfigEditor(configEditor) {\n      self.configEditor = configEditor;\n    },\n  }))\n  .views(_self => ({}));\n\nexport default AuthenticationProviderConfigEditor;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { getEnv, types } from 'mobx-state-tree';\nimport _ from 'lodash';\nimport { BaseStore } from '../BaseStore';\nimport { getAuthenticationProviderPublicConfigs } from '../../helpers/api';\nimport AuthenticationProviderPublicConfig from './AuthenticationProviderPublicConfig';\n\nconst AuthenticationProviderPublicConfigsStore = BaseStore.named('AuthenticationProviderPublicConfigsStore')\n  .props({\n    authenticationProviderPublicConfigs: types.optional(types.array(AuthenticationProviderPublicConfig), []),\n  })\n  .actions(self => ({\n    async doLoad() {\n      const configs = await getAuthenticationProviderPublicConfigs();\n\n      self.runInAction(() => {\n        self.authenticationProviderPublicConfigs = configs;\n        const authentication = getEnv(self).authentication;\n        const selected = _.get(configs, '[0].id', '');\n        authentication.setSelectedAuthenticationProviderId(selected);\n      });\n    },\n  }))\n  .views(self => ({\n    get authenticationProviderOptions() {\n      const size = _.size(self.authenticationProviderPublicConfigs);\n\n      // We don't do any filtering if we only have one configuration\n      if (size === 1) {\n        const entry = self.authenticationProviderPublicConfigs[0];\n        return [\n          {\n            key: entry.id,\n            text: entry.title,\n            value: entry.id,\n          },\n        ];\n      }\n\n      // We need to loop through all the configurations and remove any entry\n      // that is of type cognito_user_pool but only if enableNativeUserPoolUsers = false\n      const result = [];\n      _.forEach(self.authenticationProviderPublicConfigs, config => {\n        if (config.type === 'cognito_user_pool' && !config.enableNativeUserPoolUsers) return;\n        result.push({\n          key: config.id,\n          text: config.title,\n          value: config.id,\n        });\n      });\n\n      return result;\n    },\n\n    toAuthenticationProviderFromId(authenticationProviderId) {\n      return _.find(self.authenticationProviderPublicConfigs, { id: authenticationProviderId });\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.authenticationProviderPublicConfigsStore = AuthenticationProviderPublicConfigsStore.create({}, appContext);\n}\n\nexport { AuthenticationProviderPublicConfigsStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { getEnv, types } from 'mobx-state-tree';\nimport { authenticate, config } from '../../helpers/api';\nimport { isAbsoluteUrl, getQueryParam, removeQueryParams, addQueryParams } from '../../helpers/utils';\nimport { boom } from '../../helpers/errors';\nimport { websiteUrl } from '../../helpers/settings';\n\nfunction toAbsoluteUrl(uri) {\n  return isAbsoluteUrl(uri) ? uri : `${config.apiPath}/${uri}`;\n}\nconst AUTHN_EXTENSION_POINT = 'authentication';\n\n// TODO: Remove this temp adjustment method. See comments in \"absoluteSignInUrl\" getter below for more details.\nfunction adjustRedirectUri(uri, redirectType = 'login') {\n  // Adjust the name of the query param to update and determine whether to preserve the path\n  // based on whether the user is logging in or out\n  let redirectParamName = 'redirect_uri';\n  let preservePath = true;\n  if (redirectType === 'logout') {\n    redirectParamName = 'logout_uri';\n    preservePath = false;\n  }\n\n  // if the current uri contains redirect param and if it is not the same as websiteUrl then adjust it\n  // This is required during local development. For other envs, redirectUri and websiteUrl will be same.\n  const initialRedirectUri = getQueryParam(uri, [redirectParamName]);\n\n  let adjustedUri = uri;\n  if (initialRedirectUri !== websiteUrl) {\n    adjustedUri = removeQueryParams(uri, [redirectParamName]);\n    adjustedUri = addQueryParams(adjustedUri, {\n      [redirectParamName]: preservePath ? window.location : window.location.origin,\n    });\n  }\n\n  return adjustedUri;\n}\n\nconst AuthenticationProviderPublicConfig = types\n  .model('AuthenticationProviderPublicConfig', {\n    id: '',\n    title: types.identifier,\n    type: '',\n    credentialHandlingType: '',\n    signInUri: '',\n    signOutUri: '',\n    enableNativeUserPoolUsers: types.maybeNull(types.boolean),\n  })\n  .actions(self => ({\n    cleanup() {\n      // No-op for now\n    },\n\n    login: async ({ username, password } = {}) => {\n      const pluginRegistry = getEnv(self).pluginRegistry;\n\n      const handleException = err => {\n        const code = _.get(err, 'code');\n        const isBoom = _.get(err, 'isBoom');\n        if (code === 'badRequest') throw boom.badRequest(err, err.message);\n        if (isBoom) throw err;\n        throw boom.apiError(err, 'Something went wrong while trying to contact the server.');\n      };\n\n      try {\n        // Notify each authentication plugins of explicit login attempt\n        await pluginRegistry.runPlugins(AUTHN_EXTENSION_POINT, 'loginInitiated');\n\n        if (self.credentialHandlingType === 'submit') {\n          // if the selectedAuthenticationProvider requires credentials to be submitted\n          // then submit the username/password to the specified URL\n          const authenticationProviderId = self.id;\n\n          const loginResult = await authenticate(self.absoluteSignInUrl, username, password, authenticationProviderId);\n\n          // If code reached here means the login was successful.\n          // (The above line would throw exception in case of failed login - in case of incorrect credentials or any other error)\n          // Notify each authentication plugins after explicit login.\n          await pluginRegistry.runPlugins(AUTHN_EXTENSION_POINT, 'loginDetected', { explicitLogin: true });\n\n          return loginResult;\n        }\n        if (self.credentialHandlingType === 'redirect') {\n          // if the selectedAuthenticationProvider requires us to redirect to identity provider\n          // instead of collecting credentials from user (for example, in case of SAML)\n          // just redirect to the specified url.\n          // The authentication plugins will be notified of 'loginDetected' in this case after the login process is\n          // complete by the \"initialization-plugin\"\n          window.location = self.absoluteSignInUrl;\n        }\n      } catch (err) {\n        handleException(err);\n      }\n      return undefined;\n    },\n\n    logout: async ({ autoLogout = false } = {}) => {\n      const pluginRegistry = getEnv(self).pluginRegistry;\n      // Notify each authentication plugins of explicit logout attempt.\n      // Explicit logout may be explicitly initiated\n      // - by user - \"autoLogout: false\" - (e.g., clicking on logout) OR\n      // - by application automatically - \"autoLogout: true\" - (e.g., app code initiating logout due to certain period\n      // of user inactivity\n      await pluginRegistry.runPlugins(AUTHN_EXTENSION_POINT, 'logoutInitiated', { autoLogout });\n\n      if (self.signOutUri) {\n        // if the selectedAuthenticationProvider requires us to redirect to some logout URL\n        // (such as SAML logout url in case of identity federation) just redirect to the specified url.\n        // The authentication plugins will be notified of 'logoutDetected' in this case after the logout process is\n        // complete by the \"initialization-plugin\"\n        window.location = self.absoluteSignOutUrl;\n      } else {\n        const cleaner = getEnv(self).cleaner;\n        await cleaner.cleanup();\n        window.history.pushState('', '', '/');\n\n        // Notify each authentication plugins after explicit logout.\n        await pluginRegistry.runPlugins(AUTHN_EXTENSION_POINT, 'logoutDetected', {\n          explicitLogout: true,\n          autoLogout,\n        });\n      }\n    },\n  }))\n  .views(self => ({\n    get absoluteSignInUrl() {\n      // The \"signInUri\" below contains redirectUrl that comes from server and points back to the actual websiteUrl\n      // (even on local machines during local development)\n      // TODO: Temp code: Adjust redirectUrl for local development.\n      //  This will go away once we switch to the idea of \"provider registry\". Currently, the provider configs are retrieved\n      //  from a central \"AuthenticationProviderConfigService\" on the server side and the providers do not get a chance to adjust \"signInUri\"\n      //  (or any other config variables) before returning them during local development, once we move to \"provider registry\" the registry will\n      //  pick appropriate auth provider impl and give it a chance to adjust variables or create derived variables\n      return adjustRedirectUri(toAbsoluteUrl(self.signInUri));\n    },\n    get absoluteSignOutUrl() {\n      return adjustRedirectUri(toAbsoluteUrl(self.signOutUri), 'logout');\n    },\n  }));\n\nexport default AuthenticationProviderPublicConfig;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getEnv } from 'mobx-state-tree';\n\n// A convenient model that returns the display name or long display name given a user identifier\nconst UserDisplayName = types.model('UserDisplayName', {}).views(self => ({\n  getDisplayName({ uid }) {\n    let userStore;\n\n    if (_.isUndefined(uid)) {\n      userStore = getEnv(self).userStore;\n      if (userStore.user) return userStore.displayName;\n      return 'Unknown';\n    }\n\n    if (uid === '_system_') return 'System';\n\n    const usersStore = getEnv(self).usersStore;\n    const user = usersStore.asUserObject({ uid });\n\n    if (_.isUndefined(user)) return 'unknown';\n    return user.displayName || 'unknown';\n  },\n\n  // identifier: can be an instance of '_system_', other string or undefined\n  getLongDisplayName(identifier) {\n    let userStore;\n\n    if (_.isUndefined(identifier)) {\n      userStore = getEnv(self).userStore;\n      if (userStore.user) return userStore.longDisplayName;\n      return 'Unknown';\n    }\n\n    if (identifier === '_system_') return 'System';\n\n    const usersStore = getEnv(self).usersStore;\n    const user = usersStore.asUserObject(identifier);\n\n    if (_.isUndefined(user)) return 'unknown';\n    return user.longDisplayName || 'unknown';\n  },\n\n  // identifier: can be an instance of '_system_', other string or undefined\n  isSystem(identifier) {\n    let userStore;\n\n    if (_.isUndefined(identifier)) {\n      userStore = getEnv(self).userStore;\n      if (userStore.user) return userStore.user.isSystem;\n      return false;\n    }\n\n    if (identifier === '_system_') return true;\n\n    const usersStore = getEnv(self).usersStore;\n    const user = usersStore.asUserObject(identifier);\n\n    if (_.isUndefined(user)) return false;\n    return user.isSystem;\n  },\n}));\n\nfunction registerContextItems(appContext) {\n  appContext.userDisplayName = UserDisplayName.create({}, appContext);\n}\n\nexport { UserDisplayName, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { applySnapshot, detach, getSnapshot, types } from 'mobx-state-tree';\nimport { addUser, updateUser, getUsers } from '@aws-ee/base-ui/dist/helpers/api';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { deleteUser, addUsers, updateUserApplication } from '../../helpers/api';\nimport { User } from './User';\n\nconst UsersStore = BaseStore.named('UsersStore')\n  .props({\n    users: types.optional(types.map(User), {}),\n    tickPeriod: 60 * 1000, // 1 minute\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const users = (await getUsers()) || [];\n        self.runInAction(() => {\n          users.forEach(user => {\n            const userModel = User.create(user);\n            const previous = self.users.get(userModel.id);\n            if (!previous) {\n              self.users.set(userModel.id, userModel);\n            } else {\n              applySnapshot(previous, user);\n            }\n          });\n        });\n      },\n\n      cleanup: () => {\n        self.users.clear();\n        superCleanup();\n      },\n      addUser: async user => {\n        // if username is not specified then pass email as username\n        const username = user.username || user.email;\n        const addedUser = await addUser({ ...user, username });\n        self.runInAction(() => {\n          // Added newly created user to users map\n          const addedUserModel = User.create(addedUser);\n          self.users.set(addedUserModel.id, addedUserModel);\n        });\n      },\n      addUsers: async users => {\n        await addUsers(users);\n      },\n      updateUser: async user => {\n        const updatedUser = await updateUser(user);\n        const userModel = User.create(updatedUser);\n        const previousUser = self.users.get(userModel.id);\n        applySnapshot(previousUser, updatedUser);\n      },\n      updateUserApplication: async user => {\n        const res = await updateUserApplication(user);\n        return res;\n      },\n      deleteUser: async user => {\n        const id = user && user.id ? user.id : User.create(user).id;\n        await deleteUser(user);\n        const deletedUser = self.users.get(id);\n        self.runInAction(() => {\n          // Detaching here instead of deleting because the ReactTable component in UsersList somehow still fires\n          // \"Cell\" component rendering after the user is deleted from the map\n          // That results in the following error\n          // \"You are trying to read or write to an object that is no longer part of a state tree. (Object type: 'User', Path upon death: \"\n          detach(deletedUser);\n          // self.users.delete(id);\n        });\n        // return deletedUser;\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.users.size === 0;\n    },\n\n    get hasNonRootAdmins() {\n      const nonRootAdmins = _.filter(self.list, user => user.isAdmin && !user.isRootUser);\n      return !_.isEmpty(nonRootAdmins);\n    },\n\n    get hasNonRootUsers() {\n      return !_.isEmpty(self.nonRootUsers);\n    },\n\n    get nonRootUsers() {\n      return _.filter(self.list, user => !user.isRootUser);\n    },\n\n    get list() {\n      const result = [];\n      // converting map self.users to result array\n      self.users.forEach(user => result.push(user));\n      return result;\n    },\n\n    asSelectOptions({ nonClearables = [] } = {}) {\n      const result = [];\n      self.users.forEach(user =>\n        result.push({\n          value: user.id,\n          label: user.longDisplayName,\n          clearableValue: !nonClearables.includes(user.id),\n        }),\n      );\n      return result;\n    },\n\n    asDropDownOptions({ status = 'active' } = {}) {\n      const result = [];\n      self.users.forEach(user => {\n        if (user.status === status) {\n          result.push({\n            key: user.id,\n            value: user.id,\n            text: user.longDisplayName,\n          });\n        }\n      });\n      return result;\n    },\n\n    asUserObject(userIdentifier) {\n      if (userIdentifier) {\n        const user = self.users.get(userIdentifier.uid);\n        return user || User.create({ username: userIdentifier.username, ns: userIdentifier.ns });\n      }\n      return undefined;\n    },\n\n    asUserObjects(userIdentifiers = []) {\n      const result = [];\n      userIdentifiers.forEach(userIdentifier => {\n        if (userIdentifier) {\n          const user = self.users.get(userIdentifier.uid);\n          if (user) {\n            result.push(user);\n          } else {\n            result.push(User.create(getSnapshot(userIdentifier)));\n          } // this could happen in the employee is no longer active or with the company\n        }\n      });\n\n      return result;\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.usersStore = UsersStore.create({}, appContext);\n}\n\nexport { UsersStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\n\nimport { getUser } from '@aws-ee/base-ui/dist/helpers/api';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { User } from './User';\n\nconst UserStore = BaseStore.named('UserStore')\n  .props({\n    user: types.maybe(User),\n  })\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const user = await getUser();\n        self.runInAction(() => {\n          self.user = User.create(user);\n        });\n      },\n      cleanup: () => {\n        self.user = undefined;\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return _.isEmpty(self.user);\n    },\n\n    // TODO this method should really be moved to the User model and renamed to something like projectIdOptions\n    get projectIdDropdown() {\n      const result = _.map(self.user.projectId, id => ({ key: id, value: id, text: id }));\n      return result;\n    },\n\n    get cloneUser() {\n      let result = {};\n      const {\n        username,\n        authenticationProviderId,\n        identityProviderName,\n        firstName,\n        lastName,\n        email,\n        isAdmin,\n        status,\n        userRole,\n        rev,\n        projectId,\n      } = self.user;\n      result = {\n        username,\n        authenticationProviderId,\n        identityProviderName,\n        firstName,\n        lastName,\n        email,\n        isAdmin,\n        status,\n        rev,\n        userRole,\n        projectId,\n      };\n      return result;\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.userStore = UserStore.create({}, appContext);\n}\n\nexport { UserStore, registerContextItems };\n","module.exports = __webpack_public_path__ + \"static/media/favicon.435897c0.ico\";","module.exports = \"data:image/png;base64,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\"","module.exports = __webpack_public_path__ + \"static/media/login-image.94b53ea6.gif\";","module.exports = __webpack_public_path__ + \"static/media/logo-image.0c978c0a.png\";","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { decorate, computed } from 'mobx';\nimport { inject, observer } from 'mobx-react';\nimport { getEnv } from 'mobx-state-tree';\nimport { Switch, Redirect, withRouter } from 'react-router-dom';\n\nimport withAuth from './withAuth';\nimport { getRoutes, getMenuItems, getDefaultRouteLocation } from './helpers/plugins-util';\nimport MainLayout from './parts/MainLayout';\n\n// expected props\n// - app model (via injection)\n// - location (from react router)\nclass App extends React.Component {\n  get appContext() {\n    return getEnv(this.props.app) || {};\n  }\n\n  getRoutes() {\n    const { location } = this.props;\n    const appContext = this.appContext;\n    return getRoutes({ location, appContext });\n  }\n\n  getMenuItems() {\n    const { location } = this.props;\n    const appContext = this.appContext;\n    return getMenuItems({ location, appContext });\n  }\n\n  getDefaultRouteLocation() {\n    // See https://reacttraining.com/react-router/web/api/withRouter\n    const { location } = this.props;\n    const appContext = this.appContext;\n\n    return getDefaultRouteLocation({ location, appContext });\n  }\n\n  renderApp() {\n    const defaultLocation = this.getDefaultRouteLocation();\n    return (\n      <MainLayout menuItems={this.getMenuItems()}>\n        <Switch>\n          <Redirect exact from=\"/\" to={defaultLocation} />\n          {this.getRoutes()}\n        </Switch>\n      </MainLayout>\n    );\n  }\n\n  render() {\n    return this.renderApp();\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(App, {\n  appContext: computed,\n});\n\nexport default withAuth(inject('app', 'userStore')(withRouter(observer(App))));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { observable, action, decorate, runInAction, computed } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { Button, Form, Grid, Header, Segment, Label, Input, Select, Image } from 'semantic-ui-react';\n\nimport { displayError } from '../helpers/notification';\nimport { branding } from '../helpers/settings';\n\n// From https://github.com/Semantic-Org/Semantic-UI-React/blob/master/docs/app/Layouts/LoginLayout.js\n// expected props\n// - authentication (via injection)\n// - authenticationProviderPublicConfigsStore (via injection)\n// - assets (via injection)\nclass Login extends React.Component {\n  constructor(props) {\n    super(props);\n\n    runInAction(() => {\n      this.username = '';\n      this.password = '';\n      this.loading = false;\n\n      this.authenticationProviderError = '';\n      this.usernameError = '';\n      this.passwordError = '';\n\n      // When the login page is shown, we default to the auth provider id of the first provider\n      // in the this.authProviderOptions list\n      const authentication = this.props.authentication;\n      authentication.setSelectedAuthenticationProviderId(_.get(this.authProviderOptions, '[0].key', ''));\n    });\n  }\n\n  getStore() {\n    return this.props.authenticationProviderPublicConfigsStore;\n  }\n\n  get authProviderOptions() {\n    const params = new URL(document.location).searchParams;\n    const showInternal = _.isString(params.get('internal'));\n    const store = this.getStore();\n    const options = store.authenticationProviderOptions;\n    const size = _.size(options);\n\n    // If we have one or zero options, we don't want to filter them, otherwise\n    // we might be filtering the only option available.\n    if (size <= 1) return options;\n\n    return _.filter(store.authenticationProviderOptions, config => {\n      if (config.key === 'internal' && showInternal) return true;\n      return config.key !== 'internal';\n    });\n  }\n\n  handleChange = name =>\n    action(event => {\n      this[name] = event.target.value;\n      if (name === 'username') this.usernameError = '';\n      if (name === 'password') this.passwordError = '';\n    });\n\n  handleAuthenticationProviderChange = action((_event, { value }) => {\n    this.props.authentication.setSelectedAuthenticationProviderId(value);\n  });\n\n  handleLogin = action(event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.authenticationProviderError = '';\n    this.usernameError = '';\n    this.passwordError = '';\n    const username = _.trim(this.username) || '';\n    const password = this.password || '';\n    const selectedAuthenticationProviderId = this.props.authentication.selectedAuthenticationProviderId || '';\n    let error = false;\n\n    if (_.isEmpty(selectedAuthenticationProviderId)) {\n      this.authenticationProviderError = 'please select authentication provider';\n      error = true;\n    }\n\n    const collectUserNamePassword = this.props.authentication.shouldCollectUserNamePassword;\n    // Validate username and password fields only if the selected authentication provider requires\n    // username and password to be submitted.\n    // For example, in case of SAML we do not collect username/password and in that case,\n    // we won't validate username/password. It will be the responsibility of the Identity Provider\n    // Do we need to collect username/password or not is specified by the authentication provider configuration\n    // via \"credentialHandlingType\" field.\n    if (collectUserNamePassword) {\n      if (_.isEmpty(username)) {\n        this.usernameError = 'username is required';\n        error = true;\n      }\n\n      if (!_.isEmpty(username) && username.length < 3) {\n        this.usernameError = 'username must be at least 3 characters long';\n        error = true;\n      }\n\n      if (_.isEmpty(password)) {\n        this.passwordError = 'password is required';\n        error = true;\n      }\n      if (!_.isEmpty(password) && password.length < 4) {\n        this.passwordError = 'password must be at least 4 characters long';\n        error = true;\n      }\n    }\n\n    if (error) return;\n\n    const authentication = this.props.authentication;\n    this.loading = true;\n\n    Promise.resolve()\n      .then(() =>\n        authentication.login({\n          username,\n          password,\n        }),\n      )\n      .catch(err => displayError(err))\n      .finally(\n        action(() => {\n          this.loading = false;\n        }),\n      );\n  });\n\n  render() {\n    const error = !!(this.usernameError || this.passwordError || this.authenticationProviderError);\n\n    const authenticationProviderOptions = this.authProviderOptions;\n    const selectedAuthenticationProviderId = this.props.authentication.selectedAuthenticationProviderId;\n\n    const renderAuthenticationProviders = () => {\n      // Display authenticationProviderOptions only if there are more than one to choose from\n      // if there is only one authentication provider available then use that\n      if (authenticationProviderOptions && authenticationProviderOptions.length > 1) {\n        return (\n          <Form.Field error={!!this.usernameError} required>\n            <Select\n              placeholder=\"Select Authentication Provider\"\n              options={authenticationProviderOptions}\n              defaultValue={selectedAuthenticationProviderId}\n              onChange={this.handleAuthenticationProviderChange}\n            />\n            {this.authenticationProviderError && (\n              <Label basic color=\"red\" pointing className=\"float-left mb2\">\n                {this.authenticationProviderError}\n              </Label>\n            )}\n          </Form.Field>\n        );\n      }\n      return '';\n    };\n\n    const collectUserNamePassword = this.props.authentication.shouldCollectUserNamePassword;\n    const renderBrandingLogo = <Image centered src={this.props.assets.images.loginImage} />;\n    return (\n      <div className=\"login-form animated fadeIn\">\n        {/*\n        Heads up! The styles below are necessary for the correct render of this example.\n        You can do same with CSS, the main idea is that all the elements up to the `Grid`\n        below must have a height of 100%.\n      */}\n        <style>\n          {`\n        body > div#root,\n        body > div#root > div,\n        body > div#root > div > div.login-form {\n          height: 100%;\n        }\n      `}\n        </style>\n        <Grid textAlign=\"center\" style={{ height: '100%' }} verticalAlign=\"middle\">\n          <Grid.Column style={{ maxWidth: 450 }}>\n            <Form\n              error={error}\n              size=\"large\"\n              loading={this.loading}\n              onSubmit={e => {\n                e.preventDefault();\n                e.stopPropagation();\n              }}\n            >\n              <Segment stacked>\n                {renderBrandingLogo}\n                <Header as=\"h3\" textAlign=\"center\">\n                  {branding.login.title}\n                  <Header.Subheader>{branding.login.subtitle}</Header.Subheader>\n                </Header>\n\n                {renderAuthenticationProviders()}\n\n                {collectUserNamePassword && (\n                  <Form.Field error={!!this.usernameError} required>\n                    <Input\n                      fluid\n                      icon=\"user\"\n                      iconPosition=\"left\"\n                      placeholder=\"Username\"\n                      data-testid=\"username\"\n                      value={this.username}\n                      onChange={this.handleChange('username')}\n                    />\n                    {this.usernameError && (\n                      <Label basic color=\"red\" pointing className=\"float-left mb2\">\n                        {this.usernameError}\n                      </Label>\n                    )}\n                  </Form.Field>\n                )}\n\n                {collectUserNamePassword && (\n                  <Form.Field error={!!this.passwordError} required>\n                    <Input\n                      fluid\n                      icon=\"lock\"\n                      iconPosition=\"left\"\n                      placeholder=\"Password\"\n                      data-testid=\"password\"\n                      value={this.password}\n                      type=\"password\"\n                      onChange={this.handleChange('password')}\n                    />\n                    {this.passwordError && (\n                      <Label basic color=\"red\" pointing className=\"float-left mb2\">\n                        {this.passwordError}\n                      </Label>\n                    )}\n                  </Form.Field>\n                )}\n\n                <Button\n                  data-testid=\"login\"\n                  type=\"submit\"\n                  color=\"blue\"\n                  fluid\n                  basic\n                  size=\"large\"\n                  className=\"mb2\"\n                  onClick={this.handleLogin}\n                >\n                  Login\n                </Button>\n              </Segment>\n            </Form>\n          </Grid.Column>\n        </Grid>\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(Login, {\n  username: observable,\n  password: observable,\n  loading: observable,\n  authenticationProviderError: observable,\n  usernameError: observable,\n  passwordError: observable,\n  authProviderOptions: computed,\n});\n\nexport default inject(\n  'authentication',\n  'authenticationProviderPublicConfigsStore',\n  'assets',\n)(withRouter(observer(Login)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport _ from 'lodash';\nimport { Route, Switch } from 'react-router-dom';\n\n/**\n * Configures the given React Router by collecting routes contributed by all route plugins.\n *\n * @returns {*} A React.Router or Switch Component\n */\n// eslint-disable-next-line no-unused-vars\nfunction getRoutes({ location, appContext }) {\n  const plugins = appContext.pluginRegistry.getPluginsWithMethod('routes', 'registerRoutes');\n  const initial = new Map();\n  // Ask each plugin to return their routes. Each plugin is passed a Map containing the routes collected so\n  // far from other plugins. The plugins are called in the same order as returned by the registry.\n  // Each plugin gets a chance to add, remove, update, or delete routes by mutating the provided routesMap object.\n  // This routesMap is a Map that has route paths as keys and React Component as value.\n  const routesMap = _.reduce(plugins, (routesFar, plugin) => plugin.registerRoutes(routesFar, appContext), initial);\n\n  const entries = Array.from(routesMap || new Map());\n  let routeIdx = 0;\n  return (\n    <Switch>\n      {_.map(entries, ([routePath, reactComponent]) => {\n        routeIdx += 1;\n        return <Route key={routeIdx} path={routePath} component={reactComponent} />;\n      })}\n    </Switch>\n  );\n}\n\n/**\n * Returns menu items for navigation by collecting items contributed by all menu item plugins.\n *\n * @param {*} appContext An application context object containing all MobX store objects\n *\n * @returns {*}\n */\nfunction getMenuItems({ location, appContext }) {\n  const plugins = appContext.pluginRegistry.getPluginsWithMethod('menu-items', 'registerMenuItems');\n  const initial = new Map();\n  // Ask each plugin to return their nav items. Each plugin is passed a Map containing the nav items collected so\n  // far from other plugins. The plugins are called in the same order as returned by the registry.\n  // Each plugin gets a chance to add, remove, update, or delete items by mutating the provided itemsMap object.\n  // This itemsMap is a Map that has route paths (urls) as keys and menu item object as values.\n  const itemsMap = _.reduce(\n    plugins,\n    (itemsSoFar, plugin) => plugin.registerMenuItems(itemsSoFar, { location, appContext }),\n    initial,\n  );\n\n  const entries = Array.from(itemsMap || new Map());\n  return _.map(entries, ([url, menuItem]) => ({ url, ...menuItem }));\n}\n\nfunction getDefaultRouteLocation({ location, appContext }) {\n  const plugins = _.reverse(appContext.pluginRegistry.getPluginsWithMethod('routes', 'getDefaultRouteLocation') || []);\n  // We ask each plugin in reverse order if they have a default route\n  let defaultRoute;\n  _.forEach(plugins, plugin => {\n    const result = plugin.getDefaultRouteLocation({ location, appContext });\n    if (_.isUndefined(result)) return;\n    defaultRoute = result;\n    // eslint-disable-next-line consistent-return\n    return false; // This will stop lodash from continuing the forEach loop\n  });\n\n  return defaultRoute;\n}\n\nexport { getRoutes, getMenuItems, getDefaultRouteLocation };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { decorate, action } from 'mobx';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Menu, Icon, Image } from 'semantic-ui-react';\n\nimport { createLink } from '../helpers/routing';\nimport { displayError } from '../helpers/notification';\nimport { branding } from '../helpers/settings';\n\n// expected props\n// - userStore (via injection)\nclass MainLayout extends React.Component {\n  goto = pathname => () => {\n    const location = this.props.location;\n    const link = createLink({\n      location,\n      pathname,\n    });\n\n    this.props.history.push(link);\n  };\n\n  handleLogout = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    try {\n      await this.props.authentication.logout();\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  getMenuItems() {\n    return this.props.menuItems || [];\n  }\n\n  render() {\n    const currentUser = this.props.userStore.user;\n    const displayName = currentUser ? currentUser.displayName : 'Not Logged In';\n    const pathname = _.get(this.props.location, 'pathname', '');\n    const is = value => _.startsWith(pathname, value);\n\n    const itemsArr = this.getMenuItems();\n    return [\n      <Menu vertical inverted fixed=\"left\" icon=\"labeled\" key=\"ml1\" style={{ overflowY: 'auto' }}>\n        <Menu.Item name=\" \" style={{ height: '40px' }} />\n        {_.map(itemsArr, (item, index) => {\n          const show = (_.isFunction(item.shouldShow) && item.shouldShow()) || item.shouldShow;\n          return (\n            show &&\n            (item.body ? (\n              item.body\n            ) : (\n              <Menu.Item key={index} active={is(item.url)} onClick={is(item.url) ? undefined : this.goto(item.url)}>\n                <Icon name={item.icon} size=\"mini\" />\n                <span className=\"fs-7\">{item.title}</span>\n              </Menu.Item>\n            ))\n          );\n        })}\n      </Menu>,\n\n      <Menu inverted color=\"black\" fixed=\"top\" className=\"box-shadow zindex-1500\" key=\"ml2\">\n        <Menu.Item style={{ height: '50px', verticalAlign: 'middle' }}>\n          <Image\n            size=\"mini\"\n            src={this.props.assets.images.logoImage}\n            className=\"mr1\"\n            style={{ height: '40px', width: 'auto' }}\n          />\n          <span style={{ paddingLeft: '5px' }}>{branding.main.title}</span>\n        </Menu.Item>\n        <Menu.Menu position=\"right\">\n          <Menu.Item>\n            <Icon name=\"user\" /> {displayName}\n          </Menu.Item>\n          <Menu.Item name=\"logout\" onClick={this.handleLogout} />\n        </Menu.Menu>\n      </Menu>,\n      <div\n        className=\"fit animated fadeIn\"\n        style={{\n          paddingTop: '40px',\n          paddingLeft: '84px',\n          paddingBottom: '100px',\n        }}\n        key=\"ml3\"\n      >\n        {this.props.children}\n      </div>,\n    ];\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(MainLayout, {\n  handleLogout: action,\n});\n\nexport default inject('authentication', 'userStore', 'assets')(withRouter(observer(MainLayout)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observable, action, decorate, runInAction, computed } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { Button, Modal, Header } from 'semantic-ui-react';\nimport IdleTimer from 'react-idle-timer';\n\nimport { autoLogoutTimeoutInMinutes } from '../helpers/settings';\n\n// expected props\n// - authentication\n// - app\nclass AutoLogout extends React.Component {\n  constructor(props) {\n    super(props);\n\n    runInAction(() => {\n      this.dialogCountDown = undefined;\n      this.intervalId = undefined;\n    });\n  }\n\n  get app() {\n    return this.props.app;\n  }\n\n  get authentication() {\n    return this.props.authentication;\n  }\n\n  get modalOpen() {\n    return this.dialogCountDown >= 0;\n  }\n\n  componentDidMount() {}\n\n  clearInterval() {\n    if (!_.isUndefined(this.intervalId)) {\n      clearInterval(this.intervalId);\n      this.intervalId = undefined;\n    }\n    this.dialogCountDown = undefined;\n  }\n\n  startDialogCountDown = () => {\n    if (!_.isUndefined(this.intervalId)) return;\n    this.dialogCountDown = 60;\n\n    this.intervalId = setInterval(async () => {\n      // eslint-disable-next-line consistent-return\n      runInAction(() => {\n        if (this.dialogCountDown <= 0) {\n          return this.doLogout();\n        }\n        this.dialogCountDown -= 1;\n      });\n    }, 1000);\n  };\n\n  cancelDialogCountDown = () => {\n    this.clearInterval();\n  };\n\n  doLogout = async () => {\n    this.clearInterval();\n    return this.authentication.logout({ autoLogout: true });\n  };\n\n  handleLogout = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n    return this.doLogout();\n  };\n\n  render() {\n    const authenticated = this.app.userAuthenticated;\n    if (!authenticated) return null;\n    return (\n      <>\n        <IdleTimer timeout={1000 * 60 * autoLogoutTimeoutInMinutes} onIdle={this.startDialogCountDown} />\n        <Modal open={this.modalOpen} closeOnEscape={false} closeOnDimmerClick={false} centered={false}>\n          <Modal.Header>Are you still there?</Modal.Header>\n          <Modal.Content className=\"center\">\n            <div>For security purposes, you will be logged out in</div>\n            <Header as=\"h1\">{this.dialogCountDown}</Header>\n            <div>seconds</div>\n          </Modal.Content>\n          <Modal.Actions className=\"clearfix\">\n            <Button floated=\"right\" primary content=\"Keep Me Logged In\" onClick={this.cancelDialogCountDown} />\n            <Button floated=\"right\" content=\"Log Out\" onClick={this.handleLogout} />\n          </Modal.Actions>\n        </Modal>\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(AutoLogout, {\n  app: computed,\n  authentication: computed,\n  modalOpen: computed,\n  intervalId: observable,\n  dialogCountDown: observable,\n  startDialogCountDown: action,\n  doLogout: action,\n  handleLogout: action,\n  cancelDialogCountDown: action,\n  clearInterval: action,\n});\n\nexport default inject('authentication', 'app')(observer(AutoLogout));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport _ from 'lodash';\nimport { decorate } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Pie } from 'react-chartjs-2';\nimport { Container, Header, Segment, Icon } from 'semantic-ui-react';\nimport { displayError, displayWarning } from '@aws-ee/base-ui/dist/helpers/notification';\nimport ProgressPlaceHolder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\n\nimport { getEnvironments, getEnvironmentCost, getScEnvironments, getScEnvironmentCost } from '../../helpers/api';\nimport { enableBuiltInWorkspaces } from '../../helpers/settings';\n\nimport { blueDatasets } from './graphs/graph-options';\nimport BarGraph from './graphs/BarGraph';\n\nclass Dashboard extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      totalCost: 0,\n      projNameToTotalCost: {},\n      projNameToUserTotalCost: {},\n      envNameToCostInfo: {},\n      isLoading: true,\n    };\n  }\n\n  async componentDidMount() {\n    window.scrollTo(0, 0);\n    try {\n      const { totalCost, projNameToTotalCost, projNameToUserTotalCost, envNameToCostInfo } = await this.getCosts();\n      this.setState({\n        totalCost,\n        projNameToTotalCost,\n        projNameToUserTotalCost,\n        envNameToCostInfo,\n        isLoading: false,\n      });\n    } catch (error) {\n      const store = this.getStore();\n\n      // \"AccessDeniedException\" error code is thrown when Cost Explorer hasn't been configured\n      if (error.code === 'AccessDeniedException') {\n        if (store.user.isAdmin) {\n          // Cost Explorer related errors are only to be shown to admins, not researchers (GALI-266)\n          displayWarning(\n            'Error encountered accessing cost data. Please enable Cost Explorer in the AWS Management Console and wait for 24 hours.',\n          );\n        }\n      } else {\n        displayError(error.message);\n      }\n    }\n  }\n\n  getStore() {\n    return this.props.userStore;\n  }\n\n  render() {\n    return (\n      <Container className=\"mt3 mb4\">\n        {this.renderTitle()}\n        {this.renderContent()}\n      </Container>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div data-testid=\"page-title\" className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"dashboard\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Dashboard</Header.Content>\n        </Header>\n      </div>\n    );\n  }\n\n  renderContent() {\n    return (\n      <div>\n        {this.state.isLoading === false && this.state.totalCost === 0 ? (\n          <Segment className=\"bold\">No cost data to show</Segment>\n        ) : (\n          <>\n            <Segment>{this.renderCostPerProj()}</Segment>\n            <Segment>{this.renderPastMonthCostPerEnv()}</Segment>\n            <Segment>{this.renderYesterdayCostPerEnv()}</Segment>\n            <Segment className=\"clearfix\">{this.renderPastMonthCostPerProjPerUser()}</Segment>\n            <Segment className=\"bold\">\n              Total cost of all research workspaces for the past 30 days: $\n              {Math.round(this.state.totalCost * 100) / 100}\n            </Segment>\n          </>\n        )}\n      </div>\n    );\n  }\n\n  async getCosts() {\n    const { envNameToCostInfo, envNameToIndex } = await this.getAccumulatedEnvCost();\n\n    const projNameToUserTotalCost = {};\n    Object.keys(envNameToCostInfo).forEach(envName => {\n      const projName = envNameToIndex[envName];\n      if (projNameToUserTotalCost[projName] === undefined) {\n        projNameToUserTotalCost[projName] = {};\n      }\n      Object.keys(envNameToCostInfo[envName].pastMonthCostByUser).forEach(user => {\n        const currentUserCost = _.get(projNameToUserTotalCost, `${projName}.${user}`, 0);\n        projNameToUserTotalCost[projName][user] =\n          currentUserCost + envNameToCostInfo[envName].pastMonthCostByUser[user];\n      });\n    });\n\n    const projNameToTotalCost = {};\n    let totalCost = 0;\n    Object.keys(projNameToUserTotalCost).forEach(projName => {\n      let indexCost = 0;\n      Object.keys(projNameToUserTotalCost[projName]).forEach(user => {\n        indexCost += projNameToUserTotalCost[projName][user];\n      });\n      totalCost += indexCost;\n      projNameToTotalCost[projName] = indexCost;\n    });\n\n    return { totalCost, projNameToTotalCost, projNameToUserTotalCost, envNameToCostInfo };\n  }\n\n  async getAccumulatedEnvCost() {\n    const environments = enableBuiltInWorkspaces ? await getEnvironments() : await getScEnvironments();\n    const envIdToName = {};\n\n    const envNameToIndex = {};\n    environments.forEach(env => {\n      if (env.isExternal) return;\n      envIdToName[env.id] = env.name;\n      envNameToIndex[env.name] = env.indexId;\n    });\n\n    const envIds = Object.keys(envIdToName);\n    const envCostPromises = envIds.map(envId => {\n      return enableBuiltInWorkspaces\n        ? getEnvironmentCost(envId, 30, false, true)\n        : getScEnvironmentCost(envId, 30, false, true);\n    });\n\n    const envCostResults = await Promise.all(envCostPromises);\n    const pastMonthCostByUserArray = envCostResults.map(costResult => {\n      const createdByToCost = {};\n      _.forEach(costResult, costDate => {\n        const cost = costDate.cost;\n        Object.keys(cost).forEach(group => {\n          let createdBy = group.split('$')[1];\n          createdBy = createdBy || 'None';\n          const currentUserCost = _.get(createdByToCost, createdBy, 0);\n          createdByToCost[createdBy] = currentUserCost + cost[group].amount;\n        });\n      });\n      return createdByToCost;\n    });\n\n    const yesterdayCostArray = envCostResults.map(costResult => {\n      const yesterdayCost = costResult.length > 0 ? costResult[costResult.length - 1] : {};\n      let totalCost = 0;\n      if (yesterdayCost) {\n        const arrayOfCosts = _.flatMapDeep(yesterdayCost.cost);\n        arrayOfCosts.forEach(cost => {\n          totalCost += cost.amount;\n        });\n      }\n      return totalCost;\n    });\n\n    const envNameToCostInfo = {};\n    for (let i = 0; i < envIds.length; i++) {\n      const key = envIdToName[envIds[i]];\n      envNameToCostInfo[key] = {\n        pastMonthCostByUser: pastMonthCostByUserArray[i],\n        yesterdayCost: yesterdayCostArray[i],\n      };\n    }\n    return { envNameToCostInfo, envNameToIndex };\n  }\n\n  renderCostPerProj() {\n    if (_.isEmpty(this.state.projNameToTotalCost)) {\n      return <ProgressPlaceHolder />;\n    }\n    const title = 'Index Costs for Past 30 Days';\n    const labels = Object.keys(this.state.projNameToTotalCost);\n    const dataPoints = Object.keys(this.state.projNameToTotalCost).map(projName => {\n      return this.state.projNameToTotalCost[projName];\n    });\n    const data = {\n      labels,\n      datasets: blueDatasets(title, dataPoints),\n    };\n\n    return <BarGraph className=\"mr4\" data={data} title={title} />;\n  }\n\n  renderPastMonthCostPerEnv() {\n    if (_.isEmpty(this.state.envNameToCostInfo)) {\n      return <ProgressPlaceHolder />;\n    }\n\n    const pastMonthCostTotalArray = [];\n    Object.keys(this.state.envNameToCostInfo).forEach(envName => {\n      let total = 0;\n      Object.keys(this.state.envNameToCostInfo[envName].pastMonthCostByUser).forEach(user => {\n        total += this.state.envNameToCostInfo[envName].pastMonthCostByUser[user];\n      });\n      pastMonthCostTotalArray.push(total);\n    });\n    const title = 'Env Cost for Past 30 Days';\n    const labels = Object.keys(this.state.envNameToCostInfo);\n    const dataPoints = pastMonthCostTotalArray;\n    const data = {\n      labels,\n      datasets: blueDatasets(title, dataPoints),\n    };\n\n    return <BarGraph className=\"mr4\" data={data} title={title} />;\n  }\n\n  renderYesterdayCostPerEnv() {\n    if (_.isEmpty(this.state.envNameToCostInfo)) {\n      return <ProgressPlaceHolder />;\n    }\n    const title = \"Yesterday's Env Cost\";\n    const labels = Object.keys(this.state.envNameToCostInfo);\n    const dataPoints = Object.keys(this.state.envNameToCostInfo).map(envName => {\n      return this.state.envNameToCostInfo[envName].yesterdayCost;\n    });\n    const data = {\n      labels,\n      datasets: blueDatasets(title, dataPoints),\n    };\n\n    return <BarGraph className=\"mr4\" data={data} title={title} />;\n  }\n\n  renderPastMonthCostPerProjPerUser() {\n    if (_.isEmpty(this.state.projNameToUserTotalCost)) {\n      return <ProgressPlaceHolder />;\n    }\n    const results = [];\n    Object.keys(this.state.projNameToUserTotalCost).forEach(projName => {\n      const projCostData = this.state.projNameToUserTotalCost[projName];\n      const labels = Object.keys(projCostData);\n      // NOTE: We need a color for each user\n      const colors = ['#FF6384', '#36A2EB', '#FFCE56', '#CDDC39', '#4527a0', '#f4511e'];\n      const datasets = [\n        {\n          data: Object.keys(projCostData).map(user => {\n            return projCostData[user];\n          }),\n          backgroundColor: colors,\n          hoverBackgroundColor: colors,\n        },\n      ];\n\n      const data = {\n        labels,\n        datasets,\n      };\n\n      results.push(\n        <div key={projName} className=\"col col-6\">\n          <div className=\"center\">{projName}</div>\n          <Pie data={data} />\n        </div>,\n      );\n    });\n    return (\n      <>\n        <div className=\"center bold\">Index Cost Breakdowns for Past 30 Days</div>\n        {results}\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(Dashboard, {});\n\nexport default inject('userStore')(withRouter(observer(Dashboard)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { Bar } from 'react-chartjs-2';\n\nimport { barOptions } from './graph-options';\n\nconst BarGraph = ({ className, data, title, width = 250, height = 120 }) => {\n  return (\n    <div className={className}>\n      <div className=\"fs-9 center mt1 mb1\">{title}</div>\n      <div>\n        <Bar className={className} data={data} width={width} height={height} options={barOptions} />\n      </div>\n    </div>\n  );\n};\n\nexport default BarGraph;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { inject, observer } from 'mobx-react';\nimport { Component } from 'react';\n\n// expected props\n// - authenticationProviderConfigsStore (via injection)\nclass AddAuthenticationProvider extends Component {\n  render() {\n    return 'TODO: IMPLEMENT';\n  }\n}\n\nexport default inject('authenticationProviderConfigsStore')(observer(AddAuthenticationProvider));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { inject, observer } from 'mobx-react';\nimport React, { Component } from 'react';\nimport { Breadcrumb, Container, Header, Segment } from 'semantic-ui-react';\nimport { displayError, displaySuccess } from '../../helpers/notification';\n\nimport { gotoFn } from '../../helpers/routing';\nimport { swallowError } from '../../helpers/utils';\nimport { fromConfiguration } from '../../models/authentication/AuthenticationProviderConfigsStore';\nimport { isStoreError, isStoreLoading, isStoreReady } from '../../models/BaseStore';\nimport ConfigurationEditor from '../configuration/ConfigurationEditor';\nimport ConfigurationReview from '../configuration/ConfigurationReview';\nimport BasicProgressPlaceholder from '../helpers/BasicProgressPlaceholder';\nimport ErrorBox from '../helpers/ErrorBox';\n\n// expected props\n// - authenticationProviderConfigId (via react router params)\n// - authenticationProviderConfigsStore (via injection)\nclass EditAuthenticationProvider extends Component {\n  componentDidMount() {\n    const store = this.getStore();\n    swallowError(store.load());\n  }\n\n  render() {\n    const store = this.getStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder segmentCount={3} />;\n    } else if (isStoreReady(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3\">\n        <div className=\"mb4\">{content}</div>\n      </Container>\n    );\n  }\n\n  renderMain() {\n    const id = this.getAuthenticationProviderConfigId();\n    const authenticationProviderConfig = this.getAuthenticationProviderConfig();\n    if (!authenticationProviderConfig) return <ErrorBox error={`The Authentication Provider \"${id}\" does not exist`} />;\n    const goto = gotoFn(this);\n    return (\n      <div>\n        <Breadcrumb>\n          <Breadcrumb.Section link onClick={() => goto('/authentication-providers')}>\n            Authentication Providers\n          </Breadcrumb.Section>\n          <Breadcrumb.Divider icon=\"right angle\" />\n          <Breadcrumb.Section>Authentication Provider</Breadcrumb.Section>\n          <Breadcrumb.Divider icon=\"right angle\" />\n          <Breadcrumb.Section active>{authenticationProviderConfig.id}</Breadcrumb.Section>\n        </Breadcrumb>\n        <Segment>\n          <div className=\"ml2\">\n            {this.renderTitle(authenticationProviderConfig)}\n            {this.renderDetails(authenticationProviderConfig.id)}\n          </div>\n        </Segment>\n      </div>\n    );\n  }\n\n  renderTitle(authenticationProviderConfig) {\n    return (\n      <Header as=\"h1\" color=\"grey\" className=\"ml2 mt3\">\n        {authenticationProviderConfig.config.title}\n      </Header>\n    );\n  }\n\n  renderDetails(authenticationProviderConfigId) {\n    const authenticationProviderConfigEditor = this.getStore().getUpdateAuthenticationProviderConfigEditor(\n      authenticationProviderConfigId,\n    );\n    const model = authenticationProviderConfigEditor.configEditor;\n    const review = model.review;\n    if (review) {\n      return <ConfigurationReview model={model} onCancel={this.handleCancel} onSave={this.handleSave} />;\n    }\n    return <ConfigurationEditor model={model} onCancel={this.handleCancel} />;\n  }\n\n  getStore() {\n    return this.props.authenticationProviderConfigsStore;\n  }\n\n  getAuthenticationProviderConfigId() {\n    return decodeURIComponent((this.props.match.params || {}).authenticationProviderConfigId);\n  }\n\n  getAuthenticationProviderConfig() {\n    const id = this.getAuthenticationProviderConfigId();\n    return this.getStore().getAuthenticationProviderConfig(id);\n  }\n\n  handleCancel = () => {\n    const goto = gotoFn(this);\n    goto('/authentication-providers');\n  };\n\n  handleSave = async configs => {\n    try {\n      const authenticationProviderConfigToUpdate = fromConfiguration(configs);\n      const original = this.getAuthenticationProviderConfig();\n\n      const typeObj = original.config.type;\n      const providerTypeId = typeObj.type;\n\n      await this.getStore().updateAuthenticationProvider({\n        providerTypeId,\n        providerConfig: authenticationProviderConfigToUpdate,\n      });\n      const goto = gotoFn(this);\n      goto('/authentication-providers');\n\n      displaySuccess(`The authentication provider is updated successfully`);\n    } catch (error) {\n      displayError(error);\n    }\n  };\n}\n\nexport default inject('authenticationProviderConfigsStore')(observer(EditAuthenticationProvider));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { decorate } from 'mobx';\nimport { observer, inject } from 'mobx-react';\n\nimport InputEntryRenderer from './InputEntryRenderer';\n\n// expected props\n// - form (via props)\n// - inputEntries (via props) (these are the input manifest input entries)\n// - processing (via props) (default to false)\nclass InputEntriesRenderer extends React.Component {\n  getForm() {\n    return this.props.form;\n  }\n\n  getInputEntries() {\n    return this.props.inputEntries;\n  }\n\n  render() {\n    const processing = this.props.processing || false;\n    const form = this.getForm();\n    // entry is an object of this shape:\n    // { name: 'id',  type: 'string/yesNo,..', label, children: [ <optional> ], .. }\n    const entries = this.getInputEntries();\n    return (\n      <>\n        {_.map(entries, entry => (\n          <InputEntryRenderer key={entry.name} form={form} inputEntry={entry} processing={processing} />\n        ))}\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(InputEntriesRenderer, {});\n\nexport default inject()(observer(InputEntriesRenderer));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { decorate } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { Divider, Icon, Header } from 'semantic-ui-react';\n\nimport Input from '../helpers/fields/Input';\nimport YesNo from '../helpers/fields/YesNo';\nimport DropDown from '../helpers/fields/DropDown';\nimport TextArea from '../helpers/fields/TextArea';\n\n// expected props\n// - form (via props)\n// - inputEntry (via props)\n// - processing (via props) (default to false)\nclass InputEntryRenderer extends React.Component {\n  getForm() {\n    return this.props.form;\n  }\n\n  getInputEntry() {\n    return this.props.inputEntry;\n  }\n\n  getProcessing() {\n    return this.props.processing || false;\n  }\n\n  render() {\n    // entry is an object of a shape like:\n    // { name: 'id',  type: 'string/yesNo,..', label, children: [ <optional> ], .. }\n    const entry = this.getInputEntry();\n    const field = this.getField();\n\n    return (\n      <>\n        {this.renderDivider(entry)}\n        {field}\n      </>\n    );\n  }\n\n  renderDivider(entry) {\n    if (entry.divider === undefined) return null;\n    const divider = entry.divider;\n    const hasIcon = !!divider.icon;\n\n    if (_.isBoolean(entry.divider)) return <Divider className=\"mb3 mt0\" />;\n\n    return (\n      <Divider horizontal className=\"mb3 mt0\">\n        <Header as=\"h4\" color=\"grey\">\n          {hasIcon && <Icon name={divider.icon} color=\"grey\" />}\n          {divider.title}\n        </Header>\n      </Divider>\n    );\n  }\n\n  getField() {\n    const processing = this.getProcessing();\n    const form = this.getForm();\n    // entry is an object of a shape like:\n    // { name: 'id',  type: 'string/yesNo,..', label, children: [ <optional> ], .. }\n    const entry = this.getInputEntry();\n    const field = form.$(entry.name);\n\n    switch (entry.type) {\n      case 'stringInput':\n        return <Input field={field} disabled={processing} />;\n      case 'yesNoInput':\n        return <YesNo field={field} disabled={processing} />;\n      case 'dropDownInput':\n        return <DropDown field={field} fluid selection disabled={processing} />;\n      case 'textAreaInput':\n        return <TextArea field={field} disabled={processing} />;\n\n      default:\n        return <></>;\n    }\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(InputEntryRenderer, {});\n\nexport default inject()(observer(InputEntryRenderer));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React, { Component } from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Container, Header, Icon, Label, Segment } from 'semantic-ui-react';\nimport { gotoFn } from '../../helpers/routing';\n\nimport { swallowError } from '../../helpers/utils';\nimport { isStoreError, isStoreLoading, isStoreNotEmpty, isStoreReady } from '../../models/BaseStore';\nimport BasicProgressPlaceholder from '../helpers/BasicProgressPlaceholder';\nimport ErrorBox from '../helpers/ErrorBox';\nimport AuthenticationProviderCard from './AuthenticationProviderCard';\n\n// expected props\n// -  authenticationProviderConfigsStore (via injection)\nclass AuthenticationProvidersList extends Component {\n  componentDidMount() {\n    const store = this.getStore();\n    swallowError(store.load());\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.getStore();\n    store.stopHeartbeat();\n  }\n\n  getStore() {\n    return this.props.authenticationProviderConfigsStore;\n  }\n\n  handleAddAuthenticationProviderClick = _event => {\n    const goto = gotoFn(this);\n    goto('/authentication-providers/add');\n  };\n\n  render() {\n    const store = this.getStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder segmentCount={3} />;\n    } else if (isStoreReady(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3\">\n        <div className=\"mb4\">\n          {this.renderTitle()}\n          {content}\n        </div>\n      </Container>\n    );\n  }\n\n  renderTitle() {\n    const renderCount = () => {\n      const store = this.getStore();\n      const showCount = isStoreReady(store) && isStoreNotEmpty(store);\n      const list = store.list;\n      return (\n        showCount && (\n          <Label circular size=\"medium\">\n            {list.length}\n          </Label>\n        )\n      );\n    };\n\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"user secret\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">\n            Authentication Providers\n            {renderCount()}\n          </Header.Content>\n        </Header>\n        {/* <Button color=\"blue\" size=\"medium\" basic onClick={this.handleAddAuthenticationProviderClick}>Add Authentication Provider</Button> */}\n      </div>\n    );\n  }\n\n  renderMain() {\n    const store = this.getStore();\n    const list = store.list;\n\n    return (\n      <div>\n        {_.map(list, (authNProviderConfig, idx) => (\n          <Segment clearing key={authNProviderConfig.id} className=\"mb2\">\n            <AuthenticationProviderCard authenticationProviderConfig={authNProviderConfig} pos={idx + 1} />\n          </Segment>\n        ))}\n      </div>\n    );\n  }\n}\n\nexport default inject('authenticationProviderConfigsStore')(withRouter(observer(AuthenticationProvidersList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { observer } from 'mobx-react';\nimport React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { Button, Header, Label } from 'semantic-ui-react';\nimport { gotoFn } from '../../helpers/routing';\n\n// expected props\n// - authenticationProviderConfig\n// - pos\nclass AuthenticationProviderCard extends Component {\n  render() {\n    const authenticationProviderConfig = this.getAuthenticationProviderConfig();\n    return (\n      // The custom attribute \"data-id\" here is used for conveying the id of the virtualDatabase being clicked in the \"handleVirtualDatabaseClick\" handler\n      <div className=\"flex\">\n        <div className=\"flex-auto\">\n          <div className=\"flex\">\n            {this.renderIndexLabel()}\n            <Header as=\"h2\" color=\"grey\" className=\"mt0\">\n              {authenticationProviderConfig.config.title}{' '}\n              <span className=\"pl2 fs-9 breakout\">{authenticationProviderConfig.id}</span>\n              <div>{this.renderStatus(authenticationProviderConfig)}</div>\n            </Header>\n            <div className=\"ml-auto\">{this.renderActionButtons()}</div>\n          </div>\n          <div className=\"ml3 mb2 mt2 breakout\">{authenticationProviderConfig.config.type.description}</div>\n        </div>\n      </div>\n    );\n  }\n\n  getAuthenticationProviderConfig() {\n    return this.props.authenticationProviderConfig;\n  }\n\n  renderStatus(authenticationProviderConfig) {\n    const isActive = _.toLower(authenticationProviderConfig.status) === 'active';\n    return <Label color={isActive ? 'green' : 'red'}>{authenticationProviderConfig.status}</Label>;\n  }\n\n  renderIndexLabel() {\n    const pos = this.props.pos;\n    return (\n      <Label size=\"mini\" ribbon color=\"blue\" className=\"line-height-20-px\">\n        {pos}\n      </Label>\n    );\n  }\n\n  renderActionButtons() {\n    return (\n      <Button.Group basic size=\"mini\">\n        <Button icon=\"edit\" onClick={this.handleEditModeClick} />\n      </Button.Group>\n    );\n  }\n\n  handleEditModeClick = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    const id = this.getAuthenticationProviderConfig().id;\n    const goto = gotoFn(this);\n    goto(`/authentication-providers/${encodeURIComponent(id)}/edit`);\n  };\n}\n\nexport default withRouter(observer(AuthenticationProviderCard));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Container, Header, Icon, Tab, Grid } from 'semantic-ui-react';\n\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport { isStoreError, isStoreLoading, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { toIdpOptions } from '../../models/forms/UserFormUtils';\nimport DragDrop from './DragDrop';\nimport AddSingleUser from './AddSingleUser';\n\n// expected props\n// - authenticationProviderConfigsStore (via injection)\nclass AddUser extends React.Component {\n  componentDidMount() {\n    swallowError(this.getStore().load());\n  }\n\n  render() {\n    const store = this.getStore();\n    let content = null;\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0 mb3\" />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder />;\n    } else if (isStoreReady(store)) {\n      content = this.renderMain();\n    }\n\n    return (\n      <Container className=\"mt3 mb4\">\n        {this.renderTitle()}\n        {content}\n      </Container>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"user\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Add User</Header.Content>\n        </Header>\n      </div>\n    );\n  }\n\n  renderMain() {\n    const identityProviderOptions = this.getIdentityProviderOptions();\n    const panes = [\n      {\n        menuItem: 'Add Single User',\n        render: () => (\n          <Tab.Pane basic attached={false}>\n            <div className=\"mt3 animated fadeIn\">\n              <AddSingleUser />\n            </div>\n          </Tab.Pane>\n        ),\n      },\n      {\n        menuItem: 'Add Multiple Users',\n        render: () => (\n          <Tab.Pane basic attached={false}>\n            <DragDrop identityProviderOptions={identityProviderOptions} />\n          </Tab.Pane>\n        ),\n      },\n    ];\n    return (\n      <Grid>\n        <Grid.Column>\n          <Tab defaultActiveIndex={0} className=\"mt2\" menu={{ secondary: true, pointing: true }} panes={panes} />\n        </Grid.Column>\n      </Grid>\n    );\n  }\n\n  getIdentityProviderOptions() {\n    return toIdpOptions(this.getStore().list);\n  }\n\n  getStore() {\n    return this.props.authenticationProviderConfigsStore;\n  }\n}\n\nexport default inject('authenticationProviderConfigsStore')(withRouter(observer(AddUser)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '../../helpers/form';\n\nconst addUserFormFields = {\n  email: {\n    label: 'Username',\n    placeholder: 'Type email address as username for the user',\n    extra: { explain: 'Username in email format' },\n    rules: 'required|email|string',\n  },\n  identityProviderName: {\n    label: 'Identity Provider',\n    extra: { explain: 'Identity Provider for this user' },\n  },\n  projectId: {\n    label: 'Project Id',\n    extra: { explain: 'Select Project for this user' },\n  },\n  userRole: {\n    label: 'UserRole',\n    extra: { explain: \"Select user's role\" },\n  },\n  status: {\n    label: 'Status',\n    extra: {\n      explain: 'Active users can log into the Research Portal',\n      yesLabel: 'Active',\n      noLabel: 'Inactive',\n      yesValue: 'active',\n      noValue: 'inactive',\n    },\n  },\n};\n\nfunction getAddUserFormFields() {\n  return addUserFormFields;\n}\n\nfunction getAddUserForm() {\n  return createForm(addUserFormFields);\n}\n\nexport { getAddUserFormFields, getAddUserForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { Button, Container, Header, Icon, Label, Dimmer, Loader, Segment, Popup } from 'semantic-ui-react';\nimport { withRouter } from 'react-router-dom';\nimport { decorate, observable, runInAction, action } from 'mobx';\nimport { inject, observer } from 'mobx-react';\nimport ReactTable from 'react-table';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { displayWarning } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { isStoreError, isStoreLoading, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\n\nimport UpdateUser from './UpdateUser';\n\nclass UsersList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.notifyNonRootUsers = true;\n    this.state = {\n      // eslint-disable-next-line react/no-unused-state\n      selectedRole: '',\n      // eslint-disable-next-line react/no-unused-state\n      projectId: [],\n      // eslint-disable-next-line react/no-unused-state\n      identityProviderName: '',\n      // eslint-disable-next-line react/no-unused-state\n      isIdentityProviderNameChanged: false,\n      // eslint-disable-next-line react/no-unused-state\n      unchangedIdentityProviderName: '',\n    };\n    runInAction(() => {\n      // An object that keeps track of which user is being edited\n      // Each key in the object below has key as user's unique id (<ns>/<username>)\n      // and value as flag indicating whether to show the editor for the user\n      this.mapOfUsersBeingEdited = {};\n      this.formProcessing = false;\n    });\n  }\n\n  componentDidMount() {\n    const store = this.getStore();\n    swallowError(store.load());\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.getStore();\n    store.stopHeartbeat();\n  }\n\n  getStore() {\n    return this.props.usersStore;\n  }\n\n  goto(pathname) {\n    const { location, history } = this.props;\n    const link = createLink({ location, pathname });\n    history.push(link);\n  }\n\n  handleAddUser = () => {\n    this.goto('/users/add');\n  };\n\n  handleAddLocalUser = () => {\n    this.goto('/users/add/local');\n  };\n\n  handleAddAuthenticationProvider = () => {\n    this.goto('/authentication-providers');\n  };\n\n  getAwsAccountOptions() {\n    const accountStore = this.props.awsAccountsStore;\n    return accountStore.dropdownOptions;\n  }\n\n  renderHeader() {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"users\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">\n            Users\n            {this.renderTotal()}\n          </Header.Content>\n        </Header>\n        <Button color=\"blue\" size=\"medium\" className=\"mr2\" basic onClick={this.handleAddLocalUser}>\n          {' '}\n          Add Local User{' '}\n        </Button>\n        <Button color=\"blue\" size=\"medium\" basic onClick={this.handleAddUser}>\n          {' '}\n          Add Federated User{' '}\n        </Button>\n      </div>\n    );\n  }\n\n  renderTotal() {\n    const store = this.getStore();\n    if (isStoreError(store) || isStoreLoading(store)) return null;\n    const nonRootUsers = store.nonRootUsers;\n    const count = nonRootUsers.length;\n\n    return <Label circular>{count}</Label>;\n  }\n\n  renderMain() {\n    return this.renderUsers();\n  }\n\n  renderUsers() {\n    // Read \"this.mapOfUsersBeingEdited\" in the \"render\" method here\n    // The usersBeingEditedMap is then used in the ReactTable\n    // If we directly use this.mapOfUsersBeingEdited in the ReactTable's cell method, MobX does not\n    // realize that it is being used in the outer component's \"render\" method's scope\n    // Due to this, MobX does not re-render the component when observable state changes.\n    // To make this work correctly, we need to access \"this.mapOfUsersBeingEdited\" out side of ReactTable once\n\n    const store = this.getStore();\n    const usersList = store.list;\n    const pageSize = usersList.length;\n    const showPagination = usersList.length > pageSize;\n    const processing = this.formProcessing;\n\n    return (\n      // TODO: add api token stats and active flag here in the table\n      <Segment basic className=\"p0\">\n        <Dimmer active={processing} inverted>\n          <Loader inverted>Updating</Loader>\n        </Dimmer>\n        <ReactTable\n          data={usersList}\n          defaultSorted={[{ id: 'lastName', desc: true }]}\n          showPagination={showPagination}\n          defaultPageSize={pageSize}\n          className=\"-striped -highlight\"\n          filterable\n          defaultFilterMethod={(filter, row) => {\n            const columnValue = String(row[filter.id]).toLowerCase();\n            const filterValue = filter.value.toLowerCase();\n            return columnValue.indexOf(filterValue) >= 0;\n          }}\n          columns={[\n            {\n              Header: 'Name',\n              accessor: 'username',\n              width: 200,\n            },\n            {\n              Header: 'Email',\n              accessor: 'email',\n              width: 200,\n            },\n            {\n              Header: 'Identity Provider',\n              accessor: 'identityProviderName',\n              Cell: row => {\n                const user = row.original;\n                return user.identityProviderName || 'internal';\n              },\n            },\n            {\n              Header: 'Type',\n              accessor: 'isExternalUser',\n              width: 100,\n              Cell: row => {\n                const user = row.original;\n                return user.isExternalUser ? 'External' : 'Internal';\n              },\n              filterMethod: filter => {\n                if (filter.value.toLowerCase().includes('ex')) {\n                  return false;\n                }\n                return true;\n              },\n            },\n            {\n              Header: 'Role',\n              accessor: 'userRole',\n              width: 100,\n              style: { whiteSpace: 'unset' },\n              Cell: row => {\n                const user = row.original;\n                return user.userRole || 'N/A';\n              },\n            },\n            {\n              Header: 'Project',\n              style: { whiteSpace: 'unset' },\n              Cell: row => {\n                const user = row.original;\n                return user.projectId.join(', ') || '<<none>>';\n              },\n            },\n            {\n              Header: 'Status',\n              accessor: 'isActive',\n              width: 100,\n              Cell: row => {\n                const user = row.original;\n                let lable = null;\n                if (user.status === 'active') {\n                  lable = (\n                    <span>\n                      <Label color=\"green\">\n                        <i className=\"check circle outline icon\" />\n                        Active\n                      </Label>\n                    </span>\n                  );\n                } else if (user.status === 'inactive') {\n                  lable = (\n                    <span>\n                      <Label color=\"red\">\n                        <i className=\"circle icon\" />\n                        Inactive\n                      </Label>\n                    </span>\n                  );\n                } else {\n                  lable = (\n                    <span>\n                      <Label color=\"orange\">\n                        <i className=\"exclamation icon\" />\n                        Pending\n                      </Label>\n                    </span>\n                  );\n                }\n                return lable;\n              },\n              filterMethod: (filter, row) => {\n                if (row._original.status.indexOf(filter.value.toLowerCase()) >= 0) {\n                  return true;\n                }\n                return false;\n              },\n            },\n            {\n              Header: '',\n              filterable: false,\n              Cell: cell => {\n                const user = cell.original;\n                return (\n                  <div style={{ textAlign: 'center', verticalAlign: 'middle' }}>\n                    <span>\n                      <Popup\n                        content=\"View User Detail\"\n                        trigger={\n                          <UpdateUser\n                            user={user}\n                            adminMode\n                            userStore={this.props.userStore}\n                            usersStore={this.props.usersStore}\n                            userRolesStore={this.props.userRolesStore}\n                            awsAccountsStore={this.props.awsAccountsStore}\n                            projectsStore={this.props.projectsStore}\n                          />\n                        }\n                      />\n                    </span>\n                  </div>\n                );\n              },\n            },\n          ]}\n        />\n      </Segment>\n    );\n  }\n\n  render() {\n    const store = this.getStore();\n    let content = null;\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder segmentCount={3} />;\n    } else if (isStoreReady(store)) {\n      if (!store.hasNonRootUsers) {\n        if (this.notifyNonRootUsers) {\n          this.notifyNonRootUsers = false;\n          displayWarning(\n            'Please add users in the Data Lake. May need to configure authentication provider in the Auth tab at left. Then login as a regular non-root User.',\n          );\n        }\n      }\n      content = this.renderMain();\n    }\n\n    return (\n      <Container className=\"mt3 animated fadeIn\">\n        {this.renderHeader()}\n        {content}\n      </Container>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(UsersList, {\n  mapOfUsersBeingEdited: observable,\n  formProcessing: observable,\n  handleAddUser: action,\n  handleAddAuthenticationProvider: action,\n  handleAddLocalUser: action,\n});\n\nexport default inject(\n  'userStore',\n  'usersStore',\n  'userRolesStore',\n  'awsAccountsStore',\n  'projectsStore',\n)(withRouter(observer(UsersList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\n\nconst App = types\n  .model('BaseApp', {\n    userAuthenticated: false,\n  })\n  .actions(() => ({\n    // I had issues using runInAction from mobx\n    // the issue is discussed here https://github.com/mobxjs/mobx-state-tree/issues/915\n    runInAction(fn) {\n      return fn();\n    },\n  }))\n  .actions(self => ({\n    init: async payload => {\n      const tokenNotExpired = _.get(payload, 'tokenInfo.status') === 'notExpired';\n      if (tokenNotExpired) {\n        self.setUserAuthenticated(true);\n      }\n    },\n\n    setUserAuthenticated(flag) {\n      self.userAuthenticated = flag;\n    },\n\n    // this method is called by the Cleaner\n    cleanup() {\n      self.setUserAuthenticated(false);\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.app = App.create({}, appContext);\n}\n\nexport { App, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/**\n * Encrypts plaintext using AES-GCM with supplied password, for decryption with aesGcmDecrypt().\n * https://gist.github.com/chrisveness/43bcda93af9f646d083fad678071b90a\n * MIT lisence\n *\n * @param   {String} plaintext - Plaintext to be encrypted.\n * @param   {String} password - Password to use to encrypt plaintext.\n * @returns {String} Encrypted ciphertext.\n *\n * @example\n *   const ciphertext = await aesGcmEncrypt('my secret text', 'pw');\n *   aesGcmEncrypt('my secret text', 'pw').then(function(ciphertext) { console.log(ciphertext); });\n */\nasync function aesGcmEncrypt(plaintext, password) {\n  const pwUtf8 = new TextEncoder().encode(password); // encode password as UTF-8\n  const pwHash = await crypto.subtle.digest('SHA-256', pwUtf8); // hash the password\n\n  const iv = crypto.getRandomValues(new Uint8Array(12)); // get 96-bit random iv\n\n  const alg = { name: 'AES-GCM', iv }; // specify algorithm to use\n\n  const key = await crypto.subtle.importKey('raw', pwHash, alg, false, ['encrypt']); // generate key from pw\n\n  const ptUtf8 = new TextEncoder().encode(plaintext); // encode plaintext as UTF-8\n  const ctBuffer = await crypto.subtle.encrypt(alg, key, ptUtf8); // encrypt plaintext using key\n\n  const ctArray = Array.from(new Uint8Array(ctBuffer)); // ciphertext as byte array\n  const ctStr = ctArray.map(byte => String.fromCharCode(byte)).join(''); // ciphertext as string\n  const ctBase64 = btoa(ctStr); // encode ciphertext as base64\n\n  const ivHex = Array.from(iv)\n    .map(b => `00${b.toString(16)}`.slice(-2))\n    .join(''); // iv as hex string\n\n  return ivHex + ctBase64; // return iv+ciphertext\n}\n\n/**\n * Decrypts ciphertext encrypted with aesGcmEncrypt() using supplied password.\n * https://gist.github.com/chrisveness/43bcda93af9f646d083fad678071b90a\n * MIT lisence\n *\n * @param   {String} ciphertext - Ciphertext to be decrypted.\n * @param   {String} password - Password to use to decrypt ciphertext.\n * @returns {String} Decrypted plaintext.\n *\n * @example\n *   const plaintext = await aesGcmDecrypt(ciphertext, 'pw');\n *   aesGcmDecrypt(ciphertext, 'pw').then(function(plaintext) { console.log(plaintext); });\n */\nasync function aesGcmDecrypt(ciphertext, password) {\n  const pwUtf8 = new TextEncoder().encode(password); // encode password as UTF-8\n  const pwHash = await crypto.subtle.digest('SHA-256', pwUtf8); // hash the password\n\n  const iv = ciphertext\n    .slice(0, 24)\n    .match(/.{2}/g)\n    .map(byte => parseInt(byte, 16)); // get iv from ciphertext\n\n  const alg = { name: 'AES-GCM', iv: new Uint8Array(iv) }; // specify algorithm to use\n\n  const key = await crypto.subtle.importKey('raw', pwHash, alg, false, ['decrypt']); // use pw to generate key\n\n  const ctStr = atob(ciphertext.slice(24)); // decode base64 ciphertext\n  const ctUint8 = new Uint8Array(ctStr.match(/[\\s\\S]/g).map(ch => ch.charCodeAt(0))); // ciphertext as Uint8Array\n\n  const plainBuffer = await crypto.subtle.decrypt(alg, key, ctUint8); // decrypt ciphertext using key\n  const plaintext = new TextDecoder().decode(plainBuffer); // decode password from UTF-8\n\n  return plaintext; // return the plaintext\n}\n\nexport { aesGcmEncrypt, aesGcmDecrypt };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { consolidateToMap } from '@aws-ee/base-ui/dist/helpers/utils';\n\nimport { getAccounts, removeAccountInfo } from '../../helpers/api';\nimport { Account } from './Account';\nimport { AccountStore } from './AccountStore';\n\n// ==================================================================\n// AccountsStore\n// ==================================================================\nconst AccountsStore = BaseStore.named('AccountsStore')\n  .props({\n    accounts: types.optional(types.map(Account), {}),\n    accountStores: types.optional(types.map(AccountStore), {}),\n    tickPeriod: 5 * 1000, // 10 sec\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const accounts = await getAccounts();\n        // We try to preserve existing accounts data and merge the new data instead\n        // We could have used self.accounts.replace(), but it will do clear() then merge()\n        self.runInAction(() => {\n          consolidateToMap(self.accounts, accounts, (exiting, newItem) => {\n            exiting.setAccount(newItem);\n          });\n        });\n        return undefined;\n      },\n\n      addAccount(rawAccount) {\n        const id = rawAccount.id;\n        const previous = self.accounts.get(id);\n\n        if (!previous) {\n          self.accounts.put(rawAccount);\n        } else {\n          previous.setAccount(rawAccount);\n        }\n      },\n\n      async removeItem(id) {\n        const account = self.accounts.get(id);\n        self.accounts.delete(account);\n        await removeAccountInfo(id);\n      },\n\n      getAccountStore: accountId => {\n        let entry = self.accountStores.get(accountId);\n        if (!entry) {\n          // Lazily create the store\n          self.accountStores.set(accountId, AccountStore.create({ accountId }));\n          entry = self.accountStores.get(accountId);\n        }\n\n        return entry;\n      },\n\n      cleanup: () => {\n        self.accounts.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get listCreatingAccount() {\n      const result = [];\n      self.accounts.forEach(account => {\n        if (account.status === 'PENDING') {\n          result.push(account);\n        }\n      });\n      return _.reverse(_.sortBy(result, ['createdAt', 'name']));\n    },\n\n    get listErrorAccount() {\n      const result = [];\n      self.accounts.forEach(account => {\n        if (account.status === 'FAILED') {\n          result.push(account);\n        }\n      });\n      return _.reverse(_.sortBy(result, ['createdAt', 'name']));\n    },\n\n    get empty() {\n      return self.accounts.size === 0;\n    },\n\n    get total() {\n      return self.accounts.size;\n    },\n\n    get list() {\n      const result = [];\n      self.accounts.forEach(account => result.push(account));\n\n      return _.reverse(_.sortBy(result, ['createdAt', 'name']));\n    },\n\n    hasAccount(id) {\n      return self.accounts.has(id);\n    },\n\n    getAccount(id) {\n      return self.accounts.get(id);\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.accountsStore = AccountsStore.create({}, appContext);\n}\n\nexport { AccountsStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types, applySnapshot } from 'mobx-state-tree';\n\nconst CfnInfo = types.model({\n  crossAccountExecutionRoleArn: '',\n  crossAccountEnvMgmtRoleArn: '',\n  subnetId: '',\n  vpcId: '',\n  stackId: '',\n});\n// ==================================================================\n// Account\n// ==================================================================\nconst Account = types\n  .model('Account', {\n    id: types.identifier,\n    accountName: '',\n    status: '',\n    accountArn: '',\n    email: '',\n    cfnInfo: types.optional(CfnInfo, {}),\n    rev: types.maybe(types.number),\n    name: '',\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n  })\n  .actions(self => ({\n    setAccount(rawAccount) {\n      // Note: if you have partial data vs full data, you need to replace the applySnapshot() with\n      // the appropriate logic\n      applySnapshot(self, rawAccount);\n    },\n  }))\n\n  // eslint-disable-next-line no-unused-vars\n  .views(self => ({\n    // add view methods here\n  }));\n\n// eslint-disable-next-line import/prefer-default-export\nexport { Account };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { getParent } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getAccount } from '../../helpers/api';\n\n// ==================================================================\n// AccountStore\n// ==================================================================\nconst AccountStore = BaseStore.named('AccountStore')\n  .props({\n    accountId: '',\n    tickPeriod: 300 * 1000, // 5 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const parent = getParent(self, 2);\n        const rawAccount = await getAccount(self.accountId);\n        parent.addAccount(rawAccount);\n        return undefined;\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get account() {\n      const parent = getParent(self, 2);\n      const w = parent.getAccount(self.accountId);\n      return w;\n    },\n  }));\n\n// Note: Do NOT register this in the global context, if you want to gain access to an instance\n//       use accountsStore.getAccountStore()\n// eslint-disable-next-line import/prefer-default-export\nexport { AccountStore };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getAwsAccounts, addAwsAccount, createAwsAccount } from '../../helpers/api';\nimport { AwsAccount } from './AwsAccount';\nimport { BudgetStore } from './BudgetStore';\nimport Budget from './Budget';\n\n// ==================================================================\n// AwsAccountsStore\n// ==================================================================\nconst AwsAccountsStore = BaseStore.named('AwsAccountsStore')\n  .props({\n    awsAccounts: types.optional(types.map(AwsAccount), {}),\n    budgetStores: types.optional(types.map(BudgetStore), {}),\n    tickPeriod: 10 * 1000, // 10 sec\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const awsAccounts = (await getAwsAccounts()) || [];\n        // We try to preserve existing accounts data and merge the new data instead\n        // We could have used self.accounts.replace(), but it will do clear() then merge()\n        self.runInAction(() => {\n          awsAccounts.forEach(awsAccount => {\n            const awsAccountsModel = AwsAccount.create(awsAccount);\n            const previous = self.awsAccounts.get(awsAccountsModel.id);\n            if (!previous) {\n              self.awsAccounts.set(awsAccountsModel.id, awsAccountsModel);\n            } else {\n              previous.setAwsAccounts(awsAccount);\n            }\n          });\n        });\n        return undefined;\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n\n      addAwsAccount: async awsAccount => {\n        const addedAwsAccount = await addAwsAccount(awsAccount);\n        self.runInAction(() => {\n          const addedAwsAccountModel = AwsAccount.create(addedAwsAccount);\n          self.awsAccounts.set(addedAwsAccountModel.id, addedAwsAccountModel);\n        });\n      },\n\n      createAwsAccount: async awsAccount => {\n        await createAwsAccount(awsAccount);\n      },\n\n      getBudgetStore: awsAccountUUID => {\n        let entry = self.budgetStores.get(awsAccountUUID);\n        if (!entry) {\n          // Lazily create the store\n          self.budgetStores.set(awsAccountUUID, BudgetStore.create({ awsAccountUUID }));\n          entry = self.budgetStores.get(awsAccountUUID);\n        }\n        return entry;\n      },\n\n      addBudget: (awsAccountUUID, rawBudget) => {\n        const account = self.awsAccounts.get(awsAccountUUID);\n        account.budget = Budget.create(rawBudget);\n      },\n    };\n  })\n\n  .views(self => ({\n    get list() {\n      const result = [];\n      // converting map self.users to result array\n      self.awsAccounts.forEach(awsAccount => {\n        const res = {};\n        res.name = awsAccount.name;\n        res.id = awsAccount.id;\n        res.accountId = awsAccount.accountId;\n        res.roleArn = awsAccount.roleArn;\n        res.description = awsAccount.description;\n        res.externalId = awsAccount.externalId;\n        res.vpcId = awsAccount.vpcId;\n        res.subnetId = awsAccount.subnetId;\n        res.encryptionKeyArn = awsAccount.encryptionKeyArn;\n        result.push(res);\n      });\n      return result;\n    },\n\n    get dropdownOptions() {\n      const result = [];\n      // converting map self.users to result array\n      self.awsAccounts.forEach(awsAccount => {\n        const account = {};\n        account.key = awsAccount.id;\n        account.value = awsAccount.id;\n        // For migration purposes fallback to id if there's no name\n        account.text = `${awsAccount.description} (${awsAccount.name || awsAccount.id})`;\n        result.push(account);\n      });\n      return result;\n    },\n\n    getNameForAccountId(id) {\n      const account = self.awsAccounts.get(id);\n\n      // For migration purposes fallback to id if there's no name\n      if (!account || !account.name) {\n        return id;\n      }\n\n      return `${account.name} (${account.accountId})`;\n    },\n\n    getAwsAccount(id) {\n      return self.awsAccounts.get(id);\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.awsAccountsStore = AwsAccountsStore.create({}, appContext);\n}\n\nexport { AwsAccountsStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\nimport Budget from './Budget';\n\n// ==================================================================\n// AwsAccounts\n// ==================================================================\nconst AwsAccount = types\n  .model('AwsAccounts', {\n    id: types.identifier,\n    rev: types.maybe(types.number),\n    name: '',\n    description: '',\n    accountId: '',\n    externalId: '',\n    roleArn: '',\n    vpcId: '',\n    subnetId: '',\n    encryptionKeyArn: '',\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n    budget: types.optional(Budget, {}),\n  })\n  .actions(self => ({\n    setAwsAccounts(rawAwsAccounts) {\n      self.id = rawAwsAccounts.id;\n      self.rev = rawAwsAccounts.rev || self.rev || 0;\n      self.name = rawAwsAccounts.name || self.name || '';\n      self.description = rawAwsAccounts.description || self.description;\n      self.accountId = rawAwsAccounts.accountId || rawAwsAccounts.accountId;\n      self.externalId = rawAwsAccounts.externalId || self.externalId;\n      self.roleArn = rawAwsAccounts.roleArn || self.roleArn;\n      self.vpcId = rawAwsAccounts.vpcId || self.vpcId;\n      self.subnetId = rawAwsAccounts.subnetId || self.subnetId;\n      self.encryptionKeyArn = rawAwsAccounts.encryptionKeyArn || self.encryptionKeyArn;\n      self.createdAt = rawAwsAccounts.createdAt || self.createdAt;\n      self.updatedAt = rawAwsAccounts.updatedAt || self.updatedAt;\n      self.createdBy = rawAwsAccounts.createdBy || self.createdBy;\n      self.updatedBy = rawAwsAccounts.updatedBy || self.updatedBy;\n      // we don't update the other fields because they are being populated by a separate store\n    },\n  }))\n\n  // eslint-disable-next-line no-unused-vars\n  .views(self => ({\n    // add view methods here\n  }));\n\n// eslint-disable-next-line import/prefer-default-export\nexport { AwsAccount };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { getParent } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport _ from 'lodash';\n\nimport { createAwsAccountBudget, getAwsAccountBudget, updateAwsAccountBudget } from '../../helpers/api';\n\n// ==================================================================\n// BudgetStore\n// ==================================================================\nconst BudgetStore = BaseStore.named('BudgetStore')\n  .props({\n    awsAccountUUID: '',\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const parent = getParent(self, 2);\n        const rawBudget = await getAwsAccountBudget(self.awsAccountUUID);\n        parent.addBudget(self.awsAccountUUID, rawBudget);\n      },\n\n      async createOrUpdateBudget(rawBudget) {\n        const parent = getParent(self, 2);\n        const existingBudget = parent.getAwsAccount(self.awsAccountUUID).budget;\n        // Validate dependency between email and thresholds\n        if (_.isEmpty(rawBudget.thresholds) && !_.isEmpty(rawBudget.notificationEmail)) {\n          throw new Error('Notification depends on thresholds. Please input thresholds or remove notification.');\n        }\n        if (!_.isEmpty(rawBudget.thresholds) && _.isEmpty(rawBudget.notificationEmail)) {\n          throw new Error('Thresholds depends on notification. Please input notification or remove thresholds');\n        }\n        // Remove empty attributes\n        rawBudget = _.omitBy(rawBudget, val => _.isEmpty(val) && !_.isNumber(val));\n        const requestData = {\n          id: self.awsAccountUUID,\n          budgetConfiguration: rawBudget,\n        };\n        if (_.isEmpty(existingBudget.budgetLimit)) {\n          await createAwsAccountBudget(requestData);\n        } else {\n          await updateAwsAccountBudget(requestData);\n        }\n      },\n\n      cleanup: () => {\n        const parent = getParent(self, 2);\n        superCleanup();\n        parent.addBudget(self.awsAccountUUID, {});\n      },\n    };\n  })\n\n  .views(self => ({\n    get budget() {\n      const parent = getParent(self, 2);\n      const account = parent.getAwsAccount(self.awsAccountUUID);\n      return account.budget;\n    },\n\n    get thresholdsOptions() {\n      return [\n        { id: '50', value: 50, text: '50%' },\n        { id: '70', value: 70, text: '70%' },\n        { id: '80', value: 80, text: '80%' },\n        { id: '90', value: 90, text: '90%' },\n        { id: '100', value: 100, text: '100%' },\n      ];\n    },\n  }));\n\n// Note: Do NOT register this in the global context, if you want to gain access to an instance\n//       use awsAccountsStore.getBudgetStore()\n// eslint-disable-next-line import/prefer-default-export\nexport { BudgetStore };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getClientIpAddress } from '../../helpers/api';\nimport { ClientInformation } from './ClientInformation';\n\n// There are situations in which it is useful for the UI to be able to\n// determine the IP address that it has, for example so that it can use that\n// IP address in a Security Group rule that later restricts access for a given\n// compute environment to the user that launched it. So, this store implements\n// a \"what is my IP address?\" feature.\nconst ClientInformationStore = BaseStore.named('ClientInformationStore')\n  .props({\n    clientInformation: types.optional(ClientInformation, {}),\n  })\n  .actions(self => {\n    return {\n      async doLoad() {\n        const info = await getClientIpAddress();\n        const ipAddress = info.ipAddress;\n        if (ipAddress === '127.0.0.1') {\n          // Only for \"local\" development that we call http://httpbin.org/get\n          // otherwise for any other development modes including for production,\n          // we call our own api to get the ip address.\n          const answer = await fetch('http://httpbin.org/get').then(res => res.json());\n          self.runInAction(() => {\n            self.clientInformation = ClientInformation.create({ ipAddress: answer && answer.origin });\n          });\n          return;\n        }\n\n        self.runInAction(() => {\n          self.clientInformation = ClientInformation.create({ ipAddress });\n        });\n      },\n    };\n  })\n  .views(self => ({\n    get ipAddress() {\n      return self.clientInformation.ipAddress;\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.clientInformationStore = ClientInformationStore.create({}, appContext);\n}\n\nexport { ClientInformationStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\n\nconst ClientInformation = types.model('ClientInformation', {\n  ipAddress: '',\n});\n\n// eslint-disable-next-line import/prefer-default-export\nexport { ClientInformation };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { getSnapshot, types } from 'mobx-state-tree';\n\nconst InstanceInfo = types\n  .model('InstanceInfo', {\n    Ec2WorkspaceDnsName: '',\n    type: '',\n    size: '',\n    JupyterUrl: '',\n    NotebookInstanceName: '',\n    s3Mounts: '',\n    iamPolicyDocument: '',\n    environmentInstanceFiles: '',\n  })\n  .views(self => ({\n    get id() {\n      return self.identifierStr;\n    },\n    get identifier() {\n      return self;\n    },\n    get identifierStr() {\n      return JSON.stringify(getSnapshot(self));\n    },\n  }));\n\n// eslint-disable-next-line import/prefer-default-export\nexport { InstanceInfo };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nconst SageMaker = require('aws-sdk/clients/sagemaker');\n\nexport default class SageMakerService {\n  constructor(accessKeyId, secretAccessKey, region = 'us-east-1') {\n    if (accessKeyId) {\n      this.sm = new SageMaker({\n        accessKeyId,\n        secretAccessKey,\n        region,\n        sslEnabled: true,\n      });\n    } else {\n      this.sm = new SageMaker({\n        sslEnabled: true,\n      });\n    }\n  }\n\n  async getPresignedNotebookInstanceUrl(notebookInstanceName) {\n    const params = {\n      NotebookInstanceName: notebookInstanceName,\n    };\n    return this.sm.createPresignedNotebookInstanceUrl(params).promise();\n  }\n}\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { applySnapshot, types } from 'mobx-state-tree';\nimport { getEnvironmentSpotPriceHistory } from '../../helpers/api';\n\nconst SpotPriceHistoryItem = types.model('SpotPriceHistoryItem', {\n  availabilityZone: '',\n  spotPrice: types.number,\n});\n\nconst EnvironmentConfiguration = types\n  .model('EnvironmentConfiguration', {\n    id: types.identifier,\n    type: '',\n    size: '',\n    label: '',\n    price: types.number,\n    description: '',\n    defaultCidr: '',\n    properties: types.frozen(),\n    spotBidMultiplier: types.optional(types.number, 0),\n    spotPriceHistory: types.optional(types.array(SpotPriceHistoryItem), []),\n    emrConfiguration: types.frozen(),\n  })\n  .actions(self => ({\n    setEnvironmentConfiguration(configuration) {\n      // Note: if you have partial data vs full data, you need to replace the applySnapshot() with\n      // the appropriate logic\n      const fetchingSpotPriceHistory = self.fetchingSpotPriceHistory;\n      applySnapshot(self, configuration);\n      self.fetchingSpotPriceHistory = fetchingSpotPriceHistory;\n    },\n\n    async getSpotPriceHistory() {\n      const spotInstance = self.isEmrCluster ? self.emrConfiguration.workerInstanceSize : self.size;\n      const prices = await getEnvironmentSpotPriceHistory(spotInstance);\n\n      self.setSpotPriceHistory(prices);\n    },\n\n    setSpotPriceHistory(prices) {\n      self.spotPriceHistory = prices;\n    },\n  }))\n  .views(self => ({\n    get isOnDemandPricing() {\n      return !self.spotBidMultiplier;\n    },\n\n    get isEmrCluster() {\n      return !!self.emrConfiguration;\n    },\n\n    get hasSpotPriceHistory() {\n      return self.spotPriceHistory.length > 0;\n    },\n\n    get averageSpotPriceHistory() {\n      if (self.hasSpotPriceHistory) {\n        return self.spotPriceHistory.reduce(\n          (result, { spotPrice }) => result + spotPrice / self.spotPriceHistory.length,\n          0,\n        );\n      }\n      self.getSpotPriceHistory();\n      return 0;\n    },\n\n    get spotBidPrice() {\n      return self.averageSpotPriceHistory * self.spotBidMultiplier;\n    },\n\n    get isLoadingPrice() {\n      return this.isOnDemandPricing ? false : self.averageSpotPriceHistory === 0;\n    },\n\n    get totalPrice() {\n      if (self.isOnDemandPricing && !self.isEmrCluster) {\n        return self.price * 24;\n      }\n      if (self.isOnDemandPricing && self.isEmrCluster) {\n        const { workerInstanceOnDemandPrice, workerInstanceCount } = self.emrConfiguration;\n        return (self.price + workerInstanceOnDemandPrice * workerInstanceCount) * 24;\n      }\n      // this is now a spot bid below the onDemand cost\n      if (self.isEmrCluster) {\n        const { workerInstanceCount } = self.emrConfiguration;\n        return (self.price + self.spotBidPrice * workerInstanceCount) * 24;\n      }\n      // last option is spot single node\n      return self.spotBidPrice * 24;\n    },\n  }));\n\n// eslint-disable-next-line import/prefer-default-export\nexport { EnvironmentConfiguration };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { getEnv, types } from 'mobx-state-tree';\nimport { displayWarning } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { consolidateToMap, storage } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { randomString } from '@aws-ee/base-services/lib/helpers/utils';\nimport { getEstimatedCost } from '../../helpers/externalCostUtil';\nimport localStorageKeys from '../constants/local-storage-keys';\nimport {\n  getEnvironments,\n  deleteEnvironment,\n  createEnvironment,\n  startEnvironment,\n  stopEnvironment,\n  getEnvironmentCost,\n  getExternalTemplate,\n  updateEnvironment,\n} from '../../helpers/api';\nimport { Environment } from './Environment';\nimport { EnvironmentStore } from './EnvironmentStore';\nimport CfnService from '../../helpers/cfn-service';\nimport ExternalKeypairService from '../../helpers/externalKeypairService';\nimport ExternalVpcService from '../../helpers/externalVpcService';\nimport getExternalAccountDetails from '../../helpers/externalAccountDetails';\n\n// ==================================================================\n// EnvironmentsStore\n// ==================================================================\nconst EnvironmentsStore = BaseStore.named('EnvironmentsStore')\n  .props({\n    environments: types.optional(types.map(Environment), {}),\n    environmentStores: types.optional(types.map(EnvironmentStore), {}),\n    tickPeriod: 30 * 1000, // 30 seconds\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const environments = await getEnvironments();\n\n        try {\n          const costPromises = environments.map(env => {\n            if (env.isExternal) {\n              return getEstimatedCost(env, 1);\n            }\n            return getEnvironmentCost(env.id, 1);\n          });\n\n          const costInfo = await Promise.all(costPromises);\n\n          for (let i = 0; i < environments.length; i++) {\n            environments[i].costs = costInfo[i];\n          }\n        } catch (error) {\n          displayWarning('Error encountered retrieving cost data', error);\n        }\n\n        self.runInAction(() => {\n          consolidateToMap(self.environments, environments, (exiting, newItem) => {\n            exiting.setEnvironment(newItem);\n          });\n        });\n      },\n\n      addEnvironment(rawEnvironment) {\n        const id = rawEnvironment.id;\n        const previous = self.environments.get(id);\n\n        if (!previous) {\n          self.environments.put(rawEnvironment);\n        } else {\n          previous.setEnvironment(rawEnvironment);\n        }\n      },\n\n      getEnvironmentStore: environmentId => {\n        let entry = self.environmentStores.get(environmentId);\n        if (!entry) {\n          // Lazily create the store\n          self.environmentStores.set(environmentId, EnvironmentStore.create({ environmentId }));\n          entry = self.environmentStores.get(environmentId);\n        }\n\n        return entry;\n      },\n\n      async stopEnvironment(environment) {\n        const uiEventBus = getEnv(self).uiEventBus;\n        await uiEventBus.fireEvent('environmentStopping', environment);\n        await stopEnvironment(environment.id);\n      },\n\n      async startEnvironment(environment) {\n        const uiEventBus = getEnv(self).uiEventBus;\n        await uiEventBus.fireEvent('environmentStarting', environment);\n        await startEnvironment(environment.id);\n      },\n\n      markAsTerminating: id => {\n        const previous = self.environments.get(id);\n        if (previous) {\n          previous.markAsTerminating();\n        }\n      },\n\n      async updateExternalEnvironment(environment, user, pin) {\n        if (!environment.isExternal || !user.isExternalUser || _.isEmpty(storage.getItem(localStorageKeys.pinToken))) {\n          return;\n        }\n        const creds = await user.unencryptedCreds(pin);\n        const cfn = new CfnService(creds.accessKeyId, creds.secretAccessKey, creds.region);\n        const request = { id: environment.id };\n        try {\n          const response = await cfn.describeStack(environment.stackId);\n          _.assign(request, this.convertCfnResponse(response, environment.instanceInfo));\n        } catch (e) {\n          _.assign(request, { status: 'FAILED', error: e.message });\n        } finally {\n          if (environment.status !== request.status) {\n            updateEnvironment(request);\n          }\n        }\n      },\n\n      convertCfnResponse(response, instanceInfo) {\n        if (!response.isDone) {\n          return { status: 'PENDING' };\n        }\n        response.outputs.forEach(output => {\n          _.assign(instanceInfo, { [output.key]: output.value });\n        });\n        instanceInfo = _.omitBy(instanceInfo, _.isEmpty);\n        return response.isFailed\n          ? { status: 'FAILED', error: response.statusReason, instanceInfo }\n          : response.status === 'DELETE_COMPLETE'\n          ? { status: 'TERMINATED', instanceInfo }\n          : { status: 'COMPLETED', instanceInfo };\n      },\n\n      async deleteEnvironment(environment, user, pin) {\n        if (environment.isExternal) {\n          await this.deleteExternalEnvironment(await user.unencryptedCreds(pin), environment);\n        }\n        const uiEventBus = getEnv(self).uiEventBus;\n        await deleteEnvironment(environment.id);\n        await uiEventBus.fireEvent('environmentDeleted', environment);\n      },\n\n      async deleteExternalEnvironment(creds, environment) {\n        const cfn = new CfnService(creds.accessKeyId, creds.secretAccessKey, creds.region);\n        await cfn.deleteStack(environment.stackId);\n\n        if (environment.instanceInfo.type !== 'sagemaker') {\n          const externalKeypairService = new ExternalKeypairService(creds);\n          await externalKeypairService.delete(environment.id);\n        }\n      },\n\n      async createEnvironment(environment) {\n        // environment = { platformId, configurationId, name, description, projectId, studyIds, params, pin }\n        // - projectId is only available if the user is not external\n        // - pin is only available if creation of the environment is done by an external researcher user role.\n        //   and should never be sent to the server\n        const user = self.user;\n        const result = user.isExternalResearcher\n          ? await this.createExternalEnvironment(\n              await user.unencryptedCreds(environment.pin),\n              user.username,\n              _.omit(environment, ['pin']), // remove the pin, we don't want to send it to the server\n            )\n          : await createEnvironment(environment);\n        self.addEnvironment(result);\n        return self.getEnvironment(result.id);\n      },\n\n      async createExternalEnvironment(creds, username, rawEnvironment) {\n        const { platformId, configurationId } = rawEnvironment;\n        const configuration = self.getComputeConfiguration(platformId, configurationId);\n        const { type, title } = configuration;\n        const size = configuration.getParam('size');\n\n        // We need to get the external account details to pass the account Id to the api to allow ami access\n        const { Account: accountId } = await getExternalAccountDetails(creds);\n        // We first call the backend because it will enrich with id and the imageId if needed\n        const environment = await createEnvironment({ ...rawEnvironment, accountId });\n        const cfn = new CfnService(creds.accessKeyId, creds.secretAccessKey, creds.region);\n        // Stack naming combines datetime & randomString to avoid collisions when two workspaces are created at the same time\n        const name = `analysis-${new Date().getTime()}-${randomString(10)}`;\n        const params = await this.getExternalParams({ environment, name, creds });\n        const url = await getExternalTemplate(`${type}.cfn.yml`);\n        const response = await cfn.createStack(\n          name,\n          params,\n          url,\n          username,\n          `Created By ${username} - ${title} - ${type} - ${size}`,\n        );\n\n        return updateEnvironment({ id: environment.id, stackId: response.StackId });\n      },\n\n      async getExternalParams({\n        environment: {\n          id,\n          instanceInfo: { type, size, config, cidr, s3Mounts, iamPolicyDocument, environmentInstanceFiles },\n          amiImage,\n        },\n        name,\n        creds,\n      }) {\n        const cfnParams = [];\n        const addParam = (key, v) => cfnParams.push({ ParameterKey: key, ParameterValue: `${v}` });\n\n        addParam('Namespace', name);\n        addParam('S3Mounts', s3Mounts);\n        addParam('IamPolicyDocument', iamPolicyDocument);\n        addParam('EnvironmentInstanceFiles', environmentInstanceFiles);\n\n        const externalVpcService = new ExternalVpcService(creds);\n        const { vpcId, subnetId } = await externalVpcService.defaultVPCInfo();\n        addParam('VPC', vpcId);\n        addParam('Subnet', subnetId);\n\n        if (type === 'sagemaker') {\n          addParam('InstanceType', size); // Yes, size here is actually the instance type we want to send to cfn\n        }\n\n        if (type === 'emr') {\n          addParam('DiskSizeGB', config.diskSizeGb.toString());\n          addParam('MasterInstanceType', size);\n          addParam('WorkerInstanceType', config.workerInstanceSize);\n          addParam('CoreNodeCount', config.workerInstanceCount.toString());\n\n          // Add parameters to support spot instance pricing if specified\n          // TODO this needs to be parameterized\n          const isOnDemand = !config.spotBidPrice;\n          // The spot bid price can only have 3 decimal places maximum\n          const spotBidPrice = isOnDemand ? '0' : config.spotBidPrice.toFixed(3);\n\n          addParam('Market', isOnDemand ? 'ON_DEMAND' : 'SPOT');\n          addParam('WorkerBidPrice', spotBidPrice);\n\n          // These paramaters apply for types apart from sagemaker, but keep the logic simple for now\n          const externalKeypairService = new ExternalKeypairService(creds);\n          const keyName = await externalKeypairService.create(id);\n\n          addParam('AmiId', amiImage);\n          addParam('AccessFromCIDRBlock', cidr);\n          addParam('KeyName', keyName);\n        }\n\n        return cfnParams;\n      },\n\n      async updateEnvironment(environment) {\n        await updateEnvironment(environment);\n      },\n\n      cleanup: () => {\n        storage.removeItem(localStorageKeys.pinToken);\n        self.environments.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.environments.size === 0;\n    },\n\n    get total() {\n      return self.environments.size;\n    },\n\n    get list() {\n      const result = [];\n      self.environments.forEach(environment => result.push(environment));\n\n      return _.reverse(_.sortBy(result, ['createdAt', 'name']));\n    },\n\n    getEnvironment(id) {\n      return self.environments.get(id);\n    },\n\n    get user() {\n      return getEnv(self).userStore.user;\n    },\n\n    getComputeConfiguration(platformId, configurationId) {\n      const store = getEnv(self).computePlatformsStore;\n      const platform = store.getComputePlatform(platformId);\n      if (!platform) return undefined;\n      return platform.getConfiguration(configurationId);\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.environmentsStore = EnvironmentsStore.create({}, appContext);\n}\n\nexport { EnvironmentsStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nconst _ = require('lodash');\nconst { nanoid: nanoIdSync } = require('nanoid');\nconst { nanoid } = require('nanoid/async');\nconst crypto = require('crypto');\n\nfunction toVersionString(num) {\n  return `v${_.padStart(num, 4, '0')}_`;\n}\n\nfunction parseVersionString(str) {\n  return parseInt(str.substring(1), 10);\n}\n\n// Convenient function to wrap the db call with a catch for the ConditionalCheckFailedException\nasync function runAndCatch(fn, handler, code = 'ConditionalCheckFailedException') {\n  try {\n    const result = await fn();\n    return result;\n  } catch (error) {\n    if (error && error.code === code) {\n      return handler(error);\n    }\n\n    throw error;\n  }\n}\n\n/**\n * A utility function for creating a SHA256 hash for the given string\n *\n * @param {String} strData\n */\nfunction createHash(strData) {\n  const hash = crypto.createHash('sha256');\n  hash.update(`${strData}`);\n  return hash.digest('hex');\n}\n\n/**\n * A utility interval function for exponential back-off strategy. (i.e., intervals of 1, 2, 4, 8, 16 .. seconds)\n *\n * @param {Number} attemptCount\n * @param {Number} baseInterval\n * @return {Number}\n */\nfunction exponentialInterval(attemptCount, baseInterval = 500) {\n  return baseInterval * 2 ** attemptCount;\n}\n\n/**\n * A utility interval function for liner back-off strategy. (i.e., intervals of 1, 2, 3, 4, 5 .. seconds)\n *\n * @param {Number} attemptCount\n * @param {Number} baseInterval\n * @return {Number}\n */\nfunction linearInterval(attemptCount, baseInterval = 1000) {\n  return baseInterval * attemptCount;\n}\n\n/**\n * Retries calling a function as many times as requested by the 'times' argument. The retries are done with\n * back-offs specified by the 'intervalFn'. By default, it uses {@link exponentialInterval} function to pause\n * between each retry with exponential back-off (i.e., intervals of 1, 2, 4, 8, 16 .. seconds)\n *\n * @param {Function} fn - the fn to retry if it is rejected ( \"fn\" must return a promise )\n *\n * @param {Number} maxAttempts - maximum number of attempts calling the function. This includes first attempt and all\n * retries.\n * @param {Function} intervalFn - The interval function to decide the pause between the attempts. The function is\n * invoked with one argument 'attempt' number. The 'attempt' here is the count of calls attempted so far. For\n * example, if the 'fn' fails during the first attempt then the 'intervalFn' is called with attempt = 1. The\n * intervalFn is expected to return the pause time in milliseconds to wait before making the next 'fn' call attempt.\n *\n * @returns {Promise<*>} The promise returned by the 'fn'. The returned promise will be rejected with the error thrown\n * by 'fn' if the 'fn' still fails after the specified number of attempts.\n */\nasync function retry(fn, maxAttempts = 3, intervalFn = exponentialInterval) {\n  let caughtError;\n  for (let i = 0; i < maxAttempts; i += 1) {\n    try {\n      // We need to await before making next attempt so disabling no-await-in-loop lint rule here\n      // eslint-disable-next-line no-await-in-loop\n      const result = await fn();\n      return result;\n    } catch (err) {\n      caughtError = err;\n      // eslint-disable-next-line no-await-in-loop\n      await sleep(intervalFn(i + 1));\n    }\n  }\n  // We reached here means we exhausted all attempts calling the \"fn\"\n  // Propagate error that was caught in the last unsuccessful attempt\n  throw caughtError;\n}\n\n/**\n * A utility function to process given items in sequence of batches. Items in one batch are processed in-parallel but\n * all batches are processed sequentially i..e, processing of the next batch is not started until the previous batch is\n * complete.\n *\n * @param items Array of items to process\n * @param batchSize Number of items in a batch\n * @param processorFn A function to process the batch. The function is called with the item argument.\n * The function is expected to return a Promise with some result of processing the item. If the \"processorFn\" throws an\n * error for any item, the \"processInBatches\" function will fail immediately. Processing of other items in that batch\n * may be already in-flight at that point. Due to this, if you need to handle partial batch failures or if you need\n * fine grained error handling control at individual item level, you should handle errors in the \"processorFn\" itself\n * (using try/catch or Promise.catch etc) and make sure that the \"processorFn\" does not throw any errors.\n *\n * @returns {Promise<Array>}\n */\nasync function processInBatches(items, batchSize, processorFn) {\n  const itemBatches = _.chunk(items, batchSize);\n\n  let results = [];\n\n  // Process all items in one batch in parallel and wait for the batch to\n  // complete before moving on to the next batch\n  for (let i = 0; i <= itemBatches.length; i += 1) {\n    const itemsInThisBatch = itemBatches[i];\n    // We need to await for each batch in loop to make sure they are awaited in sequence instead of\n    // firing them in parallel disabling eslint for \"no-await-in-loop\" due to this\n    // eslint-disable-next-line no-await-in-loop\n    const resultsFromThisBatch = await Promise.all(\n      //  Fire promise for each item in this batch and let it be processed in parallel\n      _.map(itemsInThisBatch, processorFn),\n    );\n\n    // push all results from this batch into the main results array\n    results = _.concat(results, resultsFromThisBatch);\n  }\n  return results;\n}\n\n/**\n * A utility function that processes items sequentially. The function uses the specified processorFn to process\n * items in the given order i.e., it does not process next item in the given array until the promise returned for\n * the processing of the previous item is resolved. If the processorFn throws error (or returns a promise rejection)\n * this functions stops processing next item and the error is bubbled up to the caller (via a promise rejection).\n *\n * @param items Array of items to process\n * @param processorFn A function to process the item. The function is called with the item argument.\n * The function is expected to return a Promise with some result of processing the item.\n *\n * @returns {Promise<Array>}\n */\nasync function processSequentially(items, processorFn) {\n  return processInBatches(items, 1, processorFn);\n}\n\n/**\n * A utility function that returns a cumulative list by paginating through and calling the provided \"listingFn\"\n * recursively with appropriate page token\n *\n * @param listingFn An async function that returns list of items for a given page.\n * The function is expected to have signature \"pageToken => Promise({ list, nextPageToken })\"\n * @param pageToken\n * @returns {Promise<*|*[]>}\n */\nasync function paginatedList(listingFn, pageToken) {\n  const { list, nextPageToken } = await listingFn(pageToken);\n  let result = list || [];\n  // If there is next page then paginate through the page\n  if (nextPageToken) {\n    result = [...result, ...(await paginatedList(listingFn, nextPageToken))];\n  }\n  return result;\n}\n\n/**\n * A utility function that finds an element that the predicate returns truthy for by paginating through and calling the\n * provided \"listingFn\" recursively with appropriate page token.\n *\n * @param listingFn An async function that returns list of items for a given page.\n * The function is expected to have signature \"pageToken => Promise({ list, nextPageToken })\"\n * @param predicate\n * @param pageToken\n * @returns {Promise<*>}\n */\nasync function paginatedFind(listingFn, predicate, pageToken) {\n  const { list, nextPageToken } = await listingFn(pageToken);\n  let found = _.find(list, predicate);\n  // If no matching item found and if there are more pages then search through the next page\n  if (_.isUndefined(found) && nextPageToken) {\n    found = await paginatedFind(listingFn, predicate, nextPageToken);\n  }\n  return found;\n}\n\n/**\n * Returns a promise that will be resolved in the requested time, ms.\n * Example: await sleep(200);\n * https://stackoverflow.com/questions/951021/what-is-the-javascript-version-of-sleep/39914235#39914235\n *\n * @param ms wait time in milliseconds\n *\n * @returns a promise, that will be resolved in the requested time\n */\nfunction sleep(ms) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n\n/**\n * Returns a random integer from the uniform range [baseNumber * (1 - fuzzing), baseNumber * (1 + fuzzing)].\n * @param {Number} baseNumber - Base number.\n * @param {Number} fuzzing - Percentage of fuzzing that determines the width of the range. Default value is 0.3.\n */\nfunction fuzz(baseNumber, fuzzing = 0.3) {\n  return Math.round(baseNumber + baseNumber * fuzzing * (1 - 2 * Math.random()));\n}\n\n/**\n * Generates a random alphanumeric string of a given length.\n * @param {Number} strLength\n */\nfunction randomString(strLength = 10) {\n  return [...Array(strLength)].map(() => Math.round(Math.random() * 36).toString(36)).join('');\n}\n\nasync function generateId(prefix = '') {\n  const id = await nanoid();\n  return `${prefix}${id}`;\n}\n\nfunction generateIdSync(prefix = '') {\n  const id = nanoIdSync();\n  return `${prefix}${id}`;\n}\n\nmodule.exports = {\n  toVersionString,\n  parseVersionString,\n  runAndCatch,\n  exponentialInterval,\n  linearInterval,\n  retry,\n  processInBatches,\n  processSequentially,\n  sleep,\n  fuzz,\n  randomString,\n  paginatedList,\n  paginatedFind,\n  generateId,\n  generateIdSync,\n  createHash,\n};\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { getParent } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { displayWarning } from '@aws-ee/base-ui/dist/helpers/notification';\n\nimport { getEnvironment, getEnvironmentCost } from '../../helpers/api';\nimport { getEstimatedCost } from '../../helpers/externalCostUtil';\n\n// ==================================================================\n// EnvironmentStore\n// ==================================================================\nconst EnvironmentStore = BaseStore.named('EnvironmentStore')\n  .props({\n    environmentId: '',\n    tickPeriod: 300 * 1000, // 5 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const parent = getParent(self, 2);\n        const rawEnvironment = await getEnvironment(self.environmentId);\n        const envCreatedAt = new Date(rawEnvironment.createdAt);\n        const now = new Date();\n        const diffTime = Math.abs(now - envCreatedAt);\n        const numberOfDaysBetweenDateCreatedAndToday = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n\n        try {\n          const numberDaysInPast = Math.min(30, numberOfDaysBetweenDateCreatedAndToday);\n          const environmentCost = rawEnvironment.isExternal\n            ? await getEstimatedCost(rawEnvironment, numberDaysInPast)\n            : await getEnvironmentCost(self.environmentId, numberDaysInPast);\n          rawEnvironment.costs = environmentCost;\n        } catch (error) {\n          displayWarning('Error encountered retrieving cost data', error);\n        }\n\n        parent.addEnvironment(rawEnvironment);\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get environment() {\n      const parent = getParent(self, 2);\n      const w = parent.getEnvironment(self.environmentId);\n      return w;\n    },\n  }));\n\n// Note: Do NOT register this in the global context, if you want to gain access to an instance\n//       use environmentsStore.getEnvironmentStore()\n// eslint-disable-next-line import/prefer-default-export\nexport { EnvironmentStore };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nconst envMgmtRoleName = process.env.REACT_APP_ENV_MGMT_ROLE_NAME;\n\n// eslint-disable-next-line import/prefer-default-export\nexport { envMgmtRoleName };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\nimport { toErr, Err } from './Err';\n\n// A four-state model that has the following states:\n//  +---------+                   +-----------+\n//  | initial |            +----> |   ready   |\n//  +---------+            |      +-----------+\n//                         |\n//      + ^                |         + ^\n//      | |                |         | | success\n// load | | error          |    load | | or error\n//      v +                |         v +\n//                         |\n//  +---------+            |      +-----------+\n//  | loading +------------+      | reloading |\n//  +---------+   success         +-----------+\n//\n// state: <initial|loading|ready|reloading>\n// error: <error object> if there is an error otherwise <undefined>\n// empty: <true> if state is ready or reloading and the content is considered empty\nconst BaseStore = types\n  .model('BaseStore', {\n    state: 'initial',\n    error: types.maybe(Err),\n    tickPeriod: 7 * 1000, // 7 seconds\n    heartbeatInterval: 0,\n  })\n  .actions(() => ({\n    // I had issues using runInAction from mobx\n    // the issue is discussed here https://github.com/mobxjs/mobx-state-tree/issues/915\n    runInAction(fn) {\n      return fn();\n    },\n  }))\n  .actions(self => {\n    let loadingPromise;\n\n    return {\n      load: (...args) => {\n        if (loadingPromise) return loadingPromise;\n\n        // self.error = undefined; we don't want to clear the error here\n        if (self.state === 'ready') self.state = 'reloading';\n        else self.state = 'loading';\n\n        loadingPromise = new Promise((resolve, reject) => {\n          // if ((self.state === 'loading') || (self.state === 'reloading')) return;\n          try {\n            self\n              .doLoad(...args)\n              .then(() => {\n                self.runInAction(() => {\n                  self.state = 'ready';\n                  self.error = undefined;\n                });\n                loadingPromise = undefined;\n                resolve();\n              })\n              .catch(err => {\n                self.runInAction(() => {\n                  self.state = self.state === 'loading' ? 'initial' : 'ready';\n                  self.error = toErr(err);\n                });\n                loadingPromise = undefined;\n                reject(err);\n              });\n          } catch (err) {\n            self.runInAction(() => {\n              self.state = self.state === 'loading' ? 'initial' : 'ready';\n              self.error = toErr(err);\n            });\n            loadingPromise = undefined;\n            reject(err);\n          }\n        });\n\n        return loadingPromise;\n      },\n\n      startHeartbeat: () => {\n        if (self.heartbeatInterval !== 0) return; // there is one running\n        if (!self.shouldHeartbeat()) return;\n        const id = setInterval(async () => {\n          if (!self.shouldHeartbeat()) return;\n          try {\n            await self.load();\n          } catch (err) {\n            /* ignore */\n          }\n        }, self.tickPeriod);\n        self.heartbeatInterval = id;\n      },\n      shouldHeartbeat: () => {\n        return true; // extender can override this method\n      },\n      stopHeartbeat: () => {\n        const id = self.heartbeatInterval;\n        if (id !== 0) {\n          clearInterval(id);\n          self.heartbeatInterval = undefined;\n        }\n      },\n      changeTickPeriod(period) {\n        const beating = self.heartBeating;\n        self.tickPeriod = period;\n        if (beating) {\n          self.stopHeartbeat();\n          self.startHeartbeat();\n        }\n      },\n      cleanup: () => {\n        self.stopHeartbeat();\n        self.state = 'initial';\n        self.error = undefined;\n      },\n    };\n  })\n\n  .views(self => ({\n    get heartBeating() {\n      return self.heartbeatInterval > 0;\n    },\n    get initial() {\n      return self.state === 'initial';\n    },\n    get ready() {\n      return self.state === 'ready';\n    },\n    get loading() {\n      return self.state === 'loading';\n    },\n    get reloading() {\n      return self.state === 'reloading';\n    },\n    get errorMessage() {\n      return self.error ? self.error.message || 'unknown error' : '';\n    },\n  }));\n\nconst isStoreReady = obj => obj.ready || obj.reloading;\nconst isStoreEmpty = obj => (obj.ready || obj.reloading) && obj.empty;\nconst isStoreNotEmpty = obj => (obj.ready || obj.reloading) && !obj.empty;\nconst isStoreLoading = obj => obj.loading;\nconst isStoreReloading = obj => obj.reloading;\nconst isStoreNew = obj => obj.initial;\nconst isStoreError = obj => !!obj.error;\n\nexport {\n  BaseStore,\n  isStoreReady,\n  isStoreEmpty,\n  isStoreNotEmpty,\n  isStoreLoading,\n  isStoreReloading,\n  isStoreNew,\n  isStoreError,\n};\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nconst EC2 = require('aws-sdk/clients/ec2');\nconst SSM = require('aws-sdk/clients/ssm');\n\nconst paramStoreRoot = 'raas';\n\nexport default class EnvironmentKeypairService {\n  constructor({ accessKeyId, secretAccessKey, region = 'us-east-1' }) {\n    if (accessKeyId) {\n      this.ec2 = new EC2({\n        accessKeyId,\n        secretAccessKey,\n        region,\n        sslEnabled: true,\n      });\n      this.ssm = new SSM({\n        accessKeyId,\n        secretAccessKey,\n        region,\n        sslEnabled: true,\n      });\n    } else {\n      this.ec2 = new EC2({\n        sslEnabled: true,\n      });\n      this.ssm = new SSM({\n        sslEnabled: true,\n      });\n    }\n  }\n\n  async create(id) {\n    const keyPair = await this.ec2.createKeyPair({ KeyName: id }).promise();\n\n    const parameterName = `/${paramStoreRoot}/environments/${id}`;\n    await this.ssm\n      .putParameter({\n        Name: parameterName,\n        Type: 'SecureString',\n        Value: keyPair.KeyMaterial,\n        Description: `ssh key for environment ${id}`,\n        Overwrite: true,\n      })\n      .promise();\n\n    return keyPair.KeyName;\n  }\n\n  async mustFind(id) {\n    const parameterName = `/${paramStoreRoot}/environments/${id}`;\n    const privateKey = await this.ssm\n      .getParameter({\n        Name: parameterName,\n        WithDecryption: true,\n      })\n      .promise();\n\n    return { privateKey: privateKey.Parameter.Value };\n  }\n\n  async delete(id) {\n    const parameterName = `/${paramStoreRoot}/environments/${id}`;\n\n    await this.ec2.deleteKeyPair({ KeyName: id }).promise();\n\n    await this.ssm\n      .deleteParameter({\n        Name: parameterName,\n      })\n      .promise();\n\n    return true;\n  }\n}\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nconst EC2 = require('aws-sdk/clients/ec2');\n\nexport default class SageMakerService {\n  constructor({ accessKeyId, secretAccessKey, region = 'us-east-1' }) {\n    if (accessKeyId) {\n      this.ec2 = new EC2({\n        accessKeyId,\n        secretAccessKey,\n        region,\n        sslEnabled: true,\n      });\n    } else {\n      this.ec2 = new EC2({\n        sslEnabled: true,\n      });\n    }\n  }\n\n  async defaultVPCInfo() {\n    const { Vpcs: vpcs } = await this.ec2\n      .describeVpcs({\n        Filters: [\n          {\n            Name: 'isDefault',\n            Values: ['true'],\n          },\n        ],\n      })\n      .promise();\n    const { VpcId: vpcId } = vpcs.find(({ IsDefault }) => IsDefault);\n\n    const { Subnets: subnets } = await this.ec2\n      .describeSubnets({\n        Filters: [\n          {\n            Name: 'vpc-id',\n            Values: [vpcId],\n          },\n        ],\n      })\n      .promise();\n\n    // Default subnets should be public, but just make sure\n    const publicSubnets = subnets.filter(({ MapPublicIpOnLaunch }) => MapPublicIpOnLaunch);\n    const { SubnetId: subnetId } = publicSubnets.reduce((result, subnet) =>\n      subnet.AvailableIpAddressCount > result.AvailableIpAddressCount ? subnet : result,\n    );\n    return { vpcId, subnetId };\n  }\n}\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Header } from 'semantic-ui-react';\nimport c from 'classnames';\n\n// expected props\n// - field (via props), this is the mobx form field object\n// - className (via props)\nconst Component = observer(({ field, className = 'mt0 mb1' }) => {\n  const { id, label } = field;\n\n  return (\n    <Header className={c('field', className)} as=\"h3\">\n      <label className=\"color-grey\" htmlFor={id}>\n        {label}\n      </label>\n    </Header>\n  );\n});\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nconst STS = require('aws-sdk/clients/sts');\n\nexport default function getAccountDetails({ accessKeyId, secretAccessKey, region = 'us-east-1' }) {\n  const sts = accessKeyId\n    ? new STS({\n        accessKeyId,\n        secretAccessKey,\n        region,\n        sslEnabled: true,\n      })\n    : new STS({ sslEnabled: true });\n\n  return sts.getCallerIdentity().promise();\n}\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\nimport FileUploadGroup from './FileUploadGroup';\n\nconst FileUploadsStore = types\n  .model('FileUploadsStore', {\n    fileUploadGroups: types.map(FileUploadGroup),\n  })\n  .actions(self => ({\n    getFileUploadGroup(resourceId) {\n      let group = self.fileUploadGroups.get(resourceId);\n      if (!group) {\n        group = FileUploadGroup.create({ resourceId, state: 'PENDING' });\n        self.fileUploadGroups.put(group);\n      }\n      return group;\n    },\n    resetFileUploadGroup(resourceId) {\n      const group = FileUploadGroup.create({ resourceId, state: 'PENDING' });\n      self.fileUploadGroups.put(group);\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.fileUploadsStore = FileUploadsStore.create({}, appContext);\n}\n\nexport { FileUploadsStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\nimport uuidv4 from 'uuid/v4';\n\nconst FileUpload = types\n  .model('FileUpload', {\n    id: types.identifier,\n    status: types.union(\n      types.literal('PENDING'),\n      types.literal('UPLOADING'),\n      types.literal('COMPLETE'),\n      types.literal('FAILED'),\n    ),\n    uploaded: types.maybeNull(types.number),\n    error: types.maybeNull(types.string),\n  })\n  .volatile(() => ({\n    file: undefined,\n    cancel: undefined,\n  }))\n  .views(self => ({\n    get size() {\n      return self.file ? self.file.size : 0;\n    },\n    get name() {\n      return self.file ? self.file.name : '';\n    },\n    getFile() {\n      return self.file;\n    },\n  }))\n  .actions(self => ({\n    updateProgress(uploadedBytes) {\n      self.uploaded = uploadedBytes;\n    },\n    updateStatusToUploading() {\n      self.status = 'UPLOADING';\n    },\n    updateStatusToComplete() {\n      self.status = 'COMPLETE';\n    },\n    updateStatusToFailed(error) {\n      self.status = 'FAILED';\n      self.error = error;\n    },\n    setFile(file) {\n      self.file = file;\n    },\n    setCancel(cancel) {\n      self.cancel = cancel;\n    },\n    doCancel() {\n      if (self.cancel) {\n        self.cancel();\n        self.cancel = undefined;\n      }\n    },\n  }));\n\nconst FileUploadGroup = types\n  .model('FileUploadGroup', {\n    resourceId: types.identifier,\n    fileUploads: types.map(FileUpload),\n    state: types.union(types.literal('PENDING'), types.literal('UPLOADING'), types.literal('COMPLETE')),\n  })\n  .views(self => ({\n    get fileUploadObjects() {\n      return Array.from(self.fileUploads.values());\n    },\n    getFileUpload(fileUploadId) {\n      return self.fileUploads.get(fileUploadId);\n    },\n  }))\n  .actions(self => ({\n    async start(fileUploadHandler) {\n      if (self.state !== 'PENDING') {\n        throw new Error(`Cannot transition state from ${self.state} -> UPLOADING`);\n      }\n      self.setStateToUploading();\n      const fileUploads = Array.from(self.fileUploads.values()).filter(fileUpload => fileUpload.status === 'PENDING');\n      await Promise.all(\n        fileUploads.map(async fileUpload => {\n          fileUpload.updateStatusToUploading();\n          try {\n            await fileUploadHandler(fileUpload);\n          } catch (error) {\n            fileUpload.updateStatusToFailed(error.message);\n          }\n        }),\n      );\n      self.setStateToComplete();\n    },\n    cancel() {\n      self.fileUploads.forEach(fileUpload => {\n        fileUpload.doCancel();\n      });\n    },\n    remove(id) {\n      self.fileUploads.delete(id);\n    },\n    add({ file }) {\n      const model = FileUpload.create({\n        id: uuidv4(),\n        status: 'PENDING',\n      });\n      model.setFile(file);\n      self.fileUploads.put(model);\n    },\n    setStateToComplete() {\n      self.state = 'COMPLETE';\n    },\n    setStateToUploading() {\n      self.state = 'UPLOADING';\n    },\n  }));\n\nexport default FileUploadGroup;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { consolidateToMap } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { getIndexes, addIndex } from '../../helpers/api';\nimport { Index } from './Index';\n\n// ==================================================================\n// IndexesStore\n// ==================================================================\nconst IndexesStore = BaseStore.named('IndexesStore')\n  .props({\n    indexes: types.optional(types.map(Index), {}),\n    tickPeriod: 900 * 1000, // 15 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const indexes = (await getIndexes()) || [];\n        self.runInAction(() => {\n          consolidateToMap(self.indexes, indexes, (exiting, newItem) => {\n            exiting.setIndex(newItem);\n          });\n        });\n      },\n\n      addIndex: async index => {\n        const addedIndex = await addIndex(index);\n        self.runInAction(() => {\n          // Added newly created user to users map\n          const addedIndexModel = Index.create(addedIndex);\n          self.indexes.set(addedIndexModel.id, addedIndexModel);\n        });\n      },\n\n      getIndexesStore: indexesId => {\n        let entry = self.indexesStores.get(indexesId);\n        if (!entry) {\n          // Lazily create the store\n          self.indexesStores.set(indexesId, IndexesStore.create({ indexesId }));\n          entry = self.indexesStores.get(indexesId);\n        }\n\n        return entry;\n      },\n\n      getIndex: indexesId => {\n        let res = {};\n        self.indexes.forEach(index => {\n          if (index.id === indexesId) res = _.clone(index);\n        });\n        return res;\n      },\n\n      cleanup: () => {\n        self.indexes.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get dropdownOptions() {\n      const result = [];\n      // converting map self.users to result array\n      self.indexes.forEach(index => {\n        const proj = {};\n        proj.key = index.id;\n        proj.value = index.id;\n        proj.text = index.id;\n        result.push(proj);\n      });\n      return result;\n    },\n\n    get empty() {\n      return self.indexes.size === 0;\n    },\n\n    get total() {\n      return self.indexes.size;\n    },\n\n    get list() {\n      const result = [];\n      self.indexes.forEach(indexes => result.push(indexes));\n\n      return _.reverse(_.sortBy(result, ['createdAt', 'name']));\n    },\n\n    hasIndexes(id) {\n      return self.indexes.has(id);\n    },\n\n    getIndexes(id) {\n      return self.indexes.get(id);\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.indexesStore = IndexesStore.create({}, appContext);\n}\n\nexport { IndexesStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types, applySnapshot } from 'mobx-state-tree';\n\n// ==================================================================\n// Index\n// ==================================================================\nconst Index = types\n  .model('Index', {\n    id: types.identifier,\n    rev: types.maybe(types.number),\n    awsAccountId: '',\n    description: '',\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n  })\n  .actions(self => ({\n    setIndex(rawIndex) {\n      // Note: if you have partial data vs full data, you need to replace the applySnapshot() with\n      // the appropriate logic\n      applySnapshot(self, rawIndex);\n    },\n  }))\n\n  // eslint-disable-next-line no-unused-vars\n  .views(self => ({\n    // add view methods here\n  }));\n\n// eslint-disable-next-line import/prefer-default-export\nexport { Index };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { consolidateToMap } from '@aws-ee/base-ui/dist/helpers/utils';\n\nimport { getProjects, addProject, updateProject, deleteProject } from '../../helpers/api';\nimport { Project } from './Project';\nimport { ProjectStore } from './ProjectStore';\n\n// ==================================================================\n// ProjectsStore\n// ==================================================================\nconst ProjectsStore = BaseStore.named('ProjectsStore')\n  .props({\n    projects: types.optional(types.map(Project), {}),\n    projectStores: types.optional(types.map(ProjectStore), {}),\n    tickPeriod: 900 * 1000, // 15 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const projects = await getProjects();\n        // We try to preserve existing projects data and merge the new data instead\n        // We could have used self.projects.replace(), but it will do clear() then merge()\n        self.runInAction(() => {\n          consolidateToMap(self.projects, projects, (exiting, newItem) => {\n            exiting.setProject(newItem);\n          });\n        });\n      },\n\n      async addProject(rawProject) {\n        const id = rawProject.id;\n        const previous = self.projects.get(id);\n\n        if (!previous) {\n          self.projects.put(rawProject);\n          await addProject(rawProject);\n        } else {\n          previous.setProject(rawProject);\n        }\n      },\n\n      getProjectStore: projectId => {\n        let entry = self.projectStores.get(projectId);\n        if (!entry) {\n          // Lazily create the store\n          self.projectStores.set(projectId, ProjectStore.create({ projectId }));\n          entry = self.projectStores.get(projectId);\n        }\n\n        return entry;\n      },\n\n      deleteProject: async project => {\n        await deleteProject(project);\n      },\n\n      updateProject: async project => {\n        const updatedProject = await updateProject(project);\n        self.addProject(updatedProject);\n      },\n\n      cleanup: () => {\n        self.projects.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.projects.size === 0;\n    },\n\n    get total() {\n      return self.projects.size;\n    },\n\n    get list() {\n      const result = [];\n      self.projects.forEach(project => result.push(project));\n\n      return _.reverse(_.sortBy(result, ['createdAt', 'id']));\n    },\n\n    get dropdownOptions() {\n      const result = [];\n      // converting map self.users to result array\n      self.projects.forEach(project => {\n        const res = {};\n        res.key = project.id;\n        res.value = project.id;\n        res.text = project.id;\n        result.push(res);\n      });\n\n      return result;\n    },\n\n    hasProject(id) {\n      return self.projects.has(id);\n    },\n\n    getProject(id) {\n      return self.projects.get(id);\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.projectsStore = ProjectsStore.create({}, appContext);\n}\n\nexport { ProjectsStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, applySnapshot, getEnv } from 'mobx-state-tree';\n\n// ==================================================================\n// Project\n// ==================================================================\nconst Project = types\n  .model('Project', {\n    id: types.identifier,\n    rev: types.maybe(types.number),\n    description: '',\n    indexId: '',\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n    projectAdmins: types.optional(types.array(types.string), []),\n  })\n  .actions(self => ({\n    setProject(rawProject) {\n      // Note: if you have partial data vs full data, you need to replace the applySnapshot() with\n      // the appropriate logic\n      applySnapshot(self, rawProject);\n    },\n  }))\n\n  // eslint-disable-next-line no-unused-vars\n  .views(self => ({\n    // add view methods here\n    get projectAdminUsers() {\n      const usersStore = getEnv(self).usersStore;\n      return _.map(self.projectAdmins, uid => usersStore.asUserObject({ uid }));\n    },\n  }));\n\n// eslint-disable-next-line import/prefer-default-export\nexport { Project };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { getParent } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getProject } from '../../helpers/api';\n\n// ==================================================================\n// ProjectStore\n// ==================================================================\nconst ProjectStore = BaseStore.named('ProjectStore')\n  .props({\n    projectId: '',\n    tickPeriod: 300 * 1000, // 5 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const parent = getParent(self, 2);\n        const rawProject = await getProject(self.projectId);\n        rawProject.map(item => parent.addProject(item));\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get project() {\n      const parent = getParent(self, 2);\n      const w = parent.getProject(self.projectId);\n      return w;\n    },\n  }));\n\n// Note: Do NOT register this in the global context, if you want to gain access to an instance\n//       use projectsStore.getProjectStore()\n// eslint-disable-next-line import/prefer-default-export\nexport { ProjectStore };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable react/no-danger */\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport c from 'classnames';\nimport { Message } from 'semantic-ui-react';\n\n// expected props\n// - field (via props), this is the mobx form field object\nconst Component = observer(({ field }) => {\n  const { extra = {} } = field;\n  const explain = (extra || {}).explain;\n  const warn = (extra || {}).warn;\n  const hasExplain = !!explain;\n  const hasWarn = !!warn;\n\n  return (\n    <>\n      {hasExplain && <div className={c('field', 'mb2')} dangerouslySetInnerHTML={{ __html: explain }} />}\n      {hasWarn && (\n        <Message className=\"field\" color=\"brown\">\n          <b className=\"mr1\">Warning</b>\n          {warn}\n        </Message>\n      )}\n    </>\n  );\n});\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, applySnapshot } from 'mobx-state-tree';\n\n// TODO: Improve file model\n// const File2 = types.model('File2', {\n//   name: '',\n//   size: types.optional(types.number, 0),\n// });\n\n// TODO this should have been named 'Run'\nconst File = types.model('File', {\n  id: types.identifier,\n  name: '',\n  description: types.maybeNull(types.string),\n  accessStatus: '',\n});\n\n// TODO this should have been named 'RunsSelection'\nconst FilesSelection = types\n  .model('FilesSelection', {\n    files: types.optional(types.map(File), {}),\n  })\n  .actions(self => ({\n    setFile(file) {\n      self.files.set(file.id, file);\n    },\n    deleteFile(id) {\n      self.files.delete(id);\n    },\n    cleanup() {\n      self.files.clear();\n    },\n    setFiles(filesMapSnapshot) {\n      applySnapshot(self.files, filesMapSnapshot);\n    },\n  }))\n  .views(self => ({\n    hasFile(id) {\n      return self.files.has(id);\n    },\n    get empty() {\n      return self.files.size === 0;\n    },\n    get count() {\n      return self.files.size;\n    },\n    get studiesCount() {\n      const studyIdMap = {};\n      self.files.forEach(entry => {\n        studyIdMap[entry.studyId] = true;\n      });\n\n      return _.size(studyIdMap);\n    },\n    studiesCountByStatus: state => {\n      const studyIdMap = {};\n      self.files.forEach(entry => {\n        if (entry.accessStatus === state) studyIdMap[entry.studyId] = true;\n      });\n\n      return _.size(studyIdMap);\n    },\n    studiesCountByNotStatus: state => {\n      const studyIdMap = {};\n      self.files.forEach(entry => {\n        if (entry.accessStatus !== state) studyIdMap[entry.studyId] = true;\n      });\n\n      return _.size(studyIdMap);\n    },\n    get fileNames() {\n      const names = [];\n      self.files.forEach(entry => {\n        names.push(entry.id);\n      });\n\n      return names;\n    },\n    groupByStudy: () => {\n      const studyIdMap = {};\n      self.files.forEach(entry => {\n        const values = studyIdMap[entry.studyId];\n        if (_.isArray(values)) {\n          values.push(entry);\n        } else {\n          studyIdMap[entry.studyId] = [entry];\n        }\n      });\n\n      return studyIdMap;\n    },\n    groupNotApprovedByStudy: () => {\n      const studyIdMap = {};\n      self.files.forEach(entry => {\n        if (entry.accessStatus === 'approved') return;\n        const values = studyIdMap[entry.studyId];\n        if (_.isArray(values)) {\n          values.push(entry);\n        } else {\n          studyIdMap[entry.studyId] = [entry];\n        }\n      });\n\n      return studyIdMap;\n    },\n    countByStatus: state => {\n      let counter = 0;\n      self.files.forEach(file => {\n        if (file.accessStatus === state) counter += 1;\n      });\n\n      return counter;\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.filesSelection = FilesSelection.create({}, appContext);\n}\n\nexport { FilesSelection, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable import/prefer-default-export */\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { consolidateToMap } from '@aws-ee/base-ui/dist/helpers/utils';\n\nimport { getStudies, createStudy } from '../../helpers/api';\nimport { categories } from './categories';\nimport { Study } from './Study';\nimport { StudyStore } from './StudyStore';\n\n// ==================================================================\n// StudiesStore\n// ==================================================================\nconst StudiesStore = BaseStore.named('StudiesStore')\n  .props({\n    category: '',\n    studies: types.optional(types.map(Study), {}),\n    studyStores: types.optional(types.map(StudyStore), {}),\n    tickPeriod: 300 * 1000, // 5 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const studies = await getStudies(self.category);\n        // We try to preserve existing studies data and merge the new data instead\n        // We could have used self.studies.replace(), but it will do clear() then merge()\n        self.runInAction(() => {\n          consolidateToMap(self.studies, studies, (exiting, newItem) => {\n            exiting.setStudy(newItem);\n          });\n        });\n      },\n\n      addStudy(rawStudy) {\n        const id = rawStudy.id;\n        const previous = self.studies.get(id);\n\n        if (!previous) {\n          self.studies.put(rawStudy);\n        } else {\n          previous.setStudy(rawStudy);\n        }\n      },\n\n      getStudyStore: studyId => {\n        let entry = self.studyStores.get(studyId);\n        if (!entry) {\n          // Lazily create the store\n          self.studyStores.set(studyId, StudyStore.create({ studyId }));\n          entry = self.studyStores.get(studyId);\n        }\n\n        return entry;\n      },\n\n      async createStudy(study) {\n        const result = await createStudy({ ...study, uploadLocationEnabled: true });\n        self.runInAction(() => {\n          self.addStudy(result);\n        });\n        const resultStudy = self.getStudy(result.id);\n\n        return resultStudy;\n      },\n\n      cleanup: () => {\n        self.studies.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.studies.size === 0;\n    },\n\n    get total() {\n      return self.studies.size;\n    },\n\n    get list() {\n      const result = [];\n      self.studies.forEach(study => result.push(study));\n\n      return _.reverse(_.sortBy(result, ['createdAt', 'name']));\n    },\n\n    hasStudy(id) {\n      return self.studies.has(id);\n    },\n\n    getStudy(id) {\n      return self.studies.get(id);\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.studiesStoresMap = {\n    // TODO - we should be using ids when calling the backend but the backend needs fixing too since it does not support ids yet\n    [categories.myStudies.id]: StudiesStore.create({ category: categories.myStudies.name }),\n    [categories.organization.id]: StudiesStore.create({ category: categories.organization.name }),\n    [categories.openData.id]: StudiesStore.create({ category: categories.openData.name }),\n  };\n}\n\nexport { registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types, applySnapshot } from 'mobx-state-tree';\n\nimport { StudyFilesStore } from './StudyFilesStore';\nimport { StudyPermissionsStore } from './StudyPermissionsStore';\nimport { categories } from './categories';\n\n// ==================================================================\n// Study\n// ==================================================================\nconst Study = types\n  .model('Study', {\n    id: types.identifier,\n    rev: types.maybe(types.number),\n    name: '',\n    category: '',\n    projectId: '',\n    access: types.optional(types.array(types.string), []),\n    resources: types.optional(types.array(types.model({ arn: types.string })), []),\n    description: types.maybeNull(types.string),\n    uploadLocationEnabled: false,\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n    filesStore: types.maybe(StudyFilesStore),\n    permissionsStore: types.maybe(StudyPermissionsStore),\n  })\n  .actions(self => ({\n    setStudy(rawStudy) {\n      // Note: if you have partial data vs full data, you need to replace the applySnapshot() with\n      // the appropriate logic\n      applySnapshot(self, rawStudy);\n    },\n\n    getFilesStore() {\n      if (!self.filesStore) {\n        self.filesStore = StudyFilesStore.create({ studyId: self.id });\n      }\n      return self.filesStore;\n    },\n\n    getPermissionsStore() {\n      if (!self.permissionsStore) {\n        self.permissionsStore = StudyPermissionsStore.create({ studyId: self.id });\n      }\n      return self.permissionsStore;\n    },\n  }))\n\n  // eslint-disable-next-line no-unused-vars\n  .views(self => ({\n    // add view methods here\n    get isOpenDataStudy() {\n      return self.category === categories.openData.name; // TODO the backend should really send an id and not a name\n    },\n\n    get isOrganizationStudy() {\n      return self.category === categories.organization.name; // TODO the backend should really send an id and not a name\n    },\n\n    get canUpload() {\n      return self.access.includes('admin') || self.access.includes('readwrite');\n    },\n  }));\n\nexport { Study }; // eslint-disable-line import/prefer-default-export\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { listStudyFiles } from '../../helpers/api';\n\n// ==================================================================\n// StudyFile\n// ==================================================================\nconst StudyFile = types.model('StudyFile', {\n  filename: types.string,\n  size: types.integer,\n  lastModified: types.Date,\n});\n\n// ==================================================================\n// StudyFiles\n// ==================================================================\nconst StudyFilesStore = BaseStore.named('StudyFilesStore')\n  .props({\n    studyId: '',\n    files: types.array(StudyFile),\n    tickPeriod: 5 * 1000, // 5 seconds\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        // Retrieve files\n        let files = await listStudyFiles(self.studyId);\n\n        // Determine which files were added or removed\n        const comparator = (fileA, fileB) => fileA.filename === fileB.filename;\n        const removed = _.differenceWith(self.files, files, comparator);\n        const added = _.differenceWith(files, self.files, comparator);\n\n        // Only update store when needed to avoid unnecessary re-rendering\n        if (removed.length !== 0 || added.length !== 0) {\n          // Sort files by name and cast lastModified as Date()\n          files = files\n            .sort((fileA, fileB) => fileA.filename.localeCompare(fileB.filename))\n            .map(file => ({\n              ...file,\n              lastModified: new Date(file.lastModified),\n            }));\n\n          // Update store\n          self.runInAction(() => {\n            self.files.replace(files);\n          });\n        }\n      },\n\n      cleanup: () => {\n        self.files.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.files.length === 0;\n    },\n  }));\n\n// Note: Do NOT register this in the global context, if you want to gain access to an instance\n//       use study.getFilesStore()\nexport { StudyFilesStore }; // eslint-disable-line import/prefer-default-export\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable import/prefer-default-export */\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getStudyPermissions, updateStudyPermissions } from '../../helpers/api';\nimport { StudyPermissions } from './StudyPermissions';\n\n// ==================================================================\n// StudyStore\n// ==================================================================\nconst StudyPermissionsStore = BaseStore.named('StudyPermissionsStore')\n  .props({\n    studyId: types.identifier,\n    studyPermissions: types.maybe(StudyPermissions),\n    tickPeriod: 300 * 1000, // 5 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      doLoad: async () => {\n        const newPermissions = await getStudyPermissions(self.studyId);\n        if (!self.studyPermissions || !_.isEqual(self.studyPermissions, newPermissions)) {\n          self.runInAction(() => {\n            self.studyPermissions = newPermissions;\n          });\n        }\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n\n      update: async selectedUserIds => {\n        const updateRequest = { usersToAdd: [], usersToRemove: [] };\n\n        self.studyPermissions.userTypes.forEach(type => {\n          const userToRequestFormat = uid => ({ uid, permissionLevel: type });\n\n          // Set selected users as \"usersToAdd\" (API is idempotent)\n          updateRequest.usersToAdd.push(..._.map(selectedUserIds[type], userToRequestFormat));\n\n          // Set removed users as \"usersToRemove\"\n          updateRequest.usersToRemove.push(\n            ..._.differenceWith(self.studyPermissions[`${type}Users`], selectedUserIds[type], _.isEqual).map(\n              userToRequestFormat,\n            ),\n          );\n        });\n\n        // Perform update and reload store\n        await updateStudyPermissions(self.studyId, updateRequest);\n        await self.load();\n      },\n    };\n  });\n\nexport { StudyPermissionsStore };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable import/prefer-default-export */\nimport { types } from 'mobx-state-tree';\n\n// ==================================================================\n// Study Permissions\n// ==================================================================\nconst StudyPermissions = types\n  .model('StudyPermissions', {\n    id: types.identifier,\n    adminUsers: types.optional(types.array(types.string), []),\n    readonlyUsers: types.optional(types.array(types.string), []),\n    readwriteUsers: types.optional(types.array(types.string), []),\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n  })\n  .views(_self => ({\n    get userTypes() {\n      return ['admin', 'readwrite', 'readonly'];\n    },\n  }));\n\nexport { StudyPermissions };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { getParent } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getStudy } from '../../helpers/api';\n\n// ==================================================================\n// StudyStore\n// ==================================================================\nconst StudyStore = BaseStore.named('StudyStore')\n  .props({\n    studyId: '',\n    tickPeriod: 300 * 1000, // 5 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const parent = getParent(self, 2);\n        const rawStudy = await getStudy(self.studyId);\n        parent.addStudy(rawStudy);\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get study() {\n      const parent = getParent(self, 2);\n      const w = parent.getStudy(self.studyId);\n      return w;\n    },\n  }));\n\n// Note: Do NOT register this in the global context, if you want to gain access to an instance\n//       use studiesStore.getStudyStore()\n// eslint-disable-next-line import/prefer-default-export\nexport { StudyStore };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { consolidateToMap } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { getUserRoles } from '../../helpers/api';\nimport { UserRole } from './UserRole';\n\n// ==================================================================\n// UserRolesStore\n// ==================================================================\nconst UserRolesStore = BaseStore.named('UserRolesStore')\n  .props({\n    userRoles: types.optional(types.map(UserRole), {}),\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const userRoles = (await getUserRoles()) || [];\n        self.runInAction(() => {\n          consolidateToMap(self.userRoles, userRoles, (exiting, newItem) => {\n            exiting.setUserRole(newItem);\n          });\n        });\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get list() {\n      const result = [];\n      // converting map self.users to result array\n      self.userRoles.forEach(userRole => result.push(userRole));\n      return result;\n    },\n    get dropdownOptions() {\n      const result = [];\n      // converting map self.users to result array\n      self.userRoles.forEach(userRole => {\n        const role = {};\n        role.key = userRole.id;\n        role.value = userRole.id;\n        role.text = userRole.id;\n        result.push(role);\n      });\n      return result;\n    },\n\n    isInternalUser(userRoleId) {\n      return _.toLower(self.getUserType(userRoleId)) === 'internal';\n    },\n\n    isInternalGuest(userRoleId) {\n      return _.toLower(userRoleId) === 'internal-guest';\n    },\n\n    getUserType(userRoleId) {\n      const found = self.userRoles.get(userRoleId);\n      return found ? found.userType : '';\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.userRolesStore = UserRolesStore.create({}, appContext);\n}\n\nexport { UserRolesStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types, applySnapshot } from 'mobx-state-tree';\n\n// ==================================================================\n// UserRole\n// ==================================================================\nconst UserRole = types\n  .model('UserRole', {\n    id: types.identifier,\n    rev: types.maybe(types.number),\n    description: '',\n    userType: '',\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n  })\n  .actions(self => ({\n    setUserRole(rawUserRole) {\n      // Note: if you have partial data vs full data, you need to replace the applySnapshot() with\n      // the appropriate logic\n      applySnapshot(self, rawUserRole);\n    },\n  }))\n\n  // eslint-disable-next-line no-unused-vars\n  .views(self => ({\n    // add view methods here\n  }));\n\n// eslint-disable-next-line import/prefer-default-export\nexport { UserRole };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { values } from 'mobx';\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { consolidateToMap } from '@aws-ee/base-ui/dist/helpers/utils';\n\nimport { getComputePlatforms } from '../../helpers/api';\nimport { ComputePlatform } from './ComputePlatform';\nimport { ComputePlatformStore } from './ComputePlatformStore';\n\n// ==================================================================\n// ComputePlatformsStore\n// ==================================================================\nconst ComputePlatformsStore = BaseStore.named('ComputePlatformsStore')\n  .props({\n    platforms: types.map(ComputePlatform),\n    platformsStores: types.map(ComputePlatformStore),\n  })\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const computePlatforms = await getComputePlatforms();\n        self.runInAction(() => {\n          consolidateToMap(self.platforms, computePlatforms, (exiting, newItem) => {\n            exiting.setComputePlatform(newItem);\n          });\n        });\n      },\n\n      getComputePlatformStore(platformId) {\n        let entry = self.platformsStores.get(platformId);\n        if (!entry) {\n          // Lazily create the store\n          self.platformsStores.set(platformId, ComputePlatformStore.create({ platformId }));\n          entry = self.platformsStores.get(platformId);\n        }\n\n        return entry;\n      },\n\n      cleanup() {\n        self.platforms.clear();\n        self.platformsStores.clear();\n        superCleanup();\n      },\n    };\n  })\n  .views(self => ({\n    get empty() {\n      return self.platforms.size === 0;\n    },\n\n    get total() {\n      return self.platforms.size;\n    },\n\n    get list() {\n      return _.sortBy(values(self.platforms), 'displayOrder');\n    },\n\n    getComputePlatform(id) {\n      return self.platforms.get(id);\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.computePlatformsStore = ComputePlatformsStore.create({}, appContext);\n}\n\nexport { ComputePlatformsStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport c from 'classnames';\n\n// expected props\n// - field (via props), this is the mobx form field object\nconst Component = observer(({ field, className }) => {\n  const { error = '' } = field;\n  const hasError = !_.isEmpty(error); // IMPORTANT do NOT use field.hasError\n\n  if (!hasError) return null;\n  return <div className={c('ui pointing basic label', className)}>{error}</div>;\n});\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable import/prefer-default-export */\nimport _ from 'lodash';\nimport { values } from 'mobx';\nimport { types, getEnv, applySnapshot } from 'mobx-state-tree';\nimport { consolidateToMap } from '@aws-ee/base-ui/dist/helpers/utils';\n\nimport { ComputeConfiguration } from './ComputeConfiguration';\n\n// This represents a compute platform information such as an emr or an ec2\nconst ComputePlatform = types\n  .model('ComputePlatform', {\n    id: types.identifier,\n    type: '',\n    title: '',\n    desc: '',\n    displayOrder: types.maybe(types.number),\n    configurations: types.map(ComputeConfiguration),\n  })\n  .actions(self => ({\n    setComputePlatform(rawComputePlatform) {\n      // Note: if you have partial data vs full data, you need to replace the applySnapshot() with\n      // the appropriate logic\n\n      // Preserve configurations\n      const configurations = self.configurations || {};\n      applySnapshot(self, rawComputePlatform);\n      self.configurations = configurations;\n    },\n\n    setConfigurations(raw) {\n      consolidateToMap(self.configurations, raw, (exiting, newItem) => {\n        exiting.setComputeConfiguration(newItem);\n      });\n    },\n  }))\n  .views(self => ({\n    get descHtml() {\n      const showdown = getEnv(self).showdown;\n      return showdown.convert(self.desc);\n    },\n\n    get configurationsList() {\n      return _.sortBy(values(self.configurations), 'displayOrder');\n    },\n\n    getConfiguration(configurationId) {\n      return self.configurations.get(configurationId);\n    },\n  }));\n\nexport { ComputePlatform };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable import/prefer-default-export */\nimport _ from 'lodash';\nimport { types, getEnv, applySnapshot } from 'mobx-state-tree';\n\n// This represents a specific configuration of a compute platform, such as a specific size of an ec2 setup\nconst ComputeConfiguration = types\n  .model('ComputeConfiguration', {\n    id: types.identifier,\n    type: '',\n    title: '',\n    displayOrder: types.maybe(types.number),\n    priceInfo: types.frozen(),\n    desc: '',\n    displayProps: types.frozen(), // an array of objects, each object has a key and a value that are purely used for displaying purposes\n    params: types.frozen(),\n  })\n  .actions(self => ({\n    setComputeConfiguration(raw) {\n      // Note: if you have partial data vs full data, you need to replace the applySnapshot() with\n      // the appropriate logic\n      applySnapshot(self, raw);\n    },\n  }))\n  .views(self => ({\n    get descHtml() {\n      const showdown = getEnv(self).showdown;\n      return showdown.convert(self.desc);\n    },\n\n    // Returns true if the configuration supports changing the value of a given param\n    isMutable(param) {\n      return _.has(self.params, ['mutable', param]);\n    },\n\n    // Returns all mutable parameters that this configuration allow\n    get mutableParams() {\n      return _.get(self.params, 'mutable', {});\n    },\n\n    // If undefined is returned, it means that changing the cidr value is not supported\n    get defaultCidr() {\n      if (!self.isMutable('cidr')) return undefined;\n      return _.get(self.mutableParams, 'cidr', '');\n    },\n\n    get pricePerDay() {\n      const info = self.priceInfo || {};\n      if (info.timeUnit === 'hour') return info.value * 24;\n      if (info.timeUnit === 'day') return info.value;\n\n      return undefined;\n    },\n\n    // Use this method to get a value of a parameter, regardless whether it is immutable or not\n    // We first see if the parameter exists in the immutable params if so, it is returned,\n    // otherwise the one in the mutable params is returned if any\n    getParam(name) {\n      const value = _.get(self.params, ['immutable', name]);\n      if (!_.isUndefined(value)) return value;\n      return _.get(self.mutableParams, name);\n    },\n  }));\n\nexport { ComputeConfiguration };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable import/prefer-default-export */\nimport { getParent } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getComputeConfigurations } from '../../helpers/api';\n\n// ==================================================================\n// ComputePlatformStore\n// ==================================================================\nconst ComputePlatformStore = BaseStore.named('ComputePlatformStore')\n  .props({\n    platformId: '',\n    tickPeriod: 300 * 1000, // 5 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const configurations = await getComputeConfigurations(self.platformId);\n        const platform = self.computePlatform;\n        if (!platform) return;\n        platform.setConfigurations(configurations);\n      },\n\n      cleanup: () => {\n        self.platformId = '';\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get computePlatform() {\n      const parent = getParent(self, 2);\n      const platform = parent.getComputePlatform(self.platformId);\n      return platform;\n    },\n  }));\n\n// Note: Do NOT register this in the app context, if you want to gain access to an instance\n//       use computePlatformsStore.getComputePlatformStore()\nexport { ComputePlatformStore };\n","/* eslint-disable import/prefer-default-export */\nimport _ from 'lodash';\nimport { types, applySnapshot } from 'mobx-state-tree';\n\n// 'COMPLETED', 'PENDING', 'TAINTED', 'FAILED', 'TERMINATING', 'TERMINATED', 'TERMINATING_FAILED', 'UNKNOWN'\n// Note: 'UNKNOWN' is not something that is returned from the server, it is here to catch any other status\n// that we don't know about.\nconst states = [\n  {\n    key: 'COMPLETED',\n    display: 'AVAILABLE',\n    color: 'green',\n    tip: 'The workspace is ready to be used.',\n    spinner: false,\n    canTerminate: true,\n    canConnect: true,\n    canStop: true,\n    canStart: false,\n  },\n  {\n    key: 'PENDING',\n    display: 'PENDING',\n    color: 'orange',\n    tip: 'The workspace is being prepared, this could take sometime.',\n    spinner: true,\n    canTerminate: false,\n    canConnect: false,\n    canStop: false,\n    canStart: false,\n  },\n  {\n    key: 'STOPPED',\n    display: 'STOPPED',\n    color: 'orange',\n    tip: 'The workspace is stopped.',\n    spinner: false,\n    canTerminate: true,\n    canConnect: false,\n    canStop: false,\n    canStart: true,\n  },\n  {\n    key: 'STOPPING',\n    display: 'STOPPING',\n    color: 'orange',\n    tip: 'The workspace is stopping.',\n    spinner: true,\n    canTerminate: true,\n    canConnect: false,\n    canStop: false,\n    canStart: false,\n  },\n  {\n    key: 'STARTING',\n    display: 'STARTING',\n    color: 'orange',\n    tip: 'The workspace is starting.',\n    spinner: true,\n    canTerminate: true,\n    canConnect: false,\n    canStop: false,\n    canStart: false,\n  },\n  {\n    key: 'TAINTED',\n    display: 'TAINTED',\n    color: 'orange',\n    tip: 'The workspace is ready but the latest configuration updates might not have been successful.',\n    spinner: false,\n    canTerminate: true,\n    canConnect: true,\n    canStop: false,\n    canStart: false,\n  },\n  {\n    key: 'FAILED',\n    display: 'FAILED',\n    color: 'red',\n    tip: 'Something went wrong.',\n    spinner: false,\n    canTerminate: true,\n    canConnect: false,\n    canStop: false,\n    canStart: false,\n  },\n  {\n    key: 'TERMINATING',\n    display: 'TERMINATING',\n    color: 'red',\n    tip: 'The workspace is being terminated. This could take sometime.',\n    spinner: true,\n    canTerminate: false,\n    canConnect: false,\n    canStop: false,\n    canStart: false,\n  },\n  {\n    key: 'TERMINATED',\n    display: 'TERMINATED',\n    color: 'grey',\n    tip: 'The workspace is terminated successfully and no longer available.',\n    spinner: false,\n    canTerminate: false,\n    canConnect: false,\n    canStop: false,\n    canStart: false,\n  },\n  {\n    key: 'TERMINATING_FAILED',\n    display: 'TERMINATION FAILED',\n    color: 'red',\n    tip:\n      'The workspace was not terminated correctly, it is possible that some compute and storage resources are still in place.',\n    spinner: false,\n    canTerminate: true,\n    canConnect: true,\n    canStop: false,\n    canStart: false,\n  },\n  {\n    key: 'UNKNOWN',\n    display: 'UNKNOWN',\n    color: 'grey',\n    tip: 'Something not right. This requires further investigation by the administrator.',\n    spinner: false,\n    canTerminate: true,\n    canConnect: true,\n    canStop: false,\n    canStart: false,\n  },\n];\n\n// ==================================================================\n// ScEnvironment\n// ==================================================================\nconst ScEnvironment = types\n  .model('ScEnvironment', {\n    id: types.identifier,\n    rev: types.maybe(types.number),\n    status: '',\n    description: '',\n    name: '',\n    projectId: '',\n    envTypeId: '',\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n    error: types.maybeNull(types.string),\n    connections: types.frozen([]),\n    hasConnections: false,\n    studyIds: types.frozen([]),\n    cidr: '',\n    outputs: types.frozen([]),\n  })\n  .actions(self => ({\n    setScEnvironment(rawEnvironment) {\n      // Note: if you have partial data vs full data, you need to replace the applySnapshot() with\n      // the appropriate logic\n      const raw = { ...rawEnvironment, connections: self.connections || [] };\n      applySnapshot(self, raw);\n    },\n    setStatus(status) {\n      self.status = status;\n    },\n    setConnections(connections) {\n      self.connections = connections;\n    },\n  }))\n\n  // eslint-disable-next-line no-unused-vars\n  .views(self => ({\n    // State is a generalization of the status name. With the state object, we can provide more\n    // information about the state and what can be done/displayed\n    get state() {\n      // We need to clone the entry so that we don't impact the existing states object\n      const entry = _.cloneDeep(_.find(states, ['key', self.status]) || _.find(states, ['key', 'UNKNOWN']));\n\n      // The canConnect value is also determined by looking at the existing state requirement and\n      // if we have any connections\n      entry.canConnect = entry.canConnect && self.hasConnections;\n\n      return entry;\n    },\n\n    getConnections(filterFn = () => true) {\n      return _.filter(self.connections, filterFn);\n    },\n  }));\n\nexport { ScEnvironment };\n","import { getParent } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getScEnvironment } from '../../helpers/api';\n\n// ==================================================================\n// ScEnvironmentStore\n// ==================================================================\nconst ScEnvironmentStore = BaseStore.named('ScEnvironmentStore')\n  .props({\n    envId: '',\n    tickPeriod: 30 * 1000, // 30 seconds\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const parent = getParent(self, 2);\n        const rawEnv = await getScEnvironment(self.envId);\n        parent.addScEnvironment(rawEnv);\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get scEnvironment() {\n      const parent = getParent(self, 2);\n      const w = parent.getScEnvironment(self.envId);\n      return w;\n    },\n  }));\n\n// Note: Do NOT register this in the global context, if you want to gain access to an instance\n//       use scEnvironmentsStore.getScEnvironmentStore()\n// eslint-disable-next-line import/prefer-default-export\nexport { ScEnvironmentStore };\n","import _ from 'lodash';\nimport { getParent } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport {\n  getScEnvironmentConnections,\n  sendSshKey,\n  getWindowsRpInfo,\n  createScEnvironmentConnectionUrl,\n} from '../../helpers/api';\n\n// ==================================================================\n// ScEnvConnectionStore\n// ==================================================================\nconst ScEnvConnectionStore = BaseStore.named('ScEnvConnectionStore')\n  .props({\n    envId: '',\n    tickPeriod: 30 * 1000, // 30 seconds\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const env = self.scEnvironment;\n        const raw = await getScEnvironmentConnections(self.envId);\n        env.setConnections(raw);\n      },\n\n      async createConnectionUrl(connectionId) {\n        const urlObj = await createScEnvironmentConnectionUrl(self.envId, connectionId);\n        return _.get(urlObj, 'url');\n      },\n\n      async sendSshKey(connectionId, keyPairId) {\n        return sendSshKey(self.envId, connectionId, keyPairId);\n      },\n\n      async getWindowsRdpInfo(connectionId) {\n        return getWindowsRpInfo(self.envId, connectionId);\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get scEnvironment() {\n      const parent = getParent(self, 2);\n      const w = parent.getScEnvironment(self.envId);\n      return w;\n    },\n    get empty() {\n      return _.isEmpty(self.scEnvironment.connections);\n    },\n  }));\n\n// Note: Do NOT register this in the global context, if you want to gain access to an instance\n//       use scEnvironmentsStore.getScEnvConnectionStore()\n// eslint-disable-next-line import/prefer-default-export\nexport { ScEnvConnectionStore };\n","import _ from 'lodash';\nimport { getEnv, types } from 'mobx-state-tree';\nimport { consolidateToMap } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { BaseStore, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getScEnvironmentCost } from '../../helpers/api';\nimport { ScEnvironmentCost } from './ScEnvironmentCost';\nimport { ScEnvironmentCostStore } from './ScEnvironmentCostStore';\n\n// WARNING WARNING WARNING WARNING WARNING\n// ---------------------------------------\n// This store is here as a temporary solution, in this store we call the cost api\n// for each sc environment. This obviously is not scalable and should not be even an acceptable\n// approach, but we need to have it here for now to maintain an existing behaviour.\n// The cost api design needs to be addressed ASAP.\n// ---------------------------------------\n// WARNING WARNING WARNING WARNING WARNING\n\n// ==================================================================\n// ScEnvironmentCostsStore\n// ==================================================================\nconst ScEnvironmentCostsStore = BaseStore.named('ScEnvironmentCostsStore')\n  .props({\n    costs: types.optional(types.map(ScEnvironmentCost), {}),\n    costStores: types.optional(types.map(ScEnvironmentCostStore), {}),\n    tickPeriod: 60 * 1000, // 60 seconds\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        // we need to check if the environment lists is loaded\n        const scEnvironmentsStore = self.scEnvironmentsStore;\n        if (!isStoreReady(scEnvironmentsStore)) {\n          await scEnvironmentsStore.load();\n        }\n\n        const environments = scEnvironmentsStore.list;\n\n        // 'getCost' is an async function that will attempt to load the\n        // cost for the given environment, if an error occurs we\n        // don't fail the whole outer doLoad() function.  We just\n        // keep the error message in the 'error' props of the raw entity object\n        const getCost = async environment => {\n          const envId = environment.id;\n          const rawEntity = { entries: [], id: `${envId}-cost`, error: '' };\n          try {\n            const entries = await getScEnvironmentCost(envId, 30);\n            rawEntity.entries = entries;\n          } catch (error) {\n            const message = _.get(error, 'message') || _.get(error, 'friendly', 'Something went wrong');\n            rawEntity.error = message;\n          }\n\n          return rawEntity;\n        };\n\n        const costs = await Promise.all(_.map(environments, env => getCost(env)));\n        self.runInAction(() => {\n          consolidateToMap(self.costs, costs, (exiting, newItem) => {\n            exiting.setScEnvironmentCost(newItem);\n          });\n        });\n      },\n\n      addScEnvironmentCost(rawCost) {\n        const id = rawCost.id;\n        const previous = self.costs.get(id);\n\n        if (!previous) {\n          self.costs.put(rawCost);\n        } else {\n          previous.setScEnvironmentCost(rawCost);\n        }\n      },\n\n      getScEnvironmentCostStore(envId) {\n        let entry = self.costStores.get(envId);\n        if (!entry) {\n          // Lazily create the store\n          self.costStores.set(envId, ScEnvironmentCostStore.create({ envId }));\n          entry = self.costStores.get(envId);\n        }\n\n        return entry;\n      },\n\n      cleanup: () => {\n        self.costStores.clear();\n        self.costs.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.costs.size === 0;\n    },\n\n    getScEnvironmentCost(id) {\n      return self.costs.get(`${id}-cost`);\n    },\n\n    get scEnvironmentsStore() {\n      return getEnv(self).scEnvironmentsStore;\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.scEnvironmentCostsStore = ScEnvironmentCostsStore.create({}, appContext);\n}\n\nexport { ScEnvironmentCostsStore, registerContextItems };\n","/* eslint-disable import/prefer-default-export */\nimport _ from 'lodash';\nimport { types, applySnapshot } from 'mobx-state-tree';\n\n// ==================================================================\n// ScEnvironmentCost\n// ==================================================================\nconst ScEnvironmentCost = types\n  .model('ScEnvironmentCost', {\n    id: types.identifier, // this will be at the client side which is the same as the env id + 'cost' as suffix\n    entries: types.frozen([]),\n    error: '',\n  })\n  .actions(self => ({\n    setScEnvironmentCost(rawData) {\n      applySnapshot(self, rawData);\n    },\n  }))\n\n  // eslint-disable-next-line no-unused-vars\n  .views(self => ({\n    get previousDayCost() {\n      // We are making this assumption:\n      // - the last element in the entries is assumed to be the previousDay entry\n      const entry = _.last(self.entries);\n      if (_.isEmpty(entry)) {\n        return 0;\n      }\n\n      // entry has this shape {\n      //  startDate: '20xx-xx-xx':\n      //  cost: {\n      //    <service name1>: { amount, unit },\n      //    <service name2>: { amount, unit },\n      //    ...\n      //  }\n      // }\n      return self.getAmount(entry);\n    },\n\n    getAmount(entry) {\n      return _.sum(_.map(entry.cost, value => _.get(value, 'amount', 0)));\n    },\n\n    // Returns an array of objects, with two props.\n    // Example: [ { date: '2020-07-20', amount: 100.0, unit: 'USD' }, ... ]\n    get list() {\n      const result = _.map(self.entries, entry => ({\n        date: entry.startDate,\n        amount: self.getAmount(entry),\n        unit: entry.unit,\n      }));\n\n      return result;\n    },\n  }));\n\nexport { ScEnvironmentCost };\n","import _ from 'lodash';\nimport { getParent } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getScEnvironmentCost } from '../../helpers/api';\n\n// ==================================================================\n// ScEnvironmentCostStore\n// ==================================================================\nconst ScEnvironmentCostStore = BaseStore.named('ScEnvironmentCostStore')\n  .props({\n    envId: '',\n    tickPeriod: 12 * 60 * 60 * 1000, // 12 hours\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const id = self.envId;\n        const parent = getParent(self, 2);\n        const rawEntity = { entries: [], id: `${id}-cost`, error: '' };\n        // We are breaking the norm here by doing a try/catch. This is because we also want\n        // to update the entity.error value based on if we received an error. In general,\n        // entity models don't have 'error' property that reflects the loading status, this is\n        // because the 'error' property belongs to the store.\n        try {\n          const entries = await getScEnvironmentCost(id, 30);\n          rawEntity.entries = entries;\n          parent.addScEnvironmentCost(rawEntity);\n        } catch (error) {\n          const message = _.get(error, 'message') || _.get(error, 'friendly', 'Something went wrong');\n          rawEntity.error = message;\n          parent.addScEnvironmentCost(rawEntity);\n          // We want to throw an error here so that the store can be in the correct state\n          throw error;\n        }\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get scEnvironmentCost() {\n      const parent = getParent(self, 2);\n      const cost = parent.getScEnvironmentCost(self.envId);\n      return cost;\n    },\n  }));\n\n// Note: Do NOT register this in the global context, if you want to gain access to an instance\n//       use scEnvironmentCostsStore.getScEnvironmentCostStore()\n// eslint-disable-next-line import/prefer-default-export\nexport { ScEnvironmentCostStore };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { decorate, observable, action, runInAction } from 'mobx';\nimport { Button, Header, Container, Message } from 'semantic-ui-react';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\n\nimport { getAddUserApplicationForm } from '../models/forms/AddUserApplicationForm';\n\nclass UserApplication extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n\n    runInAction(() => {\n      this.logoutProcessing = false;\n      this.currentUser = props.userStore.cloneUser;\n    });\n    this.form = getAddUserApplicationForm();\n    this.form.$('email').value = this.currentUser.username;\n  }\n\n  handleLogout = action(async event => {\n    this.logoutProcessing = true;\n    event.preventDefault();\n    event.stopPropagation();\n\n    try {\n      await this.props.authentication.logout();\n      runInAction(() => {\n        this.logoutProcessing = false;\n      });\n    } catch (error) {\n      displayError(error);\n      runInAction(() => {\n        this.logoutProcessing = false;\n      });\n    }\n  });\n\n  render() {\n    let content = null;\n    if (this.currentUser.status === 'pending') {\n      content = this.renderFormSubmittedMessage();\n    } else {\n      content = this.renderAddUserPage();\n    }\n    return content;\n  }\n\n  renderAddUserPage() {\n    return (\n      <Container className=\"pt4\">\n        <div className=\"mt2 animated fadeIn\">\n          <Header as=\"h2\" icon textAlign=\"center\" className=\"mt3\" color=\"grey\">\n            Research Portal Application\n          </Header>\n          <div className=\"mt3 ml3 mr3 animated fadeIn\">{this.renderAddUserForm()}</div>\n        </div>\n      </Container>\n    );\n  }\n\n  renderFormSubmittedMessage() {\n    const processing = this.logoutProcessing;\n    return (\n      <Container text className=\"pt4\">\n        <Message icon>\n          <Message.Content>\n            <Message.Header>We have received your application</Message.Header>\n            You will not have access to the portal until an administrator reviews and approves your application.\n            <div className=\"mt2\">\n              We recommend you logout and login when you have received access.\n              <Button\n                floated=\"right\"\n                color=\"blue\"\n                icon\n                disabled={processing}\n                className=\"ml2\"\n                onClick={this.handleLogout}\n              >\n                Logout\n              </Button>\n            </div>\n          </Message.Content>\n        </Message>\n      </Container>\n    );\n  }\n\n  renderAddUserForm() {\n    const form = this.form;\n\n    return (\n      <Form form={form} onSuccess={this.handleSubmit}>\n        {({ processing }) => (\n          <>\n            <Input field={form.$('email')} disabled className=\"mt3 mb4\" />\n            <Input field={form.$('firstName')} className=\"mt3 mb4\" />\n            <Input field={form.$('lastName')} />\n            <TextArea field={form.$('applyReason')} />\n\n            <Button className=\"ml2 mb3\" floated=\"right\" color=\"blue\" icon disabled={processing} type=\"submit\">\n              Submit Application\n            </Button>\n          </>\n        )}\n      </Form>\n    );\n  }\n\n  handleSubmit = async form => {\n    try {\n      const user = form.values();\n\n      this.currentUser.firstName = user.firstName;\n      this.currentUser.lastName = user.lastName;\n      this.currentUser.applyReason = user.applyReason;\n      this.currentUser.status = 'pending';\n      const updatedUser = await this.getStore().updateUserApplication(this.currentUser);\n      runInAction(() => {\n        this.currentUser.status = updatedUser.status;\n      });\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  getStore() {\n    return this.props.usersStore;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(UserApplication, {\n  logoutProcessing: observable,\n  currentUser: observable,\n});\n\nexport default inject(\n  'userStore',\n  'usersStore',\n  'userRolesStore',\n  'awsAccountsStore',\n  'indexesStore',\n  'authentication',\n)(withRouter(observer(UserApplication)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '../../helpers/form';\n\nconst addUserApplicationFormFields = {\n  email: {\n    label: 'Username',\n    placeholder: 'Type email address as username for the user',\n  },\n  firstName: {\n    label: 'First Name',\n    placeholder: 'Your first name',\n    explain: 'Your current default first name is ',\n    rules: 'required|string',\n  },\n  lastName: {\n    label: 'Last Name',\n    placeholder: 'Your last name',\n    explain: 'Your current default last name is ',\n    rules: 'required|string',\n  },\n  applyReason: {\n    label: 'Describe Your Research',\n    explain: 'Please tell us why you are requesting access to the Research Portal',\n    placeholder: 'Why are you requesting access?',\n    rules: 'required|string',\n  },\n};\n\nfunction getAddUserApplicationFormFields() {\n  return addUserApplicationFormFields;\n}\n\nfunction getAddUserApplicationForm() {\n  return createForm(addUserApplicationFormFields);\n}\n\nexport { getAddUserApplicationFormFields, getAddUserApplicationForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { Tab, Segment, Container } from 'semantic-ui-react';\nimport { observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport RolesList from './RolesList';\nimport UsersList from './UsersList';\n\nconst panes = [\n  { menuItem: 'Users', render: () => <UsersList /> },\n  { menuItem: 'Roles', render: () => <RolesList /> },\n];\n\n// eslint-disable-next-line react/prefer-stateless-function\nclass User extends React.Component {\n  render() {\n    return (\n      <Container className=\"mt3 animated fadeIn\">\n        <Segment basic className=\"p0\">\n          <Tab panes={panes} />\n        </Segment>\n      </Container>\n    );\n  }\n}\n\nexport default withRouter(observer(User));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { Container, Header, Icon, Label } from 'semantic-ui-react';\nimport { withRouter } from 'react-router-dom';\nimport { decorate, observable, runInAction } from 'mobx';\nimport { inject, observer } from 'mobx-react';\nimport ReactTable from 'react-table';\n\nimport { isStoreError, isStoreLoading } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\n\nclass RolesList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n    runInAction(() => {\n      // An object that keeps track of which user is being edited\n      // Each key in the object below has key as user's unique id (<ns>/<username>)\n      // and value as flag indicating whether to show the editor for the user\n      this.mapOfUsersBeingEdited = {};\n      this.formProcessing = false;\n    });\n  }\n\n  getUserRolesStore() {\n    const store = this.props.userRolesStore;\n    return store;\n  }\n\n  getUserRoles() {\n    const store = this.getUserRolesStore();\n    return store.list;\n  }\n\n  renderMain() {\n    const userRolesData = this.getUserRoles();\n    const pageSize = userRolesData.length;\n    const showPagination = userRolesData.length > pageSize;\n    return (\n      <div>\n        <ReactTable\n          data={userRolesData}\n          showPagination={showPagination}\n          defaultPageSize={pageSize}\n          className=\"-striped -highlight\"\n          filterable\n          defaultFilterMethod={(filter, row) => {\n            const columnValue = String(row[filter.id]).toLowerCase();\n            const filterValue = filter.value.toLowerCase();\n            return columnValue.indexOf(filterValue) >= 0;\n          }}\n          columns={[\n            {\n              Header: 'User Role Name',\n              accessor: 'id',\n            },\n            {\n              Header: 'Description',\n              accessor: 'description',\n            },\n            {\n              Header: 'User Type',\n              accessor: 'userType',\n            },\n          ]}\n        />\n        <br />\n      </div>\n    );\n  }\n\n  goto(pathname) {\n    const location = this.props.location;\n    const link = createLink({ location, pathname });\n    this.props.history.push(link);\n  }\n\n  handleAddUserRole = () => {\n    this.goto('/user-roles/add');\n  };\n\n  renderHeader() {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"id badge\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">\n            User Roles\n            {this.renderTotal()}\n          </Header.Content>\n        </Header>\n      </div>\n    );\n  }\n\n  renderTotal() {\n    return <Label circular>{this.getUserRoles().length}</Label>;\n  }\n\n  render() {\n    const store = this.getUserRolesStore();\n    let content;\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder segmentCount={3} />;\n    } else {\n      content = this.renderMain();\n    }\n    return (\n      <Container className=\"mt3 animated fadeIn\">\n        {this.renderHeader()}\n        {content}\n      </Container>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(RolesList, {\n  mapOfUsersBeingEdited: observable,\n  formProcessing: observable,\n});\n\nexport default inject('userRolesStore')(withRouter(observer(RolesList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { decorate, observable, action, computed, runInAction } from 'mobx';\nimport { Button, Header, Label, Segment, Modal, Menu, Icon, Table } from 'semantic-ui-react';\nimport _ from 'lodash';\n\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\n\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport DropDown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\nimport YesNo from '@aws-ee/base-ui/dist/parts/helpers/fields/YesNo';\nimport { displayError, displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { getUpdateUserConfigForm } from '../../models/forms/UpdateUserConfig';\nimport { toIdpFromValue, toIdpOptions } from '../../models/forms/UserFormUtils';\n\nclass UpdateUser extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.stores = new Stores([\n        this.userStore,\n        this.userRolesStore,\n        this.awsAccountsStore,\n        this.projectsStore,\n        this.authenticationProviderConfigsStore,\n      ]);\n      this.modalOpen = false;\n      this.processing = false;\n      this.view = 'detail'; // view mode or edit mode\n    });\n    this.form = getUpdateUserConfigForm(this.getCurrentUser());\n  }\n\n  componentDidMount() {\n    swallowError(this.getStores().load());\n  }\n\n  render() {\n    const stores = this.getStores();\n    let content = null;\n    if (stores.hasError) {\n      content = <ErrorBox error={stores.error} className=\"p0 mb3\" />;\n    } else if (stores.loading) {\n      content = <BasicProgressPlaceholder />;\n    } else if (stores.ready) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Modal closeIcon trigger={this.renderTrigger()} open={this.modalOpen} onClose={this.handleClose}>\n        <div className=\"mt2 animated fadeIn\">\n          <Header as=\"h3\" icon textAlign=\"center\" className=\"mt3\" color=\"grey\">\n            User Detail\n          </Header>\n          <div className=\"mt3 ml3 mr3 animated fadeIn\">{content}</div>\n        </div>\n      </Modal>\n    );\n  }\n\n  renderMain() {\n    let content = null;\n    if (this.view === 'detail') {\n      content = this.renderDetailView();\n    } else if (this.view === 'edit') {\n      content = this.renderEditView();\n    }\n    return content;\n  }\n\n  renderDetailView() {\n    const getFieldLabel = fieldName => this.form.$(fieldName).label;\n    const toRow = fieldName => {\n      const value = _.get(this.getCurrentUser(), fieldName);\n      const displayValue = _.isArray(value) ? _.map(value, (v, k) => <Label key={k} content={v} />) : value;\n      return (\n        <>\n          <Table.Cell collapsing active>\n            {getFieldLabel(fieldName)}\n          </Table.Cell>\n          <Table.Cell>{displayValue}</Table.Cell>\n        </>\n      );\n    };\n\n    return (\n      <Segment basic className=\"ui fluid form mb4\">\n        <Table celled>\n          <Table.Body>\n            <Table.Row>{toRow('username')}</Table.Row>\n            <Table.Row>{toRow('firstName')}</Table.Row>\n            <Table.Row>{toRow('lastName')}</Table.Row>\n            <Table.Row>{toRow('email')}</Table.Row>\n            {this.getCurrentUser().isRootUser ? null : (\n              <>\n                <Table.Row>{toRow('userRole')}</Table.Row>\n                <Table.Row>{toRow('identityProviderName')}</Table.Row>\n                <Table.Row>{toRow('projectId')}</Table.Row>\n                {this.getCurrentUser().status === 'pending' && <Table.Row>{toRow('applyReason')}</Table.Row>}\n                <Table.Row>{toRow('status')}</Table.Row>\n              </>\n            )}\n          </Table.Body>\n        </Table>\n        {this.renderDetailViewButtons()}\n      </Segment>\n    );\n  }\n\n  renderDetailViewButtons() {\n    const makeButton = ({ label = '', color = 'blue', floated = 'left', disabled = false, ...props }) => {\n      const attrs = {};\n      if (color) attrs.color = color;\n      return (\n        <Button floated={floated} disabled={disabled} className=\"ml2\" {...attrs} {...props}>\n          {label}\n        </Button>\n      );\n    };\n\n    const currentUser = this.getCurrentUser();\n\n    const cancelButton = makeButton({\n      label: 'Cancel',\n      floated: 'left',\n      color: '',\n      onClick: this.handleCancel,\n      disabled: this.processing,\n    });\n\n    const deleteButton =\n      // TODO: deletion actions should be confirmed by user first\n      this.view === 'detail'\n        ? makeButton({\n            label: 'Delete',\n            floated: 'right',\n            color: 'red',\n            onClick: this.handleDeleteClick,\n            disabled: currentUser.isRootUser || this.processing,\n          })\n        : '';\n\n    const activeButton =\n      this.props.user.status === 'pending' || this.props.user.status === 'inactive'\n        ? makeButton({\n            label: 'Activate User',\n            floated: 'right',\n            color: 'blue',\n            onClick: () => this.handleApproveDisapproveClick('active'),\n            disabled: this.processing,\n          })\n        : '';\n\n    const deactiveButton =\n      this.props.user.status === 'active' || this.props.user.status === 'pending'\n        ? makeButton({\n            label: 'Deactivate User',\n            floated: 'right',\n            disabled: currentUser.isRootUser || this.processing,\n            onClick: () => this.handleApproveDisapproveClick('inactive'),\n          })\n        : '';\n\n    const editButton =\n      currentUser.status === 'active' || currentUser.status === 'inactive' // do not show \"edit\" button for other status(es) such as \"pending\"\n        ? makeButton({ label: 'Edit', onClick: this.handleEditClick, floated: 'right', disabled: this.processing })\n        : '';\n\n    return this.props.adminMode ? (\n      <div className=\"mt4 mb4\">\n        <Modal.Actions>\n          {cancelButton}\n          {deleteButton}\n          {deactiveButton}\n          {activeButton}\n          {editButton}\n        </Modal.Actions>\n      </div>\n    ) : (\n      <div className=\"mt4 mb4\">\n        <Modal.Actions>\n          {cancelButton}\n          {editButton}\n        </Modal.Actions>\n      </div>\n    );\n  }\n\n  renderEditView() {\n    const form = this.form;\n\n    const firstNameField = form.$('firstName');\n    const lastNameField = form.$('lastName');\n    const emailField = form.$('email');\n    const identityProviderNameField = form.$('identityProviderName');\n    const userRoleField = form.$('userRole');\n    const projectIdField = form.$('projectId');\n    const statusField = form.$('status');\n\n    const identityProviderOptions = this.getIdentityProviderOptions();\n    const userRoleOptions = this.getUserRoleOptions();\n    const projectIdOptions = this.getProjectOptions();\n\n    const isInternalUser = this.userRolesStore.isInternalUser(userRoleField.value);\n    const isInternalGuest = this.userRolesStore.isInternalGuest(userRoleField.value);\n    const showProjectField = !_.isEmpty(projectIdOptions) && isInternalUser && !isInternalGuest;\n\n    const isAdminMode = this.props.adminMode;\n    return (\n      <Segment clearing className=\"p3 mb4\">\n        <Form\n          form={form}\n          onCancel={this.handleCancel}\n          onSuccess={this.handleFormSubmission}\n          onError={this.handleFormError}\n        >\n          {({ processing, onCancel }) => (\n            <>\n              <Input field={firstNameField} disabled={processing} />\n              <Input field={lastNameField} disabled={processing} />\n              <Input field={emailField} disabled={processing} />\n              {this.getCurrentUser().isRootUser ? null : (\n                <>\n                  {isAdminMode && (\n                    <DropDown\n                      field={identityProviderNameField}\n                      options={identityProviderOptions}\n                      selection\n                      fluid\n                      disabled={processing}\n                    />\n                  )}\n                  {isAdminMode && (\n                    <DropDown field={userRoleField} options={userRoleOptions} selection fluid disabled={processing} />\n                  )}\n\n                  {isAdminMode && showProjectField && (\n                    <DropDown\n                      field={projectIdField}\n                      options={projectIdOptions}\n                      multiple\n                      selection\n                      clearable\n                      fluid\n                      disabled={processing}\n                    />\n                  )}\n\n                  <YesNo field={statusField} disabled={processing} />\n                </>\n              )}\n\n              <div className=\"mt3\">\n                <Button floated=\"right\" color=\"blue\" icon disabled={processing} className=\"ml2\" type=\"submit\">\n                  Save\n                </Button>\n                <Button floated=\"right\" disabled={processing} onClick={onCancel}>\n                  Cancel\n                </Button>\n              </div>\n            </>\n          )}\n        </Form>\n      </Segment>\n    );\n  }\n\n  renderTrigger() {\n    let content = null;\n    if (this.props.adminMode) {\n      content = (\n        <Button size=\"mini\" compact color=\"blue\" onClick={this.handleOpen}>\n          Detail\n        </Button>\n      );\n    } else {\n      content = (\n        <Menu.Item onClick={this.handleOpen}>\n          <Icon name=\"user\" /> {this.props.userStore.user.displayName}\n        </Menu.Item>\n      );\n    }\n    return content;\n  }\n\n  handleEditClick = () => {\n    this.view = 'edit';\n  };\n\n  handleCancel = () => {\n    this.form.clear();\n    if (this.view === 'edit') {\n      // if it's in edit mode then switch to detail view mode\n      this.view = 'detail';\n    } else {\n      // if not in edit mode then close\n      this.handleClose();\n    }\n  };\n\n  handleFormSubmission = async form => {\n    const values = form.values();\n    const isInternalUser = this.userRolesStore.isInternalUser(values.userRole);\n    const isInternalGuest = this.userRolesStore.isInternalGuest(values.userRole);\n    let projectId = values.projectId || [];\n    if (!isInternalUser || isInternalGuest) {\n      // Pass projectId(s) only if the user's role is internal role and if the user is not a guest.\n      // Pass empty array otherwise.\n      projectId = [];\n    }\n\n    const { firstName, lastName, email, userRole, status } = values;\n    const isAdmin = userRole === 'admin';\n    const identityProviderNameField = form.$('identityProviderName');\n\n    let userToUpdate = { ...this.getCurrentUser(), firstName, lastName, email };\n    if (this.props.adminMode && !this.getCurrentUser().isRootUser) {\n      userToUpdate = { ...userToUpdate, userRole, isAdmin, projectId, status };\n    }\n\n    try {\n      const usersStore = this.usersStore;\n      if (identityProviderNameField.isDirty) {\n        // Change in identityProviderName so delete existing user and add it again with new identityProviderName\n        if (this.props.adminMode) {\n          // clear out the user namespace as it will be re-derived based on authenticationProviderId and\n          // identityProviderName on server side\n          userToUpdate.ns = undefined;\n          // The values.identityProviderName is in JSON string format\n          // containing authentication provider id as well as identity provider name\n          // See \"src/models/forms/UserFormUtils.js\" for more details.\n          const idpOptionValue = toIdpFromValue(identityProviderNameField.value);\n          userToUpdate.identityProviderName = idpOptionValue.idpName;\n          userToUpdate.authenticationProviderId = idpOptionValue.authNProviderId;\n          await usersStore.addUser(userToUpdate);\n\n          // Delete existing user first\n          await usersStore.deleteUser(this.getCurrentUser());\n        } else {\n          displayError('Only admins can update identity provider information for the user');\n        }\n      } else {\n        // No change in identityProviderName so simply update the user\n\n        // allow updating only firstName, lastName and email in case self-service update (i.e., adminMode = false)\n        // or if the user being updated is a root user (i.e., this.getCurrentUser().isRootUser = true)\n        await usersStore.updateUser(userToUpdate);\n      }\n      form.clear();\n      displaySuccess('Updated user successfully');\n\n      // reload the current user's store after user updates, in case the currently\n      // logged in user is updated\n      await this.userStore.load();\n\n      this.handleClose();\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  handleDeleteClick = async () => {\n    try {\n      this.processing = true;\n      await this.usersStore.deleteUser(this.getCurrentUser());\n    } catch (error) {\n      displayError(error);\n    }\n    runInAction(() => {\n      this.processing = false;\n    });\n    this.handleClose();\n  };\n\n  handleApproveDisapproveClick = async status => {\n    try {\n      this.processing = true;\n      await this.usersStore.updateUser({ ...this.getCurrentUser(), status });\n\n      // reload the current user's store after user updates, in case the currently\n      // logged in user is updated\n      await this.userStore.load();\n    } catch (err) {\n      displayError(err);\n    }\n    runInAction(() => {\n      this.processing = false;\n    });\n    this.handleClose();\n  };\n\n  getStores() {\n    return this.stores;\n  }\n\n  handleOpen = () => {\n    this.usersStore.stopHeartbeat();\n\n    // Need to recreate form based on the user being passed (i.e., getCurrentUser) to make sure the form field values\n    // are updated as per the latest user information\n    this.form = getUpdateUserConfigForm(this.getCurrentUser());\n    this.modalOpen = true;\n  };\n\n  handleClose = () => {\n    this.usersStore.startHeartbeat();\n    this.modalOpen = false;\n  };\n\n  // eslint-disable-next-line no-unused-vars\n  handleFormError = (_form, _errors) => {\n    // We don't need to do anything here\n  };\n\n  getIdentityProviderOptions() {\n    return toIdpOptions(this.authenticationProviderConfigsStore.list);\n  }\n\n  getUserRoleOptions() {\n    return this.userRolesStore.dropdownOptions;\n  }\n\n  getProjectOptions() {\n    return this.projectsStore.dropdownOptions;\n  }\n\n  getCurrentUser() {\n    return this.props.user;\n  }\n\n  get userStore() {\n    return this.props.userStore;\n  }\n\n  get usersStore() {\n    return this.props.usersStore;\n  }\n\n  get userRolesStore() {\n    return this.props.userRolesStore;\n  }\n\n  get awsAccountsStore() {\n    return this.props.awsAccountsStore;\n  }\n\n  get projectsStore() {\n    return this.props.projectsStore;\n  }\n\n  get authenticationProviderConfigsStore() {\n    return this.props.authenticationProviderConfigsStore;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(UpdateUser, {\n  modalOpen: observable,\n  view: observable,\n  processing: observable,\n\n  authenticationProviderConfigsStore: computed,\n  projectsStore: computed,\n  awsAccountsStore: computed,\n  userRolesStore: computed,\n  usersStore: computed,\n  userStore: computed,\n\n  handleOpen: action,\n  handleClose: action,\n  handleCancel: action,\n\n  handleEditClick: action,\n  handleDeleteClick: action,\n  handleApproveDisapproveClick: action,\n\n  handleFormSubmission: action,\n});\nexport default inject('authenticationProviderConfigsStore')(observer(UpdateUser));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { createForm } from '../../helpers/form';\nimport { toValueFromIdp } from './UserFormUtils';\n\nfunction getUpdateUserConfigFormFields(existingUser) {\n  return {\n    username: {\n      label: 'Username',\n      value: _.get(existingUser, 'username', ''),\n    },\n    firstName: {\n      label: 'First Name',\n      placeholder: 'First name of this user',\n      value: _.get(existingUser, 'firstName', ''),\n      rules: 'required|string',\n    },\n    lastName: {\n      label: 'Last Name',\n      placeholder: 'Last name of this user',\n      value: _.get(existingUser, 'lastName', ''),\n      rules: 'required|string',\n    },\n    email: {\n      label: 'Email',\n      placeholder: 'email address',\n      value: _.get(existingUser, 'email', ''),\n      rules: 'required|email|string',\n    },\n    identityProviderName: {\n      label: 'Identity Provider Name',\n      value: toValueFromIdp({\n        authenticationProviderId: _.get(existingUser, 'authenticationProviderId', ''),\n        identityProviderName: _.get(existingUser, 'identityProviderName', ''),\n      }),\n    },\n    projectId: {\n      label: 'Project',\n      value: _.get(existingUser, 'projectId', ''),\n    },\n    userRole: {\n      label: 'User Role',\n      value: _.get(existingUser, 'userRole', ''),\n    },\n    applyReason: {\n      label: 'Reason for Applying',\n      explain: ' ',\n      value: _.get(existingUser, 'applyReason', ''),\n    },\n    status: {\n      label: 'User Status',\n      extra: {\n        explain: 'Active users can log into the Research Portal',\n        yesLabel: 'Active',\n        noLabel: 'Inactive',\n        yesValue: 'active',\n        noValue: 'inactive',\n      },\n      value: _.get(existingUser, 'status', ''),\n    },\n  };\n}\n\nfunction getUpdateUserConfigForm(existingUser) {\n  return createForm(getUpdateUserConfigFormFields(existingUser));\n}\n\nexport { getUpdateUserConfigFormFields, getUpdateUserConfigForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { Tab, Segment, Container } from 'semantic-ui-react';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport AwsAccountsList from './AwsAccountsList';\nimport IndexesList from './IndexesList';\nimport ProjectsList from '../projects/ProjectsList';\n\nconst panes = [\n  { menuItem: 'Projects', render: () => <ProjectsList /> },\n  { menuItem: 'Indexes', render: () => <IndexesList /> },\n  { menuItem: 'AWS Accounts', render: () => <AwsAccountsList /> },\n];\n\n// eslint-disable-next-line react/prefer-stateless-function\nclass Accounts extends React.Component {\n  render() {\n    return (\n      <Container className=\"mt3 animated fadeIn\">\n        <Segment basic className=\"p0\">\n          <Tab panes={panes} />\n        </Segment>\n      </Container>\n    );\n  }\n}\n\nexport default inject('userRolesStore', 'indexesStore', 'awsAccountsStore')(withRouter(observer(Accounts)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { Button, Container, Header, Icon, Label, Message } from 'semantic-ui-react';\nimport { withRouter } from 'react-router-dom';\nimport { decorate, observable, runInAction } from 'mobx';\nimport { inject, observer } from 'mobx-react';\nimport ReactTable from 'react-table';\n\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreError, isStoreLoading } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\nclass AwsAccountsList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n    runInAction(() => {\n      // An object that keeps track of which user is being edited\n      // Each key in the object below has key as user's unique id (i.e., uid)\n      // and value as flag indicating whether to show the editor for the user\n      this.mapOfUsersBeingEdited = {};\n    });\n  }\n\n  componentDidMount() {\n    const accountsStore = this.props.accountsStore;\n    const awsAccountsStore = this.props.awsAccountsStore;\n    swallowError(accountsStore.load());\n    swallowError(awsAccountsStore.load());\n    accountsStore.startHeartbeat();\n    awsAccountsStore.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const accountsStore = this.props.accountsStore;\n    const awsAccountsStore = this.props.awsAccountsStore;\n    accountsStore.stopHeartbeat();\n    awsAccountsStore.stopHeartbeat();\n  }\n\n  getAwsAccountsStore() {\n    const store = this.props.awsAccountsStore;\n    return store;\n  }\n\n  getAwsAccounts() {\n    const store = this.getAwsAccountsStore();\n    return store.list;\n  }\n\n  renderMain() {\n    const awsAccountsData = this.getAwsAccounts();\n    const pageSize = 5;\n    const showPagination = awsAccountsData.length > pageSize;\n    return (\n      <div>\n        <ReactTable\n          data={awsAccountsData}\n          showPagination={showPagination}\n          defaultPageSize={pageSize}\n          className=\"-striped -highlight\"\n          filterable\n          defaultFilterMethod={(filter, row) => {\n            const columnValue = String(row[filter.id]).toLowerCase();\n            const filterValue = filter.value.toLowerCase();\n            return columnValue.indexOf(filterValue) >= 0;\n          }}\n          columns={[\n            {\n              Header: 'Account Name',\n              accessor: 'name',\n            },\n            {\n              Header: 'AWS Account ID',\n              accessor: 'accountId',\n            },\n            {\n              Header: 'Description',\n              accessor: 'description',\n            },\n            {\n              Header: 'Role ARN',\n              accessor: 'roleArn',\n            },\n            {\n              Header: 'External ID',\n              accessor: 'externalId',\n            },\n            {\n              Header: 'VPC ID',\n              accessor: 'vpcId',\n            },\n            {\n              Header: 'Subnet ID',\n              accessor: 'subnetId',\n            },\n            {\n              Header: 'Encryption Key Arn',\n              accessor: 'encryptionKeyArn',\n            },\n            {\n              Header: 'Budget Configuration',\n              filterable: false,\n              Cell: observer(cell => (\n                <Button primary compact size=\"mini\" onClick={() => this.handleBudgetConfiguration(cell.original.id)}>\n                  Budget Detail\n                </Button>\n              )),\n            },\n          ]}\n        />\n      </div>\n    );\n  }\n\n  goto(pathname) {\n    const location = this.props.location;\n    const link = createLink({ location, pathname });\n    this.props.history.push(link);\n  }\n\n  handleAddAwsAccount = () => {\n    this.goto('/aws-accounts/add');\n  };\n\n  handleCreateAwsAccount = () => {\n    this.goto('/aws-accounts/create');\n  };\n\n  handleBudgetConfiguration(awsAccountId) {\n    this.goto(`/aws-accounts/budget/${awsAccountId}`);\n  }\n\n  renderHeader() {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"amazon\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">\n            AWS Accounts\n            {this.renderTotal()}\n          </Header.Content>\n        </Header>\n        <Button color=\"blue\" size=\"medium\" basic onClick={this.handleCreateAwsAccount}>\n          Create AWS Account\n        </Button>\n        <Button className=\"ml2\" color=\"blue\" size=\"medium\" basic onClick={this.handleAddAwsAccount}>\n          Add AWS Account\n        </Button>\n      </div>\n    );\n  }\n\n  renderTotal() {\n    return <Label circular>{this.getAwsAccounts().length}</Label>;\n  }\n\n  handleDismiss(id) {\n    const accountsStore = this.props.accountsStore;\n    accountsStore.removeItem(id);\n    this.componentDidMount();\n  }\n\n  renderCreatingAccountNotification() {\n    const accountsStore = this.props.accountsStore;\n    const pendingAccount = accountsStore.listCreatingAccount;\n    const errorAccounts = accountsStore.listErrorAccount;\n    return (\n      <div className=\"mt3 mb3 animated fadeIn\">\n        {pendingAccount.map(account => (\n          <Message>\n            <Icon name=\"circle notched\" loading />\n            Trying to create accountID: {account.id}\n          </Message>\n        ))}\n        {errorAccounts.map(account => (\n          <Message onDismiss={() => this.handleDismiss(account.id)}>\n            <Icon name=\"times\" color=\"red\" />\n            Error happended in creating accountID: {account.id}. If the account is created, please contact follow{' '}\n            <a\n              href=\"https://aws.amazon.com/blogs/security/aws-organizations-now-supports-self-service-removal-of-accounts-from-an-organization/\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              instruction\n            </a>{' '}\n            to remove it. You may close this message after you make sure the account is removed.\n          </Message>\n        ))}\n      </div>\n    );\n  }\n\n  render() {\n    const store = this.getAwsAccountsStore();\n    let content;\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder segmentCount={3} />;\n    } else {\n      content = this.renderMain();\n    }\n    return (\n      <Container className=\"mt3 animated fadeIn\">\n        {this.renderHeader()}\n        {this.renderCreatingAccountNotification()}\n        {content}\n      </Container>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(AwsAccountsList, {\n  mapOfUsersBeingEdited: observable,\n});\n\nexport default inject('awsAccountsStore', 'accountsStore')(withRouter(observer(AwsAccountsList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { Button, Container, Header, Icon, Label } from 'semantic-ui-react';\nimport { withRouter } from 'react-router-dom';\nimport { inject, observer } from 'mobx-react';\nimport ReactTable from 'react-table';\n\nimport { isStoreError, isStoreLoading } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\n\nclass IndexesList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  getIndexesStore() {\n    const store = this.props.indexesStore;\n    store.load();\n    return store;\n  }\n\n  getIndexes() {\n    const store = this.getIndexesStore();\n    return store.list;\n  }\n\n  renderMain() {\n    const indexesData = this.getIndexes();\n    const pageSize = indexesData.length;\n    const pagination = indexesData.length > pageSize;\n    return (\n      <div>\n        <ReactTable\n          data={indexesData}\n          showPagination={pagination}\n          defaultPageSize={pageSize}\n          className=\"-striped -highlight\"\n          filterable\n          defaultFilterMethod={(filter, row) => {\n            const columnValue = String(row[filter.id]).toLowerCase();\n            const filterValue = filter.value.toLowerCase();\n            return columnValue.indexOf(filterValue) >= 0;\n          }}\n          columns={[\n            {\n              Header: 'Index Name',\n              accessor: 'id',\n            },\n            {\n              Header: 'AWS Account',\n              id: 'awsAccountId',\n              accessor: row => this.props.awsAccountsStore.getNameForAccountId(row.awsAccountId),\n            },\n            {\n              Header: 'Description',\n              accessor: 'description',\n            },\n          ]}\n        />\n        <br />\n      </div>\n    );\n  }\n\n  goto(pathname) {\n    const location = this.props.location;\n    const link = createLink({ location, pathname });\n    this.props.history.push(link);\n  }\n\n  handleAddIndex = () => {\n    this.goto('/indexes/add');\n  };\n\n  renderHeader() {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"briefcase\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">\n            Indexes\n            {this.renderTotal()}\n          </Header.Content>\n        </Header>\n        <Button color=\"blue\" size=\"medium\" basic onClick={this.handleAddIndex}>\n          Add Index\n        </Button>\n      </div>\n    );\n  }\n\n  renderTotal() {\n    return <Label circular>{this.getIndexes().length}</Label>;\n  }\n\n  render() {\n    const store = this.getIndexesStore();\n    let content;\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder segmentCount={3} />;\n    } else {\n      content = this.renderMain();\n    }\n    return (\n      <Container className=\"mt3 animated fadeIn\">\n        {this.renderHeader()}\n        {content}\n      </Container>\n    );\n  }\n}\n\nexport default inject('awsAccountsStore', 'indexesStore')(withRouter(observer(IndexesList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { Button, Container, Header, Icon, Label, Popup } from 'semantic-ui-react';\nimport { withRouter } from 'react-router-dom';\nimport { runInAction } from 'mobx';\nimport { inject, observer } from 'mobx-react';\nimport ReactTable from 'react-table';\nimport _ from 'lodash';\n\nimport { isStoreError, isStoreLoading } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\n\nimport ProjectConfigure from './ProjectConfigure';\n\nclass ProjectsList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n    runInAction(() => {\n      this.stores = new Stores([this.props.projectsStore]);\n    });\n  }\n\n  getProjectsStore() {\n    const store = this.props.projectsStore;\n    store.load();\n    return store;\n  }\n\n  getProjects() {\n    const store = this.getProjectsStore();\n    return store.list;\n  }\n\n  renderMain() {\n    const projectsData = this.getProjects();\n    const pageSize = projectsData.length;\n    const pagination = projectsData.length > pageSize;\n    return (\n      <div>\n        <ReactTable\n          data={projectsData}\n          showPagination={pagination}\n          defaultPageSize={pageSize}\n          className=\"-striped -highlight\"\n          filterable\n          defaultFilterMethod={(filter, row) => {\n            const columnValue = String(row[filter.id]).toLowerCase();\n            const filterValue = filter.value.toLowerCase();\n            return columnValue.indexOf(filterValue) >= 0;\n          }}\n          columns={[\n            {\n              Header: 'Project Name',\n              accessor: 'id',\n            },\n            {\n              Header: 'Index Id',\n              accessor: 'indexId',\n            },\n            {\n              Header: 'Description',\n              accessor: 'description',\n            },\n            {\n              Header: 'Project Admins',\n              accessor: 'projectAdmins',\n              style: { whiteSpace: 'unset' },\n              Cell: observer(row => {\n                const project = row.original;\n                const projectAdminUsers = project.projectAdminUsers;\n                return _.map(projectAdminUsers, u => u.username).join(', ') || '<<none>>';\n              }),\n            },\n            {\n              Header: '',\n              accessor: 'viewDetail',\n              filterable: false,\n              Cell: observer(cell => {\n                const project = { ...cell.original };\n                return (\n                  <div style={{ textAlign: 'center', verticalAlign: 'middle' }}>\n                    <span>\n                      <Popup\n                        content=\"View Project Detail\"\n                        trigger={\n                          <ProjectConfigure\n                            project={project}\n                            userStore={this.props.userStore}\n                            usersStore={this.props.usersStore}\n                            projectsStore={this.props.projectsStore}\n                            awsAccountsStore={this.props.awsAccountsStore}\n                          />\n                        }\n                      />\n                    </span>\n                  </div>\n                );\n              }),\n            },\n          ]}\n        />\n        <br />\n      </div>\n    );\n  }\n\n  goto(pathname) {\n    const location = this.props.location;\n    const link = createLink({ location, pathname });\n    this.props.history.push(link);\n  }\n\n  handleAddProject = () => {\n    this.goto('/projects/add');\n  };\n\n  renderHeader() {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"briefcase\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">\n            Projects\n            {this.renderTotal()}\n          </Header.Content>\n        </Header>\n        <Button color=\"blue\" size=\"medium\" basic onClick={this.handleAddProject}>\n          Add Project\n        </Button>\n      </div>\n    );\n  }\n\n  renderTotal() {\n    return <Label circular>{this.getProjects().length}</Label>;\n  }\n\n  render() {\n    const store = this.getProjectsStore();\n    let content;\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder segmentCount={3} />;\n    } else {\n      content = this.renderMain();\n    }\n    return (\n      <Container className=\"mt3 animated fadeIn\">\n        {this.renderHeader()}\n        {content}\n      </Container>\n    );\n  }\n}\n\nexport default inject(\n  'awsAccountsStore',\n  'projectsStore',\n  'userStore',\n  'usersStore',\n)(withRouter(observer(ProjectsList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { decorate, observable, action, runInAction, computed } from 'mobx';\nimport { Button, Dimmer, Header, Loader, Table, Label, Dropdown, Segment, Modal, Confirm } from 'semantic-ui-react';\nimport _ from 'lodash';\nimport { displayError, displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport { getAddProjectFormFields, getAddProjectForm } from '../../models/forms/AddProjectForm';\n\nclass ProjectConfigure extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.stores = new Stores([this.usersStore, this.awsAccountsStore, this.projectsStore, this.userStore]);\n      const { rev, id, description, indexId, projectAdmins } = this.props.project;\n      this.updateProject = {\n        rev,\n        id,\n        description,\n        indexId,\n        projectAdmins,\n      };\n      this.formProcessing = false;\n      this.modalOpen = false;\n      this.confirmDeleteOpen = false;\n      this.view = 'detail';\n    });\n    this.form = getAddProjectForm();\n    this.addProjectFormFields = getAddProjectFormFields();\n    this.currentProject = this.props.project;\n  }\n\n  componentWillUnmount() {\n    this.cleanUp();\n  }\n\n  getStores() {\n    return this.stores;\n  }\n\n  componentDidMount() {\n    swallowError(this.getStores().load());\n  }\n\n  cleanUp() {\n    runInAction(() => {\n      this.modalOpen = false;\n      this.confirmDeleteOpen = false;\n    });\n  }\n\n  handleModalOpen = () => {\n    runInAction(() => {\n      const { rev, id, description, indexId, projectAdmins } = this.props.project;\n      this.updateProject = {\n        rev,\n        id,\n        description,\n        indexId,\n        projectAdmins,\n      };\n      this.formProcessing = false;\n      this.modalOpen = false;\n      this.confirmDeleteOpen = false;\n      this.view = 'detail';\n      this.modalOpen = true;\n    });\n  };\n\n  handleModalClose = () => {\n    this.cleanUp();\n  };\n\n  handleDeleteConfirmOpen = () => {\n    runInAction(() => {\n      this.confirmDeleteOpen = true;\n    });\n  };\n\n  handleDeleteConfirmClose = () => {\n    runInAction(() => {\n      this.confirmDeleteOpen = false;\n    });\n  };\n\n  renderDetailView() {\n    const getFieldLabel = fieldName => this.form.$(fieldName).label;\n    const toRow = fieldName => {\n      const value = _.get(this.currentProject, fieldName);\n      const displayValue = _.isArray(value)\n        ? _.map(value, (v, k) => {\n            const user = this.usersStore.asUserObject({ uid: v });\n            return <Label key={k} content={user.username} />;\n          })\n        : value;\n      return (\n        <>\n          <Table.Cell collapsing active>\n            {getFieldLabel(fieldName)}\n          </Table.Cell>\n          <Table.Cell>{displayValue}</Table.Cell>\n        </>\n      );\n    };\n\n    return (\n      <Segment basic className=\"ui fluid form mb4\">\n        <Table celled>\n          <Table.Body>\n            <Table.Row>{toRow('id')}</Table.Row>\n            <Table.Row>{toRow('description')}</Table.Row>\n            <Table.Row>{toRow('projectAdmins')}</Table.Row>\n          </Table.Body>\n        </Table>\n        {this.renderButtons()}\n      </Segment>\n    );\n  }\n\n  renderTrigger() {\n    return (\n      <Button size=\"mini\" compact color=\"blue\" onClick={this.handleModalOpen}>\n        Detail\n      </Button>\n    );\n  }\n\n  renderMain() {\n    let content = null;\n    if (this.view === 'detail') {\n      content = this.renderDetailView();\n    } else if (this.view === 'edit') {\n      content = this.renderEditView();\n    }\n    return content;\n  }\n\n  render() {\n    const stores = this.getStores();\n    let content = null;\n    if (stores.hasError) {\n      content = <ErrorBox error={stores.error} className=\"p0 mb3\" />;\n    } else if (stores.loading) {\n      content = <BasicProgressPlaceholder />;\n    } else if (stores.ready) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Modal closeIcon trigger={this.renderTrigger()} open={this.modalOpen} onClose={this.handleModalClose}>\n        <div className=\"mt2 animated fadeIn\">\n          <Header as=\"h3\" icon textAlign=\"center\" className=\"mt3\" color=\"grey\">\n            Project Detail\n          </Header>\n          <div className=\"mt3 ml3 mr3 animated fadeIn\">{content}</div>\n        </div>\n      </Modal>\n    );\n  }\n\n  renderEditView() {\n    const processing = this.formProcessing;\n    const fields = this.addProjectFormFields;\n    const toEditableInput = (attributeName, type = 'text') => {\n      const handleChange = action(event => {\n        event.preventDefault();\n        this.updateProject[attributeName] = event.target.value;\n      });\n      return (\n        <div className=\"ui focus input\">\n          <input\n            type={type}\n            defaultValue={this.currentProject[attributeName]}\n            placeholder={fields[attributeName].placeholder || ''}\n            onChange={handleChange}\n          />\n        </div>\n      );\n    };\n\n    return (\n      <Segment basic className=\"ui fluid form\">\n        <Dimmer active={processing} inverted>\n          <Loader inverted>Checking</Loader>\n        </Dimmer>\n        {this.renderField('id', toEditableInput('id', 'id'))}\n        <div className=\"mb2\" />\n        {this.renderField('description', toEditableInput('description', 'description'))}\n        <div className=\"mb2\" />\n        {this.renderField('projectAdmins')}\n        {this.renderProjectAdminsSelection()}\n        <div className=\"mb2\" />\n        {this.renderButtons()}\n        <div className=\"mb4\" />\n      </Segment>\n    );\n  }\n\n  handleClickEditButton = () => {\n    runInAction(() => {\n      this.view = 'edit';\n    });\n  };\n\n  handleClickCancelButton = () => {\n    if (this.view === 'edit') {\n      runInAction(() => {\n        this.view = 'detail';\n      });\n    } else {\n      this.handleModalClose();\n    }\n  };\n\n  handleClickSubmitButton = action(async () => {\n    if (!this.updateProject.id) {\n      this.updateProject.id = this.currentProject.id;\n    }\n    runInAction(() => {\n      this.formProcessing = true;\n    });\n    try {\n      const store = this.getStore();\n      await store.updateProject(this.updateProject);\n\n      runInAction(() => {\n        this.formProcessing = false;\n      });\n\n      this.cleanUp();\n\n      displaySuccess('Updated project successfully');\n    } catch (err) {\n      runInAction(() => {\n        this.formProcessing = false;\n      });\n      displayError(err);\n    }\n  });\n\n  handleClickDeleteButton = action(async () => {\n    runInAction(() => {\n      this.confirmDeleteOpen = false;\n      this.formProcessing = true;\n    });\n    try {\n      const store = this.getStore();\n      await store.deleteProject(this.currentProject.id);\n      await store.load();\n      runInAction(async () => {\n        this.formProcessing = false;\n      });\n      this.cleanUp();\n    } catch (error) {\n      runInAction(() => {\n        this.formProcessing = false;\n      });\n      displayError(error);\n    }\n  });\n\n  renderButtons() {\n    const processing = this.formProcessing;\n\n    const makeButton = ({ label = '', color = 'blue', floated = 'left', ...props }) => {\n      return (\n        <Button color={color} floated={floated} disabled={processing} className=\"ml2\" {...props}>\n          {label}\n        </Button>\n      );\n    };\n\n    const makeConfirmDeleteButton = ({ label = 'Delete', color = 'red', floated = 'right' } = {}) => {\n      return (\n        <div>\n          <Button\n            color={color}\n            floated={floated}\n            disabled={processing}\n            className=\"ml2\"\n            onClick={this.handleDeleteConfirmOpen}\n          >\n            {label}\n          </Button>\n          <Confirm\n            open={this.confirmDeleteOpen}\n            content=\"Are you sure you want to delete this project?\"\n            onCancel={this.handleDeleteConfirmClose}\n            onConfirm={this.handleClickDeleteButton}\n          />\n        </div>\n      );\n    };\n\n    const editButton = this.view === 'detail' ? makeButton({ label: 'Edit', onClick: this.handleClickEditButton }) : '';\n\n    const saveButton = this.view === 'edit' ? makeButton({ label: 'Save', onClick: this.handleClickSubmitButton }) : '';\n\n    const deleteButton = this.view === 'detail' ? makeConfirmDeleteButton() : '';\n\n    const cancelButton = makeButton({\n      label: 'Cancel',\n      floated: 'right',\n      color: 'grey',\n      onClick: this.handleClickCancelButton,\n    });\n\n    return (\n      <div className=\"mt3 mb3\">\n        <Modal.Actions>\n          {cancelButton}\n          {deleteButton}\n          {saveButton}\n          {editButton}\n        </Modal.Actions>\n      </div>\n    );\n  }\n\n  renderProjectAdminsSelection() {\n    const usersStore = this.props.usersStore;\n    const projectAdminsOption = usersStore.asDropDownOptions();\n    const currentProjectAdminUsers = _.map(this.currentProject.projectAdmins, uid => usersStore.asUserObject({ uid }));\n    return (\n      <Dropdown\n        options={projectAdminsOption}\n        defaultValue={_.map(currentProjectAdminUsers, x => x.uid)}\n        fluid\n        multiple\n        selection\n        onChange={this.handleProjectAdminsSelection}\n      />\n    );\n  }\n\n  handleProjectAdminsSelection = (e, { value }) => {\n    runInAction(() => {\n      this.updateProject.projectAdmins = value;\n    });\n  };\n\n  renderField(name, component, contentRenderer) {\n    const fields = this.addProjectFormFields;\n    const explain = fields[name].explain;\n    const label = fields[name].label;\n    const hasExplain = !_.isEmpty(explain);\n    let content = this.currentProject[name];\n    if (contentRenderer && typeof contentRenderer === 'function') {\n      content = contentRenderer(content);\n    }\n    content = _.isEmpty(content) ? 'N/A' : content;\n\n    return (\n      <div>\n        <Header className=\"mr3 mt0\" as=\"h4\" color=\"grey\">\n          {label}\n        </Header>\n        {hasExplain && (\n          <div className=\"mb2\">\n            {explain} <span>{this.view === 'detail' ? content : ''}</span>\n          </div>\n        )}\n        <div className=\"ui field input block m0\">{component}</div>\n      </div>\n    );\n  }\n\n  getStore() {\n    return this.props.projectsStore;\n  }\n\n  get userStore() {\n    return this.props.userStore;\n  }\n\n  get usersStore() {\n    return this.props.usersStore;\n  }\n\n  get awsAccountsStore() {\n    return this.props.awsAccountsStore;\n  }\n\n  get projectStore() {\n    return this.props.projectsStore.getProjectStore();\n  }\n\n  get projectsStore() {\n    return this.props.projectsStore;\n  }\n}\n\n// Using the MobX 4 way to use decorators without decorator syntax\ndecorate(ProjectConfigure, {\n  formProcessing: observable,\n  modalOpen: observable,\n  confirmDeleteOpen: observable,\n  view: observable,\n  updateProject: observable,\n\n  projectsStore: computed,\n  awsAccountsStore: computed,\n  usersStore: computed,\n  userStore: computed,\n\n  handleClickSubmitButton: action,\n});\nexport default observer(ProjectConfigure);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React, { Component } from 'react';\nimport Dropzone from 'react-dropzone';\nimport { withRouter } from 'react-router-dom';\nimport { inject, observer } from 'mobx-react';\nimport { Segment, Icon, Header, Button, Message, Container } from 'semantic-ui-react';\nimport { computed, decorate, observable, action, runInAction } from 'mobx';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\n\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\nimport UserTable from './UserTable';\n\nclass DragDrop extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      files: [],\n      fileContent: '',\n      jsonArrayContent: [],\n    };\n    runInAction(() => {\n      this.formProcessing = false;\n      this.validationErrors = new Map();\n      this.user = {};\n\n      this.stores = new Stores([\n        this.authenticationProviderConfigsStore,\n        this.userRolesStore,\n        this.usersStore,\n        this.userStore,\n      ]);\n    });\n  }\n\n  get userRolesStore() {\n    return this.props.userRolesStore;\n  }\n\n  get usersStore() {\n    return this.props.usersStore;\n  }\n\n  get userStore() {\n    return this.props.userStore;\n  }\n\n  get authenticationProviderConfigsStore() {\n    return this.props.authenticationProviderConfigsStore;\n  }\n\n  componentDidMount() {\n    swallowError(this.stores.load());\n  }\n\n  csvJSON(csv) {\n    const result = [];\n    const lines = csv.split(/\\r?\\n/);\n    const headers = lines[0].split(',');\n\n    for (let i = 1; i < lines.length; i++) {\n      const obj = {};\n      const currentline = lines[i].split(',');\n      for (let j = 0; j < headers.length; j++) {\n        obj[headers[j]] = currentline[j];\n      }\n      result.push(obj);\n    }\n\n    return result;\n  }\n\n  onDrop = files => {\n    const reader = new FileReader();\n    reader.onabort = () => console.log('file reading was aborted');\n    reader.onerror = () => console.log('file reading has failed');\n    reader.onload = () => {\n      const binaryStr = reader.result;\n      const jsonArray = this.csvJSON(binaryStr);\n      this.setState({ jsonArrayContent: jsonArray });\n      this.setState({ fileContent: binaryStr });\n    };\n    files.forEach(file => reader.readAsText(file));\n    this.setState({ files });\n  };\n\n  goto(pathname) {\n    const location = this.props.location;\n    const link = createLink({ location, pathname });\n    this.props.history.push(link);\n  }\n\n  renderButtons() {\n    const processing = this.formProcessing;\n    return (\n      <div className=\"mt3\">\n        <Button floated=\"right\" color=\"blue\" icon disabled={processing} className=\"ml2\" onClick={this.handleSubmit}>\n          Submit\n        </Button>\n        <Button floated=\"right\" disabled={processing} onClick={this.handleCancel}>\n          Cancel\n        </Button>\n      </div>\n    );\n  }\n\n  async addAuthProviderId(userArr) {\n    const promises = userArr.map(async user => {\n      const provider = this.authenticationProviderConfigsStore.getAuthenticationProviderConfigByIdpName(\n        user.identityProviderName,\n      );\n      const authenticationProviderId = _.get(provider, 'id');\n      user.authenticationProviderId = authenticationProviderId;\n      return user;\n    });\n    userArr = await Promise.all(promises);\n    return userArr;\n  }\n\n  handleSubmit = action(async () => {\n    this.formProcessing = true;\n    try {\n      // compose the content to users and invoke add user\n      const userArr = await this.addAuthProviderId(this.state.jsonArrayContent);\n      await this.usersStore.addUsers(userArr);\n      runInAction(() => {\n        this.formProcessing = false;\n      });\n      await this.usersStore.load();\n      this.goto('/users');\n    } catch (error) {\n      runInAction(() => {\n        this.formProcessing = false;\n      });\n      displayError(error);\n    }\n  });\n\n  handleCancel = action(event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.formProcessing = false;\n    this.goto('/users');\n  });\n\n  renderTable() {\n    let content;\n    if (this.state.fileContent) {\n      content = <UserTable userData={this.state.jsonArrayContent} />;\n    } else {\n      content = '';\n    }\n    return content;\n  }\n\n  render() {\n    const stores = this.stores;\n    let content = null;\n    if (stores.hasError) {\n      content = <ErrorBox error={stores.error} className=\"p0 mb3\" />;\n    } else if (stores.loading) {\n      content = <BasicProgressPlaceholder />;\n    } else if (stores.ready) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n    return content;\n  }\n\n  renderMain() {\n    const files = this.state.files.map(file => (\n      <li key={file.name}>\n        {file.name} - {file.size} bytes\n      </li>\n    ));\n    const maxSize = 512000;\n    return (\n      <div>\n        <Container text>\n          <Message info>\n            <Message.Content>\n              <Message.Header>CSV Example</Message.Header>\n              <p>email,userRole,identityProviderName</p>\n              <p>user1@datalake.amazonaws.com,researcher,DataLake</p>\n              <p>user2@organization.onmicrosoft.com,researcher,AzureAD</p>\n            </Message.Content>\n          </Message>\n        </Container>\n\n        <Segment className=\"mt4 center\">\n          <Header as=\"h4\" color=\"grey\">\n            Drag and drop files here\n          </Header>\n          <Dropzone onDrop={this.onDrop} minSize={0} maxSize={maxSize} multiple>\n            {({ getRootProps, getInputProps, rejectedFiles }) => {\n              const isFileTooLarge = rejectedFiles.length > 0 && rejectedFiles[0].size > maxSize;\n              return (\n                <div {...getRootProps()}>\n                  <input {...getInputProps()} />\n                  {<Icon name=\"cloud upload\" size=\"massive\" color=\"grey\" />}\n                  {isFileTooLarge && <div className=\"text-danger mt-2\">File is too large.</div>}\n                </div>\n              );\n            }}\n          </Dropzone>\n        </Segment>\n        <aside>\n          <h4>Files</h4>\n          <ul>{files}</ul>\n        </aside>\n        {this.renderTable()}\n        {this.renderButtons()}\n      </div>\n    );\n  }\n}\ndecorate(DragDrop, {\n  authenticationProviderConfigsStore: computed,\n  userRolesStore: computed,\n  usersStore: computed,\n  userStore: computed,\n  formProcessing: observable,\n});\n\nexport default inject(\n  'userStore',\n  'usersStore',\n  'userRolesStore',\n  'authenticationProviderConfigsStore',\n)(withRouter(observer(DragDrop)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { observer } from 'mobx-react';\n// Import React Table\nimport ReactTable from 'react-table';\n\n// eslint-disable-next-line react/prefer-stateless-function\nclass UserTable extends React.Component {\n  render() {\n    const { userData } = this.props;\n    return (\n      <div>\n        <ReactTable\n          data={userData}\n          columns={[\n            {\n              Header: 'Email',\n              accessor: 'email',\n            },\n            {\n              Header: 'User Role',\n              accessor: 'userRole',\n            },\n            {\n              Header: 'Identity Provider',\n              accessor: 'identityProviderName',\n            },\n          ]}\n          defaultPageSize={5}\n          className=\"-striped -highlight\"\n        />\n        <br />\n      </div>\n    );\n  }\n}\n\nexport default withRouter(observer(UserTable));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport _ from 'lodash';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { decorate, computed, runInAction } from 'mobx';\nimport { Segment, Button } from 'semantic-ui-react';\n\nimport { displaySuccess, displayError } from '@aws-ee/base-ui/dist//helpers/notification';\n\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport YesNo from '@aws-ee/base-ui/dist/parts/helpers/fields/YesNo';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport DropDown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport { getAddUserForm, getAddUserFormFields } from '../../models/forms/AddUserForm';\nimport { toIdpFromValue, toIdpOptions } from '../../models/forms/UserFormUtils';\n\n// expected props\n// - userStore (via injection)\n// - usersStore (via injection)\n// - userRolesStore (via injection)\n// - awsAccountsStore (via injection)\n// - projectsStore (via injection)\n// - authenticationProviderConfigsStore (via injection)\nclass AddSingleUser extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.stores = new Stores([\n        this.userStore,\n        this.usersStore,\n        this.userRolesStore,\n        this.awsAccountsStore,\n        this.projectsStore,\n        this.authenticationProviderConfigsStore,\n      ]);\n    });\n    this.form = getAddUserForm();\n    this.addUserFormFields = getAddUserFormFields();\n  }\n\n  componentDidMount() {\n    swallowError(this.getStores().load());\n  }\n\n  render() {\n    const stores = this.getStores();\n    let content = null;\n    if (stores.hasError) {\n      content = <ErrorBox error={stores.error} className=\"p0 mb3\" />;\n    } else if (stores.loading) {\n      content = <BasicProgressPlaceholder />;\n    } else if (stores.ready) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return content;\n  }\n\n  renderMain() {\n    const form = this.form;\n    const emailField = form.$('email');\n    const identityProviderNameField = form.$('identityProviderName');\n    const userRoleField = form.$('userRole');\n    const projectIdField = form.$('projectId');\n    const statusField = form.$('status');\n\n    const identityProviderOptions = this.getIdentityProviderOptions();\n    const userRoleOptions = this.getUserRoleOptions();\n    const projectIdOptions = this.getProjectOptions();\n\n    const isInternalUser = this.userRolesStore.isInternalUser(userRoleField.value);\n    const isInternalGuest = this.userRolesStore.isInternalGuest(userRoleField.value);\n    const showProjectField = !_.isEmpty(projectIdOptions) && isInternalUser && !isInternalGuest;\n\n    return (\n      <Segment clearing className=\"p3\">\n        <Form\n          form={form}\n          onCancel={this.handleCancel}\n          onSuccess={this.handleFormSubmission}\n          onError={this.handleFormError}\n        >\n          {({ processing, _onSubmit, onCancel }) => (\n            <>\n              <Input field={emailField} disabled={processing} />\n              <DropDown\n                field={identityProviderNameField}\n                options={identityProviderOptions}\n                selection\n                fluid\n                disabled={processing}\n              />\n              <DropDown field={userRoleField} options={userRoleOptions} selection fluid disabled={processing} />\n\n              {showProjectField && (\n                <DropDown\n                  field={projectIdField}\n                  options={projectIdOptions}\n                  multiple\n                  selection\n                  clearable\n                  fluid\n                  disabled={processing}\n                />\n              )}\n\n              <YesNo field={statusField} disabled={processing} />\n\n              <div className=\"mt3\">\n                <Button floated=\"right\" color=\"blue\" icon disabled={processing} className=\"ml2\" type=\"submit\">\n                  Add User\n                </Button>\n                <Button floated=\"right\" disabled={processing} onClick={onCancel}>\n                  Cancel\n                </Button>\n              </div>\n            </>\n          )}\n        </Form>\n      </Segment>\n    );\n  }\n\n  getIdentityProviderOptions() {\n    return toIdpOptions(this.authenticationProviderConfigsStore.list);\n  }\n\n  getUserRoleOptions() {\n    return this.userRolesStore.dropdownOptions;\n  }\n\n  getProjectOptions() {\n    return this.projectsStore.dropdownOptions;\n  }\n\n  // Private methods\n  handleCancel = () => {\n    const goto = gotoFn(this);\n    goto('/users');\n  };\n\n  handleFormSubmission = async form => {\n    const values = form.values();\n    const isInternalUser = this.userRolesStore.isInternalUser(values.userRole);\n    const isInternalGuest = this.userRolesStore.isInternalGuest(values.userRole);\n    let projectId = values.projectId || [];\n    if (!isInternalUser || isInternalGuest) {\n      // Pass projectId(s) only if the user's role is internal role and if the user is not a guest.\n      // Pass empty array otherwise.\n      projectId = [];\n    }\n\n    // The values.identityProviderName is in JSON string format\n    // containing authentication provider id as well as identity provider name\n    // See \"src/models/forms/UserFormUtils.js\" for more details.\n    const idpOptionValue = toIdpFromValue(values.identityProviderName);\n    const identityProviderName = idpOptionValue.idpName;\n    const authenticationProviderId = idpOptionValue.authNProviderId;\n\n    try {\n      await this.usersStore.addUser({ ...values, authenticationProviderId, identityProviderName, projectId });\n      form.clear();\n      displaySuccess('Added user successfully');\n\n      const goto = gotoFn(this);\n      goto('/users');\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  // eslint-disable-next-line no-unused-vars\n  handleFormError = (_form, _errors) => {\n    // We don't need to do anything here\n  };\n\n  getStores() {\n    return this.stores;\n  }\n\n  get userStore() {\n    return this.props.userStore;\n  }\n\n  get usersStore() {\n    return this.props.usersStore;\n  }\n\n  get userRolesStore() {\n    return this.props.userRolesStore;\n  }\n\n  get awsAccountsStore() {\n    return this.props.awsAccountsStore;\n  }\n\n  get projectsStore() {\n    return this.props.projectsStore;\n  }\n\n  get authenticationProviderConfigsStore() {\n    return this.props.authenticationProviderConfigsStore;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(AddSingleUser, {\n  userStore: computed,\n  usersStore: computed,\n  userRolesStore: computed,\n  awsAccountsStore: computed,\n  projectsStore: computed,\n  authenticationProviderConfigsStore: computed,\n});\n\nexport default inject(\n  'userStore',\n  'usersStore',\n  'userRolesStore',\n  'awsAccountsStore',\n  'projectsStore',\n  'authenticationProviderConfigsStore',\n)(withRouter(observer(AddSingleUser)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { decorate, observable, action, runInAction } from 'mobx';\nimport { Button, Dimmer, Header, List, Loader, Dropdown, Segment } from 'semantic-ui-react';\nimport _ from 'lodash';\n\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\nimport validate from '@aws-ee/base-ui/dist/models/forms/Validate';\n\nimport { getAddIndexForm, getAddIndexFormFields } from '../../models/forms/AddIndexForm';\n\nclass AddIndex extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      // eslint-disable-next-line react/no-unused-state\n      role: 'guest',\n      // eslint-disable-next-line react/no-unused-state\n      status: 'active',\n      awsAccountId: '',\n    };\n\n    runInAction(() => {\n      this.formProcessing = false;\n      this.validationErrors = new Map();\n      this.index = {};\n    });\n    this.form = getAddIndexForm();\n    this.addIndexFormFields = getAddIndexFormFields();\n  }\n\n  goto(pathname) {\n    const location = this.props.location;\n    const link = createLink({ location, pathname });\n    this.props.history.push(link);\n  }\n\n  render() {\n    return (\n      <div className=\"mt2 animated fadeIn\">\n        <Header as=\"h2\" icon textAlign=\"center\" className=\"mt3\" color=\"grey\">\n          Add Index\n        </Header>\n        <div className=\"mt3 ml3 mr3 animated fadeIn\">{this.renderAddIndexForm()}</div>\n      </div>\n    );\n  }\n\n  // eslint-disable-next-line react/no-unused-state\n  handleRoleChange = (e, { value }) => this.setState({ role: value });\n\n  // eslint-disable-next-line react/no-unused-state\n  handleStatusChange = (e, { value }) => this.setState({ status: value });\n\n  renderAddIndexForm() {\n    const processing = this.formProcessing;\n    const fields = this.addIndexFormFields;\n    const toEditableInput = (attributeName, type = 'text') => {\n      const handleChange = action(event => {\n        event.preventDefault();\n        this.index[attributeName] = event.target.value;\n      });\n      return (\n        <div className=\"ui focus input\">\n          <input\n            type={type}\n            defaultValue={this.index[attributeName]}\n            placeholder={fields[attributeName].placeholder || ''}\n            onChange={handleChange}\n          />\n        </div>\n      );\n    };\n\n    return (\n      <Segment basic className=\"ui fluid form\">\n        <Dimmer active={processing} inverted>\n          <Loader inverted>Checking</Loader>\n        </Dimmer>\n        {this.renderField('id', toEditableInput('id', 'id'))}\n        <div className=\"mb4\" />\n        {this.renderField('awsAccountId')}\n        {this.renderAwsAccountSelection()}\n        <div className=\"mb4\" />\n        {this.renderField('description', toEditableInput('description', 'description'))}\n        {this.renderButtons()}\n      </Segment>\n    );\n  }\n\n  renderButtons() {\n    const processing = this.formProcessing;\n    return (\n      <div className=\"mt3\">\n        <Button floated=\"right\" color=\"blue\" icon disabled={processing} className=\"ml2\" onClick={this.handleSubmit}>\n          Add Index\n        </Button>\n        <Button floated=\"right\" disabled={processing} onClick={this.handleCancel}>\n          Cancel\n        </Button>\n      </div>\n    );\n  }\n\n  renderAwsAccountSelection() {\n    const awsAccountIdOption = this.props.awsAccountsStore.dropdownOptions;\n    return (\n      <Dropdown\n        options={awsAccountIdOption}\n        placeholder=\"Please select an AWS Account\"\n        fluid\n        selection\n        onChange={this.handleAwsAccountSelection}\n      />\n    );\n  }\n\n  handleAwsAccountSelection = (e, { value }) => this.setState({ awsAccountId: value });\n\n  renderField(name, component) {\n    const fields = this.addIndexFormFields;\n    const explain = fields[name].explain;\n    const label = fields[name].label;\n    const hasExplain = !_.isEmpty(explain);\n    const fieldErrors = this.validationErrors.get(name);\n    const hasError = !_.isEmpty(fieldErrors);\n\n    return (\n      <div>\n        <Header className=\"mr3 mt0\" as=\"h2\" color=\"grey\">\n          {label}\n        </Header>\n        {hasExplain && <div className=\"mb2\">{explain}</div>}\n        <div className={`ui big field input block m0 ${hasError ? 'error' : ''}`}>{component}</div>\n        {hasError && (\n          <div className=\"ui pointing red basic label\">\n            <List>\n              {_.map(fieldErrors, fieldError => (\n                <List.Item key={name}>\n                  <List.Content>{fieldError}</List.Content>\n                </List.Item>\n              ))}\n            </List>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  handleCancel = action(event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.formProcessing = false;\n    this.goto('/accounts');\n  });\n\n  handleSubmit = action(async () => {\n    this.formProcessing = true;\n    try {\n      // Perform client side validations first\n      this.index.awsAccountId = this.state.awsAccountId;\n      const validationResult = await validate(this.index, this.addIndexFormFields);\n      // if there are any client side validation errors then do not attempt to make API call\n      if (validationResult.fails()) {\n        runInAction(() => {\n          this.validationErrors = validationResult.errors;\n          this.formProcessing = false;\n        });\n      } else {\n        // There are no client side validation errors so ask the store to add user (which will make API call to server to add the user)\n        await this.props.indexesStore.addIndex(this.index);\n        runInAction(() => {\n          this.formProcessing = false;\n        });\n        this.goto('/accounts');\n      }\n    } catch (error) {\n      runInAction(() => {\n        this.formProcessing = false;\n      });\n      displayError(error);\n    }\n  });\n\n  getStore() {\n    return this.props.usersStore;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(AddIndex, {\n  formProcessing: observable,\n  user: observable,\n  validationErrors: observable,\n});\nexport default inject('usersStore', 'indexesStore', 'awsAccountsStore')(withRouter(observer(AddIndex)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '../../helpers/form';\n\nconst addIndexFormFields = {\n  id: {\n    label: 'Index ID',\n    placeholder: 'Type id for this index',\n    rules: 'required|string|between:1,300',\n  },\n  awsAccountId: {\n    label: 'AWS Account ID',\n    rules: 'required|string',\n  },\n  description: {\n    label: 'Description',\n    placeholder: 'Type description for this index',\n    rules: 'string|between:1,3000',\n  },\n};\n\nfunction getAddIndexFormFields() {\n  return addIndexFormFields;\n}\n\nfunction getAddIndexForm() {\n  return createForm(addIndexFormFields);\n}\n\nexport { getAddIndexFormFields, getAddIndexForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable max-classes-per-file */\nimport React from 'react';\nimport _ from 'lodash';\nimport { decorate, action, observable, computed } from 'mobx';\nimport { observer, inject, Observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Container, Icon, Button, Label, Header, Tab, Message, Menu } from 'semantic-ui-react';\nimport { niceNumber } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\n\nimport { isStoreError, isStoreNew, isStoreLoading } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { categories } from '../../models/studies/categories';\nimport StudiesTab from './StudiesTab';\nimport CreateStudy from './CreateStudy';\nimport StudyStepsProgress from './StudyStepsProgress';\n\n// This component is used with the TabPane to replace the default Segment wrapper since\n// we don't want to display the border.\n// eslint-disable-next-line react/prefer-stateless-function\nclass TabPaneWrapper extends React.Component {\n  render() {\n    return <>{this.props.children}</>;\n  }\n}\n\n// expected props\n// - filesSelection (via injection)\n// - studiesStoresMap (via injection)\n// - userStore (via injection)\nclass StudiesPage extends React.Component {\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  getStudiesStore(category) {\n    return this.props.studiesStoresMap[category.id];\n  }\n\n  goto(pathname) {\n    const goto = gotoFn(this);\n    goto(pathname);\n  }\n\n  get canCreateStudy() {\n    // Note, this does not cover the case if you can create a study but don't have any project linked with you yet.\n    return _.get(this.props.userStore, 'user.capabilities.canCreateStudy', true);\n  }\n\n  get canSelectStudy() {\n    return _.get(this.props.userStore, 'user.capabilities.canSelectStudy', true);\n  }\n\n  get isExternalUser() {\n    // Both external guests and external researchers are considered external users\n    return _.get(this.props.userStore, 'user.isExternalUser', true);\n  }\n\n  get hasProjects() {\n    return _.get(this.props.userStore, 'user.hasProjects', true);\n  }\n\n  handleNext = () => {\n    if (this.envTypeId) {\n      this.goto(`/studies/setup-workspace/type/${encodeURIComponent(this.envTypeId)}`);\n    } else {\n      this.goto('/studies/setup-workspace');\n    }\n  };\n\n  render() {\n    const canSelectStudy = this.canSelectStudy;\n\n    return (\n      <Container className=\"mt3\">\n        {this.renderTitle()}\n        {canSelectStudy && this.renderStepsProgress()}\n        {this.renderSelection()}\n        {this.renderStudyTabs()}\n      </Container>\n    );\n  }\n\n  renderTitle() {\n    const canCreateStudy = this.canCreateStudy;\n    const hasProjects = this.hasProjects;\n    return (\n      <div className=\"flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"book\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Studies</Header.Content>\n        </Header>\n        {canCreateStudy && hasProjects && <CreateStudy />}\n      </div>\n    );\n  }\n\n  renderStepsProgress() {\n    return <StudyStepsProgress envTypeImmutable={!!this.envTypeId} />;\n  }\n\n  renderStudyTabs() {\n    const isExternalUser = this.isExternalUser;\n    const getMenuItemLabel = category => {\n      const store = this.getStudiesStore(category);\n      const emptySpan = null;\n      if (!store) return emptySpan;\n      if (isStoreError(store)) return emptySpan;\n      if (isStoreNew(store)) return emptySpan;\n      if (isStoreLoading(store)) return emptySpan;\n      return <Label>{niceNumber(store.total)}</Label>;\n    };\n\n    // Create tab panes for each study category. If the user is not external user, then myStudies pane should not be shown\n    const applicableCategories = _.filter(categories, category => {\n      if (category.id === 'my-studies' && isExternalUser) return false;\n      return true;\n    });\n\n    const studyPanes = _.map(applicableCategories, category => ({\n      menuItem: (\n        <Menu.Item key={category.id}>\n          {category.name} {getMenuItemLabel(category)}\n        </Menu.Item>\n      ),\n      render: () => (\n        <Tab.Pane attached={false} key={category.id} as={TabPaneWrapper}>\n          <Observer>{() => <StudiesTab category={category} />}</Observer>\n        </Tab.Pane>\n      ),\n    }));\n\n    return <Tab className=\"mt3\" menu={{ secondary: true, pointing: true }} renderActiveOnly panes={studyPanes} />;\n  }\n\n  renderSelection() {\n    const selection = this.props.filesSelection;\n    const empty = selection.empty;\n    const count = selection.count;\n    const canCreateStudy = this.canCreateStudy;\n    const canSelectStudy = this.canSelectStudy;\n    const hasProjects = this.hasProjects;\n\n    if (empty && canCreateStudy && canSelectStudy && hasProjects) {\n      return this.renderWarningWithButton({\n        content: (\n          <>\n            Select one or more studies to proceed to the next step or create a study by clicking on <b>Create Study</b>{' '}\n            button at the top.\n          </>\n        ),\n      });\n    }\n\n    if (empty && canCreateStudy && canSelectStudy && !hasProjects) {\n      return this.renderWarning({\n        header: 'Missing association with one or more projects!',\n        content:\n          \"You won't be able to select or create studies because you currently don't have any association with one or more projects, please contact your administrator.\",\n      });\n    }\n\n    if (empty && canSelectStudy && !canCreateStudy) {\n      return this.renderWarningWithButton({\n        content: 'Select one or more studies to proceed to the next step.',\n      });\n    }\n\n    if (empty) {\n      return this.renderWarning({\n        header: 'Limited access',\n        content:\n          'You currently have limited access and will not be able to select studies to proceed to the next step.',\n      });\n    }\n\n    return (\n      <Message visible className=\"clearfix\" info>\n        <Button icon labelPosition=\"right\" className=\"ml2\" floated=\"right\" onClick={this.handleNext} color=\"blue\">\n          Next\n          <Icon name=\"right arrow\" />\n        </Button>\n        {// If envTypeId is present then it means we landed on this page after\n        // env type selection from workspace-type-management page.\n        // Show previous button in this case to allow to go back to workspace-type-management screen\n        this.envTypeId && (\n          <Button\n            floated=\"right\"\n            icon=\"left arrow\"\n            labelPosition=\"left\"\n            className=\"ml2\"\n            content=\"Previous\"\n            onClick={this.handlePrevious}\n          />\n        )}\n        <div className=\"mt1\">\n          <span>\n            Selected studies\n            <Label circular color=\"blue\" className=\"ml1\">\n              {niceNumber(count)}\n            </Label>{' '}\n          </span>\n        </div>\n      </Message>\n    );\n  }\n\n  renderWarning({ header, content }) {\n    return (\n      <Message icon warning className=\"mt2\">\n        <Icon name=\"warning\" />\n        <Message.Content>\n          <Message.Header>{header}</Message.Header>\n          <p>{content}</p>\n        </Message.Content>\n      </Message>\n    );\n  }\n\n  renderWarningWithButton({ content }) {\n    return (\n      <Message visible className=\"clearfix\" warning>\n        <Button icon labelPosition=\"right\" className=\"ml2\" floated=\"right\" disabled>\n          Next\n          <Icon name=\"right arrow\" />\n        </Button>\n        {// If envTypeId is present then it means we landed on this page after\n        // env type selection from workspace-type-management page.\n        // Show previous button in this case to allow to go back to workspace-type-management screen\n        this.envTypeId && (\n          <Button\n            floated=\"right\"\n            icon=\"left arrow\"\n            labelPosition=\"left\"\n            className=\"ml2\"\n            content=\"Previous\"\n            onClick={this.handlePrevious}\n          />\n        )}\n        <div className=\"mt1\">{content}</div>\n      </Message>\n    );\n  }\n\n  handlePrevious = () => {\n    this.goto('/workspace-types-management');\n  };\n\n  get envTypeId() {\n    return (this.props.match.params || {}).envTypeId;\n  }\n}\n\ndecorate(StudiesPage, {\n  getStudiesStore: observable,\n  canCreateStudy: computed,\n  canSelectStudy: computed,\n  hasProjects: computed,\n  isExternalUser: computed,\n  handleNext: action,\n});\n\nexport default inject('filesSelection', 'studiesStoresMap', 'userStore')(withRouter(observer(StudiesPage)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable max-classes-per-file */\nimport React from 'react';\nimport _ from 'lodash';\nimport { computed, decorate } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { Header, Icon, Segment } from 'semantic-ui-react';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreLoading, isStoreError, isStoreReady, isStoreEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\nimport StudyRow from './StudyRow';\nimport { categories } from '../../models/studies/categories';\n\n// expected props\n// - category (an object with the shape { name, id})\n// - studiesStoresMap (via injection)\n// - userStore (via injection)\nclass StudiesTab extends React.Component {\n  get studiesStore() {\n    return this.props.studiesStoresMap[this.props.category.id];\n  }\n\n  componentDidMount() {\n    const store = this.studiesStore;\n    if (!store) return;\n    if (!isStoreReady(store)) swallowError(store.load());\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.studiesStore;\n    if (!store) return;\n    store.stopHeartbeat();\n  }\n\n  get canCreateStudy() {\n    return _.get(this.props.userStore, 'user.capabilities.canCreateStudy', true) && this.hasProjects;\n  }\n\n  get canSelectStudy() {\n    const can = _.get(this.props.userStore, 'user.capabilities.canSelectStudy', true);\n    if (!can) return can; // If can't select study, then return early, no need to examine if the user is internal and does not have projects\n    if (!this.isExternalUser) return this.hasProjects;\n\n    return can;\n  }\n\n  get isExternalUser() {\n    // Both external guests and external researchers are considered external users\n    return _.get(this.props.userStore, 'user.isExternalUser', true);\n  }\n\n  get hasProjects() {\n    return _.get(this.props.userStore, 'user.hasProjects', true);\n  }\n\n  render() {\n    const studiesStore = this.studiesStore;\n    if (!studiesStore) return null;\n\n    // Render loading, error, or tab content\n    let content;\n    if (isStoreError(studiesStore)) {\n      content = <ErrorBox error={studiesStore.error} className=\"mt3 mr0 ml0\" />;\n    } else if (isStoreLoading(studiesStore)) {\n      content = <BasicProgressPlaceholder segmentCount={3} className=\"mt3 mr0 ml0\" />;\n    } else if (isStoreEmpty(studiesStore)) {\n      content = this.renderEmpty();\n    } else {\n      content = this.renderContent();\n    }\n\n    return content;\n  }\n\n  renderContent() {\n    const studiesStore = this.studiesStore;\n    const isSelectable = this.canSelectStudy;\n    return (\n      <div className=\"mt3 mr0 ml0\">\n        {studiesStore.list.map(study => (\n          <StudyRow key={study.id} study={study} isSelectable={isSelectable} />\n        ))}\n      </div>\n    );\n  }\n\n  renderEmpty() {\n    const categoryId = this.props.category.id;\n    const isOpenData = categoryId === categories.openData.id;\n    const isOrgData = categoryId === categories.organization.id;\n    const canCreateStudy = this.canCreateStudy;\n\n    let header = 'No studies';\n    let subheader = canCreateStudy ? (\n      <>\n        To create a study, click on the <b>Create Study</b> button at the top.\n      </>\n    ) : (\n      ''\n    );\n\n    if (isOpenData) {\n      header = 'No studies from the Open Data project';\n      subheader = 'The information in this page is updated once a day, please come back later.';\n    }\n\n    if (isOrgData) {\n      header = 'No studies shared with you';\n      subheader = (\n        <>\n          <div>\n            Studies created at the organization level can be shared but you don&apos;t have any that is shared with you.\n          </div>\n          {canCreateStudy && (\n            <div>\n              You can create one yourself by clicking on the <b>Create Study</b> button at the top.\n            </div>\n          )}\n          {!canCreateStudy && (\n            <div>\n              Consider viewing the Open Data studies by clicking on the <span>Open Data</span> tab above.\n            </div>\n          )}\n        </>\n      );\n    }\n\n    return (\n      <Segment placeholder className=\"mt3\">\n        <Header icon className=\"color-grey\">\n          <Icon name=\"clipboard outline\" />\n          {header}\n          <Header.Subheader>{subheader}</Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n}\n\ndecorate(StudiesTab, {\n  studiesStore: computed,\n  canCreateStudy: computed,\n  canSelectStudy: computed,\n  hasProjects: computed,\n  isExternalUser: computed,\n});\n\nexport default inject('studiesStoresMap', 'userStore')(observer(StudiesTab));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { decorate, action, computed, runInAction, observable } from 'mobx';\nimport { inject, observer } from 'mobx-react';\nimport { Header, Checkbox, Segment, Accordion, Icon } from 'semantic-ui-react';\nimport c from 'classnames';\n\nimport StudyFilesTable from './StudyFilesTable';\nimport StudyPermissionsTable from './StudyPermissionsTable';\nimport UploadStudyFiles from './UploadStudyFiles';\n\n// expected props\n// - study (via props)\n// - isSelectable (via props)\n// - filesSelection (via injection)\nclass StudyRow extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.filesExpanded = false;\n      this.permissionsExpanded = false;\n    });\n  }\n\n  get study() {\n    return this.props.study;\n  }\n\n  get isSelectable() {\n    return this.props.isSelectable;\n  }\n\n  handleFileSelection = study => {\n    const selection = this.props.filesSelection;\n    if (selection.hasFile(study.id)) {\n      selection.deleteFile(study.id);\n    } else {\n      const { id, name, description } = study;\n      // TODO: actually do different statuses?\n      selection.setFile({ id, name, description, accessStatus: 'approved' });\n    }\n  };\n\n  handleFilesExpanded = () => {\n    this.filesExpanded = !this.filesExpanded;\n  };\n\n  handlePermissionsExpanded = () => {\n    this.permissionsExpanded = !this.permissionsExpanded;\n  };\n\n  render() {\n    const isSelectable = this.isSelectable; // Internal and external guests can't select studies\n    const study = this.study;\n    const selection = this.props.filesSelection;\n    const isSelected = selection.hasFile(study.id);\n    const attrs = {};\n    const onClickAttr = {};\n\n    if (isSelected) attrs.color = 'blue';\n    if (isSelectable) onClickAttr.onClick = () => this.handleFileSelection(study);\n\n    return (\n      <Segment clearing padded raised className=\"mb3\" {...attrs}>\n        <div className=\"flex\">\n          <div className=\"mr2\" {...onClickAttr}>\n            {isSelectable && <Checkbox checked={isSelected} style={{ marginTop: '3px' }} />}\n          </div>\n          <div className=\"flex-auto mb1\">\n            {this.renderHeader(study)}\n            {this.renderDescription(study)}\n            {this.renderFilesAccordion(study)}\n            {this.renderPermissionsAccordion(study)}\n          </div>\n        </div>\n      </Segment>\n    );\n  }\n\n  renderHeader(study) {\n    const isSelectable = this.isSelectable; // Internal and external guests can't select studies\n    const onClickAttr = {};\n\n    if (isSelectable) onClickAttr.onClick = () => this.handleFileSelection(study);\n\n    return (\n      <>\n        {study.uploadLocationEnabled && study.canUpload && <UploadStudyFiles studyId={study.id} />}\n        <Header as=\"h3\" color=\"blue\" className={c('mt0', isSelectable ? 'cursor-pointer' : '')} {...onClickAttr}>\n          {study.name}\n          <Header.Subheader>\n            <span className=\"pt1 fs-8 color-grey\">{study.id}</span>\n            {study.projectId && <span className=\"fs-8 color-grey\"> &middot; {study.projectId}</span>}\n          </Header.Subheader>\n        </Header>\n      </>\n    );\n  }\n\n  renderDescription(study) {\n    return <div>{study.description}</div>;\n  }\n\n  renderFilesAccordion(study) {\n    if (study.isOpenDataStudy) return null;\n    if (!study.uploadLocationEnabled) return null;\n    const expanded = this.filesExpanded;\n\n    return (\n      <Accordion className=\"mt2\">\n        <Accordion.Title active={expanded} index={0} onClick={this.handleFilesExpanded}>\n          <Icon name=\"dropdown\" />\n          <b>Files</b>\n        </Accordion.Title>\n        <Accordion.Content active={expanded}>\n          {expanded && study.uploadLocationEnabled && (\n            <div className=\"mb2\">\n              <StudyFilesTable study={study} />\n            </div>\n          )}\n        </Accordion.Content>\n      </Accordion>\n    );\n  }\n\n  renderPermissionsAccordion(study) {\n    if (!study.isOrganizationStudy) return null;\n    const expanded = this.permissionsExpanded;\n\n    return (\n      <Accordion className=\"mt0\">\n        <Accordion.Title active={expanded} index={0} onClick={this.handlePermissionsExpanded}>\n          <Icon name=\"dropdown\" />\n          <b>Permissions</b>\n        </Accordion.Title>\n        <Accordion.Content active={expanded}>{expanded && <StudyPermissionsTable study={study} />}</Accordion.Content>\n      </Accordion>\n    );\n  }\n}\n\ndecorate(StudyRow, {\n  handleFileSelection: action,\n  handleFilesExpanded: action,\n  handlePermissionsExpanded: action,\n  study: computed,\n  filesExpanded: observable,\n  permissionsExpanded: observable,\n  isSelectable: computed,\n});\n\nexport default inject('filesSelection')(observer(StudyRow));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observable, runInAction, decorate } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { Table, Segment, Header, Icon } from 'semantic-ui-react';\n\nimport { formatBytes, swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreError, isStoreLoading, isStoreEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\n// expected props\n// - study\nclass StudyFilesTable extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.filesStore = props.study.getFilesStore();\n    });\n  }\n\n  componentDidMount() {\n    swallowError(this.filesStore.load());\n    this.filesStore.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    this.filesStore.stopHeartbeat();\n  }\n\n  render() {\n    const store = this.filesStore;\n    // Render loading, error, or tab content\n    let content;\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"m0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder segmentCount={1} />;\n    } else if (isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else {\n      content = this.renderTable();\n    }\n\n    return content;\n  }\n\n  renderTable() {\n    return (\n      <>\n        <Table striped>\n          <Table.Header>\n            <Table.Row>\n              <Table.HeaderCell>Filename</Table.HeaderCell>\n              <Table.HeaderCell>Size</Table.HeaderCell>\n              <Table.HeaderCell>Last Modified</Table.HeaderCell>\n            </Table.Row>\n          </Table.Header>\n\n          <Table.Body>\n            {this.filesStore.files.map(file => (\n              <Table.Row key={file.filename}>\n                <Table.Cell>{file.filename}</Table.Cell>\n                <Table.Cell>{formatBytes(file.size)}</Table.Cell>\n                <Table.Cell>{file.lastModified.toISOString()}</Table.Cell>\n              </Table.Row>\n            ))}\n          </Table.Body>\n        </Table>\n      </>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <Segment placeholder className=\"mt0\">\n        <Header icon className=\"color-grey\">\n          <Icon name=\"file outline\" />\n          No files\n          <Header.Subheader>No files are uploaded yet for this study</Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n}\n\ndecorate(StudyFilesTable, {\n  filesStore: observable,\n});\n\nexport default observer(StudyFilesTable);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { action, decorate, observable, runInAction } from 'mobx';\nimport { inject, observer } from 'mobx-react';\nimport { Button, Dimmer, Dropdown, Loader, Icon, Table } from 'semantic-ui-react';\n\nimport { displayError, displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreError, isStoreLoading, isStoreNew } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport UserLabels from '@aws-ee/base-ui/dist/parts/helpers/UserLabels';\n\n// expected props\n// - study\n// - userStore (via injection)\n// - usersStore (via injection)\nclass StudyPermissionsTable extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.permissionsStore = props.study.getPermissionsStore();\n      this.currUser = props.userStore.user;\n      this.usersStore = props.usersStore;\n\n      this.resetForm();\n    });\n  }\n\n  componentDidMount() {\n    swallowError(this.permissionsStore.load());\n    this.permissionsStore.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    this.permissionsStore.stopHeartbeat();\n  }\n\n  enableEditMode = () => {\n    // Set users who currently have permission to the study as the selected users\n    this.permissionsStore.studyPermissions.userTypes.forEach(userType => {\n      this.selectedUserIds[userType] = this.permissionsStore.studyPermissions[`${userType}Users`];\n    });\n\n    // Show edit dropdowns via observable\n    this.editModeOn = true;\n  };\n\n  resetForm = () => {\n    this.editModeOn = false;\n    this.isProcessing = false;\n    this.selectedUserIds = {};\n  };\n\n  submitUpdate = async () => {\n    runInAction(() => {\n      this.isProcessing = true;\n    });\n\n    // Perform update\n    try {\n      await this.permissionsStore.update(this.selectedUserIds);\n      displaySuccess('Update Succeeded');\n      runInAction(() => {\n        this.resetForm();\n      });\n    } catch (error) {\n      displayError('Update Failed', error);\n      runInAction(() => {\n        this.isProcessing = false;\n      });\n    }\n  };\n\n  render() {\n    // Render loading, error, or permissions table\n    let content;\n    if (isStoreError(this.permissionsStore)) {\n      content = <ErrorBox error={this.permissionsStore.error} className=\"mt0\" />;\n    } else if (isStoreLoading(this.permissionsStore) || isStoreNew(this.permissionsStore)) {\n      content = <BasicProgressPlaceholder segmentCount={1} />;\n    } else {\n      content = this.renderTable();\n    }\n\n    return content;\n  }\n\n  renderTable() {\n    const studyPermissions = this.permissionsStore.studyPermissions;\n    const isEditable = studyPermissions.adminUsers.some(uid => uid === this.currUser.uid);\n\n    return (\n      <>\n        <Dimmer.Dimmable dimmed={this.isProcessing}>\n          <Dimmer active={this.isProcessing} inverted>\n            <Loader size=\"big\" />\n          </Dimmer>\n          <Table striped className=\"mt0\">\n            <Table.Header>\n              <Table.Row>\n                <Table.HeaderCell width={2}>Permission Level</Table.HeaderCell>\n                <Table.HeaderCell>\n                  Users\n                  {isEditable && !this.editModeOn && (\n                    <Icon name=\"pencil\" className=\"ml1 cursor-pointer\" color=\"grey\" onClick={this.enableEditMode} />\n                  )}\n                </Table.HeaderCell>\n              </Table.Row>\n            </Table.Header>\n\n            <Table.Body>\n              {this.permissionsStore.studyPermissions.userTypes.map(userType => {\n                const uids = studyPermissions[`${userType}Users`];\n                const userIdentifiers = _.map(uids, uid => ({ uid }));\n                const users = this.usersStore.asUserObjects(userIdentifiers);\n                return (\n                  <Table.Row key={userType}>\n                    <Table.Cell style={{ textTransform: 'capitalize' }}>{userType}</Table.Cell>\n                    <Table.Cell>\n                      {this.editModeOn ? this.renderUsersDropdown(userType) : <UserLabels users={users} />}\n                    </Table.Cell>\n                  </Table.Row>\n                );\n              })}\n            </Table.Body>\n          </Table>\n\n          {this.editModeOn && (\n            <>\n              <Button\n                floated=\"right\"\n                disabled={this.isProcessing}\n                onClick={this.submitUpdate}\n                size=\"mini\"\n                color=\"blue\"\n                icon\n              >\n                Submit\n              </Button>\n\n              <Button floated=\"right\" disabled={this.isProcessing} onClick={this.resetForm} size=\"mini\">\n                Cancel\n              </Button>\n            </>\n          )}\n        </Dimmer.Dimmable>\n      </>\n    );\n  }\n\n  renderUsersDropdown(userType) {\n    const dropdownOnChange = action((_event, data) => {\n      this.selectedUserIds[userType] = data.value;\n    });\n\n    return (\n      <Dropdown\n        selection\n        fluid\n        multiple\n        search\n        options={this.usersStore.asDropDownOptions()}\n        value={this.selectedUserIds[userType]}\n        placeholder=\"Select users\"\n        onChange={dropdownOnChange}\n      />\n    );\n  }\n}\n\ndecorate(StudyPermissionsTable, {\n  editModeOn: observable,\n  isProcessing: observable,\n  selectedUserIds: observable,\n\n  enableEditMode: action,\n  resetForm: action,\n  submitUpdate: action,\n});\nexport default inject('userStore', 'usersStore')(observer(StudyPermissionsTable));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Label } from 'semantic-ui-react';\n\nconst UserLabels = props => {\n  const { color, className = '', users } = props;\n\n  return (\n    <div className={className}>\n      {_.map(users, user => (\n        <Label key={user.username} color={color} image className=\"mt1\">\n          {user.firstName}\n          {user.lastName}\n          <Label.Detail>\n            {user.unknown && `${user.username}??`}\n            {!user.unknown && (user.email || user.username)}\n          </Label.Detail>\n        </Label>\n      ))}\n    </div>\n  );\n};\n\nexport default observer(UserLabels);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { action, decorate, observable, runInAction } from 'mobx';\nimport { Button, Header, Modal } from 'semantic-ui-react';\n\nimport FileUpload from '../files/FileUpload';\nimport { getPresignedStudyUploadRequests } from '../../helpers/api';\nimport upload from '../../helpers/xhr-upload';\n\n// expected props\n// - studyId\nclass UploadStudyFiles extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.modalOpen = false;\n    });\n    this.fileUploadHandler = this.fileUploadHandler.bind(this);\n  }\n\n  async fileUploadHandler(fileUpload) {\n    const file = fileUpload.getFile();\n    if (!file) {\n      throw new Error('No file');\n    }\n\n    // Get presigned POST request\n    let uploadRequest;\n    try {\n      const presignResult = await getPresignedStudyUploadRequests(this.props.studyId, fileUpload.name);\n      uploadRequest = presignResult[fileUpload.name];\n    } catch (error) {\n      const errMessage = 'Error occurred obtaining presigned request';\n      console.error(`${errMessage}:`, error);\n      throw new Error(errMessage);\n    }\n\n    if (!uploadRequest) {\n      throw new Error('Failed to obtain presigned request');\n    }\n\n    // Upload file\n    const uploadHandle = upload(file, uploadRequest.url, uploadRequest.fields);\n    fileUpload.setCancel(uploadHandle.cancel);\n    uploadHandle.onProgress(fileUpload.updateProgress);\n\n    try {\n      await uploadHandle.done;\n    } catch (error) {\n      const errMessage = 'Error encountered while uploading file';\n      console.error(`${errMessage}:`, error);\n      throw new Error(errMessage);\n    }\n  }\n\n  render() {\n    return (\n      <Modal\n        closeIcon\n        trigger={this.renderTrigger()}\n        open={this.modalOpen}\n        onClose={action(() => {\n          this.modalOpen = false;\n        })}\n      >\n        <div className=\"mt2 animated fadeIn\">\n          <Header as=\"h3\" icon textAlign=\"center\" className=\"mt3\" color=\"grey\">\n            Upload Study Files\n          </Header>\n          <div className=\"mx3 animated fadeIn\">\n            <FileUpload resourceId={this.props.studyId} fileUploadHandler={this.fileUploadHandler} />\n          </div>\n        </div>\n      </Modal>\n    );\n  }\n\n  renderTrigger() {\n    return (\n      <Button\n        floated=\"right\"\n        color=\"blue\"\n        basic\n        onClick={action(() => {\n          this.modalOpen = true;\n        })}\n      >\n        Upload Files\n      </Button>\n    );\n  }\n}\n\ndecorate(UploadStudyFiles, {\n  modalOpen: observable,\n});\n\nexport default observer(UploadStudyFiles);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { decorate, observable, runInAction } from 'mobx';\nimport { inject, observer, PropTypes as MobXPropTypes } from 'mobx-react';\nimport PropTypes from 'prop-types';\n\nimport React from 'react';\nimport { Button, Grid, Header, Segment } from 'semantic-ui-react';\n\nimport { displayError, displaySuccess, displayWarning } from '@aws-ee/base-ui/dist/helpers/notification';\n\nimport StudyFileDropZone from './FileDropZone';\nimport FileUploadTable from './FileUploadTable';\n\nconst FileUpload = observer(\n  ({\n    files = [],\n    state = 'PENDING',\n    onCancelSelectFiles,\n    onCancelUpload,\n    onClickStartUpload,\n    onClickUploadMore,\n    onSelectFiles,\n    onClickRemoveFile,\n    onClickCancelFile,\n  }) => {\n    return (\n      <Segment vertical>\n        <Header as=\"h3\">Upload Files</Header>\n        <StudyFileDropZone state={state} onSelectFiles={onSelectFiles} />\n        {files.length > 0 && (\n          <Segment>\n            <Grid>\n              <Grid.Row>\n                <Grid.Column>\n                  <FileUploadTable\n                    files={files}\n                    state={state}\n                    onClickRemoveFile={onClickRemoveFile}\n                    onClickCancelFile={onClickCancelFile}\n                  />\n                </Grid.Column>\n              </Grid.Row>\n              <Grid.Row>\n                <Grid.Column>\n                  {state === 'PENDING' ? (\n                    <Button floated=\"right\" basic color=\"blue\" onClick={onClickStartUpload}>\n                      Upload Files\n                    </Button>\n                  ) : state === 'UPLOADING' ? (\n                    <Button floated=\"right\" basic color=\"blue\" loading disabled>\n                      Uploading\n                    </Button>\n                  ) : state === 'COMPLETE' ? (\n                    <Button floated=\"right\" basic color=\"blue\" onClick={onClickUploadMore}>\n                      Upload More Files\n                    </Button>\n                  ) : null}\n                  {state === 'PENDING' ? (\n                    <Button floated=\"right\" basic onClick={onCancelSelectFiles}>\n                      Cancel\n                    </Button>\n                  ) : state === 'UPLOADING' ? (\n                    <Button floated=\"right\" basic onClick={onCancelUpload}>\n                      Cancel\n                    </Button>\n                  ) : null}\n                </Grid.Column>\n              </Grid.Row>\n            </Grid>\n          </Segment>\n        )}\n      </Segment>\n    );\n  },\n);\nFileUpload.propTypes = {\n  files: PropTypes.arrayOf(\n    PropTypes.shape({\n      name: PropTypes.string.isRequired,\n      size: PropTypes.number.isRequired,\n      status: PropTypes.oneOf(['PENDING', 'UPLOADING', 'COMPLETE', 'FAILED']).isRequired,\n      uploaded: PropTypes.number,\n      error: PropTypes.string,\n    }),\n  ),\n  state: PropTypes.oneOf(['PENDING', 'UPLOADING', 'COMPLETE']).isRequired,\n  onCancelSelectFiles: PropTypes.func,\n  onCancelUpload: PropTypes.func,\n  onClickStartUpload: PropTypes.func,\n  onClickUploadMore: PropTypes.func,\n  onSelectFiles: PropTypes.func,\n  onClickRemoveFile: PropTypes.func,\n  onClickCancelFile: PropTypes.func,\n};\n\nclass ConnectedFileUpload extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.fileUploadGroup = props.fileUploadsStore.getFileUploadGroup(this.props.resourceId);\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.resourceId !== this.props.resourceId) {\n      runInAction(() => {\n        this.fileUploadGroup = this.props.fileUploadsStore.getFileUploadGroup(this.props.resourceId);\n      });\n    }\n  }\n\n  handleResetFileUploadGroup = () => {\n    runInAction(() => {\n      this.props.fileUploadsStore.resetFileUploadGroup(this.props.resourceId);\n      this.fileUploadGroup = this.props.fileUploadsStore.getFileUploadGroup(this.props.resourceId);\n    });\n  };\n\n  handleCancel = () => {\n    this.fileUploadGroup.cancel();\n  };\n\n  handleStart = async () => {\n    const group = this.fileUploadGroup;\n    try {\n      await group.start(this.props.fileUploadHandler);\n      let success = 0;\n      let errors = 0;\n      group.fileUploadObjects.forEach(fileUpload => {\n        // eslint-disable-next-line default-case\n        switch (fileUpload.status) {\n          case 'COMPLETE':\n            success++;\n            break;\n          case 'FAILED':\n            if (fileUpload.error !== 'Cancelled') {\n              errors++;\n            }\n            break;\n        }\n      });\n      if (errors > 0 && success > 0) {\n        displayWarning(`File uploads completed with ${errors} errors`);\n      } else if (errors > 0) {\n        displayError(`File uploads failed`);\n      } else if (success > 0) {\n        displaySuccess(`File uploads completed successfully!`);\n      }\n    } catch (err) {\n      displayError(`File uploads failed: ${err}`);\n    }\n  };\n\n  handleCancelFileUpload = id => {\n    const fileUpload = this.fileUploadGroup.getFileUpload(id);\n    if (fileUpload) {\n      fileUpload.doCancel();\n    }\n  };\n\n  handleRemoveFileUpload = id => {\n    this.fileUploadGroup.remove(id);\n  };\n\n  handleSelectFiles = files => {\n    const group = this.fileUploadGroup;\n    files.forEach(file => {\n      group.add({ file });\n    });\n  };\n\n  render() {\n    return (\n      <FileUpload\n        files={this.fileUploadGroup.fileUploadObjects}\n        state={this.fileUploadGroup.state}\n        onCancelSelectFiles={this.handleResetFileUploadGroup}\n        onCancelUpload={this.handleCancel}\n        onClickStartUpload={this.handleStart}\n        onClickUploadMore={this.handleResetFileUploadGroup}\n        onSelectFiles={this.handleSelectFiles}\n        onClickRemoveFile={this.handleRemoveFileUpload}\n        onClickCancelFile={this.handleCancelFileUpload}\n      />\n    );\n  }\n}\nConnectedFileUpload.propTypes = {\n  resourceId: PropTypes.string.isRequired,\n  fileUploadHandler: PropTypes.func.isRequired,\n  fileUploadsStore: MobXPropTypes.observableObject.isRequired,\n};\n\ndecorate(ConnectedFileUpload, {\n  fileUploadGroup: observable,\n});\nexport default inject('fileUploadsStore')(observer(ConnectedFileUpload));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { decorate, observable, runInAction } from 'mobx';\nimport { observer } from 'mobx-react';\nimport PropTypes from 'prop-types';\n\nimport { Segment, Header, Divider, Button, Icon } from 'semantic-ui-react';\nimport uuidv4 from 'uuid/v4';\n\n/**\n * A reusable file input component.\n * Motivation: <input type=\"file\" /> components are stateful and behave unexpectedly\n * when attempting to reuse them to upload multiple files.\n */\nconst ReusableFileInput = React.forwardRef(({ onChange, ...props }, ref) => {\n  const [inputKey, setInputKey] = React.useState(uuidv4());\n  return (\n    <input\n      key={inputKey}\n      ref={ref}\n      type=\"file\"\n      onChange={event => {\n        onChange(event);\n        setInputKey(uuidv4());\n      }}\n      {...props}\n    />\n  );\n});\n\nclass FileDropZone extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.highlighted = false;\n    });\n  }\n\n  setHighlight(isHighlighted) {\n    runInAction(() => {\n      this.highlighted = isHighlighted;\n    });\n  }\n\n  render() {\n    const fileInputRef = React.createRef();\n    const enabled = this.props.state === 'PENDING';\n    return (\n      <Segment\n        tertiary={this.highlighted}\n        placeholder\n        onDragEnter={event => {\n          if (enabled) {\n            if (event.dataTransfer.types.includes('Files')) {\n              event.preventDefault();\n              this.setHighlight(true);\n            }\n          }\n        }}\n        onDragOver={event => {\n          if (enabled) {\n            if (event.dataTransfer.types.includes('Files')) {\n              event.preventDefault();\n              this.setHighlight(true);\n            }\n          }\n        }}\n        onDragLeave={() => {\n          this.setHighlight(false);\n        }}\n        onDragEnd={() => {\n          this.setHighlight(false);\n        }}\n        onDrop={event => {\n          if (enabled) {\n            if (event.dataTransfer.types.includes('Files')) {\n              event.preventDefault();\n              this.setHighlight(false);\n              const fileList = event.dataTransfer.files || [];\n              this.props.onSelectFiles([...fileList]);\n            }\n          }\n        }}\n      >\n        <Header icon color=\"grey\">\n          <ReusableFileInput\n            ref={fileInputRef}\n            hidden\n            multiple\n            onChange={event => {\n              if (this.props.onSelectFiles) {\n                const fileList = event.currentTarget.files || [];\n                this.props.onSelectFiles([...fileList]);\n              }\n            }}\n          />\n          {this.props.state === 'PENDING' ? (\n            <>\n              <Icon name=\"upload\" className=\"mb2\" />\n              Drag and drop\n              <Divider horizontal>Or</Divider>\n              <Button\n                basic\n                color=\"blue\"\n                onClick={() => {\n                  if (fileInputRef.current) {\n                    fileInputRef.current.click();\n                  }\n                }}\n              >\n                Browse Files\n              </Button>\n            </>\n          ) : this.props.state === 'UPLOADING' ? (\n            <>\n              <Icon loading name=\"circle notch\" className=\"mb2\" />\n              Uploading\n            </>\n          ) : this.props.state === 'COMPLETE' ? (\n            <>\n              <Icon name=\"check\" className=\"mb2\" />\n              Upload Complete\n            </>\n          ) : null}\n        </Header>\n      </Segment>\n    );\n  }\n}\nFileDropZone.propTypes = {\n  state: PropTypes.oneOf(['PENDING', 'UPLOADING', 'COMPLETE']).isRequired,\n  onSelectFiles: PropTypes.func,\n};\nFileDropZone.defaultProps = {\n  onSelectFiles: null,\n};\n\ndecorate(FileDropZone, {\n  setHighlight: observable,\n});\nexport default observer(FileDropZone);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport prettyBytes from 'pretty-bytes';\nimport { observer } from 'mobx-react';\nimport { Button, Icon, Progress, Table } from 'semantic-ui-react';\n\nconst FileUploadStatus = observer(({ file }) =>\n  file.status === 'PENDING' ? (\n    'Pending'\n  ) : file.status === 'UPLOADING' ? (\n    <Progress\n      size=\"small\"\n      className=\"mb0\"\n      indicating\n      autoSuccess\n      progress\n      percent={Math.floor((file.uploaded / file.size) * 100)}\n    />\n  ) : file.status === 'FAILED' ? (\n    <>\n      <Icon name=\"times\" color=\"red\" /> {`${file.error || 'Error'}`}\n    </>\n  ) : file.status === 'COMPLETE' ? (\n    <>\n      <Icon name=\"check\" color=\"green\" /> Complete\n    </>\n  ) : (\n    'Unknown'\n  ),\n);\n\nconst FileUploadToolbar = observer(({ file, state, onClickRemove, onClickCancel }) =>\n  file.status === 'PENDING' ? (\n    <Button\n      floated=\"right\"\n      icon=\"trash\"\n      size=\"tiny\"\n      basic\n      color=\"grey\"\n      onClick={onClickRemove}\n      disabled={state !== 'PENDING'}\n    />\n  ) : file.status === 'UPLOADING' ? (\n    <Button floated=\"right\" icon=\"remove\" size=\"tiny\" basic color=\"red\" onClick={onClickCancel} />\n  ) : null,\n);\n\nconst FileUploadRow = observer(({ file, state, onClickRemove, onClickCancel }) => (\n  <Table.Row>\n    <Table.Cell>{file.name}</Table.Cell>\n    <Table.Cell>{prettyBytes(file.size)}</Table.Cell>\n    <Table.Cell>\n      <FileUploadStatus file={file} />\n    </Table.Cell>\n    <Table.Cell>\n      <FileUploadToolbar file={file} state={state} onClickRemove={onClickRemove} onClickCancel={onClickCancel} />\n    </Table.Cell>\n  </Table.Row>\n));\n\nconst FileUploadTable = observer(({ files = [], state, onClickRemoveFile, onClickCancelFile }) => (\n  <Table basic=\"very\">\n    <Table.Header>\n      <Table.Row>\n        <Table.HeaderCell>Filename</Table.HeaderCell>\n        <Table.HeaderCell>Size</Table.HeaderCell>\n        <Table.HeaderCell>Status</Table.HeaderCell>\n        <Table.HeaderCell />\n      </Table.Row>\n    </Table.Header>\n    <Table.Body>\n      {files.map(file => (\n        <FileUploadRow\n          key={file.id}\n          file={file}\n          state={state}\n          onClickRemove={() => onClickRemoveFile(file.id)}\n          onClickCancel={() => onClickCancelFile(file.id)}\n        />\n      ))}\n    </Table.Body>\n  </Table>\n));\n\nexport default FileUploadTable;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/**\n * @typedef {Object} UploadHandle\n * @property {Promise<void>} done a Promise that resolves if the upload completes, or rejects if there is an upload error.\n * @property {() => void} cancel cancels the upload by calling XMLHttpRequest.abort().\n * @property {(callback: (uploadedBytes: number) => void) => void} onProgress used to register event listeners for upload progress events\n */\n\n/**\n * Uploads an HTML file object or a blob using XMLHttpRequest.\n *\n * @params {File|Blob} file\n * @params {sring} url\n * @params {Object<string, any>} fields\n * @returns {UploadHandle}\n */\nconst upload = (file, url, fields = {}) => {\n  const req = new XMLHttpRequest();\n  const uploadProgressListeners = [];\n  const uploadProgressCallback = uploadedBytes => {\n    uploadProgressListeners.forEach(fn => {\n      fn(uploadedBytes);\n    });\n  };\n\n  const done = new Promise((resolve, reject) => {\n    req.upload.addEventListener('progress', event => {\n      uploadProgressCallback(event.loaded || 0);\n    });\n    req.upload.addEventListener('error', () => {\n      reject(new Error('Network Error'));\n    });\n    req.onreadystatechange = () => {\n      if (req.readyState === 4) {\n        // Request is DONE\n        if (req.status === 0) {\n          // Request status is UNSENT\n          reject(new Error('Cancelled'));\n        } else if (req.status >= 400 && req.status <= 599) {\n          // Request received 4xx or 5xx error\n          reject(new Error(`Error: ${req.statusText}`));\n        } else {\n          resolve();\n        }\n      }\n    };\n  });\n\n  const formData = new FormData();\n  Object.entries(fields).forEach(([name, value]) => formData.append(name, value));\n  formData.append('file', file, file.name);\n\n  req.open('POST', url);\n  req.send(formData);\n\n  return {\n    done,\n    cancel() {\n      req.abort();\n    },\n    onProgress(cb) {\n      uploadProgressListeners.push(cb);\n    },\n  };\n};\n\nexport default upload;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { decorate, observable, action, runInAction } from 'mobx';\nimport { Button, Header, Modal, Segment } from 'semantic-ui-react';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport Dropdown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\nimport YesNo from '@aws-ee/base-ui/dist/parts/helpers/fields/YesNo';\n\nimport { getCreateStudyForm } from '../../models/forms/CreateStudy';\nimport { getCategoryById } from '../../models/studies/categories';\n\n// expected props\n// - userStore (via injection)\n// - studiesStoresMap (via injection)\nclass CreateStudy extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.cleanModal();\n      this.form = getCreateStudyForm();\n    });\n  }\n\n  getStudiesStore(categoryId) {\n    return this.props.studiesStoresMap[categoryId];\n  }\n\n  cleanModal = () => {\n    runInAction(() => {\n      this.modalOpen = false;\n    });\n  };\n\n  handleFormCancel = form => {\n    form.clear();\n    this.cleanModal();\n  };\n\n  handleFormError = (_form, _errors) => {};\n\n  handleFormSubmission = async form => {\n    try {\n      const studyValues = form.values();\n      const categoryId = studyValues.categoryId; // Type here is the category id\n      const categoryName = (getCategoryById(categoryId) || {}).name;\n      const studiesStore = this.getStudiesStore(categoryId);\n\n      delete studyValues.categoryId;\n\n      // Create study, clear form, and close modal\n      await studiesStore.createStudy({ ...studyValues, category: categoryName }); // TODO the backend should really accept category id not the category name\n      form.clear();\n      this.cleanModal();\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  render() {\n    return (\n      <Modal closeIcon trigger={this.renderTrigger()} open={this.modalOpen} onClose={this.cleanModal}>\n        <div className=\"mt2\">\n          <Header as=\"h3\" icon textAlign=\"center\" className=\"mt3\" color=\"grey\">\n            Create Study\n          </Header>\n          <div className=\"mx3\">{this.renderCreateStudyForm()}</div>\n        </div>\n      </Modal>\n    );\n  }\n\n  renderTrigger() {\n    return (\n      <Button\n        floated=\"right\"\n        color=\"blue\"\n        onClick={action(() => {\n          this.modalOpen = true;\n        })}\n      >\n        Create Study\n      </Button>\n    );\n  }\n\n  renderCreateStudyForm() {\n    const form = this.form;\n    const projectIds = this.props.userStore.projectIdDropdown;\n\n    return (\n      <Segment clearing className=\"p3 mb3\">\n        <Form form={form} onCancel={this.handleFormCancel} onSuccess={this.handleFormSubmission}>\n          {({ processing, /* onSubmit, */ onCancel }) => (\n            <>\n              <Input field={form.$('id')} />\n              <YesNo field={form.$('categoryId')} />\n              <Input field={form.$('name')} />\n              <TextArea field={form.$('description')} />\n              <Dropdown field={form.$('projectId')} options={projectIds} fluid selection />\n\n              <Button className=\"ml2\" floated=\"right\" color=\"blue\" icon disabled={processing} type=\"submit\">\n                Create Study\n              </Button>\n              <Button floated=\"right\" disabled={processing} onClick={onCancel}>\n                Cancel\n              </Button>\n            </>\n          )}\n        </Form>\n      </Segment>\n    );\n  }\n}\n\ndecorate(CreateStudy, {\n  form: observable,\n  modalOpen: observable,\n  getStudiesStore: observable,\n  cleanModal: action,\n  handleFormSubmission: action,\n});\n\nexport default inject('userStore', 'studiesStoresMap')(observer(CreateStudy));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '../../helpers/form';\nimport { categories } from '../studies/categories';\n\nconst createStudyFields = {\n  // General fields\n  id: {\n    label: 'ID',\n    placeholder: 'A unique ID used to reference the study',\n    extra: {\n      explain: 'Must be less than 100 characters long and only contain alphanumeric characters, \"-\", or \"_\"',\n    },\n    rules: ['required', 'string', 'between:1,100', 'regex:/^[A-Za-z0-9-_]+$/'],\n  },\n  categoryId: {\n    label: '', // not shown because extra.showHeader = false\n    extra: {\n      explain:\n        'If you choose \"My Study\", only you can access it. If you choose \"Organization Study\", you get to decide who can access it.',\n      yesLabel: 'My Study',\n      noLabel: 'Organization Study',\n      yesValue: categories.myStudies.id,\n      noValue: categories.organization.id,\n      showHeader: false,\n    },\n    rules: ['required'],\n  },\n  name: {\n    label: 'Name',\n    placeholder: 'A name for the study',\n    rules: ['string', 'max:2048'],\n  },\n  description: {\n    label: 'Description',\n    placeholder: 'A description of the study',\n    rules: ['string', 'max:8192'],\n  },\n  projectId: {\n    label: 'Project ID',\n    placeholder: 'The project ID associated with this study',\n    rules: ['required', 'string', 'min:1', 'max:100'],\n  },\n};\n\nconst getCreateStudyForm = () => {\n  return createForm(createStudyFields);\n};\n\nexport { getCreateStudyForm }; // eslint-disable-line import/prefer-default-export\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, runInAction, observable, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Icon, Container, Header, Segment, Button } from 'semantic-ui-react';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\n\nimport { enableBuiltInWorkspaces } from '../../helpers/settings';\nimport { CurrentStep } from '../compute/helpers/CurrentStep';\nimport ComputePlatformSetup from '../compute/ComputePlatformSetup';\nimport StudyStepsProgress from './StudyStepsProgress';\nimport ScEnvironmentSetup from '../environments-sc/setup/ScEnvironmentSetup';\n\n// expected props\n// - filesSelection (via injection)\nclass StudyEnvironmentSetup extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      const step = enableBuiltInWorkspaces\n        ? 'selectComputePlatform'\n        : this.envTypeId\n        ? 'selectEnvConfig' // If envTypeId id is passed then jump to env config step\n        : 'selectEnvType';\n      this.currentStep = CurrentStep.create({ step });\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  goto(pathname) {\n    const goto = gotoFn(this);\n    goto(pathname);\n  }\n\n  handlePrevious = () => {\n    if (this.envTypeId) {\n      this.goto(`/studies/workspace-type/${encodeURIComponent(this.envTypeId)}`);\n    } else {\n      this.goto('/studies');\n    }\n  };\n\n  // eslint-disable-next-line no-unused-vars\n  handleCompleted = async environment => {\n    this.props.filesSelection.cleanup();\n    displaySuccess('The research workspace is being provisioned');\n    this.goto('/workspaces');\n  };\n\n  get studyIds() {\n    return this.props.filesSelection.fileNames; // TODO - yes this is confusing, we should refactor the filesSelection to studiesSelection\n  }\n\n  render() {\n    return (\n      <Container className=\"mt3\">\n        {this.renderTitle()}\n        {this.renderStepsProgress()}\n        {this.renderContent()}\n      </Container>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div className=\"flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"book\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Studies</Header.Content>\n        </Header>\n      </div>\n    );\n  }\n\n  renderStepsProgress() {\n    return <StudyStepsProgress currentStep={this.currentStep} envTypeImmutable={!!this.envTypeId} />;\n  }\n\n  renderContent() {\n    const studyIds = this.studyIds;\n\n    if (_.isEmpty(studyIds)) {\n      return this.renderEmpty();\n    }\n\n    let content = null;\n    if (enableBuiltInWorkspaces) {\n      content = (\n        <ComputePlatformSetup\n          currentStep={this.currentStep}\n          studyIds={this.studyIds}\n          onPrevious={this.handlePrevious}\n          onCompleted={this.handleCompleted}\n        />\n      );\n    } else {\n      content = (\n        <ScEnvironmentSetup\n          currentStep={this.currentStep}\n          studyIds={this.studyIds}\n          onPrevious={this.handlePrevious}\n          onCompleted={this.handleCompleted}\n          envTypeId={this.envTypeId}\n          envTypeImmutable={!!this.envTypeId} // If envTypeId is passed already then do not allow selecting it\n        />\n      );\n    }\n\n    return content;\n  }\n\n  renderEmpty() {\n    return (\n      <>\n        <Segment placeholder className=\"mt2\">\n          <Header icon className=\"color-grey\">\n            <Icon name=\"clipboard outline\" />\n            No studies selected\n            <Header.Subheader>\n              Before you can create a workspace, you need to select one or more studies.\n            </Header.Subheader>\n          </Header>\n        </Segment>\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderButtons() {\n    return (\n      <div className=\"mt3\">\n        <Button\n          floated=\"right\"\n          icon=\"right arrow\"\n          labelPosition=\"right\"\n          className=\"ml2\"\n          primary\n          content=\"Next\"\n          disabled\n        />\n        <Button\n          floated=\"right\"\n          icon=\"left arrow\"\n          labelPosition=\"left\"\n          className=\"ml2\"\n          content=\"Previous\"\n          onClick={this.handlePrevious}\n        />\n      </div>\n    );\n  }\n\n  get envTypeId() {\n    return (this.props.match.params || {}).envTypeId;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(StudyEnvironmentSetup, {\n  handlePrevious: action,\n  handleCompleted: action,\n  studyIds: computed,\n  currentStep: observable,\n});\n\nexport default inject('filesSelection')(withRouter(observer(StudyEnvironmentSetup)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\n\nconst categories = {\n  myStudies: { name: 'My Studies', id: 'my-studies' },\n  organization: { name: 'Organization', id: 'organization' },\n  openData: { name: 'Open Data', id: 'open-data' },\n};\n\nfunction getCategoryById(id) {\n  return _.find(categories, ['id', id]);\n}\n\nexport { categories, getCategoryById }; // eslint-disable-line import/prefer-default-export\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Icon } from 'semantic-ui-react';\nimport c from 'classnames';\n\nimport Header from './Header';\nimport Description from './Description';\nimport ErrorPointer from './ErrorPointer';\n\n// expected props\n// - form (via props)\n// - field (via props), this is the mobx form field object\n// - show (via props), can be 'headerOnly', 'toggleOnly', 'both' (default to 'both')\n// - className (via props)\n//\n// The following props are to support existing React Semantic UI props:\n// - disabled (via props), default to false\n// - size (via props), default to large\nconst Component = observer(({ field, disabled = false, show = 'both', className = 'mb4', size = 'large' }) => {\n  const { id, value, sync, error = '', extra = {} } = field;\n  const { yesLabel = 'Yes', noLabel = 'No' } = extra || {};\n  const hasError = !_.isEmpty(error); // IMPORTANT do NOT use field.hasError\n  const isDisabled = field.disabled || disabled;\n  const disabledClass = isDisabled ? 'disabled' : '';\n  const errorClass = hasError ? 'error' : '';\n  const yesSelected = (_.isBoolean(value) && value === true) || value === 'true';\n  const cursor = isDisabled ? 'op-3' : 'cursor-pointer';\n  const handleClick = toAssign => event => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (isDisabled) return;\n    sync(toAssign);\n    field.validate({ showErrors: true });\n  };\n\n  const yesAttributes = {\n    name: 'toggle on',\n    color: hasError ? 'red' : 'blue',\n    size,\n    className: 'mr1',\n    disabled: isDisabled,\n  };\n  const noAttributes = {\n    name: 'toggle off',\n    color: hasError ? 'red' : 'grey',\n    size,\n    className: 'mr1',\n    disabled: isDisabled,\n  };\n\n  const headerOrHeaderAndToggle = show === 'both' || show === 'headerOnly';\n  const headerOnly = show === 'headerOnly';\n  const toggleOnly = show === 'toggleOnly';\n\n  const toggleButton = (\n    <div className={c(hasError ? 'color-red' : '')}>\n      {yesSelected && (\n        <span id={id} className={c(cursor)} onClick={handleClick(false)}>\n          <Icon {...yesAttributes} />\n          {yesLabel}\n        </span>\n      )}\n      {!yesSelected && (\n        <span id={id} className={c('op-65', cursor)} onClick={handleClick(true)}>\n          <Icon {...noAttributes} />\n          {noLabel}\n        </span>\n      )}\n    </div>\n  );\n\n  return (\n    <div className={c(className, errorClass, disabledClass)}>\n      {headerOrHeaderAndToggle && (\n        <>\n          <div className=\"flex flex-wrap mb1\">\n            <Header field={field} className=\"mt0 mb0 mr2\" />\n            {!headerOnly && toggleButton}\n          </div>\n          <Description field={field} />\n          <ErrorPointer field={field} />\n        </>\n      )}\n      {toggleOnly && toggleButton}\n    </div>\n  );\n});\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '../../helpers/form';\n\nfunction getExternalUserPinFormFields() {\n  return [\n    {\n      name: 'pin',\n      label: 'PIN',\n      placeholder: 'A PIN or password to secure your IAM credentials',\n      rules: 'required|string|between:4,16',\n    },\n  ];\n}\n\nfunction getExternalUserPinForm() {\n  return createForm(getExternalUserPinFormFields());\n}\n\nexport { getExternalUserPinForm, getExternalUserPinFormFields };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\n\nexport default class PinInput extends React.PureComponent {\n  render() {\n    const pin = this.props.form.$('pin');\n    return <Input field={pin} disabled={this.props.processing} type=\"password\" icon=\"lock\" iconPosition=\"left\" />;\n  }\n}\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, runInAction, observable, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Icon, Header, Segment, Button, Card, Radio, Divider } from 'semantic-ui-react';\nimport c from 'classnames';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreLoading, isStoreError, isStoreEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\n// expected props\n// - onPrevious (via props)\n// - onNext (via props) a function is called with the selected computeTypeId\n// - computePlatformsStore (via injection)\n// - userStore (via injection)\nclass SelectComputePlatformStep extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.selectedPlatformId = undefined;\n      this.processing = false;\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n    swallowError(this.computePlatformsStore.load());\n  }\n\n  goto(pathname) {\n    const goto = gotoFn(this);\n    goto(pathname);\n  }\n\n  get userStore() {\n    return this.props.userStore;\n  }\n\n  get computePlatformsStore() {\n    return this.props.computePlatformsStore;\n  }\n\n  handleSelectedComputeType = typeId => {\n    this.selectedPlatformId = typeId;\n  };\n\n  handlePrevious = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (_.isFunction(this.props.onPrevious)) this.props.onPrevious();\n  };\n\n  handleNext = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (_.isFunction(this.props.onNext)) {\n      try {\n        this.processing = true;\n        await this.props.onNext(this.selectedPlatformId);\n      } catch (error) {\n        displayError(error);\n      } finally {\n        runInAction(() => {\n          this.processing = false;\n        });\n      }\n    }\n  };\n\n  render() {\n    const store = this.computePlatformsStore;\n    if (!store) return null;\n\n    let content;\n    if (isStoreError(store)) {\n      content = this.renderLoadingError();\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder className=\"mt2\" />;\n    } else if (isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else {\n      content = this.renderContent();\n    }\n\n    return content;\n  }\n\n  renderContent() {\n    // Logic:\n    // - if external researcher and no aws creds configured yet, show a message\n    // - if guest (internal/external) show a message\n    // - if internal researcher and no project ids, show a message\n    // - else show compute types card\n    const nextDisabled = _.isUndefined(this.selectedPlatformId);\n\n    return (\n      <div className=\"mt2 animated fadeIn\">\n        {this.renderCards()}\n        {this.renderButtons({ nextDisabled })}\n      </div>\n    );\n  }\n\n  renderCards() {\n    const processing = this.processing;\n    const computeTypes = this.computePlatformsStore.list || [];\n    const isSelected = type => type.id === this.selectedPlatformId;\n    const getAttrs = type => {\n      const attrs = {};\n      if (isSelected(type)) attrs.color = 'blue';\n      if (!processing) attrs.onClick = () => this.handleSelectedComputeType(type.id);\n      return attrs;\n    };\n\n    return (\n      <Card.Group stackable itemsPerRow={3}>\n        {_.map(computeTypes, type => (\n          <Card key={type.id} raised className={c('mb3', { 'cursor-pointer': !processing })} {...getAttrs(type)}>\n            <Card.Content>\n              <Card.Header>\n                <Radio className=\"mr2\" checked={isSelected(type)} disabled={processing} />\n                {type.title}\n                <Divider />\n              </Card.Header>\n              <Card.Description>\n                <div className=\"mb3 pr1 pl1 pb1\">\n                  {/* Yes, we are doing dangerouslySetInnerHTML, the content was already sanitized by showdownjs */}\n                  {/* eslint-disable-next-line react/no-danger */}\n                  <div dangerouslySetInnerHTML={{ __html: type.descHtml }} />\n                </div>\n              </Card.Description>\n            </Card.Content>\n          </Card>\n        ))}\n      </Card.Group>\n    );\n  }\n\n  renderLoadingError() {\n    const store = this.computePlatformsStore;\n    return (\n      <>\n        <ErrorBox error={store.error} className=\"p0 mt2 mb3\" />\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <>\n        <Segment placeholder className=\"mt2\">\n          <Header icon className=\"color-grey\">\n            <Icon name=\"server\" />\n            No compute platform\n            <Header.Subheader>\n              There are no compute platform to choose from. Your role might be restricted. Please contact your\n              administrator.\n            </Header.Subheader>\n          </Header>\n        </Segment>\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderButtons({ nextDisabled = true } = {}) {\n    const processing = this.processing;\n    return (\n      <div className=\"mt3\">\n        <Button\n          floated=\"right\"\n          icon=\"right arrow\"\n          labelPosition=\"right\"\n          className=\"ml2\"\n          primary\n          content=\"Next\"\n          loading={processing}\n          disabled={nextDisabled || processing}\n          onClick={this.handleNext}\n        />\n        <Button\n          floated=\"right\"\n          icon=\"left arrow\"\n          labelPosition=\"left\"\n          className=\"ml2\"\n          content=\"Previous\"\n          disabled={processing}\n          onClick={this.handlePrevious}\n        />\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(SelectComputePlatformStep, {\n  handlePrevious: action,\n  handleNext: action,\n  handleSelectedComputeType: action,\n  userStore: computed,\n  computePlatformsStore: computed,\n  processing: observable,\n  selectedPlatformId: observable,\n});\n\nexport default inject('userStore', 'computePlatformsStore')(withRouter(observer(SelectComputePlatformStep)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { Icon, Header, Segment, Button } from 'semantic-ui-react';\n\nimport CreateInternalPlatformForm from './parts/CreateInternalPlatformForm';\nimport CreateExternalPlatformForm from './parts/CreateExternalPlatformForm';\n\n// expected props\n// - onPrevious (via props)\n// - onCompleted (via props) a function is called after a call to create a workspace is performed\n// - platformId (via props)\n// - studyIds (via props)\n// - computePlatformsStore (via injection)\n// - clientInformationStore (via injection)\n// - userStore (via injection)\n// - environmentsStore (via injection)\nclass ConfigureComputePlatformStep extends React.Component {\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  get platformId() {\n    return this.props.platformId;\n  }\n\n  get platformTitle() {\n    return _.get(this.computePlatformsStore.getComputePlatform(this.platformId), 'title');\n  }\n\n  get userStore() {\n    return this.props.userStore;\n  }\n\n  get clientInformationStore() {\n    return this.props.clientInformationStore;\n  }\n\n  get computePlatformsStore() {\n    return this.props.computePlatformsStore;\n  }\n\n  get environmentsStore() {\n    return this.props.environmentsStore;\n  }\n\n  get configurations() {\n    const platform = this.computePlatformsStore.getComputePlatform(this.platformId);\n    if (!platform) return [];\n    return platform.configurationsList;\n  }\n\n  get defaultCidr() {\n    // We pick the first one\n    const value = _.get(_.first(this.configurations), 'defaultCidr');\n    if (_.isUndefined(value)) return undefined; // This means that cidr should not be treated as an input\n    if (!_.isEmpty(value)) return value;\n    if (_.isEmpty(this.clientInformationStore.ipAddress)) return '';\n\n    return `${this.clientInformationStore.ipAddress}/32`;\n  }\n\n  get studyIds() {\n    return this.props.studyIds;\n  }\n\n  handlePrevious = () => {\n    if (_.isFunction(this.props.onPrevious)) this.props.onPrevious();\n  };\n\n  // eslint-disable-next-line consistent-return\n  handleCreate = async data => {\n    const studyIds = this.studyIds || [];\n    const store = this.environmentsStore;\n    const environment = await store.createEnvironment({ ...data, studyIds });\n    return this.props.onCompleted(environment);\n  };\n\n  render() {\n    // Note: we assume that whatever component that is including this component, has\n    // already loaded and verified that the computePlatformsStore has no errors\n    const configurations = this.configurations;\n    let content = null;\n\n    if (_.isEmpty(configurations)) {\n      content = this.renderEmpty();\n    } else {\n      content = this.renderContent();\n    }\n\n    return content;\n  }\n\n  renderContent() {\n    const platformId = this.platformId;\n    const configurations = this.configurations;\n    const title = this.platformTitle;\n    const defaultCidr = this.defaultCidr;\n    const isExternal = this.userStore.user.isExternalUser;\n\n    return (\n      <div className=\"mt2 animated fadeIn\">\n        {!isExternal && (\n          <CreateInternalPlatformForm\n            platformId={platformId}\n            configurations={configurations}\n            title={title}\n            defaultCidr={defaultCidr}\n            onPrevious={this.handlePrevious}\n            onNext={this.handleCreate}\n          />\n        )}\n        {isExternal && (\n          <CreateExternalPlatformForm\n            platformId={platformId}\n            configurations={configurations}\n            title={title}\n            defaultCidr={defaultCidr}\n            onPrevious={this.handlePrevious}\n            onNext={this.handleCreate}\n          />\n        )}\n      </div>\n    );\n  }\n\n  renderEmpty() {\n    const title = this.platformTitle;\n    return (\n      <>\n        <Header as=\"h3\" textAlign=\"center\" className=\"mt2\">\n          {title}\n        </Header>\n        <Segment placeholder className=\"mt2\">\n          <Header icon className=\"color-grey\">\n            <Icon name=\"server\" />\n            No compute platform configurations\n            <Header.Subheader>\n              There are no compute platform configurations to choose from. Your role might be restricted. Please contact\n              your administrator.\n            </Header.Subheader>\n          </Header>\n        </Segment>\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderButtons({ nextDisabled = true } = {}) {\n    return (\n      <div className=\"mt3\">\n        <Button floated=\"right\" className=\"ml2\" primary content=\"Create Research Workspace\" disabled={nextDisabled} />\n        <Button\n          floated=\"right\"\n          icon=\"left arrow\"\n          labelPosition=\"left\"\n          className=\"ml2\"\n          content=\"Previous\"\n          onClick={this.handlePrevious}\n        />\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ConfigureComputePlatformStep, {\n  handlePrevious: action,\n  handleCreate: action,\n  userStore: computed,\n  computePlatformsStore: computed,\n  clientInformationStore: computed,\n  platformId: computed,\n  defaultCidr: computed,\n  platformTitle: computed,\n  environmentsStore: computed,\n  studyIds: computed,\n});\n\nexport default inject(\n  'userStore',\n  'computePlatformsStore',\n  'clientInformationStore',\n  'environmentsStore',\n)(observer(ConfigureComputePlatformStep));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, runInAction, observable, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { Segment, Button, Header } from 'semantic-ui-react';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport Dropdown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\n\nimport { getCreateInternalPlatformForm } from '../../../models/forms/CreateInternalPlatformForm';\nimport SelectConfigurationCards from './SelectConfigurationCards';\n\n// expected props\n// - onPrevious (via props)\n// - onNext (via props) a function is called with the form data\n// - platformId (via props)\n// - configurations (via props)\n// - title (via props)\n// - defaultCidr (via props)\n// - clientInformationStore (via injection)\n// - userStore (via injection)\nclass CreateInternalPlatformForm extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.form = getCreateInternalPlatformForm({\n        projectIdOptions: this.projectIdOptions,\n        cidr: this.props.defaultCidr,\n      });\n    });\n  }\n\n  get projectIdOptions() {\n    const store = this.userStore;\n    return store.projectIdDropdown;\n  }\n\n  get platformId() {\n    return this.props.platformId;\n  }\n\n  get configurations() {\n    return this.props.configurations;\n  }\n\n  get userStore() {\n    return this.props.userStore;\n  }\n\n  // eslint-disable-next-line consistent-return\n  handlePrevious = () => {\n    if (_.isFunction(this.props.onPrevious)) return this.props.onPrevious();\n  };\n\n  // eslint-disable-next-line consistent-return\n  handleNext = async form => {\n    const data = { ...form.values(), params: {}, platformId: this.platformId };\n\n    // We pick the mutable parameters and put them in params object\n    const configuration = _.find(this.configurations, ['id', data.configurationId]);\n    _.forEach(_.keys(configuration.mutableParams), key => {\n      if (!_.has(data, key)) return;\n      data.params[key] = data[key];\n      delete data[key];\n    });\n\n    try {\n      await this.props.onNext(data);\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  render() {\n    const title = this.props.title || '';\n    return (\n      <div className=\"mt2\">\n        <Header as=\"h3\" textAlign=\"center\">\n          {title}\n        </Header>\n        {this.renderForm()}\n      </div>\n    );\n  }\n\n  renderForm() {\n    const form = this.form;\n    const askForCidr = !_.isUndefined(this.props.defaultCidr);\n    const configurations = this.configurations;\n\n    return (\n      <Segment clearing className=\"p3 mb3\">\n        <Form form={form} onCancel={this.handlePrevious} onSuccess={this.handleNext}>\n          {({ processing, /* onSubmit, */ onCancel }) => (\n            <>\n              <Input field={form.$('name')} />\n              {askForCidr && <Input field={form.$('cidr')} />}\n              <Dropdown field={form.$('projectId')} fluid selection />\n              <SelectConfigurationCards configurations={configurations} formField={form.$('configurationId')} />\n              <TextArea field={form.$('description')} />\n\n              <Button\n                floated=\"right\"\n                className=\"ml2\"\n                primary\n                content=\"Create Research Workspace\"\n                disabled={processing}\n                type=\"submit\"\n              />\n\n              <Button\n                floated=\"right\"\n                icon=\"left arrow\"\n                labelPosition=\"left\"\n                className=\"ml2\"\n                content=\"Previous\"\n                disabled={processing}\n                onClick={onCancel}\n              />\n            </>\n          )}\n        </Form>\n      </Segment>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(CreateInternalPlatformForm, {\n  form: observable,\n  platformId: computed,\n  configurations: computed,\n  userStore: computed,\n  projectIdOptions: computed,\n  handlePrevious: action,\n});\n\nexport default inject('userStore', 'clientInformationStore')(observer(CreateInternalPlatformForm));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { createForm } from '../../helpers/form';\n\nconst getFields = ({ projectIdOptions, cidr }) => {\n  const fields = {\n    name: {\n      label: 'Name',\n      placeholder: 'Type a name for this research workspace',\n      extra: {\n        explain:\n          'Name can contain only alphanumeric characters (case sensitive) and hyphens. It must start with an alphabetic character and cannot be longer than 128 characters',\n      },\n      rules: 'required|string|between:3,128|regex:/^[A-Za-z][A-Za-z0-9-]+$/',\n    },\n    description: {\n      label: 'Description',\n      placeholder: 'The description of this research workspace',\n      rules: 'required|string|between:3,2048',\n    },\n    projectId: {\n      label: 'Project ID',\n      placeholder: 'The project ID associated with this study',\n      rules: ['required', 'string', 'min:1', 'max:100'],\n      extra: {\n        options: projectIdOptions,\n      },\n    },\n    configurationId: {\n      label: 'Configuration',\n      placeholder: 'The configuration for the research workspace',\n      rules: 'required',\n    },\n  };\n\n  if (!_.isUndefined(cidr)) {\n    fields.cidr = {\n      label: 'Restricted CIDR',\n      extra: {\n        explain: `This research workspace will only be reachable from this CIDR. You can get your organization's CIDR range from your IT department. The provided default is the CIDR that restricts to your IP address.`,\n      },\n      placeholder: 'The CIDR range to restrict research workspace access to',\n      rules: 'required|cidr',\n      value: cidr,\n    };\n  }\n\n  return fields;\n};\n\nfunction getCreateInternalPlatformForm(...args) {\n  return createForm(getFields(...args));\n}\n\n// eslint-disable-next-line import/prefer-default-export\nexport { getCreateInternalPlatformForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, runInAction, observable, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { Segment, Button, Header } from 'semantic-ui-react';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { awsRegion } from '@aws-ee/base-ui/dist/helpers/settings';\n\nimport { getCreateExternalPlatformForm } from '../../../models/forms/CreateExternalPlatformForm';\nimport SelectConfigurationCards from './SelectConfigurationCards';\n\n// expected props\n// - onPrevious (via props)\n// - onNext (via props) a function is called with the form data\n// - platformId (via props)\n// - configurations (via props)\n// - title (via props)\n// - defaultCidr (via props)\n// - clientInformationStore (via injection)\n// - userStore (via injection)\n// - usersStore (via injection)\nclass CreateExternalPlatformForm extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.askForCredentials = !this.userStore.user.hasCredentials;\n      this.form = getCreateExternalPlatformForm({\n        askForCredentials: this.askForCredentials,\n        cidr: this.props.defaultCidr,\n      });\n    });\n  }\n\n  get platformId() {\n    return this.props.platformId;\n  }\n\n  get configurations() {\n    return this.props.configurations;\n  }\n\n  get userStore() {\n    return this.props.userStore;\n  }\n\n  get usersStore() {\n    return this.props.usersStore;\n  }\n\n  // eslint-disable-next-line consistent-return\n  handlePrevious = () => {\n    if (_.isFunction(this.props.onPrevious)) return this.props.onPrevious();\n  };\n\n  // eslint-disable-next-line consistent-return\n  handleNext = async form => {\n    const data = { ...form.values(), params: {}, platformId: this.platformId };\n\n    // We pick the mutable parameters and put them in params object\n    const configuration = _.find(this.configurations, ['id', data.configurationId]);\n    _.forEach(_.keys(configuration.mutableParams), key => {\n      if (!_.has(data, key)) return;\n      data.params[key] = data[key];\n      delete data[key];\n    });\n\n    // Next, we need to encrypt the credentials if they are provided\n    const askForCredentials = this.askForCredentials;\n    const user = this.userStore.user;\n    const props = ['accessKeyId', 'secretAccessKey'];\n\n    try {\n      if (askForCredentials) {\n        const credentials = _.pick(data, props);\n        credentials.region = awsRegion;\n        const usersStore = this.usersStore;\n        await user.setEncryptedCreds(credentials, data.pin);\n        await usersStore.updateUser(user);\n      }\n\n      // We remove any access key information from data\n      // but we keep pin in data, and the environment store will remove it\n      const adjustedData = _.omit(data, props);\n\n      await this.props.onNext(adjustedData);\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  handleForgotPin = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const form = this.form;\n    const addRequired = field => {\n      const rules = field.rules;\n      if (_.startsWith('required')) return;\n      field.set('rules', `required|${rules}`);\n    };\n\n    addRequired(form.$('accessKeyId'));\n    addRequired(form.$('secretAccessKey'));\n    this.askForCredentials = true;\n  };\n\n  render() {\n    const title = this.props.title || '';\n    return (\n      <div className=\"mt2\">\n        <Header as=\"h3\" textAlign=\"center\">\n          {title}\n        </Header>\n        {this.renderForm()}\n      </div>\n    );\n  }\n\n  renderForm() {\n    const form = this.form;\n    const askForCidr = !_.isUndefined(this.props.defaultCidr);\n    const configurations = this.configurations;\n    const askForCredentials = this.askForCredentials;\n\n    return (\n      <Segment clearing className=\"p3 mb3\">\n        <Form form={form} onCancel={this.handlePrevious} onSuccess={this.handleNext}>\n          {({ processing, /* onSubmit, */ onCancel }) => (\n            <>\n              <Input field={form.$('name')} />\n              {askForCidr && <Input field={form.$('cidr')} />}\n              <SelectConfigurationCards configurations={configurations} formField={form.$('configurationId')} />\n              <TextArea field={form.$('description')} />\n              {askForCredentials && (\n                <>\n                  <Input field={form.$('accessKeyId')} />\n                  <Input field={form.$('secretAccessKey')} type=\"password\" />\n                </>\n              )}\n              <Input field={form.$('pin')} type=\"password\" icon=\"lock\" iconPosition=\"left\" />\n\n              {!askForCredentials && (\n                <Button floated=\"left\" disabled={processing} onClick={this.handleForgotPin}>\n                  Forgot PIN?\n                </Button>\n              )}\n\n              <Button\n                floated=\"right\"\n                className=\"ml2\"\n                primary\n                content=\"Create Research Workspace\"\n                disabled={processing}\n                type=\"submit\"\n              />\n\n              <Button\n                floated=\"right\"\n                icon=\"left arrow\"\n                labelPosition=\"left\"\n                className=\"ml2\"\n                content=\"Previous\"\n                disabled={processing}\n                onClick={onCancel}\n              />\n            </>\n          )}\n        </Form>\n      </Segment>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(CreateExternalPlatformForm, {\n  form: observable,\n  platformId: computed,\n  askForCredentials: observable,\n  configurations: computed,\n  userStore: computed,\n  usersStore: computed,\n  handlePrevious: action,\n  handleForgotPin: action,\n});\n\nexport default inject('userStore', 'usersStore', 'clientInformationStore')(observer(CreateExternalPlatformForm));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\n\nimport { createForm } from '../../helpers/form';\n\nconst getFields = ({ askForCredentials, cidr }) => {\n  const rulesPrefix = askForCredentials ? 'required|' : '';\n  const fields = {\n    name: {\n      label: 'Name',\n      placeholder: 'Type a name for this research workspace',\n      extra: {\n        explain:\n          'Name can contain only alphanumeric characters (case sensitive) and hyphens. It must start with an alphabetic character and cannot be longer than 128 characters',\n      },\n      rules: 'required|string|between:3,128|regex:/^[A-Za-z][A-Za-z0-9-]+$/',\n    },\n    description: {\n      label: 'Description',\n      placeholder: 'The description of this research workspace',\n      rules: 'required|string|between:3,2048',\n    },\n    configurationId: {\n      label: 'Configuration',\n      placeholder: 'The configuration for the research workspace',\n      rules: 'required',\n    },\n    accessKeyId: {\n      label: 'IAM Access Key Id',\n      placeholder: 'Access key for your IAM user',\n      rules: `${rulesPrefix}string|between:16,128`,\n    },\n    secretAccessKey: {\n      label: 'IAM Secret Access Key',\n      placeholder: 'Secret access key for your IAM user',\n      rules: `${rulesPrefix}string|size:40`, // TODO - is this right?\n    },\n    pin: {\n      label: 'PIN',\n      placeholder: 'A PIN or password to secure your IAM credentials',\n      rules: 'required|string|between:4,16',\n    },\n  };\n\n  if (!_.isUndefined(cidr)) {\n    fields.cidr = {\n      label: 'Restricted CIDR',\n      extra: {\n        explain: `This research workspace will only be reachable from this CIDR. You can get your organization's CIDR range from your IT department. The provided default is the CIDR that restricts to your IP address.`,\n      },\n      placeholder: 'The CIDR range to restrict research workspace access to',\n      rules: 'required|cidr',\n      value: cidr,\n    };\n  }\n\n  return fields;\n};\n\nfunction getCreateExternalPlatformForm(...args) {\n  return createForm(getFields(...args));\n}\n\n// eslint-disable-next-line import/prefer-default-export\nexport { getCreateExternalPlatformForm };\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, runInAction, observable, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Icon, Header, Segment, Button, Card, Radio, Divider } from 'semantic-ui-react';\nimport c from 'classnames';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreLoading, isStoreError, isStoreEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\n// expected props\n// - onPrevious (via props)\n// - onNext (via props) a function is called with the selected envTypeId\n// - envTypesStore (via injection)\n// - userStore (via injection)\nclass SelectEnvTypeStep extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.selectedEnvTypeId = undefined;\n      this.processing = false;\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n    swallowError(this.envTypesStore.load());\n  }\n\n  goto(pathname) {\n    const goto = gotoFn(this);\n    goto(pathname);\n  }\n\n  get userStore() {\n    return this.props.userStore;\n  }\n\n  get envTypesStore() {\n    return this.props.envTypesStore;\n  }\n\n  handleSelectedEnvType = typeId => {\n    this.selectedEnvTypeId = typeId;\n  };\n\n  handlePrevious = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (_.isFunction(this.props.onPrevious)) this.props.onPrevious();\n  };\n\n  handleNext = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    if (_.isFunction(this.props.onNext)) {\n      try {\n        this.processing = true;\n        await this.props.onNext(this.selectedEnvTypeId);\n      } catch (error) {\n        displayError(error);\n      } finally {\n        runInAction(() => {\n          this.processing = false;\n        });\n      }\n    }\n  };\n\n  render() {\n    const store = this.envTypesStore;\n    if (!store) return null;\n\n    let content;\n    if (isStoreError(store)) {\n      content = this.renderLoadingError();\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder className=\"mt2\" />;\n    } else if (isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else {\n      content = this.renderContent();\n    }\n\n    return content;\n  }\n\n  renderContent() {\n    // Logic:\n    // - if external researcher and no aws creds configured yet, show a message\n    // - if guest (internal/external) show a message\n    // - if internal researcher and no project ids, show a message\n    // - else show env types card\n    const nextDisabled = _.isUndefined(this.selectedEnvTypeId);\n\n    return (\n      <div className=\"mt2 animated fadeIn\">\n        {this.renderCards()}\n        {this.renderButtons({ nextDisabled })}\n      </div>\n    );\n  }\n\n  renderCards() {\n    const processing = this.processing;\n    const envTypes = this.envTypesStore.listApproved || [];\n    const isSelected = type => type.id === this.selectedEnvTypeId;\n    const getAttrs = type => {\n      const attrs = {};\n      if (isSelected(type)) attrs.color = 'blue';\n      if (!processing) attrs.onClick = () => this.handleSelectedEnvType(type.id);\n      return attrs;\n    };\n\n    return (\n      <Card.Group stackable itemsPerRow={3}>\n        {_.map(envTypes, type => (\n          <Card\n            data-testid=\"env-type-card\"\n            key={type.id}\n            raised\n            className={c('mb3', { 'cursor-pointer': !processing })}\n            {...getAttrs(type)}\n          >\n            <Card.Content>\n              <Card.Header>\n                <div className=\"flex mt1\">\n                  <Radio className=\"mr2\" checked={isSelected(type)} disabled={processing} />\n                  <Header as=\"h4\" className=\"flex-auto mt0 pt0\">\n                    {type.name}\n                  </Header>\n                </div>\n                <Divider />\n              </Card.Header>\n              <Card.Description>\n                <div className=\"mb3 pr1 pl1 pb1\">\n                  {/* Yes, we are doing dangerouslySetInnerHTML, the content was already sanitized by showdownjs */}\n                  {/* eslint-disable-next-line react/no-danger */}\n                  <div dangerouslySetInnerHTML={{ __html: type.descHtml }} />\n                </div>\n              </Card.Description>\n            </Card.Content>\n          </Card>\n        ))}\n      </Card.Group>\n    );\n  }\n\n  renderLoadingError() {\n    const store = this.envTypesStore;\n    return (\n      <>\n        <ErrorBox error={store.error} className=\"p0 mt2 mb3\" />\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <>\n        <Segment placeholder className=\"mt2\">\n          <Header icon className=\"color-grey\">\n            <Icon name=\"server\" />\n            No workspace types\n            <Header.Subheader>\n              There are no workspace types to choose from. Your role might be restricted. Please contact your\n              administrator.\n            </Header.Subheader>\n          </Header>\n        </Segment>\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderButtons({ nextDisabled = true } = {}) {\n    const processing = this.processing;\n    return (\n      <div className=\"mt3\">\n        <Button\n          floated=\"right\"\n          icon=\"right arrow\"\n          labelPosition=\"right\"\n          className=\"ml2\"\n          primary\n          content=\"Next\"\n          loading={processing}\n          disabled={nextDisabled || processing}\n          onClick={this.handleNext}\n        />\n        <Button\n          floated=\"right\"\n          icon=\"left arrow\"\n          labelPosition=\"left\"\n          className=\"ml2\"\n          content=\"Previous\"\n          disabled={processing}\n          onClick={this.handlePrevious}\n        />\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(SelectEnvTypeStep, {\n  handlePrevious: action,\n  handleNext: action,\n  handleSelectedEnvType: action,\n  userStore: computed,\n  envTypesStore: computed,\n  processing: observable,\n  selectedEnvTypeId: observable,\n});\n\nexport default inject('userStore', 'envTypesStore')(withRouter(observer(SelectEnvTypeStep)));\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { Icon, Header, Segment, Button } from 'semantic-ui-react';\n\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreEmpty, isStoreError, isStoreLoading } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport CreateInternalEnvForm from './CreateInternalEnvForm';\n\n// expected props\n// - onPrevious (via props)\n// - onCompleted (via props) a function is called after a call to create a workspace is performed\n// - envTypeId (via props)\n// - studyIds (via props)\n// - envTypesStore (via injection)\n// - clientInformationStore (via injection)\n// - userStore (via injection)\n// - scEnvironmentsStore (via injection)\nclass ConfigureEnvTypeStep extends React.Component {\n  componentDidMount() {\n    window.scrollTo(0, 0);\n\n    swallowError(this.envTypeConfigsStore.load());\n  }\n\n  get envTypeId() {\n    return this.props.envTypeId;\n  }\n\n  get envTypeTitle() {\n    return _.get(this.envTypesStore.getEnvType(this.envTypeId), 'name');\n  }\n\n  get userStore() {\n    return this.props.userStore;\n  }\n\n  get clientInformationStore() {\n    return this.props.clientInformationStore;\n  }\n\n  get envTypesStore() {\n    return this.props.envTypesStore;\n  }\n\n  get scEnvironmentsStore() {\n    return this.props.scEnvironmentsStore;\n  }\n\n  get envTypeConfigsStore() {\n    return this.envTypesStore.getEnvTypeConfigsStore(this.envTypeId);\n  }\n\n  get configurations() {\n    return this.envTypeConfigsStore.list;\n  }\n\n  get defaultCidr() {\n    if (_.isEmpty(this.clientInformationStore.ipAddress)) return '';\n\n    return `${this.clientInformationStore.ipAddress}/32`;\n  }\n\n  get studyIds() {\n    return this.props.studyIds;\n  }\n\n  handlePrevious = () => {\n    if (_.isFunction(this.props.onPrevious)) this.props.onPrevious();\n  };\n\n  // eslint-disable-next-line consistent-return\n  handleCreate = async data => {\n    const studyIds = this.studyIds || [];\n    const store = this.scEnvironmentsStore;\n    const environment = await store.createScEnvironment({ ...data, studyIds });\n    return this.props.onCompleted(environment);\n  };\n\n  render() {\n    const store = this.envTypeConfigsStore;\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = this.renderLoadingError();\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder className=\"mt2\" />;\n    } else if (isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else {\n      content = this.renderContent();\n    }\n\n    return content;\n  }\n\n  renderLoadingError() {\n    const store = this.envTypeConfigsStore;\n    return (\n      <>\n        <ErrorBox error={store.error} className=\"p0 mt2 mb3\" />\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderContent() {\n    const envTypeId = this.envTypeId;\n    const configurations = this.configurations;\n    const title = this.envTypeTitle;\n    const defaultCidr = this.defaultCidr;\n    const isExternal = this.userStore.user.isExternalUser;\n\n    return (\n      <div className=\"mt2 animated fadeIn\">\n        {!isExternal && (\n          <CreateInternalEnvForm\n            envTypeId={envTypeId}\n            configurations={configurations}\n            title={title}\n            defaultCidr={defaultCidr}\n            onPrevious={this.handlePrevious}\n            onNext={this.handleCreate}\n          />\n        )}\n        {isExternal && this.renderExternalNotSupported()}\n        {/* {isExternal && (\n          <CreateExternalEnvForm\n            envTypeId={envTypeId}\n            configurations={configurations}\n            title={title}\n            defaultCidr={defaultCidr}\n            onPrevious={this.handlePrevious}\n            onNext={this.handleCreate}\n          />\n        )} */}\n      </div>\n    );\n  }\n\n  renderExternalNotSupported() {\n    return (\n      <>\n        <Segment placeholder className=\"mt2\">\n          <Header icon className=\"color-grey\">\n            <Icon name=\"server\" />\n            No support for external researchers\n            <Header.Subheader>\n              There are no workspace configurations to choose from. Your role is restricted. Please contact your\n              administrator.\n            </Header.Subheader>\n          </Header>\n        </Segment>\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderEmpty() {\n    const title = this.envTypeTitle;\n    return (\n      <>\n        <Header as=\"h3\" textAlign=\"center\" className=\"mt2\">\n          {title}\n        </Header>\n        <Segment placeholder className=\"mt2\">\n          <Header icon className=\"color-grey\">\n            <Icon name=\"server\" />\n            No workspace configurations\n            <Header.Subheader>\n              There are no workspace configurations to choose from. Your role might be restricted. Please contact your\n              administrator.\n            </Header.Subheader>\n          </Header>\n        </Segment>\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderButtons({ nextDisabled = true } = {}) {\n    return (\n      <div className=\"mt3\">\n        <Button floated=\"right\" className=\"ml2\" primary content=\"Create Research Workspace\" disabled={nextDisabled} />\n        <Button\n          floated=\"right\"\n          icon=\"left arrow\"\n          labelPosition=\"left\"\n          className=\"ml2\"\n          content=\"Previous\"\n          onClick={this.handlePrevious}\n        />\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ConfigureEnvTypeStep, {\n  handlePrevious: action,\n  handleCreate: action,\n  userStore: computed,\n  envTypesStore: computed,\n  clientInformationStore: computed,\n  envTypeId: computed,\n  defaultCidr: computed,\n  envTypeTitle: computed,\n  scEnvironmentsStore: computed,\n  configurations: computed,\n  studyIds: computed,\n});\n\nexport default inject(\n  'userStore',\n  'envTypesStore',\n  'scEnvironmentsStore',\n  'clientInformationStore',\n)(observer(ConfigureEnvTypeStep));\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, runInAction, observable, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { Segment, Button, Header } from 'semantic-ui-react';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport Dropdown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\n\nimport { getCreateInternalEnvForm } from '../../../models/forms/CreateInternalEnvForm';\nimport SelectConfigurationCards from './SelectConfigurationCards';\n\n// expected props\n// - onPrevious (via props)\n// - onNext (via props) a function is called with the form data\n// - envTypeId (via props)\n// - configurations (via props)\n// - title (via props)\n// - defaultCidr (via props)\n// - clientInformationStore (via injection)\n// - userStore (via injection)\nclass CreateInternalEnvForm extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.form = getCreateInternalEnvForm({\n        projectIdOptions: this.projectIdOptions,\n        cidr: this.props.defaultCidr,\n      });\n    });\n  }\n\n  get projectIdOptions() {\n    const store = this.userStore;\n    return store.projectIdDropdown;\n  }\n\n  get envTypeId() {\n    return this.props.envTypeId;\n  }\n\n  get configurations() {\n    return this.props.configurations;\n  }\n\n  get userStore() {\n    return this.props.userStore;\n  }\n\n  // eslint-disable-next-line consistent-return\n  handlePrevious = () => {\n    if (_.isFunction(this.props.onPrevious)) return this.props.onPrevious();\n  };\n\n  // eslint-disable-next-line consistent-return\n  handleNext = async form => {\n    const data = { ...form.values(), envTypeId: this.envTypeId };\n\n    try {\n      await this.props.onNext(data);\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  render() {\n    const title = this.props.title || '';\n    return (\n      <div className=\"mt2\">\n        <Header as=\"h3\" textAlign=\"center\">\n          {title}\n        </Header>\n        {this.renderForm()}\n      </div>\n    );\n  }\n\n  renderForm() {\n    const form = this.form;\n    const askForCidr = !_.isUndefined(this.props.defaultCidr);\n    const configurations = this.configurations;\n\n    return (\n      <Segment clearing className=\"p3 mb3\">\n        <Form form={form} onCancel={this.handlePrevious} onSuccess={this.handleNext}>\n          {({ processing, /* onSubmit, */ onCancel }) => (\n            <>\n              <Input dataTestId=\"workspace-name\" field={form.$('name')} />\n              {askForCidr && <Input field={form.$('cidr')} />}\n              <Dropdown dataTestId=\"project-id\" field={form.$('projectId')} fluid selection />\n              <SelectConfigurationCards configurations={configurations} formField={form.$('envTypeConfigId')} />\n              <TextArea dataTestId=\"description-text-area\" field={form.$('description')} />\n\n              <Button\n                floated=\"right\"\n                className=\"ml2\"\n                primary\n                content=\"Create Research Workspace\"\n                disabled={processing}\n                type=\"submit\"\n              />\n\n              <Button\n                floated=\"right\"\n                icon=\"left arrow\"\n                labelPosition=\"left\"\n                className=\"ml2\"\n                content=\"Previous\"\n                disabled={processing}\n                onClick={onCancel}\n              />\n            </>\n          )}\n        </Form>\n      </Segment>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(CreateInternalEnvForm, {\n  form: observable,\n  envTypeId: computed,\n  configurations: computed,\n  userStore: computed,\n  projectIdOptions: computed,\n  handlePrevious: action,\n});\n\nexport default inject('userStore', 'clientInformationStore')(observer(CreateInternalEnvForm));\n","import _ from 'lodash';\nimport { createForm } from '../../helpers/form';\n\nconst getFields = ({ projectIdOptions, cidr }) => {\n  const fields = {\n    name: {\n      label: 'Name',\n      placeholder: 'Type a name for this research workspace',\n      extra: {\n        explain:\n          'Name can contain only alphanumeric characters (case sensitive) and hyphens. It must start with an alphabetic character and cannot be longer than 128 characters',\n      },\n      rules: 'required|string|between:3,128|regex:/^[A-Za-z][A-Za-z0-9-]+$/',\n    },\n    description: {\n      label: 'Description',\n      placeholder: 'The description of this research workspace',\n      rules: 'required|string|between:3,2048',\n    },\n    projectId: {\n      label: 'Project ID',\n      placeholder: 'The project ID associated with this study',\n      rules: ['required', 'string', 'min:1', 'max:100'],\n      extra: {\n        options: projectIdOptions,\n      },\n    },\n    envTypeConfigId: {\n      label: 'Configuration',\n      placeholder: 'The configuration for the research workspace',\n      rules: 'required',\n    },\n  };\n\n  if (!_.isUndefined(cidr)) {\n    fields.cidr = {\n      label: 'Restricted CIDR',\n      extra: {\n        explain: `This research workspace will only be reachable from this CIDR. You can get your organization's CIDR range from your IT department. The provided default is the CIDR that restricts to your IP address.`,\n      },\n      placeholder: 'The CIDR range to restrict research workspace access to',\n      rules: 'required|cidr',\n      value: cidr,\n    };\n  }\n\n  return fields;\n};\n\nfunction getCreateInternalEnvForm(...args) {\n  return createForm(getFields(...args));\n}\n\n// eslint-disable-next-line import/prefer-default-export\nexport { getCreateInternalEnvForm };\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { Card, Radio, Divider, Table, Header as SemanticHeader } from 'semantic-ui-react';\nimport c from 'classnames';\nimport Header from '@aws-ee/base-ui/dist/parts/helpers/fields/Header';\nimport Description from '@aws-ee/base-ui/dist/parts/helpers/fields/Description';\nimport ErrorPointer from '@aws-ee/base-ui/dist/parts/helpers/fields/ErrorPointer';\nimport { nicePrice } from '@aws-ee/base-ui/dist/helpers/utils';\n\n// expected props\n// - configurations (via props) and array of the env type configurations MST\n// - formField (via props) an instance of the mobx form field\nclass SelectConfigurationCards extends React.Component {\n  get configurations() {\n    return this.props.configurations;\n  }\n\n  get configurationId() {\n    return this.formField.value;\n  }\n\n  get formField() {\n    return this.props.formField;\n  }\n\n  handleSelectConfigurationId = configId => {\n    this.formField.sync(configId);\n    this.formField.resetValidation();\n  };\n\n  render() {\n    const field = this.formField;\n    const { error = '' } = field;\n    const hasError = !_.isEmpty(error); // IMPORTANT do NOT use field.hasError\n    const isDisabled = field.disabled;\n    const disabledClass = isDisabled ? 'disabled' : '';\n    const errorClass = hasError ? 'error' : '';\n\n    return (\n      <div className={c('mb4', errorClass, disabledClass)}>\n        <Header field={field} />\n        <Description field={field} />\n        <ErrorPointer field={field} className=\"mb1\" />\n        {this.renderCards()}\n      </div>\n    );\n  }\n\n  renderCards() {\n    const disabled = this.formField.disabled;\n    const configurations = this.configurations;\n    const isSelected = config => config.id === this.configurationId;\n    const getAttrs = config => {\n      const attrs = {};\n      if (isSelected(config)) attrs.color = 'blue';\n      if (!disabled) attrs.onClick = () => this.handleSelectConfigurationId(config.id);\n\n      return attrs;\n    };\n\n    return (\n      <Card.Group stackable itemsPerRow={3} className=\"mt1\">\n        {_.map(configurations, config => (\n          <Card\n            data-testid=\"configuration-card\"\n            key={config.id}\n            className={c('mb3', { 'cursor-pointer': !disabled })}\n            {...getAttrs(config)}\n          >\n            <Card.Content>\n              <Card.Header>\n                <div className=\"flex mt1\">\n                  <Radio className=\"mr2\" checked={isSelected(config)} disabled={disabled} />\n                  <SemanticHeader as=\"h4\" className=\"flex-auto mt0 pt0\">\n                    {config.name}\n                  </SemanticHeader>\n                </div>\n                <Divider />\n              </Card.Header>\n              <Card.Description>\n                <div className=\"pr1 pl1 pb1\">\n                  {/* Yes, we are doing dangerouslySetInnerHTML, the content was already sanitized by showdownjs */}\n                  {/* eslint-disable-next-line react/no-danger */}\n                  <div dangerouslySetInnerHTML={{ __html: config.descHtml }} />\n                </div>\n                <Divider />\n                {this.renderEstimatedCostInfo(config)}\n              </Card.Description>\n            </Card.Content>\n          </Card>\n        ))}\n      </Card.Group>\n    );\n  }\n\n  renderEstimatedCostInfo(config) {\n    const hasCost = !_.isEmpty(config.estimatedCostInfoHtml);\n    let content = (\n      <div className=\"flex p1\">\n        <div className=\"bold flex-auto\">Estimated Cost</div>\n        <div className=\"pr1\">N/A</div>\n      </div>\n    );\n    if (hasCost) {\n      content = (\n        <div className=\"p1\">\n          <div className=\"mb2 bold\">Estimated Cost</div>\n          {/* eslint-disable-next-line react/no-danger */}\n          <div dangerouslySetInnerHTML={{ __html: config.estimatedCostInfoHtml }} />\n        </div>\n      );\n    }\n\n    return content;\n  }\n\n  renderTableInfo(config) {\n    // estimatedCostInfo\n    const priceTitle = item => {\n      const isSpot = _.get(item, 'priceInfo.type') === 'spot';\n      return isSpot ? 'Maximum price per day' : 'Price per day';\n    };\n    const region = item => _.get(item, 'priceInfo.region');\n    const price = item => {\n      const perDay = item.pricePerDay;\n      if (_.isUndefined(perDay) || (_.isString(perDay) && _.isEmpty(perDay))) return 'N/A';\n      return `$${nicePrice(perDay)}`;\n    };\n\n    return (\n      <Table basic=\"very\" size=\"small\">\n        <Table.Body>\n          {_.map(config.displayProps).map((property, propertyIndex) => {\n            return (\n              // eslint-disable-next-line react/no-array-index-key\n              <Table.Row key={propertyIndex} textAlign=\"center\">\n                <Table.Cell>{property.key}</Table.Cell>\n                <Table.Cell>{property.value}</Table.Cell>\n              </Table.Row>\n            );\n          })}\n          <Table.Row textAlign=\"center\">\n            <Table.Cell>\n              {priceTitle(config)}\n              <div className=\"color-grey fs-9\">{region(config)}</div>\n            </Table.Cell>\n            <Table.Cell verticalAlign=\"top\">{price(config)}</Table.Cell>\n          </Table.Row>\n        </Table.Body>\n      </Table>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(SelectConfigurationCards, {\n  configurations: computed,\n  configurationId: computed,\n  formField: computed,\n  handleSelectConfigurationId: action,\n});\n\nexport default inject()(observer(SelectConfigurationCards));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\n\nimport { enableBuiltInWorkspaces } from '../../helpers/settings';\nimport BuiltIntEnvironmentsList from '../environments-builtin/EnvironmentsList';\nimport ScEnvironmentsList from '../environments-sc/ScEnvironmentsList';\n\nexport default () => (enableBuiltInWorkspaces ? <BuiltIntEnvironmentsList /> : <ScEnvironmentsList />);\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, action, observable, runInAction } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Header, Icon, Segment, Container, Label, Button } from 'semantic-ui-react';\n\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { storage, swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreLoading, isStoreEmpty, isStoreNotEmpty, isStoreError } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport ProgressPlaceHolder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\n\nimport EnvironmentCard from './EnvironmentCard';\nimport UserOnboarding from '../users/UserOnboarding';\nimport UserPinModal from '../users/UserPinModal';\nimport localStorageKeys from '../../models/constants/local-storage-keys';\n\n// expected props\n// - environmentsStore (via injection)\n// - location (from react router)\nclass EnvironmentsList extends React.Component {\n  constructor(props) {\n    super(props);\n    const user = this.getUserStore().user;\n\n    runInAction(() => {\n      this.user = user;\n      this.onboardingOpen = false;\n      this.pinModalOpen = user.isExternalUser && _.isEmpty(storage.getItem(localStorageKeys.pinToken));\n    });\n  }\n\n  componentDidMount() {\n    swallowError(this.getEnvironmentsStore().load());\n    this.getEnvironmentsStore().startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    this.getEnvironmentsStore().stopHeartbeat();\n  }\n\n  getEnvironmentsStore() {\n    return this.props.environmentsStore;\n  }\n\n  getUserStore() {\n    return this.props.userStore;\n  }\n\n  setOnboarding = value => {\n    this.onboardingOpen = value;\n  };\n\n  hidePinModal = () => {\n    this.pinModalOpen = false;\n  };\n\n  handleDetailClick = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    // see https://reactjs.org/docs/events.html and https://github.com/facebook/react/issues/5733\n    const instanceId = event.currentTarget.dataset.instance;\n    const goto = gotoFn(this);\n    goto(`/workspaces/id/${instanceId}`);\n  };\n\n  handleCreateEnvironment = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const goto = gotoFn(this);\n    goto(`/workspaces/create`);\n  };\n\n  handleConfigureCredentials = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.setOnboarding(true);\n  };\n\n  needsAWSCredentials = () => this.user.isExternalResearcher && !this.user.hasCredentials;\n\n  render() {\n    const store = this.getEnvironmentsStore();\n    let content = null;\n\n    if (this.needsAWSCredentials()) {\n      content = this.renderConfigureAWS();\n    } else if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder segmentCount={3} />;\n    } else if (isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (isStoreNotEmpty(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3 animated fadeIn\">\n        {this.renderTitle()}\n        {content}\n        {this.onboardingOpen && <UserOnboarding onclose={() => this.setOnboarding(false)} />}\n      </Container>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"clipboard outline\" />\n          No research workspaces\n          <Header.Subheader>To create a research workspace, click Create Research Workspace.</Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderConfigureAWS() {\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"key\" />\n          No AWS credentials\n          <Header.Subheader>To manage research workspaces, click Configure AWS Credentials.</Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"server\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Research Workspaces {this.renderTotal()}</Header.Content>\n        </Header>\n        {this.needsAWSCredentials() ? (\n          <Button color=\"orange\" size=\"medium\" basic onClick={this.handleConfigureCredentials}>\n            Configure AWS Credentials\n          </Button>\n        ) : (\n          <Button color=\"blue\" size=\"medium\" basic onClick={this.handleCreateEnvironment}>\n            Create Research Workspace\n          </Button>\n        )}\n      </div>\n    );\n  }\n\n  renderTotal() {\n    const store = this.getEnvironmentsStore();\n    if (isStoreError(store) || isStoreLoading(store)) return null;\n\n    return <Label circular>{store.total}</Label>;\n  }\n\n  renderMain() {\n    const store = this.getEnvironmentsStore();\n    const list = store.list;\n\n    return (\n      <div>\n        <UserPinModal\n          show={this.pinModalOpen}\n          hideModal={this.hidePinModal}\n          user={this.user}\n          message=\"PIN is required to get previously created stack information\"\n        />\n        {_.map(list, item => (\n          <Segment\n            className=\"p3 mb2 cursor-pointer\"\n            clearing\n            key={item.id}\n            data-instance={item.id}\n            onClick={this.handleDetailClick}\n          >\n            <EnvironmentCard environment={item} environmentsStore={this.getEnvironmentsStore()} user={this.user} />\n          </Segment>\n        ))}\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(EnvironmentsList, {\n  handleDetailClick: action,\n  setOnboarding: action,\n  hidePinModal: action,\n  user: observable,\n  onboardingOpen: observable,\n  pinModalOpen: observable,\n});\n\nexport default inject('environmentsStore', 'userStore')(withRouter(observer(EnvironmentsList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport _ from 'lodash';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, observable, runInAction } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport TimeAgo from 'react-timeago';\nimport { Header, Icon, Label, Image, Modal, Button } from 'semantic-ui-react';\nimport Dotdotdot from 'react-dotdotdot';\n\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { storage } from '@aws-ee/base-ui/dist/helpers/utils';\n\nimport EnvironmentStatusIcon from './EnvironmentStatusIcon';\nimport By from '../helpers/By';\nimport EnvironmentConnectButton from './EnvironmentConnectButton';\nimport localStorageKeys from '../../models/constants/local-storage-keys';\nimport sagemakerNotebookIcon from '../../../images/marketplace/sagemaker-notebook-icon.svg';\nimport emrIcon from '../../../images/marketplace/emr-icon.svg';\nimport ec2Icon from '../../../images/marketplace/ec2-icon.svg';\nimport rstudioIcon from '../../../images/marketplace/rstudio-icon.svg';\n\nconst UPDATE_INTERVAL_MS = 20000;\n\n// expected props\n// - environment - a Environment model instance (via props)\n// - environmentsStore - MobX environmentsStore model\n// - user - Current user\n// - userDisplayName (via injection)\n// - location (from react router)\nclass EnvironmentCard extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.shouldShowTerminateDialog = false;\n      this.terminationInProgress = false;\n    });\n  }\n\n  componentDidMount() {\n    const environment = this.getEnvironment();\n\n    environment.setFetchingUrl(false);\n    if (environment.isExternal && environment.isPending && this.props.user.isExternalUser) {\n      // TODO abstract this workflow to be used elsewhere\n      // Call checkExternalUpdate every minute\n      this.intervalId = setInterval(this.checkExternalUpdate, UPDATE_INTERVAL_MS, environment, this.props.user);\n    }\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.intervalId);\n  }\n\n  checkExternalUpdate = (environment, user) => {\n    const pin = storage.getItem(localStorageKeys.pinToken);\n    // Confirm if the stack still needs to be checked\n    if (!(environment.isExternal && environment.isPending && user.isExternalUser)) {\n      clearInterval(this.intervalId);\n      return;\n    }\n    if (!_.isEmpty(pin)) {\n      this.getStore().updateExternalEnvironment(environment, user, pin);\n    }\n  };\n\n  handleTerminateEnvironment = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const cleanTerminationState = () => {\n      runInAction(() => {\n        this.shouldShowTerminateDialog = false;\n        this.terminationInProgress = false;\n      });\n    };\n\n    try {\n      runInAction(() => {\n        this.terminationInProgress = true;\n      });\n      const store = this.getStore();\n      await store.deleteEnvironment(this.getEnvironment(), this.props.user, storage.getItem(localStorageKeys.pinToken));\n      cleanTerminationState();\n    } catch (error) {\n      cleanTerminationState();\n      displayError(error);\n    }\n  };\n\n  renderTerminateDialog(environment) {\n    const shouldShowTerminateDialog = this.shouldShowTerminateDialog;\n    const { name } = environment;\n    const progress = this.terminationInProgress;\n\n    return (\n      <Modal\n        open={shouldShowTerminateDialog}\n        size=\"tiny\"\n        onClose={this.hideTerminateDialog}\n        closeOnDimmerClick={!progress}\n      >\n        <Header content=\"Terminate Environment\" />\n        <Modal.Content>\n          <p>Are you sure you want to terminate environment &quot;{name}&quot; ?</p>\n        </Modal.Content>\n        <Modal.Actions>\n          <Button disabled={progress} onClick={this.hideTerminateDialog}>\n            Cancel\n          </Button>\n          <Button loading={progress} disabled={progress} color=\"red\" onClick={this.handleTerminateEnvironment}>\n            <Icon name=\"remove\" /> Terminate\n          </Button>\n        </Modal.Actions>\n      </Modal>\n    );\n  }\n\n  handleStopEnvironment = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    try {\n      const store = this.getStore();\n      await store.stopEnvironment(this.getEnvironment());\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  handleStartEnvironment = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    try {\n      const store = this.getStore();\n      await store.startEnvironment(this.getEnvironment());\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  showTerminateDialog = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.shouldShowTerminateDialog = true;\n    this.terminationInProgress = false;\n  };\n\n  hideTerminateDialog = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (this.terminationInProgress) return;\n    this.shouldShowTerminateDialog = false;\n  };\n\n  getEnvironment() {\n    return this.props.environment;\n  }\n\n  getStore() {\n    return this.props.environmentsStore;\n  }\n\n  getUserDisplayName() {\n    return this.props.userDisplayName;\n  }\n\n  getIcon(type) {\n    switch (type) {\n      case 'sagemaker':\n        return sagemakerNotebookIcon;\n      case 'emr':\n        return emrIcon;\n      case 'ec2-rstudio':\n        return rstudioIcon;\n      case 'ec2-linux':\n      case 'ec2-windows':\n        return ec2Icon;\n      default:\n        return null;\n    }\n  }\n\n  render() {\n    const item = this.getEnvironment();\n    return (\n      <div className=\"flex\">\n        {this.renderLeftCard(item)}\n        {this.renderRightCard(item)}\n        {this.renderTerminateDialog(item)}\n      </div>\n    );\n  }\n\n  renderLeftCard(env) {\n    const { name, description, createdAt, createdBy, fetchingUrl, status, instanceInfo } = env;\n    return (\n      <div className=\"flex-auto\">\n        <div className=\"flex\">\n          <Image\n            src={this.getIcon(instanceInfo.type)}\n            className=\"mt0 mr1\"\n            style={{ maxHeight: '24px', maxWidth: '24px' }}\n          />\n          <Header as=\"h3\" color=\"grey\" className=\"mt0 flex-auto\">\n            {name}\n          </Header>\n          <div className=\"flex\">\n            <Label className=\"flex-auto basic\" style={{ border: 0 }}>\n              {status === 'COMPLETED' &&\n                (instanceInfo.type === 'ec2-rstudio' ||\n                  instanceInfo.type === 'sagemaker' ||\n                  instanceInfo.type === 'emr') && (\n                  <EnvironmentConnectButton\n                    as={Label}\n                    user={this.props.user}\n                    environment={env}\n                    size=\"mini\"\n                    color=\"green\"\n                  >\n                    {fetchingUrl ? (\n                      <>\n                        Connecting\n                        <Icon loading name=\"spinner\" size=\"small\" className=\"ml1 mr1\" />\n                      </>\n                    ) : (\n                      <>Connect</>\n                    )}\n                  </EnvironmentConnectButton>\n                )}\n            </Label>\n            <Label className=\"flex-auto basic\" style={{ border: 0 }}>\n              <EnvironmentStatusIcon environment={env} />\n            </Label>\n          </div>\n        </div>\n        <div className=\"ml3 mb2 mt2 breakout\">\n          created <TimeAgo date={createdAt} /> <By uid={createdBy} />\n        </div>\n        <div className=\"ml3 mb2 mt2 breakout\">\n          <Dotdotdot clamp={3}>{description}</Dotdotdot>\n        </div>\n        <div className=\"ml3 mb2 mt2 breakout bold\">\n          Yesterday&apos;s Research Workspace Cost: ${this.getCostInPastDay(env.costs)}\n        </div>\n      </div>\n    );\n  }\n\n  getCostInPastDay(costInfo) {\n    if (_.isEmpty(costInfo)) {\n      return 0;\n    }\n    const costsForLatestDate = costInfo[costInfo.length - 1].cost;\n    let total = 0;\n    costsForLatestDate.forEach(service => {\n      total += service.amount;\n    });\n    return total.toFixed(2);\n  }\n\n  renderRightCard(environment) {\n    const userDisplayName = this.getUserDisplayName();\n    const sharedWithUsers = environment.sharedWithUsers; // array of uid\n    const sharedWithUsernames = _.map(sharedWithUsers, uid => userDisplayName.getDisplayName({ uid }));\n    return (\n      <div className=\"border-left border-grey pl2 ml2\">\n        <div className=\"mt1 fs-9\">\n          <span className=\"bold  inline-block\">Research Workspace Owners</span>{' '}\n          <Label circular size=\"mini\" color=\"blue\">\n            {1}\n          </Label>\n        </div>\n        <div className=\"fs-9\">\n          <Dotdotdot clamp={1}>{userDisplayName.getLongDisplayName({ uid: environment.createdBy })}</Dotdotdot>\n        </div>\n        <div className=\"mt3 fs-9\">\n          <span className=\"bold  inline-block\">Research Workspace Shared Users</span>{' '}\n          <Label circular size=\"mini\">\n            {sharedWithUsernames.length}\n          </Label>\n        </div>\n        <div className=\"fs-9\">\n          <Dotdotdot clamp={1}>{sharedWithUsernames.join(', ')}</Dotdotdot>\n        </div>\n\n        <div className=\"mt3 fs-9\">\n          <span className=\"bold  inline-block\">Project</span>{' '}\n        </div>\n        <div className=\"fs-9 mb2\">\n          <Dotdotdot clamp={1}>{environment.projectId}</Dotdotdot>\n        </div>\n        <div className=\"mb1 mt5 breakout flex-auto\">\n          {this.renderStopButton(environment)}\n          {this.renderStartButton(environment)}\n          {this.renderTerminateButton(environment)}\n        </div>\n      </div>\n    );\n  }\n\n  renderTerminateButton(environment) {\n    let terminateButton;\n    if (environment.isCompleted || environment.isStopped) {\n      terminateButton = (\n        <Label color=\"red\" className=\"cursor-pointer\" data-id={environment.id} onClick={this.showTerminateDialog}>\n          <Icon name=\"minus circle\" />\n          Terminate\n        </Label>\n      );\n    }\n\n    return <>{terminateButton}</>;\n  }\n\n  renderStopButton(environment) {\n    let stopButton;\n    // Only the environment types listed here currently have the start/stop functionality\n    const validEnvTypes = ['ec2-windows', 'ec2-linux', 'ec2-rstudio', 'sagemaker'];\n    // Render button if Environment can be stopped AND prevent admins from attempting to terminate external envs\n    if (\n      environment.isCompleted &&\n      !(this.props.user.isAdmin && environment.isExternal) &&\n      _.includes(validEnvTypes, environment.instanceInfo.type)\n    ) {\n      stopButton = (\n        <Label color=\"orange\" className=\"cursor-pointer\" data-id={environment.id} onClick={this.handleStopEnvironment}>\n          <Icon name=\"power\" />\n          Stop\n        </Label>\n      );\n    }\n\n    return <>{stopButton}</>;\n  }\n\n  renderStartButton(environment) {\n    let startButton;\n    // Render button if Environment can be stpped AND prevent admins from attempting to terminate external envs\n    if (environment.isStopped && !(this.props.user.isAdmin && environment.isExternal)) {\n      startButton = (\n        <Label color=\"green\" className=\"cursor-pointer\" data-id={environment.id} onClick={this.handleStartEnvironment}>\n          <Icon name=\"power\" />\n          Start\n        </Label>\n      );\n    }\n\n    return <>{startButton}</>;\n  }\n}\n\n// Using MobX-4 to decorate here\ndecorate(EnvironmentCard, {\n  showTerminateDialog: action,\n  hideTerminateDialog: action,\n  handleStartEnvironment: action,\n  handleStopEnvironment: action,\n  shouldShowTerminateDialog: observable,\n  terminationInProgress: observable,\n});\n\nexport default inject('userDisplayName')(withRouter(observer(EnvironmentCard)));\n","module.exports = __webpack_public_path__ + \"static/media/sagemaker-notebook-icon.16b8ce34.svg\";","module.exports = __webpack_public_path__ + \"static/media/emr-icon.bd442490.svg\";","module.exports = __webpack_public_path__ + \"static/media/ec2-icon.5803b096.svg\";","module.exports = __webpack_public_path__ + \"static/media/rstudio-icon.b72a04a4.svg\";","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { decorate, observable, runInAction } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { Modal, Form, Header, Button } from 'semantic-ui-react';\nimport PropTypes from 'prop-types';\n\nclass UserPinModal extends React.Component {\n  constructor(props) {\n    super(props);\n\n    runInAction(() => {\n      this.errorMsg = undefined;\n    });\n  }\n\n  handlePinSubmission = async e => {\n    e.preventDefault();\n    e.persist();\n\n    // Will throw error if PIN is incorrect\n    try {\n      await this.props.user.unencryptedCreds(e.target.pin.value);\n      runInAction(() => {\n        this.errorMsg = undefined;\n      });\n      this.props.hideModal();\n    } catch (error) {\n      runInAction(() => {\n        this.errorMsg = error.message;\n      });\n    }\n  };\n\n  render() {\n    return (\n      <Modal\n        as={Form}\n        onSubmit={this.handlePinSubmission}\n        open={this.props.show}\n        size=\"tiny\"\n        onClose={this.props.hideModal}\n        closeOnDimmerClick\n      >\n        <Header content=\"Enter PIN\" />\n        <Modal.Content>\n          {this.props.message}\n          <Form.Input\n            label=\"PIN\"\n            name=\"pin\"\n            required\n            type=\"password\"\n            placeholder=\"Your pin to access your AWS IAM user\"\n            error={this.errorMsg}\n          />\n        </Modal.Content>\n        <Modal.Actions>\n          <Button type=\"button\" content=\"Close\" onClick={this.props.hideModal} />\n          <Button type=\"submit\" color=\"blue\" content=\"Save\" />\n        </Modal.Actions>\n      </Modal>\n    );\n  }\n}\nUserPinModal.propTypes = {\n  show: PropTypes.bool.isRequired,\n  hideModal: PropTypes.func.isRequired,\n  // eslint-disable-next-line react/forbid-prop-types\n  user: PropTypes.object.isRequired,\n  message: PropTypes.string,\n};\nUserPinModal.defaultProps = {\n  message: '',\n};\n\ndecorate(UserPinModal, {\n  errorMsg: observable,\n});\n\nexport default observer(UserPinModal);\n","import React from 'react';\nimport _ from 'lodash';\nimport { decorate, computed, action, observable, runInAction } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Container, Segment, Header, Icon, Button, Label } from 'semantic-ui-react';\n\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { swallowError, storage } from '@aws-ee/base-ui/dist/helpers/utils';\nimport storageKeys from '@aws-ee/base-ui/dist/models/constants/local-storage-keys';\nimport {\n  isStoreLoading,\n  isStoreEmpty,\n  isStoreNotEmpty,\n  isStoreError,\n  isStoreReady,\n} from '@aws-ee/base-ui/dist/models/BaseStore';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport ProgressPlaceHolder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\n\nimport { filterNames } from '../../models/environments-sc/ScEnvironmentsStore';\nimport ScEnvironmentCard from './ScEnvironmentCard';\nimport ScEnvironmentsFilterButtons from './parts/ScEnvironmentsFilterButtons';\n\n// expected props\n// - scEnvironmentsStore (via injection)\n// - envTypesStore (via injection)\nclass ScEnvironmentsList extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      const key = storageKeys.workspacesFilterName;\n      const name = storage.getItem(key) || filterNames.ALL;\n      storage.setItem(key, name);\n      this.selectedFilter = name;\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n    const store = this.envsStore;\n    swallowError(store.load());\n    store.startHeartbeat();\n\n    const typesStore = this.envTypesStore;\n    if (!isStoreReady(typesStore)) {\n      swallowError(typesStore.load());\n    }\n  }\n\n  componentWillUnmount() {\n    const store = this.envsStore;\n    store.stopHeartbeat();\n  }\n\n  get envTypesStore() {\n    return this.props.envTypesStore;\n  }\n\n  get envsStore() {\n    return this.props.scEnvironmentsStore;\n  }\n\n  handleCreateEnvironment = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const goto = gotoFn(this);\n    goto(`/workspaces/create`);\n  };\n\n  handleSelectedFilter = name => {\n    this.selectedFilter = name;\n    const key = storageKeys.workspacesFilterName;\n    storage.setItem(key, name);\n  };\n\n  render() {\n    const store = this.envsStore;\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder segmentCount={3} />;\n    } else if (isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (isStoreNotEmpty(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3 animated fadeIn\">\n        {this.renderTitle()}\n        {content}\n      </Container>\n    );\n  }\n\n  renderMain() {\n    const store = this.envsStore;\n    const selectedFilter = this.selectedFilter;\n    const list = store.filtered(selectedFilter);\n    const isEmpty = _.isEmpty(list);\n\n    return (\n      <div data-testid=\"workspaces\">\n        <ScEnvironmentsFilterButtons\n          selectedFilter={selectedFilter}\n          onSelectedFilter={this.handleSelectedFilter}\n          className=\"mb3\"\n        />\n        {!isEmpty &&\n          _.map(list, item => (\n            <Segment className=\"p3 mb4\" clearing key={item.id}>\n              <ScEnvironmentCard scEnvironment={item} />\n            </Segment>\n          ))}\n        {isEmpty && (\n          <Segment placeholder>\n            <Header icon className=\"color-grey\">\n              <Icon name=\"server\" />\n              No research workspaces matching the selected filter.\n              <Header.Subheader>Select &apos;All&apos; to view all the workspaces</Header.Subheader>\n            </Header>\n          </Segment>\n        )}\n      </div>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <Segment data-testid=\"workspaces\" placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"server\" />\n          No research workspaces\n          <Header.Subheader>To create a research workspace, click Create Research Workspace.</Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"server\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Research Workspaces {this.renderTotal()}</Header.Content>\n        </Header>\n        <div>\n          <Button\n            data-testid=\"create-workspace\"\n            color=\"blue\"\n            size=\"medium\"\n            basic\n            onClick={this.handleCreateEnvironment}\n          >\n            Create Research Workspace\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  renderTotal() {\n    const store = this.envsStore;\n    if (isStoreError(store) || isStoreLoading(store)) return null;\n\n    return <Label circular>{store.total}</Label>;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentsList, {\n  selectedFilter: observable,\n  envsStore: computed,\n  envTypesStore: computed,\n  handleCreateEnvironment: action,\n  handleSelectedFilter: action,\n});\n\nexport default inject('scEnvironmentsStore', 'envTypesStore')(withRouter(observer(ScEnvironmentsList)));\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Header, Label, Popup, Icon, Divider, Message, Table, Grid, Segment } from 'semantic-ui-react';\nimport TimeAgo from 'react-timeago';\nimport { niceNumber } from '@aws-ee/base-ui/dist/helpers/utils';\n\nimport By from '../helpers/By';\nimport ScEnvironmentButtons from './parts/ScEnvironmentButtons';\nimport ScEnvironmentCost from './parts/ScEnvironmentCost';\n\n// expected props\n// - scEnvironment (via prop)\n// - envTypesStore (via injection)\nclass ScEnvironmentCard extends React.Component {\n  get envTypesStore() {\n    return this.props.envTypesStore;\n  }\n\n  get environment() {\n    return this.props.scEnvironment;\n  }\n\n  get envType() {\n    const env = this.props.scEnvironment;\n    const store = this.envTypesStore;\n    const envType = store.getEnvType(env.envTypeId);\n\n    return envType;\n  }\n\n  render() {\n    const env = this.environment;\n    const state = env.state;\n\n    return (\n      <>\n        {this.renderStatus(state)}\n        {this.renderTitle(env)}\n        {this.renderError(env)}\n        <Divider className=\"mt1 mb1\" />\n        {this.renderButtons(env)}\n        <Divider className=\"mt1\" />\n        {env.description || 'No description was provided for this workspace.'}\n        <Grid columns={2} stackable className=\"mt2\">\n          <Grid.Row stretched>\n            <Grid.Column width={12}>{this.renderDetailTable(env)}</Grid.Column>\n            <Grid.Column width={4}>\n              <Segment className=\"flex items-center\">\n                <div className=\"w-100 overflow-hidden\">\n                  <ScEnvironmentCost envId={env.id} />\n                </div>\n              </Segment>\n            </Grid.Column>\n          </Grid.Row>\n        </Grid>\n      </>\n    );\n  }\n\n  renderDetailTable(env) {\n    const studyCount = _.size(_.get(env, 'studyIds', []));\n    const envType = this.envType || {};\n    const renderRow = (key, value) => (\n      <Table.Row>\n        <Table.Cell width={5}>{key}</Table.Cell>\n        <Table.Cell width={11} className=\"breakout\">\n          {value}\n        </Table.Cell>\n      </Table.Row>\n    );\n\n    return (\n      <Table definition>\n        <Table.Body>\n          {renderRow('Owner', <By uid={env.createdBy} skipPrefix />)}\n          {renderRow('Studies', studyCount === 0 ? 'No studies linked to this workspace' : niceNumber(studyCount))}\n          {renderRow('Project', _.isEmpty(env.projectId) ? 'N/A' : env.projectId)}\n          {renderRow('Restricted CIDR', _.isEmpty(env.cidr) ? 'N/A' : env.cidr)}\n          {renderRow('Workspace Type', envType.name)}\n        </Table.Body>\n      </Table>\n    );\n  }\n\n  renderButtons(env) {\n    return <ScEnvironmentButtons scEnvironment={env} showDetailButton />;\n  }\n\n  renderStatus(state) {\n    return (\n      <div style={{ cursor: 'default' }}>\n        <Popup\n          trigger={\n            <Label attached=\"top left\" size=\"mini\" color={state.color}>\n              {state.spinner && <Icon name=\"spinner\" loading />}\n              {state.display}\n            </Label>\n          }\n        >\n          {state.tip}\n        </Popup>\n      </div>\n    );\n  }\n\n  renderTitle(env) {\n    return (\n      <Header as=\"h3\" className=\"mt1\">\n        {env.name}\n        <Header.Subheader>\n          <span className=\"fs-8 color-grey\">\n            Created <TimeAgo date={env.createdAt} className=\"mr2\" /> <By uid={env.createdBy} className=\"mr2\" />\n          </span>\n          <span className=\"fs-8 color-grey mr2\"> {env.id}</span>\n        </Header.Subheader>\n      </Header>\n    );\n  }\n\n  renderError(env) {\n    if (_.isEmpty(env.error)) return null;\n\n    return (\n      <Message negative>\n        <p>{env.error}</p>\n      </Message>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentCard, {\n  envTypesStore: computed,\n  environment: computed,\n  envType: computed,\n});\n\nexport default inject('envTypesStore')(withRouter(observer(ScEnvironmentCard)));\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Segment, Icon, Header } from 'semantic-ui-react';\n\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport {\n  isStoreLoading,\n  isStoreEmpty,\n  isStoreNotEmpty,\n  isStoreError,\n  isStoreReady,\n} from '@aws-ee/base-ui/dist/models/BaseStore';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport ProgressPlaceHolder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\n\nimport ScEnvironmentHttpConnections from './ScEnvironmentHttpConnections';\nimport ScEnvironmentSshConnections from './ScEnvironmentSshConnections';\nimport ScEnvironmentRdpConnections from './ScEnvironmentRdpConnections';\n\n// expected props\n// - scEnvironment (via prop)\n// - scEnvironmentsStore (via injection)\nclass ScEnvironmentConnections extends React.Component {\n  componentDidMount() {\n    const store = this.getConnectionStore();\n    if (!isStoreReady(store)) {\n      swallowError(store.load());\n    }\n  }\n\n  get environment() {\n    return this.props.scEnvironment;\n  }\n\n  get envsStore() {\n    return this.props.scEnvironmentsStore;\n  }\n\n  getConnectionStore() {\n    return this.envsStore.getScEnvConnectionStore(this.environment.id);\n  }\n\n  render() {\n    const store = this.getConnectionStore();\n    const env = this.environment;\n    const state = env.state;\n    const canConnect = state.canConnect;\n\n    if (!canConnect) return null;\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"pt2 mb2\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder segmentCount={1} className=\"mt2 mb2\" />;\n    } else if (isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (isStoreNotEmpty(store)) {\n      content = this.renderConnections();\n    } else {\n      content = null;\n    }\n    return <div className=\"fadeIn animated\">{content}</div>;\n  }\n\n  renderConnections() {\n    const env = this.environment;\n    const isHttp = scheme => scheme === 'http' || scheme === 'https' || _.isEmpty(scheme);\n    const isSsh = scheme => scheme === 'ssh';\n    const isRdp = scheme => scheme === 'rdp';\n    const hasHttp = !_.isEmpty(env.getConnections(item => isHttp(item.scheme)));\n    const hasSsh = !_.isEmpty(env.getConnections(item => isSsh(item.scheme)));\n    const hasRdp = !_.isEmpty(env.getConnections(item => isRdp(item.scheme)));\n\n    return (\n      // Keep the order the way it is, otherwise the drop down menus in the ssh connections\n      // will be cropped due to the 'fadeIn animated' changing the z index\n      <>\n        {hasHttp && <ScEnvironmentHttpConnections scEnvironment={env} />}\n        {hasRdp && <ScEnvironmentRdpConnections scEnvironment={env} />}\n        {hasSsh && <ScEnvironmentSshConnections scEnvironment={env} />}\n      </>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <Segment placeholder className=\"mt2 mb2\">\n        <Header icon className=\"color-grey\">\n          <Icon name=\"linkify\" />\n          No Connections\n          <Header.Subheader>This workspace does not have any defined connections.</Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentConnections, {\n  envsStore: computed,\n  environment: computed,\n});\n\nexport default inject('scEnvironmentsStore')(withRouter(observer(ScEnvironmentConnections)));\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, action, runInAction, observable } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Segment, Icon, Button, Header, Table } from 'semantic-ui-react';\n\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\n\nconst openWindow = (url, windowFeatures) => {\n  return window.open(url, '_blank', windowFeatures);\n};\n\n// expected props\n// - environment (via prop)\n// - scEnvironmentsStore (via injection)\nclass ScEnvironmentHttpConnections extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      // The id of the connection that is being processed\n      this.processingId = '';\n    });\n  }\n\n  get environment() {\n    return this.props.scEnvironment;\n  }\n\n  get envsStore() {\n    return this.props.scEnvironmentsStore;\n  }\n\n  getConnectionStore() {\n    return this.envsStore.getScEnvConnectionStore(this.environment.id);\n  }\n\n  // Returns only the connections that either have a scheme = 'http' or 'https' or no scheme\n  // [ {id, name: <string>(optional), url: <string>(optional)}, ... ]\n  get connections() {\n    const isHttp = scheme => scheme === 'http' || scheme === 'https' || _.isEmpty(scheme);\n    const connections = this.environment.getConnections(item => isHttp(item.scheme));\n\n    return connections;\n  }\n\n  handleConnect = id =>\n    action(async () => {\n      const store = this.getConnectionStore();\n      const connections = this.environment.connections;\n      const connectInfo = _.find(connections, ['id', id]) || {};\n      let url = connectInfo.url;\n\n      this.processingId = id;\n      try {\n        if (url) {\n          // We use noopener and noreferrer for good practices https://developer.mozilla.org/en-US/docs/Web/API/Window/open#noopener\n          openWindow(url, 'noopener,noreferrer');\n        } else {\n          const newTab = openWindow('about:blank');\n          url = await store.createConnectionUrl(id);\n          newTab.location = url;\n        }\n      } catch (error) {\n        displayError(error);\n      } finally {\n        runInAction(() => {\n          this.processingId = '';\n        });\n      }\n    });\n\n  render() {\n    const env = this.environment;\n    const state = env.state;\n    const canConnect = state.canConnect;\n    const connections = this.connections;\n    const processingId = this.processingId;\n    const isDisabled = id => processingId !== id && !_.isEmpty(processingId);\n    const isLoading = id => processingId === id;\n    if (!canConnect) return null;\n\n    return (\n      <div className=\"mt2 mb2\">\n        <Table celled>\n          <Table.Header>\n            <Table.Row>\n              <Table.HeaderCell colSpan=\"1\">HTTP Connections</Table.HeaderCell>\n            </Table.Row>\n          </Table.Header>\n          <Table.Body>\n            {_.map(connections, item => (\n              <Table.Row key={item.id}>\n                <Table.Cell className=\"clearfix\">\n                  <Button\n                    floated=\"right\"\n                    size=\"mini\"\n                    primary\n                    disabled={isDisabled(item.id)}\n                    loading={isLoading(item.id)}\n                    onClick={this.handleConnect(item.id)}\n                  >\n                    Connect\n                  </Button>\n\n                  <div className=\"mt1\">{item.name || 'Connect'}</div>\n                </Table.Cell>\n              </Table.Row>\n            ))}\n          </Table.Body>\n        </Table>\n      </div>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <Segment placeholder className=\"mt2 mb2\">\n        <Header icon className=\"color-grey\">\n          <Icon name=\"linkify\" />\n          No HTTP Connections\n          <Header.Subheader>This workspace does not have any defined HTTP connections.</Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentHttpConnections, {\n  envsStore: computed,\n  environment: computed,\n  connections: computed,\n  processingId: observable,\n});\n\nexport default inject('scEnvironmentsStore')(withRouter(observer(ScEnvironmentHttpConnections)));\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, action, runInAction, observable } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Segment, Icon, Button, Header, Table, Message } from 'semantic-ui-react';\n\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreLoading, isStoreError, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport ProgressPlaceHolder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport KeyPairCreateForm from '@aws-ee/key-pair-mgmt-ui/dist/parts/key-pairs/parts/KeyPairCreateForm';\n\nimport ScEnvironmentSshConnectionRow from './ScEnvironmentSshConnectionRow';\n\n// expected props\n// - environment (via prop)\n// - keyPairsStore  (vai injection)\nclass ScEnvironmentSshConnections extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      // A flag to indicate if we need to show the create key form\n      this.showCreateKey = false;\n    });\n  }\n\n  componentDidMount() {\n    const store = this.keyPairsStore;\n    if (!isStoreReady(store)) {\n      swallowError(store.load());\n    }\n  }\n\n  get environment() {\n    return this.props.scEnvironment;\n  }\n\n  get keyPairsStore() {\n    return this.props.keyPairsStore;\n  }\n\n  // Returns only the connections that scheme = 'ssh'\n  // [ {id, name: <string>(optional), instanceId: <string>, scheme: 'ssh'}, ... ]\n  get connections() {\n    const connections = this.environment.getConnections(item => item.scheme === 'ssh');\n\n    return connections;\n  }\n\n  toggleCreateKey = () => {\n    this.showCreateKey = !this.showCreateKey;\n  };\n\n  render() {\n    const store = this.keyPairsStore;\n    const env = this.environment;\n    const state = env.state;\n    const canConnect = state.canConnect;\n    const empty = _.isEmpty(this.connections);\n\n    if (!canConnect) return null;\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"pt2 mb2\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder segmentCount={1} className=\"mt2 mb2\" />;\n    } else if (empty) {\n      content = this.renderEmpty();\n    } else {\n      content = this.renderConnections();\n    }\n\n    return <div className=\"fadeIn animated\">{content}</div>;\n  }\n\n  renderConnections() {\n    const env = this.environment;\n    const showCreateKey = this.showCreateKey;\n    const connections = this.connections;\n    const store = this.keyPairsStore;\n    const empty = store.empty;\n\n    if (showCreateKey) return this.renderCreateKeyForm();\n\n    return (\n      <div className=\"mt2 mb2 fadeIn animated\">\n        {empty && (\n          <Message warning>\n            <Message.Header>Attention!</Message.Header>\n            <Message.List>\n              <Message.Item>\n                You do not have any key pairs. A key pair is needed to connect via SSH to the target machine.\n              </Message.Item>\n              <Message.Item>\n                You can create a key pair now by clicking on the &apos;Create Key&apos; button below.\n              </Message.Item>\n            </Message.List>\n          </Message>\n        )}\n        <Table celled>\n          <Table.Header>\n            <Table.Row>\n              <Table.HeaderCell colSpan=\"3\" className=\"clearfix\">\n                <div>\n                  <Button floated=\"right\" color=\"blue\" size=\"mini\" basic onClick={this.toggleCreateKey}>\n                    Create Key\n                  </Button>\n                </div>\n                <div className=\"mt1\">SSH Connections</div>\n              </Table.HeaderCell>\n            </Table.Row>\n          </Table.Header>\n          <Table.Body>\n            {_.map(connections, item => (\n              <ScEnvironmentSshConnectionRow key={item.id} scEnvironment={env} connectionId={item.id} />\n            ))}\n          </Table.Body>\n        </Table>\n      </div>\n    );\n  }\n\n  renderCreateKeyForm() {\n    return (\n      <Segment className=\"clearfix mt2 mb2 p2 fadeIn animated\">\n        <KeyPairCreateForm onCancel={this.toggleCreateKey} />\n      </Segment>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <Segment placeholder className=\"mt2 mb2\">\n        <Header icon className=\"color-grey\">\n          <Icon name=\"linkify\" />\n          No SSH Connections\n          <Header.Subheader>This workspace does not have any defined SSH connections.</Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentSshConnections, {\n  environment: computed,\n  keyPairsStore: computed,\n  connections: computed,\n  showCreateKey: observable,\n  toggleCreateKey: action,\n});\n\nexport default inject('keyPairsStore')(withRouter(observer(ScEnvironmentSshConnections)));\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, action, runInAction, observable } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Button, Table, Dropdown } from 'semantic-ui-react';\n\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\n\nimport ScEnvSshConnRowExpanded from './ScEnvSshConnRowExpanded';\n\n// expected props\n// - scEnvironment (via prop)\n// - connectionId (via prop)\n// - scEnvironmentsStore (via injection)\n// - keyPairsStore  (vai injection)\nclass ScEnvironmentSshConnectionRow extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      const key = _.first(this.keyPairsStore.listActive) || {};\n\n      // The networksInterfaces we get once we send the ssh key\n      this.networkInterfaces = undefined;\n      // A flag to indicate if the activation of ssh is being processed\n      this.processingSendKey = false;\n      // We default the selected key (if any) to the first latest active key\n      this.selectedKeyId = key.id;\n    });\n  }\n\n  get environment() {\n    return this.props.scEnvironment;\n  }\n\n  get envsStore() {\n    return this.props.scEnvironmentsStore;\n  }\n\n  get keyPairsStore() {\n    return this.props.keyPairsStore;\n  }\n\n  get keyPairOptions() {\n    return _.map(this.keyPairsStore.listActive, item => ({ key: item.id, value: item.id, text: item.name }));\n  }\n\n  getConnectionStore() {\n    return this.envsStore.getScEnvConnectionStore(this.environment.id);\n  }\n\n  // Returns only the connections that scheme = 'ssh'\n  // [ {id, name: <string>(optional), instanceId: <string>, scheme: 'ssh'}, ... ]\n  get connections() {\n    const connections = this.environment.getConnections(item => item.scheme === 'ssh');\n\n    return connections;\n  }\n\n  get connection() {\n    const id = this.connectionId;\n    const connections = this.connections;\n\n    return _.find(connections, ['id', id]) || {};\n  }\n\n  get connectionId() {\n    return this.props.connectionId;\n  }\n\n  get selectedKeyName() {\n    if (_.isEmpty(this.selectedKeyId)) return '';\n    return _.get(this.keyPairsStore.getKeyPair(this.selectedKeyId), 'name');\n  }\n\n  handleActivate = async () => {\n    const keyId = this.selectedKeyId;\n    const store = this.getConnectionStore();\n    const connectionId = this.connectionId;\n    if (_.isEmpty(keyId)) {\n      displayError('Please select the name of the key pair that you want to use');\n      return;\n    }\n\n    this.networkInterfaces = undefined;\n    this.processingSendKey = true;\n    try {\n      const result = await store.sendSshKey(connectionId, keyId);\n      runInAction(() => {\n        this.networkInterfaces = _.get(result, 'networkInterfaces');\n      });\n    } catch (error) {\n      displayError(error);\n    } finally {\n      runInAction(() => {\n        this.processingSendKey = false;\n      });\n    }\n  };\n\n  handleKeyChange = (e, data) => {\n    const value = _.get(data, 'value');\n    const changed = value !== this.selectedKeyId;\n    this.selectedKeyId = value;\n\n    if (changed) this.networkInterfaces = undefined;\n  };\n\n  render() {\n    const store = this.keyPairsStore;\n    const emptyKeys = _.isEmpty(store.listActive);\n    const item = this.connection;\n    const networkInterfaces = this.networkInterfaces;\n    const options = this.keyPairOptions;\n    const selectedKeyId = this.selectedKeyId;\n    const selectedKeyName = this.selectedKeyName;\n    const rows = [\n      <Table.Row key={item.id}>\n        <Table.Cell>\n          <div className=\"mt1\">{item.name || item.instanceId}</div>\n        </Table.Cell>\n        <Table.Cell>\n          {emptyKeys && 'No key pair found'}\n          {!emptyKeys && (\n            <Dropdown\n              upward\n              placeholder=\"Select Key\"\n              fluid\n              selection\n              options={options}\n              value={selectedKeyId}\n              onChange={this.handleKeyChange}\n              disabled={emptyKeys || this.processingSendKey}\n            />\n          )}\n        </Table.Cell>\n        <Table.Cell collapsing>\n          <Button\n            primary\n            size=\"mini\"\n            onClick={this.handleActivate}\n            disabled={emptyKeys}\n            loading={this.processingSendKey}\n          >\n            Use this SSH Key\n          </Button>\n        </Table.Cell>\n      </Table.Row>,\n    ];\n\n    if (networkInterfaces) {\n      rows.push(\n        <ScEnvSshConnRowExpanded\n          key={`${item.id}__1`}\n          networkInterfaces={networkInterfaces}\n          keyName={selectedKeyName}\n          connectionId={item.id}\n        />,\n      );\n    }\n\n    return rows;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentSshConnectionRow, {\n  envsStore: computed,\n  environment: computed,\n  keyPairsStore: computed,\n  connections: computed,\n  connection: computed,\n  connectionId: computed,\n  keyPairOptions: computed,\n  selectedKeyName: computed,\n  selectedKeyId: observable,\n  networkInterfaces: observable,\n  processingSendKey: observable,\n  handleActivate: action,\n  handleKeyChange: action,\n});\n\nexport default inject('scEnvironmentsStore', 'keyPairsStore')(withRouter(observer(ScEnvironmentSshConnectionRow)));\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, action, runInAction, observable, computed } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Table, List, Segment, Label, Grid } from 'semantic-ui-react';\n\nimport CopyToClipboard from '../../helpers/CopyToClipboard';\n\n// expected props\n// networkInterfaces (via props)\n// keyName (via props)\n// connectionId (via props)\nclass ScEnvSshConnRowExpanded extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      // The count down value\n      this.countDown = undefined;\n      this.intervalId = undefined;\n      this.expired = false;\n    });\n  }\n\n  get networkInterfaces() {\n    const entries = this.props.networkInterfaces;\n    if (_.isEmpty(entries)) return [];\n\n    const result = [];\n    _.forEach(entries, item => {\n      if (item.publicDnsName) result.push({ value: item.publicDnsName, type: 'dns', scope: 'public', info: 'Public' });\n      if (item.privateIp) result.push({ value: item.privateIp, type: 'ip', scope: 'private', info: 'Private' });\n    });\n\n    return result;\n  }\n\n  get keyName() {\n    return this.props.keyName;\n  }\n\n  get connectionId() {\n    return this.props.connectionId;\n  }\n\n  componentDidMount() {\n    this.startCountDown();\n  }\n\n  componentWillUnmount() {\n    this.clearInterval();\n  }\n\n  clearInterval() {\n    if (!_.isUndefined(this.intervalId)) {\n      clearInterval(this.intervalId);\n      this.intervalId = undefined;\n    }\n    this.countDown = undefined;\n    this.expired = false;\n  }\n\n  startCountDown = () => {\n    if (!_.isUndefined(this.intervalId)) return;\n    this.countDown = 60;\n\n    this.intervalId = setInterval(async () => {\n      // eslint-disable-next-line consistent-return\n      runInAction(() => {\n        if (this.countDown <= 0) {\n          this.clearInterval();\n          this.expired = true;\n          return;\n        }\n        this.countDown -= 1;\n      });\n    }, 1000);\n  };\n\n  render() {\n    const connectionId = this.connectionId;\n    const keyName = this.keyName;\n    const interfaces = this.networkInterfaces;\n    const example = `ssh -i '${keyName}.pem' ec2-user@${_.get(_.first(interfaces), 'value')}`;\n\n    return (\n      <Table.Row key={connectionId} className=\"fadeIn animated\">\n        <Table.Cell colSpan=\"3\" className=\"p3\">\n          <Grid columns={2} stackable>\n            <Grid.Row stretched>\n              <Grid.Column width={12}>{this.renderInfo()}</Grid.Column>\n              <Grid.Column width={4}>\n                <Segment className=\"flex items-center\">\n                  <div className=\"w-100 overflow-hidden\">{this.renderCountDown()}</div>\n                </Segment>\n              </Grid.Column>\n            </Grid.Row>\n          </Grid>\n          <div className=\"mt3\">\n            Example:\n            <Segment className=\"mt2\">\n              {example} <CopyToClipboard text={example} className=\"ml2 mt0\" />\n            </Segment>\n          </div>\n        </Table.Cell>\n      </Table.Row>\n    );\n  }\n\n  renderInfo() {\n    const interfaces = this.networkInterfaces;\n    const moreThanOne = _.size(interfaces) > 1;\n\n    return (\n      <div>\n        <b>You&apos;ll need two pieces of information to connect to this research workspace.</b>\n        <List bulleted>\n          <List.Item>\n            The IP Address or DNS of the instance.{' '}\n            {moreThanOne ? 'Ask your administrator if you are not sure which one to use:' : ''}\n            <List>\n              {_.map(interfaces, network => (\n                <List.Item key={network.value} className=\"flex\">\n                  {this.renderHostLabel(network)}\n                  <CopyToClipboard text={network.value} />\n                </List.Item>\n              ))}\n            </List>\n          </List.Item>\n          <List.Item>The SSH private key. You downloaded the private key when you created the SSH key.</List.Item>\n        </List>\n        <div className=\"mt3\">\n          Connecting to your research workspace depends on the operating system you are connecting from.\n        </div>\n        <List bulleted>\n          <List.Item\n            href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AccessingInstancesLinux.html\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            Connecting from MacOS or Linux via SSH\n          </List.Item>\n          <List.Item\n            href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/putty.html\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            Connecting from Windows via Putty\n          </List.Item>\n        </List>\n      </div>\n    );\n  }\n\n  renderCountDown() {\n    const expired = this.expired;\n    const countDown = this.countDown;\n    if (expired) {\n      return (\n        <div className=\"center color-red\">\n          The time window to connect has expired. To reset it, click on the <b className=\"fs-9\">Use this SSH Key</b>{' '}\n          button again.\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"center\">\n        <div className=\"mb1\">\n          You have <br /> <b>{countDown}</b> <br /> seconds to connect\n        </div>\n      </div>\n    );\n  }\n\n  renderHostLabel(network) {\n    return (\n      <Label>\n        Host\n        <Label.Detail>\n          {network.value} <span className=\"fs-7 pl1\">({network.info})</span>\n        </Label.Detail>\n      </Label>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvSshConnRowExpanded, {\n  networkInterfaces: computed,\n  keyName: computed,\n  connectionId: computed,\n  intervalId: observable,\n  countDown: observable,\n  expired: observable,\n  startCountDown: action,\n  clearInterval: action,\n});\n\nexport default inject()(withRouter(observer(ScEnvSshConnRowExpanded)));\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Segment, Icon, Header, Table } from 'semantic-ui-react';\n\nimport ScEnvironmentRdpConnectionRow from './ScEnvironmentRdpConnectionRow';\n\n// expected props\n// - environment (via prop)\nclass ScEnvironmentRdpConnections extends React.Component {\n  get environment() {\n    return this.props.scEnvironment;\n  }\n\n  // Returns only the connections that scheme = 'rdp'\n  // [ {id, name: <string>(optional), instanceId: <string>, scheme: 'rdp'}, ... ]\n  get connections() {\n    const connections = this.environment.getConnections(item => item.scheme === 'rdp');\n\n    return connections;\n  }\n\n  render() {\n    const env = this.environment;\n    const state = env.state;\n    const canConnect = state.canConnect;\n    const empty = _.isEmpty(this.connections);\n\n    if (!canConnect) return null;\n    let content = null;\n\n    if (empty) {\n      content = this.renderEmpty();\n    } else {\n      content = this.renderConnections();\n    }\n\n    return <div className=\"fadeIn animated\">{content}</div>;\n  }\n\n  renderConnections() {\n    const env = this.environment;\n    const connections = this.connections;\n\n    return (\n      <div className=\"mt2 mb2 fadeIn animated\">\n        <Table celled>\n          <Table.Header>\n            <Table.Row>\n              <Table.HeaderCell colSpan=\"1\">RDP Connections</Table.HeaderCell>\n            </Table.Row>\n          </Table.Header>\n          <Table.Body>\n            {_.map(connections, item => (\n              <ScEnvironmentRdpConnectionRow key={item.id} scEnvironment={env} connectionId={item.id} />\n            ))}\n          </Table.Body>\n        </Table>\n      </div>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <Segment placeholder className=\"mt2 mb2\">\n        <Header icon className=\"color-grey\">\n          <Icon name=\"linkify\" />\n          No RDP Connections\n          <Header.Subheader>This workspace does not have any defined RDP connections.</Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentRdpConnections, {\n  environment: computed,\n  connections: computed,\n});\n\nexport default inject()(withRouter(observer(ScEnvironmentRdpConnections)));\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, action, runInAction, observable } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Button, Table, List, Label } from 'semantic-ui-react';\n\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\n\nimport CopyToClipboard from '../../helpers/CopyToClipboard';\n\n// expected props\n// - scEnvironment (via prop)\n// - connectionId (via prop)\n// - scEnvironmentsStore (via injection)\nclass ScEnvironmentRdpConnectionRow extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      // The windowsRdpInfo we get once we ask for the windows rdp info\n      // This is an object { password: <string>, networkInterfaces: [ ... ] }\n      this.windowsRdpInfo = undefined;\n      // A flag to indicate if we are in the process of getting the windows rdp info\n      this.processingGetInfo = false;\n      // Should the password be shown\n      this.showPassword = false;\n    });\n  }\n\n  get environment() {\n    return this.props.scEnvironment;\n  }\n\n  get envsStore() {\n    return this.props.scEnvironmentsStore;\n  }\n\n  getConnectionStore() {\n    return this.envsStore.getScEnvConnectionStore(this.environment.id);\n  }\n\n  // Returns only the connections that scheme = 'rdp'\n  // [ {id, name: <string>(optional), instanceId: <string>, scheme: 'rdp'}, ... ]\n  get connections() {\n    const connections = this.environment.getConnections(item => item.scheme === 'rdp');\n\n    return connections;\n  }\n\n  get connection() {\n    const id = this.connectionId;\n    const connections = this.connections;\n\n    return _.find(connections, ['id', id]) || {};\n  }\n\n  get connectionId() {\n    return this.props.connectionId;\n  }\n\n  get networkInterfaces() {\n    const entries = _.get(this.windowsRdpInfo, 'networkInterfaces');\n    if (_.isEmpty(entries)) return [];\n\n    const result = [];\n    _.forEach(entries, item => {\n      if (item.publicDnsName) result.push({ value: item.publicDnsName, type: 'dns', scope: 'public', info: 'Public' });\n      if (item.privateIp) result.push({ value: item.privateIp, type: 'ip', scope: 'private', info: 'Private' });\n    });\n\n    return result;\n  }\n\n  handleGetInfo = async () => {\n    const store = this.getConnectionStore();\n    const connectionId = this.connectionId;\n\n    this.windowsRdpInfo = undefined;\n    this.showPassword = false;\n    this.processingGetInfo = true;\n\n    try {\n      const result = await store.getWindowsRdpInfo(connectionId);\n      runInAction(() => {\n        this.windowsRdpInfo = result || {};\n      });\n    } catch (error) {\n      displayError(error);\n    } finally {\n      runInAction(() => {\n        this.processingGetInfo = false;\n      });\n    }\n  };\n\n  toggleShowPassword = () => {\n    this.showPassword = !this.showPassword;\n  };\n\n  render() {\n    const item = this.connection;\n    const windowsRdpInfo = this.windowsRdpInfo;\n    const processing = this.processingGetInfo;\n\n    const rows = [\n      <Table.Row key={item.id}>\n        <Table.Cell className=\"clearfix\">\n          <Button floated=\"right\" size=\"mini\" primary loading={processing} onClick={this.handleGetInfo}>\n            Get Password\n          </Button>\n\n          <div className=\"mt1\">{item.name || 'Connect'}</div>\n        </Table.Cell>\n      </Table.Row>,\n    ];\n\n    if (windowsRdpInfo) {\n      rows.push(this.renderExpanded());\n    }\n\n    return rows;\n  }\n\n  renderExpanded() {\n    const item = this.connection;\n    const windowsRdpInfo = this.windowsRdpInfo;\n    const interfaces = this.networkInterfaces;\n    const username = 'Administrator';\n    const password = windowsRdpInfo.password;\n    const showPassword = this.showPassword;\n    const moreThanOne = _.size(interfaces) > 1;\n\n    return (\n      <Table.Row key={`${item.id}__2`}>\n        <Table.Cell className=\"p3\">\n          <b>\n            Your Windows workspace can be accessed via an RDP client by using the DNS host name and credentials defined\n            below.\n          </b>\n          <List bulleted>\n            <List.Item>\n              The IP Address or DNS of the instance.{' '}\n              {moreThanOne ? 'Ask your administrator if you are not sure which one to use:' : ''}\n              <List>\n                {_.map(interfaces, network => (\n                  <List.Item key={network.value} className=\"flex\">\n                    {this.renderHostLabel(network)}\n                    <CopyToClipboard text={network.value} />\n                  </List.Item>\n                ))}\n              </List>\n            </List.Item>\n            <List.Item>\n              The username and password:\n              <List>\n                <List.Item className=\"flex\">\n                  {this.renderUsernameLabel(username)}\n                  <CopyToClipboard text={username} />\n                </List.Item>\n                <List.Item className=\"flex\">\n                  {this.renderPasswordLabel(password)}\n                  <Button className=\"ml2\" basic size=\"mini\" onClick={this.toggleShowPassword}>\n                    {showPassword ? 'Hide' : 'Show'}\n                  </Button>\n                  <CopyToClipboard text={password} />\n                </List.Item>\n              </List>\n            </List.Item>\n          </List>\n          <div className=\"mt3\">\n            Additional information about connecting via RDP can be found in the documentation below:\n          </div>\n          <List bulleted>\n            <List.Item\n              href=\"https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/connecting_to_windows_instance.html#connect-rdp\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              Connect to Your Windows Instance\n            </List.Item>\n          </List>\n        </Table.Cell>\n      </Table.Row>\n    );\n  }\n\n  renderPasswordLabel(password) {\n    const showPassword = this.showPassword;\n    return (\n      <Label>\n        Password\n        <Label.Detail>{showPassword ? password : '****************'}</Label.Detail>\n      </Label>\n    );\n  }\n\n  renderUsernameLabel(username) {\n    return (\n      <Label>\n        Username\n        <Label.Detail>{username}</Label.Detail>\n      </Label>\n    );\n  }\n\n  renderHostLabel(network) {\n    return (\n      <Label>\n        Host\n        <Label.Detail>\n          {network.value} <span className=\"fs-7 pl1\">({network.info})</span>\n        </Label.Detail>\n      </Label>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentRdpConnectionRow, {\n  envsStore: computed,\n  environment: computed,\n  connections: computed,\n  connection: computed,\n  connectionId: computed,\n  networkInterfaces: computed,\n  windowsRdpInfo: observable,\n  processingGetInfo: observable,\n  showPassword: observable,\n  handleGetInfo: action,\n  toggleShowPassword: action,\n});\n\nexport default inject('scEnvironmentsStore')(withRouter(observer(ScEnvironmentRdpConnectionRow)));\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, action } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { Button } from 'semantic-ui-react';\nimport c from 'classnames';\n\nimport { filterNames } from '../../../models/environments-sc/ScEnvironmentsStore';\n\nconst filterColorMap = {\n  [filterNames.ALL]: 'blue',\n  [filterNames.AVAILABLE]: 'green',\n  [filterNames.PENDING]: 'orange',\n  [filterNames.ERRORED]: 'red',\n  [filterNames.TERMINATED]: 'grey',\n};\n\n// expected props\n// - selectedFilter (via prop) the filter name of the currently selected filter\n// - onSelectedFilter (via prop) a fn to be called when a button is selected\n// - className (via prop) optional\nclass ScEnvironmentsFilterButtons extends React.Component {\n  get selectedFilter() {\n    return this.props.selectedFilter;\n  }\n\n  get onSelectedFilter() {\n    const fn = this.props.onSelectedFilter;\n    return _.isFunction(fn) ? fn : () => {};\n  }\n\n  handleSelected = name =>\n    action(() => {\n      this.onSelectedFilter(name);\n    });\n\n  render() {\n    const selectedFilter = this.selectedFilter;\n    const getAttrs = name => {\n      const color = _.get(filterColorMap, name, 'grey');\n      const selected = name === selectedFilter;\n      const attrs = { active: selected, basic: !selected, color, style: { cursor: selected ? 'default' : 'pointer' } };\n      if (!selected) attrs.onClick = this.handleSelected(name);\n      return attrs;\n    };\n\n    return (\n      <div className={c('clearfix', this.props.className)}>\n        <Button.Group floated=\"right\">\n          {_.map(_.keys(filterColorMap), name => (\n            <Button key={name} {...getAttrs(name)}>\n              {_.startCase(name)}\n            </Button>\n          ))}\n        </Button.Group>\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentsFilterButtons, {\n  selectedFilter: computed,\n  onSelectedFilter: computed,\n});\n\nexport default observer(ScEnvironmentsFilterButtons);\n","import React from 'react';\n\nimport { enableBuiltInWorkspaces } from '../../helpers/settings';\nimport BuiltIntEnvironmentDetailPage from '../environments-builtin/EnvironmentDetailPage';\nimport ScEnvironmentDetailPage from '../environments-sc/ScEnvironmentDetailPage';\n\nexport default () => (enableBuiltInWorkspaces ? <BuiltIntEnvironmentDetailPage /> : <ScEnvironmentDetailPage />);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject, Observer } from 'mobx-react';\nimport { decorate, observable, action, runInAction } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport TimeAgo from 'react-timeago';\nimport {\n  Accordion,\n  Breadcrumb,\n  Button,\n  Container,\n  Dropdown,\n  Header,\n  Icon,\n  Label,\n  Popup,\n  Reveal,\n  Segment,\n  Tab,\n  Table,\n} from 'semantic-ui-react';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\n\nimport crypto from 'crypto';\n\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { isStoreLoading, isStoreReady, isStoreError } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport ProgressPlaceHolder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\n\nimport EnvironmentStatusIcon from './EnvironmentStatusIcon';\nimport By from '../helpers/By';\nimport EnvironmentConnectButton from './EnvironmentConnectButton';\n\nconst ErrorInfo = ({ environment }) => {\n  const [visible, setVisible] = React.useState(() => false);\n  // if (!environment.error) {\n  //   environment.getEnvironmentError();\n  // }\n\n  return (\n    <Segment>\n      This research workspace encountered an {environment.error ? 'error' : 'unknown error'}.\n      {environment.error ? (\n        <Accordion>\n          <Accordion.Title active={visible} index={0} onClick={() => setVisible(s => !s)}>\n            <Icon name=\"dropdown\" />\n            Detailed error information\n          </Accordion.Title>\n          <Accordion.Content active={visible}>\n            <p>{environment.error}</p>\n          </Accordion.Content>\n        </Accordion>\n      ) : null}\n    </Segment>\n  );\n};\n\n// expected props\n// - environmentsStore (via injection)\n// - userStore (via injection)\n// - location (from react router)\nclass EnvironmentDetailPage extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.updateSharedWithUsers = [];\n      this.formProcessing = false;\n    });\n  }\n\n  componentDidMount() {\n    const store = this.getInstanceStore();\n    swallowError(store.load());\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.getInstanceStore();\n    store.stopHeartbeat();\n  }\n\n  getInstanceStore() {\n    const instanceId = this.getInstanceId();\n    return this.props.environmentsStore.getEnvironmentStore(instanceId);\n  }\n\n  getUserStore() {\n    return this.props.userStore;\n  }\n\n  getUser() {\n    const store = this.getUserStore();\n    if (!isStoreReady(store)) return {};\n    return store.user;\n  }\n\n  getInstanceId() {\n    return (this.props.match.params || {}).instanceId;\n  }\n\n  getEnvironment() {\n    const store = this.getInstanceStore();\n    if (!isStoreReady(store)) return {};\n    return store.environment;\n  }\n\n  render() {\n    const store = this.getInstanceStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder />;\n    } else if (isStoreReady(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3\">\n        {this.renderBreadcrumb()}\n        {content}\n      </Container>\n    );\n  }\n\n  renderBreadcrumb() {\n    const instanceId = this.getInstanceId();\n    const goto = gotoFn(this);\n\n    return (\n      <Breadcrumb className=\"block mb3\">\n        <Breadcrumb.Section link onClick={() => goto('/workspaces')}>\n          Research Workspaces\n        </Breadcrumb.Section>\n        <Breadcrumb.Divider icon=\"right angle\" />\n        <Breadcrumb.Section active>{instanceId}</Breadcrumb.Section>\n      </Breadcrumb>\n    );\n  }\n\n  renderMain() {\n    const instance = this.getEnvironment();\n    const { id, name, updatedAt, updatedBy } = instance;\n\n    return (\n      <>\n        <div className=\"flex mb2\">\n          <Header as=\"h3\" color=\"grey\" className=\"mt0 flex-auto ellipsis\">\n            <span className=\"flex justify-between\">\n              <div>\n                <Label color=\"blue\" className=\"ml0 mr1\">\n                  Research Workspace\n                </Label>\n                {name} - {id}\n              </div>\n              <div>\n                <EnvironmentStatusIcon environment={instance} />\n              </div>\n            </span>\n            <Header.Subheader className=\"fs-9 color-grey mt1\">\n              <div>\n                updated <TimeAgo date={updatedAt} /> <By uid={updatedBy} />\n              </div>\n            </Header.Subheader>\n          </Header>\n        </div>\n        <div className=\"mb3\">{this.renderTabs()}</div>\n      </>\n    );\n  }\n\n  renderTabs() {\n    const environment = this.getEnvironment();\n    if (environment.isCompleted) {\n      return this.renderCompletedTabs();\n    }\n    if (environment.isStopped) {\n      return this.renderStoppedTabs();\n    }\n    if (environment.isError) {\n      return <ErrorInfo environment={environment} />;\n    }\n    if (environment.isTerminated) {\n      return this.renderTerminateInfo();\n    }\n    return this.renderPendingInfo();\n  }\n\n  renderCostDetailsTabPane() {\n    return {\n      menuItem: 'Research Workspace Details',\n      render: () => (\n        <Tab.Pane attached={false}>\n          <Observer>{() => this.renderInstanceDetails()}</Observer>\n        </Tab.Pane>\n      ),\n    };\n  }\n\n  renderCompletedTabs() {\n    const environment = this.getEnvironment();\n\n    const panes = [\n      {\n        menuItem: 'Security',\n        render: () => (\n          <Tab.Pane attached={false}>\n            <Observer>\n              {() => {\n                switch (environment.instanceInfo.type) {\n                  case 'ec2-rstudio':\n                    return this.renderRStudioSecurity();\n                  case 'ec2-linux':\n                    return this.renderEc2LinuxSecurity();\n                  case 'ec2-windows':\n                    return this.renderEc2WindowsSecurity();\n                  case 'sagemaker':\n                    return this.renderSagemakerSecurity();\n                  case 'emr':\n                    return this.renderEmrSecurity();\n                  default:\n                    return (\n                      <Segment placeholder>\n                        <Header icon className=\"color-grey\">\n                          <Icon name=\"hdd\" />\n                          Security\n                        </Header>\n                      </Segment>\n                    );\n                }\n              }}\n            </Observer>\n          </Tab.Pane>\n        ),\n      },\n      this.renderCostDetailsTabPane(),\n      this.renderUserShareTabPane(),\n    ];\n\n    return <Tab menu={{ secondary: true, pointing: true }} panes={panes} />;\n  }\n\n  renderInstanceDetails() {\n    return this.renderCostInfo();\n  }\n\n  renderCostInfo() {\n    return (\n      <Segment>\n        <h2 className=\"center\"> Daily Costs</h2>\n        {this.renderCostTable()}\n      </Segment>\n    );\n  }\n\n  renderUserShareTabPane() {\n    const environment = this.getEnvironment();\n    const uid = environment.createdBy;\n    const sharedWithUsersDropDownOptions = this.props.usersStore.asDropDownOptions().filter(item => {\n      return !(item.value === uid);\n    });\n\n    return {\n      menuItem: 'Sharing',\n      render: () => (\n        <Tab.Pane attached={false}>\n          <Observer>\n            {() => {\n              return (\n                <Segment>\n                  <h2 className=\"center\">Share with Users</h2>\n                  <Dropdown\n                    options={sharedWithUsersDropDownOptions}\n                    defaultValue={environment.sharedWithUsers.map(item => item.id)}\n                    fluid\n                    multiple\n                    selection\n                    search\n                    placeholder=\"Select other users you want to share this environment\"\n                    disabled={this.formProcessing}\n                    onChange={this.handleSharedWithUsersSelection}\n                  />\n                  <div className=\"mb2\" />\n                  <Button color=\"blue\" disabled={this.formProcessing} onClick={this.handleSubmitSharedWithUsersClick}>\n                    Update\n                  </Button>\n                </Segment>\n              );\n            }}\n          </Observer>\n        </Tab.Pane>\n      ),\n    };\n  }\n\n  renderStoppedTabs() {\n    const panes = [this.renderUserShareTabPane(), this.renderCostDetailsTabPane()];\n\n    return <Tab menu={{ secondary: true, pointing: true }} panes={panes} />;\n  }\n\n  handleSharedWithUsersSelection = (e, { value }) => {\n    this.updateSharedWithUsers = value.map(item => JSON.parse(item));\n  };\n\n  handleSubmitSharedWithUsersClick = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n    const environment = this.getEnvironment();\n\n    runInAction(() => {\n      this.formProcessing = true;\n    });\n\n    const updateEnvironment = {\n      id: environment.id,\n      sharedWithUsers: this.updateSharedWithUsers,\n    };\n\n    try {\n      await this.props.environmentsStore.updateEnvironment(updateEnvironment);\n    } catch (error) {\n      runInAction(() => {\n        this.formProcessing = false;\n      });\n      displayError(error);\n    }\n    runInAction(() => {\n      this.formProcessing = false;\n    });\n  };\n\n  renderCostTable() {\n    // Convert from mobx obj to normal obj\n    const environment = JSON.parse(JSON.stringify(this.getEnvironment()));\n\n    let costHeadings = [];\n    const rows = [];\n    environment.costs.forEach(costItemGivenADate => {\n      const cost = costItemGivenADate.cost;\n      const headings = Object.keys(cost);\n      costHeadings.push(headings);\n      const rowValues = {};\n      rowValues.date = costItemGivenADate.startDate;\n      let total = 0;\n      headings.forEach(heading => {\n        const amount = cost[heading].amount;\n        rowValues[heading] = amount.toFixed(2);\n        total += amount;\n      });\n      rowValues.total = total.toFixed(2);\n      rows.push(rowValues);\n    });\n\n    costHeadings = _.flatten(costHeadings);\n    costHeadings = _.uniq(costHeadings);\n\n    return (\n      <Table celled>\n        <Table.Header>\n          <Table.Row>\n            <Table.HeaderCell>Date</Table.HeaderCell>\n            {costHeadings.map(header => {\n              return <Table.HeaderCell key={header}>{header}</Table.HeaderCell>;\n            })}\n            <Table.HeaderCell>Total</Table.HeaderCell>\n          </Table.Row>\n        </Table.Header>\n        <Table.Body>\n          {rows.map(row => {\n            return (\n              <Table.Row key={row.date}>\n                <Table.Cell>{row.date}</Table.Cell>\n                {costHeadings.map(header => {\n                  return <Table.Cell key={row}>${_.get(row, header, 0)}</Table.Cell>;\n                })}\n                <Table.Cell>${row.total}</Table.Cell>\n              </Table.Row>\n            );\n          })}\n        </Table.Body>\n      </Table>\n    );\n  }\n\n  renderTerminateInfo() {\n    const environment = this.getEnvironment();\n    return (\n      <>\n        <Segment>\n          This research workspace was terminated <TimeAgo date={environment.updatedAt} />{' '}\n          <By uid={environment.updatedBy} />.\n        </Segment>\n        {this.renderCostInfo()}\n      </>\n    );\n  }\n\n  renderPendingInfo() {\n    const environment = this.getEnvironment();\n    return (\n      <>\n        <Segment>\n          This research workspace was started <TimeAgo date={environment.createdAt} />{' '}\n          <By uid={environment.createdBy} />.\n        </Segment>\n      </>\n    );\n  }\n\n  renderCopyToClipboard(text) {\n    return (\n      <Popup\n        content=\"Copy\"\n        trigger={\n          // <CopyToClipboard text={text} style={{ 'margin-left': '4px', cursor: 'pointer' }}>\n          <CopyToClipboard className=\"ml1 mr0\" text={text} style={{ cursor: 'pointer' }}>\n            <Icon name=\"copy\" />\n          </CopyToClipboard>\n        }\n      />\n    );\n  }\n\n  handleKeyPairRequest = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const environment = this.getEnvironment();\n    const keyPair = await environment.getKeyPair();\n\n    const downloadLink = document.createElement('a');\n    downloadLink.setAttribute('href', `data:application/octet-stream,${encodeURIComponent(keyPair.privateKey)}`);\n    downloadLink.setAttribute('download', `${environment.id}.pem`);\n    downloadLink.click();\n  };\n\n  handleWindowsPasswordRequest = async event => {\n    event.preventDefault();\n    runInAction(() => {\n      this.windowsPassword = 'loading';\n    });\n\n    const environment = this.getEnvironment();\n    const [{ privateKey }, { passwordData }] = await environment.getWindowsPassword();\n\n    const password = crypto\n      .privateDecrypt(\n        { key: privateKey, padding: crypto.constants.RSA_PKCS1_PADDING },\n        Buffer.from(passwordData, 'base64'),\n      )\n      .toString('utf8');\n\n    runInAction(() => {\n      this.windowsPassword = password;\n    });\n  };\n\n  renderEc2LinuxSecurity() {\n    const environment = this.getEnvironment();\n    return (\n      <div>\n        You&apos;ll need two pieces of information to connect to this research workspace.\n        <ol>\n          <li>\n            The IP Address or DNS of the instance, for this research workspace it is{' '}\n            {environment.instanceInfo.Ec2WorkspaceDnsName}\n          </li>\n          <li>The ssh key</li>\n        </ol>\n        Connecting to your research workspace depends on the operating system you are connecting from.\n        <ul>\n          <li>\n            <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/putty.html\">\n              Connecting from Windows via Putty\n            </a>\n          </li>\n          <li>\n            <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AccessingInstancesLinux.html\">\n              Connecting from MacOS or Linux via SSH\n            </a>\n          </li>\n        </ul>\n        Example:\n        <Segment>{`ssh -i ${environment.id}.pem ec2-user@${environment.instanceInfo.Ec2WorkspaceDnsName}`}</Segment>\n        <Button color=\"blue\" onClick={this.handleKeyPairRequest}>\n          Download SSH Key\n        </Button>\n      </div>\n    );\n  }\n\n  renderEc2WindowsSecurity() {\n    const environment = this.getEnvironment();\n    const passRevealDisabled = !this.windowsPassword || this.windowsPassword === 'loading';\n    const passRevealStyle = {\n      width: '27em',\n      height: '5em',\n    };\n\n    return (\n      <>\n        <p>\n          Your Windows workspace can be accessed via an RDP client by using the DNS host name and credentials defined\n          defined below.\n        </p>\n\n        <Label className=\"mx1\">\n          Host <Label.Detail>{environment.instanceInfo.Ec2WorkspaceDnsName}</Label.Detail>\n          {this.renderCopyToClipboard(environment.instanceInfo.Ec2WorkspaceDnsName)}\n        </Label>\n\n        <Reveal className=\"mt1\" animated=\"move\" disabled={passRevealDisabled}>\n          <Reveal.Content visible>\n            <Button\n              color=\"blue\"\n              onClick={this.handleWindowsPasswordRequest}\n              loading={this.windowsPassword === 'loading'}\n              style={passRevealStyle}\n            >\n              <Icon name={passRevealDisabled ? 'lock' : 'unlock'} />\n              {passRevealDisabled ? 'Get ' : 'Show '} Windows Credentials\n            </Button>\n          </Reveal.Content>\n          <Reveal.Content hidden>\n            <Segment className=\"px1 py1\" style={passRevealStyle}>\n              <Label>\n                Username <Label.Detail>Administrator</Label.Detail>\n              </Label>\n              <br />\n              <Label className=\"mx0\">\n                Password\n                <Label.Detail>{this.windowsPassword}</Label.Detail>\n                {this.renderCopyToClipboard(this.windowsPassword)}\n              </Label>\n            </Segment>\n          </Reveal.Content>\n        </Reveal>\n\n        <p className=\"mt2\">\n          Additional information about connecting via RDP can be found in the documentation below:\n          <ul>\n            <li>\n              <a\n                href=\"https://docs.aws.amazon.com/AWSEC2/latest/WindowsGuide/connecting_to_windows_instance.html#connect-rdp\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                Connect to Your Windows Instance\n              </a>\n            </li>\n          </ul>\n        </p>\n      </>\n    );\n  }\n\n  renderRStudioSecurity() {\n    return this.renderConnectBtn('To connect to this RStudio Server instance simply click the launch button below.');\n  }\n\n  renderEmrSecurity() {\n    return this.renderConnectBtn(\n      'To connect to this EMR Jupyter notebook instance simply click the launch button below.',\n    );\n  }\n\n  renderSagemakerSecurity() {\n    return this.renderConnectBtn(\n      'To connect to this SageMaker notebook instance simply click the launch button below.',\n    );\n  }\n\n  renderConnectBtn(msg) {\n    const environment = this.getEnvironment();\n\n    return (\n      <div>\n        <p>{msg}</p>\n        <EnvironmentConnectButton as={Button} environment={environment} color=\"green\">\n          {environment.fetchingUrl ? (\n            <>\n              Connecting\n              <Icon loading name=\"spinner\" size=\"small\" className=\"ml1 mr1\" />\n            </>\n          ) : (\n            <>Connect</>\n          )}\n        </EnvironmentConnectButton>\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(EnvironmentDetailPage, {\n  windowsPassword: observable,\n  updateSharedWithUsers: observable,\n  formProcessing: observable,\n  handleSharedWithUsersSelection: action,\n});\n\nexport default inject('environmentsStore', 'userStore', 'usersStore')(withRouter(observer(EnvironmentDetailPage)));\n","/* eslint-disable max-classes-per-file */\nimport React from 'react';\nimport _ from 'lodash';\nimport { decorate, computed } from 'mobx';\nimport { observer, inject, Observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport {\n  Container,\n  Breadcrumb,\n  Divider,\n  Grid,\n  Segment,\n  Table,\n  Header,\n  Message,\n  Popup,\n  Label,\n  Icon,\n  Tab,\n} from 'semantic-ui-react';\nimport TimeAgo from 'react-timeago';\n\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreLoading, isStoreError, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport ProgressPlaceHolder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\n\nimport By from '../helpers/By';\nimport ScEnvironmentButtons from './parts/ScEnvironmentButtons';\nimport ScEnvironmentCost from './parts/ScEnvironmentCost';\nimport ScEnvironmentTypeName from './parts/ScEnvironmentTypeName';\nimport ScEnvironmentCostTable from './parts/ScEnvironmentCostTable';\n\n// This component is used with the TabPane to replace the default Segment wrapper since\n// we don't want to display the border.\n// eslint-disable-next-line react/prefer-stateless-function\nclass TabPaneWrapper extends React.Component {\n  render() {\n    return <>{this.props.children}</>;\n  }\n}\n\n// expected props\n// - scEnvironmentsStore (via injection)\nclass ScEnvironmentDetailPage extends React.Component {\n  componentDidMount() {\n    window.scrollTo(0, 0);\n    const store = this.getEnvStore();\n    if (store) {\n      swallowError(store.load());\n      store.startHeartbeat();\n    }\n  }\n\n  componentWillUnmount() {\n    const store = this.getEnvStore();\n    if (store) {\n      store.stopHeartbeat();\n    }\n  }\n\n  get envsStore() {\n    return this.props.scEnvironmentsStore;\n  }\n\n  get instanceId() {\n    return (this.props.match.params || {}).instanceId;\n  }\n\n  getEnvStore() {\n    const envsStore = this.envsStore;\n    const envId = this.instanceId;\n    return envsStore.getScEnvironmentStore(envId);\n  }\n\n  getEnv() {\n    const store = this.getEnvStore();\n    if (!store) return {};\n    if (!isStoreReady(store)) return {};\n    return store.scEnvironment;\n  }\n\n  render() {\n    const store = this.getEnvStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder />;\n    } else if (isStoreReady(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3\">\n        {this.renderBreadcrumb()}\n        {content}\n      </Container>\n    );\n  }\n\n  renderBreadcrumb() {\n    const envId = this.instanceId;\n    const goto = gotoFn(this);\n\n    return (\n      <Breadcrumb className=\"block mb3\">\n        <Breadcrumb.Section link onClick={() => goto('/workspaces')}>\n          Research Workspaces\n        </Breadcrumb.Section>\n        <Breadcrumb.Divider icon=\"right angle\" />\n        <Breadcrumb.Section active>Workspace # {envId}</Breadcrumb.Section>\n      </Breadcrumb>\n    );\n  }\n\n  renderMain() {\n    const env = this.getEnv();\n\n    return (\n      <>\n        {this.renderTitle(env)}\n        {this.renderError(env)}\n        <Divider className=\"mt1 mb1\" />\n        {this.renderButtons(env)}\n        <Divider className=\"mt1\" />\n        {env.description || 'Not description for this workspace was provided.'}\n        <Grid columns={2} stackable className=\"mt2\">\n          <Grid.Row stretched>\n            <Grid.Column width={12}>{this.renderDetailTable(env)}</Grid.Column>\n            <Grid.Column width={4}>\n              <Segment className=\"flex items-center\">\n                <div className=\"w-100 overflow-hidden\">\n                  <ScEnvironmentCost envId={env.id} />\n                </div>\n              </Segment>\n            </Grid.Column>\n          </Grid.Row>\n        </Grid>\n        {this.renderTabs(env)}\n      </>\n    );\n  }\n\n  renderDetailTable(env) {\n    const studyIds = _.get(env, 'studyIds', []);\n    const studyCount = _.size(studyIds);\n    const renderRow = (key, value) => (\n      <Table.Row>\n        <Table.Cell width={5}>{key}</Table.Cell>\n        <Table.Cell width={11} className=\"breakout\">\n          {value}\n        </Table.Cell>\n      </Table.Row>\n    );\n\n    return (\n      <Table definition>\n        <Table.Body>\n          {renderRow('Status', this.renderStatus(env))}\n          {renderRow('Owner', <By uid={env.createdBy} skipPrefix />)}\n          {renderRow('Studies', studyCount === 0 ? 'No studies linked to this workspace' : studyIds.join(', '))}\n          {renderRow('Project', _.isEmpty(env.projectId) ? 'N/A' : env.projectId)}\n          {renderRow('Restricted CIDR', _.isEmpty(env.cidr) ? 'N/A' : env.cidr)}\n          {renderRow('Workspace Type', <ScEnvironmentTypeName envTypeId={env.envTypeId} />)}\n        </Table.Body>\n      </Table>\n    );\n  }\n\n  renderButtons(env) {\n    return <ScEnvironmentButtons scEnvironment={env} />;\n  }\n\n  renderTitle(env) {\n    return (\n      <Header as=\"h3\" className=\"mt1\">\n        <Icon name=\"server\" className=\"align-top\" />\n        <Header.Content className=\"left-align\">{env.name}</Header.Content>\n        <Header.Subheader>\n          <span className=\"fs-8 color-grey\">\n            Created <TimeAgo date={env.createdAt} className=\"mr2\" /> <By uid={env.createdBy} className=\"mr2\" />\n          </span>\n          <span className=\"fs-8 color-grey mr2\"> {env.id}</span>\n        </Header.Subheader>\n      </Header>\n    );\n  }\n\n  renderStatus(env) {\n    const state = env.state;\n    return (\n      <div style={{ cursor: 'default' }}>\n        <Popup\n          trigger={\n            <Label size=\"mini\" color={state.color}>\n              {state.spinner && <Icon name=\"spinner\" loading />}\n              {state.display}\n            </Label>\n          }\n        >\n          {state.tip}\n        </Popup>\n      </div>\n    );\n  }\n\n  renderError(env) {\n    if (_.isEmpty(env.error)) return null;\n\n    return (\n      <Message negative>\n        <p>{env.error}</p>\n      </Message>\n    );\n  }\n\n  renderTabs(env) {\n    const panes = [\n      {\n        menuItem: 'Cost',\n        render: () => (\n          <Tab.Pane attached={false} key=\"cost\" as={TabPaneWrapper}>\n            <Observer>{() => <ScEnvironmentCostTable envId={env.id} />}</Observer>\n          </Tab.Pane>\n        ),\n      },\n      {\n        menuItem: 'CloudFormation Output',\n        render: () => (\n          <Tab.Pane attached={false} key=\"cfn-outputs\" as={TabPaneWrapper}>\n            <Observer>{() => this.renderCfnOutput(env)}</Observer>\n          </Tab.Pane>\n        ),\n      },\n    ];\n\n    return <Tab className=\"mt4\" menu={{ secondary: true, pointing: true }} renderActiveOnly panes={panes} />;\n  }\n\n  renderCfnOutput(env) {\n    const outputs = env.outputs;\n    const isEmpty = _.isEmpty(outputs);\n    const renderRow = (index, key, value, desc) => (\n      <Table.Row key={index}>\n        <Table.Cell width={5}>{key}</Table.Cell>\n        <Table.Cell width={11} className=\"breakout\">\n          {value}\n          <div className=\"fs-7\">{desc}</div>\n        </Table.Cell>\n      </Table.Row>\n    );\n\n    return (\n      <>\n        {!isEmpty && (\n          <Table definition className=\"mt3\">\n            <Table.Body>\n              {_.map(outputs, (item, index) => renderRow(index, item.OutputKey, item.OutputValue, item.Description))}\n            </Table.Body>\n          </Table>\n        )}\n        {isEmpty && <Message className=\"mt3\" content=\"None is available\" />}\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentDetailPage, {\n  instanceId: computed,\n  envsStore: computed,\n});\n\nexport default inject('scEnvironmentsStore')(withRouter(observer(ScEnvironmentDetailPage)));\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Label, Popup, Placeholder } from 'semantic-ui-react';\n\nimport { isStoreLoading, isStoreError, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\n\n// This component displays the name of the env type. The envTypeId is expected to be passed\n// as a prop to this component. This component displays a progress place holder or an error with a popup\n// message if the env type name can't be determined.\n\n// expected props\n// - envTypeId  (via prop)\n// - envTypesStore (via injection)\nclass ScEnvironmentTypeName extends React.Component {\n  componentDidMount() {\n    const store = this.getEnvTypeStore();\n    if (store && !isStoreReady(store)) {\n      swallowError(store.load());\n    }\n  }\n\n  get envTypeId() {\n    return this.props.envTypeId;\n  }\n\n  get envTypesStore() {\n    return this.props.envTypesStore;\n  }\n\n  getEnvTypeStore() {\n    const envTypesStore = this.envTypesStore;\n    const envTypeId = this.envTypeId;\n    return envTypesStore.getEnvTypeStore(envTypeId);\n  }\n\n  render() {\n    const store = this.getEnvTypeStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = this.renderError(store.error);\n    } else if (isStoreLoading(store)) {\n      content = (\n        <Placeholder>\n          <Placeholder.Line />\n        </Placeholder>\n      );\n    } else if (isStoreReady(store)) {\n      content = store.envType.name || 'Not provided';\n    } else {\n      content = null;\n    }\n\n    return content;\n  }\n\n  renderError(error) {\n    const defaultMessage = 'Hmm... something went wrong';\n    const rawMessage = error || defaultMessage;\n    const message = _.isString(rawMessage) ? rawMessage : _.get(rawMessage, 'message', defaultMessage);\n\n    return (\n      <Popup\n        trigger={\n          <Label size=\"mini\" basic color=\"red\">\n            Show Error\n          </Label>\n        }\n        basic\n      >\n        <div className=\"color-red\">\n          <p>An error occurred while retrieving the workspace type information.</p>\n          <p>The system returned this error message:</p>\n          <p>{message}</p>\n        </div>\n      </Popup>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentTypeName, {\n  envTypeId: computed,\n  envTypesStore: computed,\n});\n\nexport default inject('envTypesStore')(withRouter(observer(ScEnvironmentTypeName)));\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Table, Message } from 'semantic-ui-react';\n\nimport { isStoreLoading, isStoreError, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { swallowError, nicePrice } from '@aws-ee/base-ui/dist/helpers/utils';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport ProgressPlaceHolder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\n\n// expected props\n// - envId (via prop)\n// - scEnvironmentCostsStore  (via injection)\nclass ScEnvironmentCostTable extends React.Component {\n  componentDidMount() {\n    const costStore = this.getEnvCostStore();\n    if (!isStoreReady(costStore) && !isStoreError(costStore)) {\n      swallowError(costStore.load());\n    }\n\n    costStore.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const costStore = this.getEnvCostStore();\n    costStore.stopHeartbeat();\n  }\n\n  get costsStore() {\n    return this.props.scEnvironmentCostsStore;\n  }\n\n  get envId() {\n    return this.props.envId;\n  }\n\n  getEnvCostStore() {\n    const costsStore = this.costsStore;\n    const envId = this.envId;\n    return costsStore.getScEnvironmentCostStore(envId);\n  }\n\n  render() {\n    const store = this.getEnvCostStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder />;\n    } else if (isStoreReady(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return <>{content}</>;\n  }\n\n  renderMain() {\n    const costStore = this.getEnvCostStore();\n    const cost = costStore.scEnvironmentCost;\n    const list = cost.list;\n    const isEmpty = _.isEmpty(list);\n    const renderRow = (index, key, value) => (\n      <Table.Row key={index}>\n        <Table.Cell width={5}>{key}</Table.Cell>\n        <Table.Cell width={11} className=\"breakout\">\n          ${nicePrice(value)}\n        </Table.Cell>\n      </Table.Row>\n    );\n\n    return (\n      <>\n        {!isEmpty && (\n          <Table definition className=\"mt3\">\n            <Table.Body>{_.map(list, (item, index) => renderRow(index, item.date, item.amount))}</Table.Body>\n          </Table>\n        )}\n        {isEmpty && <Message className=\"mt3\" content=\"None is available\" />}\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentCostTable, {\n  costsStore: computed,\n  envId: computed,\n});\n\nexport default inject('scEnvironmentCostsStore')(withRouter(observer(ScEnvironmentCostTable)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { decorate, observable, action, runInAction } from 'mobx';\nimport { Button, Dimmer, Header, List, Loader, Segment } from 'semantic-ui-react';\nimport _ from 'lodash';\n\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\nimport validate from '@aws-ee/base-ui/dist/models/forms/Validate';\n\nimport { getAddAwsAccountForm, getAddAwsAccountFormFields } from '../../models/forms/AddAwsAccountForm';\n\nclass AddAwsAccount extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      // eslint-disable-next-line react/no-unused-state\n      role: 'guest',\n      // eslint-disable-next-line react/no-unused-state\n      status: 'active',\n    };\n\n    runInAction(() => {\n      this.formProcessing = false;\n      this.validationErrors = new Map();\n      this.awsAccount = {};\n    });\n    this.form = getAddAwsAccountForm();\n    this.addAwsAccountFormFields = getAddAwsAccountFormFields();\n  }\n\n  render() {\n    return (\n      <div className=\"mt2 animated fadeIn\">\n        <Header as=\"h2\" icon textAlign=\"center\" className=\"mt3\" color=\"grey\">\n          Add AWS Account\n        </Header>\n        <div className=\"mt3 ml3 mr3 animated fadeIn\">{this.renderAddAwsAccountForm()}</div>\n      </div>\n    );\n  }\n\n  // eslint-disable-next-line react/no-unused-state\n  handleRoleChange = (e, { value }) => this.setState({ role: value });\n\n  // eslint-disable-next-line react/no-unused-state\n  handleStatusChange = (e, { value }) => this.setState({ status: value });\n\n  renderAddAwsAccountForm() {\n    const processing = this.formProcessing;\n    const fields = this.addAwsAccountFormFields;\n    const toEditableInput = (attributeName, type = 'text') => {\n      const handleChange = action(event => {\n        event.preventDefault();\n        this.awsAccount[attributeName] = event.target.value;\n      });\n      return (\n        <div className=\"ui focus input\">\n          <input\n            type={type}\n            defaultValue={this.awsAccount[attributeName]}\n            placeholder={fields[attributeName].placeholder || ''}\n            onChange={handleChange}\n          />\n        </div>\n      );\n    };\n\n    return (\n      <Segment basic className=\"ui fluid form\">\n        <Dimmer active={processing} inverted>\n          <Loader inverted>Checking</Loader>\n        </Dimmer>\n        {Object.keys(fields).map(field => (\n          <React.Fragment key={field}>\n            {this.renderField(field, toEditableInput(field))}\n            <div className=\"mb4\" />\n          </React.Fragment>\n        ))}\n        {this.renderButtons()}\n      </Segment>\n    );\n  }\n\n  renderButtons() {\n    const processing = this.formProcessing;\n    return (\n      <div className=\"mt3\">\n        <Button floated=\"right\" color=\"blue\" icon disabled={processing} className=\"ml2\" onClick={this.handleSubmit}>\n          Add AWS Account\n        </Button>\n        <Button floated=\"right\" disabled={processing} onClick={this.handleCancel}>\n          Cancel\n        </Button>\n      </div>\n    );\n  }\n\n  renderField(name, component) {\n    const fields = this.addAwsAccountFormFields;\n    const explain = fields[name].explain;\n    const label = fields[name].label;\n    const hasExplain = !_.isEmpty(explain);\n    const fieldErrors = this.validationErrors.get(name);\n    const hasError = !_.isEmpty(fieldErrors);\n\n    return (\n      <div>\n        <Header className=\"mr3 mt0\" as=\"h2\" color=\"grey\">\n          {label}\n        </Header>\n        {hasExplain && <div className=\"mb2\">{explain}</div>}\n        <div className={`ui big field input block m0 ${hasError ? 'error' : ''}`}>{component}</div>\n        {hasError && (\n          <div className=\"ui pointing red basic label\">\n            <List>\n              {_.map(fieldErrors, fieldError => (\n                <List.Item key={name}>\n                  <List.Content>{fieldError}</List.Content>\n                </List.Item>\n              ))}\n            </List>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  goto(pathname) {\n    const location = this.props.location;\n    const link = createLink({ location, pathname });\n    this.props.history.push(link);\n  }\n\n  handleCancel = action(event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.formProcessing = false;\n    this.goto('/accounts');\n  });\n\n  handleSubmit = action(async () => {\n    this.formProcessing = true;\n    try {\n      // Perform client side validations first\n      const validationResult = await validate(this.awsAccount, this.addAwsAccountFormFields);\n      // if there are any client side validation errors then do not attempt to make API call\n      if (validationResult.fails()) {\n        runInAction(() => {\n          this.validationErrors = validationResult.errors;\n          this.formProcessing = false;\n        });\n      } else {\n        // There are no client side validation errors so ask the store to add user (which will make API call to server to add the user)\n\n        await this.props.awsAccountsStore.addAwsAccount(this.awsAccount);\n        runInAction(() => {\n          this.formProcessing = false;\n        });\n        this.goto('/accounts');\n      }\n    } catch (error) {\n      runInAction(() => {\n        this.formProcessing = false;\n      });\n      displayError(error);\n    }\n  });\n\n  getStore() {\n    return this.props.usersStore;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(AddAwsAccount, {\n  formProcessing: observable,\n  user: observable,\n  validationErrors: observable,\n});\nexport default inject('usersStore', 'awsAccountsStore')(withRouter(observer(AddAwsAccount)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '../../helpers/form';\n\nconst addAwsAccountFormFields = {\n  name: {\n    label: 'Account Name',\n    placeholder: 'Type the name of this account',\n    rules: 'required|string|between:1,100',\n  },\n  accountId: {\n    label: 'AWS Account ID',\n    placeholder: 'Type the 12-digit AWS account ID',\n    rules: 'required|string|size:12',\n  },\n  roleArn: {\n    label: 'Role Arn',\n    placeholder: 'Type Role ARN for launching resources into this AWS account',\n    rules: 'required|string|between:10,300',\n  },\n  xAccEnvMgmtRoleArn: {\n    label: 'AWS Service Catalog Role Arn',\n    placeholder: 'Type Role ARN for launching resources into this AWS account using AWS Service Catalog',\n    rules: 'required|string|between:10,300',\n  },\n  externalId: {\n    label: 'External ID',\n    placeholder: 'Type external ID for this AWS account',\n    rules: 'required|string|between:1,300',\n  },\n  description: {\n    label: 'Description',\n    placeholder: 'Type description for this AWS account',\n    rules: 'required|string',\n  },\n  vpcId: {\n    label: 'VPC ID',\n    placeholder: 'Type the ID of the VPC where EMR clusters will be launched',\n    rules: 'required|string|min:12|max:21',\n  },\n  subnetId: {\n    label: 'Subnet ID',\n    placeholder: 'Type the ID of the subnet where the EMR clusters will be launched',\n    rules: 'required|string|min:15|max:24',\n  },\n  encryptionKeyArn: {\n    label: 'KMS Encryption Key ARN',\n    placeholder: 'Type the KMS Encryption Key ARN to use for this AWS account',\n    rules: 'required|string|between:1,100',\n  },\n};\n\nfunction getAddAwsAccountFormFields() {\n  return addAwsAccountFormFields;\n}\n\nfunction getAddAwsAccountForm() {\n  return createForm(addAwsAccountFormFields);\n}\n\nexport { getAddAwsAccountFormFields, getAddAwsAccountForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { decorate, observable, action, runInAction } from 'mobx';\nimport { Button, Dimmer, Header, List, Loader, Segment } from 'semantic-ui-react';\nimport _ from 'lodash';\n\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\nimport validate from '@aws-ee/base-ui/dist/models/forms/Validate';\n\nimport { getCreateAwsAccountForm, getCreateAwsAccountFormFields } from '../../models/forms/CreateAwsAccountForm';\n\nclass CreateAwsAccount extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.formProcessing = false;\n      this.validationErrors = new Map();\n      this.awsAccount = {};\n    });\n    this.form = getCreateAwsAccountForm();\n    this.createAwsAccountFormFields = getCreateAwsAccountFormFields();\n  }\n\n  render() {\n    return (\n      <div className=\"mt2 animated fadeIn\">\n        <Header as=\"h2\" icon textAlign=\"center\" className=\"mt3\" color=\"grey\">\n          Create AWS Account\n        </Header>\n        <div className=\"mt3 ml3 mr3 animated fadeIn\">{this.renderCreateAwsAccountForm()}</div>\n      </div>\n    );\n  }\n\n  // eslint-disable-next-line react/no-unused-state\n  handleRoleChange = (e, { value }) => this.setState({ role: value });\n\n  // eslint-disable-next-line react/no-unused-state\n  handleStatusChange = (e, { value }) => this.setState({ status: value });\n\n  renderCreateAwsAccountForm() {\n    const processing = this.formProcessing;\n    const fields = this.createAwsAccountFormFields;\n    const toEditableInput = (attributeName, type = 'text') => {\n      const handleChange = action(event => {\n        event.preventDefault();\n        this.awsAccount[attributeName] = event.target.value;\n      });\n      return (\n        <div className=\"ui focus input\">\n          <input\n            type={type}\n            defaultValue={this.awsAccount[attributeName]}\n            placeholder={fields[attributeName].placeholder || ''}\n            onChange={handleChange}\n          />\n        </div>\n      );\n    };\n\n    return (\n      <Segment basic className=\"ui fluid form\">\n        <Dimmer active={processing} inverted>\n          <Loader inverted>Checking</Loader>\n        </Dimmer>\n        {Object.keys(fields).map(field => (\n          <React.Fragment key={field}>\n            {this.renderField(field, toEditableInput(field))}\n            <div className=\"mb4\" />\n          </React.Fragment>\n        ))}\n        {this.renderButtons()}\n      </Segment>\n    );\n  }\n\n  renderButtons() {\n    const processing = this.formProcessing;\n    return (\n      <div className=\"mt3\">\n        <Button floated=\"right\" color=\"blue\" icon disabled={processing} className=\"ml2\" onClick={this.handleSubmit}>\n          Create AWS Account\n        </Button>\n        <Button floated=\"right\" disabled={processing} onClick={this.handleCancel}>\n          Cancel\n        </Button>\n      </div>\n    );\n  }\n\n  renderField(name, component) {\n    const fields = this.createAwsAccountFormFields;\n    const explain = fields[name].explain;\n    const label = fields[name].label;\n    const hasExplain = !_.isEmpty(explain);\n    const fieldErrors = this.validationErrors.get(name);\n    const hasError = !_.isEmpty(fieldErrors);\n\n    return (\n      <div>\n        <Header className=\"mr3 mt0\" as=\"h2\" color=\"grey\">\n          {label}\n        </Header>\n        {hasExplain && <div className=\"mb2\">{explain}</div>}\n        <div className={`ui big field input block m0 ${hasError ? 'error' : ''}`}>{component}</div>\n        {hasError && (\n          <div className=\"ui pointing red basic label\">\n            <List>\n              {_.map(fieldErrors, fieldError => (\n                <List.Item key={name}>\n                  <List.Content>{fieldError}</List.Content>\n                </List.Item>\n              ))}\n            </List>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  goto(pathname) {\n    const location = this.props.location;\n    const link = createLink({ location, pathname });\n    this.props.history.push(link);\n  }\n\n  handleCancel = action(event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.formProcessing = false;\n    this.goto('/accounts');\n  });\n\n  handleSubmit = action(async () => {\n    this.formProcessing = true;\n    try {\n      // Perform client side validations first\n      const validationResult = await validate(this.awsAccount, this.createAwsAccountFormFields);\n      // if there are any client side validation errors then do not attempt to make API call\n      if (validationResult.fails()) {\n        runInAction(() => {\n          this.validationErrors = validationResult.errors;\n          this.formProcessing = false;\n        });\n      } else {\n        // There are no client side validation errors so ask the store to add user (which will make API call to server to add the user)\n        await this.props.awsAccountsStore.createAwsAccount(this.awsAccount);\n        runInAction(() => {\n          this.formProcessing = false;\n        });\n        this.goto('/accounts');\n      }\n    } catch (error) {\n      runInAction(() => {\n        this.formProcessing = false;\n      });\n      displayError(error);\n    }\n  });\n\n  getStore() {\n    return this.props.usersStore;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(CreateAwsAccount, {\n  formProcessing: observable,\n  user: observable,\n  validationErrors: observable,\n});\nexport default inject('usersStore', 'awsAccountsStore')(withRouter(observer(CreateAwsAccount)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '../../helpers/form';\n\nconst createAwsAccountFormFields = {\n  accountName: {\n    label: 'Account Name',\n    placeholder: 'Type the name of this account',\n    rules: 'required|string|between:1,100',\n  },\n  accountEmail: {\n    label: 'AWS Account Email',\n    placeholder: 'Type AWS account email',\n    rules: 'required|string|email',\n  },\n  masterRoleArn: {\n    label: 'Master Role Arn',\n    placeholder: 'Type configured Role ARN of master account of the Organization',\n    rules: 'required|string|between:10,300',\n  },\n  externalId: {\n    label: 'External ID',\n    placeholder: 'Type external ID for this AWS account',\n    rules: 'required|string|between:1,300',\n  },\n  description: {\n    label: 'Description',\n    placeholder: 'Type description for this AWS account',\n    rules: 'required|string',\n  },\n};\n\nfunction getCreateAwsAccountFormFields() {\n  return createAwsAccountFormFields;\n}\n\nfunction getCreateAwsAccountForm() {\n  return createForm(createAwsAccountFormFields);\n}\n\nexport { getCreateAwsAccountFormFields, getCreateAwsAccountForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { decorate, action } from 'mobx';\nimport { Button, Header } from 'semantic-ui-react';\n\nimport { displaySuccess, displayError } from '@aws-ee/base-ui/dist//helpers/notification';\n\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport { isStoreError, isStoreLoading } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport DropDown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\nimport getBudgetForm from '../../models/forms/AddBudgetForm';\n\n// expected props\n// - awsAccount (pass in from AwsAccountList cell click)\n// - awsAccountsStore (from injection)\nclass UpdateBudget extends React.Component {\n  constructor(props) {\n    super(props);\n    this.awsAccountUUID = (this.props.match.params || {}).id;\n    this.budgetStore = this.props.awsAccountsStore.getBudgetStore(this.awsAccountUUID);\n  }\n\n  render() {\n    let content;\n    if (isStoreError(this.budgetStore)) {\n      content = <ErrorBox error={this.budgetStore.error} className=\"p0 mb3\" />;\n    } else if (isStoreLoading(this.budgetStore)) {\n      content = <BasicProgressPlaceholder />;\n    } else {\n      content = this.renderMain();\n    }\n    return (\n      <div className=\"mt2 animated fadeIn\">\n        <Header as=\"h2\" icon textAlign=\"center\" className=\"mt3\" color=\"grey\">\n          Budget Detail\n        </Header>\n        <div className=\"mt3 ml3 mr3 animated fadeIn\">{content}</div>\n      </div>\n    );\n  }\n\n  renderMain() {\n    const budget = this.budgetStore.budget;\n\n    const form = getBudgetForm(budget);\n    const thresholdsOptions = this.budgetStore.thresholdsOptions;\n    return (\n      <Form form={form} onCancel={this.handleCancel} onSuccess={this.handleFormSubmission}>\n        {({ processing, onCancel }) => (\n          <>\n            <Input field={form.$('budgetLimit')} type=\"number\" />\n            <Input field={form.$('startDate')} type=\"date\" />\n            <Input field={form.$('endDate')} type=\"date\" />\n            <DropDown field={form.$('thresholds')} options={thresholdsOptions} multiple selection clearable fluid />\n            <Input field={form.$('notificationEmail')} type=\"email\" />\n            <div className=\"mt3\">\n              <Button\n                floated=\"right\"\n                primary\n                className=\"ml2\"\n                type=\"submit\"\n                content=\"Update Budget\"\n                disabled={processing}\n              />\n              <Button floated=\"right\" onClick={onCancel} content=\"Cancel\" disabled={processing} />\n            </div>\n          </>\n        )}\n      </Form>\n    );\n  }\n\n  componentDidMount = async () => {\n    try {\n      await this.budgetStore.load();\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  // Private methods\n  handleCancel = () => {\n    this.goBackToAccountsPage();\n  };\n\n  handleFormSubmission = async form => {\n    try {\n      const values = this.convertDateToEpoch(form.values());\n      await this.budgetStore.createOrUpdateBudget(values);\n      form.clear();\n      displaySuccess('Updated budget successfully');\n      this.goBackToAccountsPage();\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  goto(pathname) {\n    const location = this.props.location;\n    const link = createLink({ location, pathname });\n    this.props.history.push(link);\n  }\n\n  goBackToAccountsPage() {\n    this.budgetStore.cleanup();\n    this.goto('/accounts');\n  }\n\n  convertDateToEpoch(values) {\n    // Divided by 1000 to convert from milliseconds to seconds\n    values.startDate = new Date(values.startDate).getTime() / 1000;\n    values.endDate = new Date(values.endDate).getTime() / 1000;\n    return values;\n  }\n}\n\n// decorate is a new API introduced by Mobx4, that allows usage of decorators without the decorator annotations\ndecorate(UpdateBudget, {\n  handleCancel: action,\n  handleFormSubmission: action,\n});\n\nexport default inject('awsAccountsStore')(observer(UpdateBudget));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { createForm } from '../../helpers/form';\n\nfunction getBudgetForm(existingBudget) {\n  const addBudgetFormFields = {\n    budgetLimit: {\n      label: 'Budget Limit Dollar Amount',\n      placeholder: 'Type the dollar amount for the budget',\n      rules: 'required|numeric|regex:/^[^-]*$/', // regex to make sure the number is non-negative\n      value: _.get(existingBudget, 'budgetLimit', ''),\n    },\n    // AWS Budget return date string with timezone information\n    // trim it so it can be correctly shown by input type date\n    startDate: {\n      label: 'Budget Start Date',\n      rules: 'required|string',\n      value: _.get(existingBudget, 'startDate', '').slice(0, 10),\n    },\n    endDate: {\n      label: 'Budget Expiration Date',\n      extra: { explain: 'Budget expiration date need to be less than a year from start date.' },\n      rules: 'required|string',\n      value: _.get(existingBudget, 'endDate', '').slice(0, 10),\n    },\n    thresholds: {\n      label: 'Thresholds',\n      extra: {\n        explain: 'Give percentage thresholds you would like to receive alarm for this budget, up to 5 thresholds.',\n      },\n      value: _.get(existingBudget, 'thresholds'),\n    },\n    notificationEmail: {\n      label: 'Notification Email',\n      extra: { explain: 'Email to notify when actual spent exceeds a threshold. ' },\n      rules: 'email',\n      value: _.get(existingBudget, 'notificationEmail'),\n    },\n  };\n  return createForm(addBudgetFormFields);\n}\n\nexport default getBudgetForm;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { decorate, runInAction, observable, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Icon, Container, Header } from 'semantic-ui-react';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\n\nimport { enableBuiltInWorkspaces } from '../../helpers/settings';\nimport { CurrentStep } from '../compute/helpers/CurrentStep';\nimport ComputePlatformSetup from '../compute/ComputePlatformSetup';\nimport SetupStepsProgress from '../environments-builtin/SetupStepsProgress';\nimport ScEnvironmentSetup from '../environments-sc/setup/ScEnvironmentSetup';\n\n// expected props\nclass EnvironmentSetup extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      let step = 'selectEnvType';\n      if (enableBuiltInWorkspaces) {\n        step = 'selectComputePlatform';\n      } else if (this.envTypeId) {\n        step = 'selectEnvConfig'; // If envTypeId id is passed then jump to env config step\n      }\n      this.currentStep = CurrentStep.create({ step });\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  goto(pathname) {\n    const goto = gotoFn(this);\n    goto(pathname);\n  }\n\n  handlePrevious = () => {\n    if (this.envTypeId) {\n      // If envTypeId is already preselected selected\n      // then we must have reached here via env type management page so go back to that page\n      this.goto('/workspace-types-management');\n    } else {\n      this.goto('/workspaces');\n    }\n  };\n\n  // eslint-disable-next-line no-unused-vars\n  handleCompleted = async environment => {\n    displaySuccess('The research workspace is being provisioned');\n    this.goto('/workspaces');\n  };\n\n  render() {\n    return (\n      <Container className=\"mt3\">\n        {this.renderTitle()}\n        {this.renderStepsProgress()}\n        {this.renderContent()}\n      </Container>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div className=\"flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"server\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Research Workspaces</Header.Content>\n        </Header>\n      </div>\n    );\n  }\n\n  renderStepsProgress() {\n    return <SetupStepsProgress currentStep={this.currentStep} envTypeImmutable={!!this.envTypeId} />;\n  }\n\n  renderContent() {\n    let content = null;\n    if (enableBuiltInWorkspaces) {\n      content = (\n        <ComputePlatformSetup\n          currentStep={this.currentStep}\n          onPrevious={this.handlePrevious}\n          onCompleted={this.handleCompleted}\n        />\n      );\n    } else {\n      content = (\n        <ScEnvironmentSetup\n          currentStep={this.currentStep}\n          onPrevious={this.handlePrevious}\n          onCompleted={this.handleCompleted}\n          envTypeId={this.envTypeId}\n          envTypeImmutable={!!this.envTypeId} // If envTypeId is passed already then do not allow selecting it\n        />\n      );\n    }\n\n    return content;\n  }\n\n  get envTypeId() {\n    return (this.props.match.params || {}).envTypeId;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(EnvironmentSetup, {\n  handlePrevious: action,\n  handleCompleted: action,\n  currentStep: observable,\n});\n\nexport default inject()(withRouter(observer(EnvironmentSetup)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Step, Icon } from 'semantic-ui-react';\n\n// expected props\n// currentStep an instance of the CurrentStep model\nconst Component = observer(({ currentStep = {}, envTypeImmutable = false }) => {\n  let activeIndex;\n  const step = currentStep.step;\n\n  switch (step) {\n    case 'selectComputePlatform':\n    case 'selectEnvType':\n      activeIndex = 0;\n      break;\n    case 'selectComputeConfiguration':\n    case 'selectEnvConfig':\n      activeIndex = 1;\n      break;\n    default:\n      activeIndex = 0;\n  }\n\n  return (\n    <Step.Group widths={2}>\n      {!envTypeImmutable && (\n        <Step active={activeIndex === 0} disabled={activeIndex < 0}>\n          <Icon name=\"server\" />\n          <Step.Content>\n            <Step.Title>Select Compute</Step.Title>\n            <Step.Description>Select a compute platform</Step.Description>\n          </Step.Content>\n        </Step>\n      )}\n      <Step active={activeIndex === 1} disabled={activeIndex < 1}>\n        <Icon name=\"hdd outline\" />\n        <Step.Content>\n          <Step.Title>Create Workspace</Step.Title>\n          <Step.Description>Create the workspace</Step.Description>\n        </Step.Content>\n      </Step>\n    </Step.Group>\n  );\n});\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { decorate, observable, action, runInAction } from 'mobx';\nimport { Button, Dimmer, Header, List, Loader, Dropdown, Segment } from 'semantic-ui-react';\nimport _ from 'lodash';\n\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\nimport validate from '@aws-ee/base-ui/dist/models/forms/Validate';\n\nimport { getAddProjectForm, getAddProjectFormFields } from '../../models/forms/AddProjectForm';\n\nclass AddProject extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      // eslint-disable-next-line react/no-unused-state\n      role: 'guest',\n      // eslint-disable-next-line react/no-unused-state\n      status: 'active',\n      indexId: '',\n    };\n\n    runInAction(() => {\n      this.formProcessing = false;\n      this.validationErrors = new Map();\n      this.project = {\n        id: '',\n        description: '',\n        indexId: '',\n        projectAdmins: [],\n      };\n    });\n    this.form = getAddProjectForm();\n    this.addProjectFormFields = getAddProjectFormFields();\n  }\n\n  goto(pathname) {\n    const location = this.props.location;\n    const link = createLink({ location, pathname });\n    this.props.history.push(link);\n  }\n\n  render() {\n    return (\n      <div className=\"mt2 animated fadeIn\">\n        <Header as=\"h2\" icon textAlign=\"center\" className=\"mt3\" color=\"grey\">\n          Add Project\n        </Header>\n        <div className=\"mt3 ml3 mr3 animated fadeIn\">{this.renderAddProjectForm()}</div>\n      </div>\n    );\n  }\n\n  // eslint-disable-next-line react/no-unused-state\n  handleRoleChange = (e, { value }) => this.setState({ role: value });\n\n  // eslint-disable-next-line react/no-unused-state\n  handleStatusChange = (e, { value }) => this.setState({ status: value });\n\n  renderAddProjectForm() {\n    const processing = this.formProcessing;\n    const fields = this.addProjectFormFields;\n    const toEditableInput = (attributeName, type = 'text') => {\n      const handleChange = action(event => {\n        event.preventDefault();\n        this.project[attributeName] = event.target.value;\n      });\n      return (\n        <div className=\"ui focus input\">\n          <input\n            type={type}\n            defaultValue={this.project[attributeName]}\n            placeholder={fields[attributeName].placeholder || ''}\n            onChange={handleChange}\n          />\n        </div>\n      );\n    };\n\n    return (\n      <Segment basic className=\"ui fluid form\">\n        <Dimmer active={processing} inverted>\n          <Loader inverted>Checking</Loader>\n        </Dimmer>\n        {this.renderField('id', toEditableInput('id', 'id'))}\n        <div className=\"mb4\" />\n        {this.renderField('indexId')}\n        {this.renderIndexSelection()}\n        <div className=\"mb4\" />\n        {this.renderField('description', toEditableInput('description', 'description'))}\n        <div className=\"mb4\" />\n        {this.renderField('projectAdmins')}\n        {this.renderProjectAdminsSelection()}\n        {this.renderButtons()}\n      </Segment>\n    );\n  }\n\n  renderProjectAdminsSelection() {\n    const projectAdminsOption = this.props.usersStore.asDropDownOptions();\n    const fields = this.addProjectFormFields;\n    const placeholder = fields.projectAdmins.placeholder || 'Please select a user';\n\n    return (\n      <Dropdown\n        options={projectAdminsOption}\n        placeholder={placeholder}\n        fluid\n        multiple\n        selection\n        onChange={this.handleProjectAdminsSelection}\n      />\n    );\n  }\n\n  handleProjectAdminsSelection = (e, { value }) => {\n    runInAction(() => {\n      if (Array.isArray(value)) {\n        this.project.projectAdmins = value;\n      }\n    });\n  };\n\n  renderButtons() {\n    const processing = this.formProcessing;\n    return (\n      <div className=\"mt3\">\n        <Button floated=\"right\" color=\"blue\" icon disabled={processing} className=\"ml2\" onClick={this.handleSubmit}>\n          Add Project\n        </Button>\n        <Button floated=\"right\" disabled={processing} onClick={this.handleCancel}>\n          Cancel\n        </Button>\n      </div>\n    );\n  }\n\n  renderIndexSelection() {\n    const indexIdOption = this.props.indexesStore.dropdownOptions;\n    return (\n      <Dropdown\n        options={indexIdOption}\n        placeholder=\"Please assign indexes to this project\"\n        fluid\n        selection\n        onChange={this.handleIndexSelection}\n      />\n    );\n  }\n\n  handleIndexSelection = (e, { value }) => this.setState({ indexId: value });\n\n  renderField(name, component) {\n    const fields = this.addProjectFormFields;\n    const explain = fields[name].explain;\n    const label = fields[name].label;\n    const hasExplain = !_.isEmpty(explain);\n    const fieldErrors = this.validationErrors.get(name);\n    const hasError = !_.isEmpty(fieldErrors);\n\n    return (\n      <div>\n        <Header className=\"mr3 mt0\" as=\"h2\" color=\"grey\">\n          {label}\n        </Header>\n        {hasExplain && <div className=\"mb2\">{explain}</div>}\n        <div className={`ui big field input block m0 ${hasError ? 'error' : ''}`}>{component}</div>\n        {hasError && (\n          <div className=\"ui pointing red basic label\">\n            <List>\n              {_.map(fieldErrors, fieldError => (\n                <List.Item key={name}>\n                  <List.Content>{fieldError}</List.Content>\n                </List.Item>\n              ))}\n            </List>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  handleCancel = action(event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.formProcessing = false;\n    this.goto('/accounts');\n  });\n\n  handleSubmit = action(async () => {\n    this.formProcessing = true;\n    try {\n      // Perform client side validations first\n      this.project.indexId = this.state.indexId;\n      const validationResult = await validate(this.project, this.addProjectFormFields);\n      // if there are any client side validation errors then do not attempt to make API call\n      if (validationResult.fails()) {\n        runInAction(() => {\n          this.validationErrors = validationResult.errors;\n          this.formProcessing = false;\n        });\n      } else {\n        // There are no client side validation errors so ask the store to add user (which will make API call to server to add the user)\n        await this.props.projectsStore.addProject(this.project);\n        runInAction(() => {\n          this.formProcessing = false;\n        });\n        this.goto('/accounts');\n      }\n    } catch (error) {\n      runInAction(() => {\n        this.formProcessing = false;\n      });\n      displayError(error);\n    }\n  });\n\n  getStore() {\n    return this.props.usersStore;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(AddProject, {\n  formProcessing: observable,\n  user: observable,\n  validationErrors: observable,\n});\nexport default inject('usersStore', 'indexesStore', 'projectsStore')(withRouter(observer(AddProject)));\n","import _ from 'lodash';\nimport React from 'react';\nimport { computed, decorate, observable, runInAction, action } from 'mobx';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Container, Header, Icon, Message, Segment, Button } from 'semantic-ui-react';\n\nimport { displaySuccess, displayError } from '@aws-ee/base-ui/dist//helpers/notification';\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport YesNo from '@aws-ee/base-ui/dist/parts/helpers/fields/YesNo';\nimport DropDown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\n\nimport { isStoreLoading, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { getAddUserForm } from '../../models/forms/AddLocalUserForm';\n\n// expected props\n// - projectsStore (via injection)\n// - userRolesStore (via injection)\n// - usersStore (via injection)\nclass AddSingleLocalUser extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.stores = new Stores([this.userRolesStore, this.projectsStore]);\n      this.form = getAddUserForm();\n    });\n  }\n\n  componentDidMount() {\n    swallowError(this.stores.load());\n  }\n\n  get projectsStore() {\n    return this.props.projectsStore;\n  }\n\n  get userRolesStore() {\n    return this.props.userRolesStore;\n  }\n\n  get usersStore() {\n    return this.props.usersStore;\n  }\n\n  // Private methods\n  handleCancel = () => {\n    const goto = gotoFn(this);\n    goto('/users');\n  };\n\n  handleFormSubmission = async form => {\n    const values = form.values();\n    const isInternalUser = this.userRolesStore.isInternalUser(values.userRole);\n    const isInternalGuest = this.userRolesStore.isInternalGuest(values.userRole);\n\n    let projectId = values.projectId || [];\n    if (!isInternalUser || isInternalGuest) {\n      // Pass projectId(s) only if it is internal user or a guest. Pass empty array otherwise.\n      projectId = [];\n    }\n\n    try {\n      await this.usersStore.addUser({ ...values, projectId });\n      runInAction(() => {\n        form.clear();\n      });\n      displaySuccess('Added local user successfully');\n\n      const goto = gotoFn(this);\n      goto('/users');\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  render() {\n    const stores = this.stores;\n    let content = null;\n    if (stores.hasError) {\n      content = <ErrorBox error={stores.error} className=\"p0 mb3\" />;\n    } else if (isStoreLoading(stores)) {\n      content = <BasicProgressPlaceholder />;\n    } else if (isStoreReady(stores)) {\n      content = this.renderContent();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3 mb4\">\n        {this.renderTitle()}\n        {this.renderWarning()}\n        {content}\n      </Container>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"user\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Add Local User</Header.Content>\n        </Header>\n      </div>\n    );\n  }\n\n  renderContent() {\n    const form = this.form;\n    const emailField = form.$('email');\n    const firstNameField = form.$('firstName');\n    const lastNameField = form.$('lastName');\n    const passwordField = form.$('password');\n    const userRoleField = form.$('userRole');\n    const projectIdField = form.$('projectId');\n    const statusField = form.$('status');\n\n    const userRoleOptions = this.userRolesStore.dropdownOptions;\n    const projectIdOptions = this.projectsStore.dropdownOptions;\n\n    const isInternalUser = this.userRolesStore.isInternalUser(userRoleField.value);\n    const isInternalGuest = this.userRolesStore.isInternalGuest(userRoleField.value);\n    const showProjectField = !_.isEmpty(projectIdOptions) && isInternalUser && !isInternalGuest;\n    const showProjectWarning = _.isEmpty(projectIdOptions) && isInternalUser && !isInternalGuest;\n\n    return (\n      <Segment clearing className=\"p3\">\n        <Form form={form} onCancel={this.handleCancel} onSuccess={this.handleFormSubmission}>\n          {({ processing, onCancel }) => (\n            <>\n              <Input field={emailField} disabled={processing} />\n              <Input field={firstNameField} disabled={processing} />\n              <Input field={lastNameField} disabled={processing} />\n              <Input field={passwordField} type=\"password\" disabled={processing} />\n              <DropDown field={userRoleField} options={userRoleOptions} selection fluid disabled={processing} />\n\n              {showProjectField && (\n                <DropDown\n                  field={projectIdField}\n                  options={projectIdOptions}\n                  multiple\n                  selection\n                  clearable\n                  fluid\n                  disabled={processing}\n                />\n              )}\n\n              {showProjectWarning && (\n                <Message\n                  className=\"mb4\"\n                  icon=\"warning\"\n                  header=\"Missing projects\"\n                  content=\"There are no projects created. Once you create a project or two. You want to come back and associate this user to at least one project. You can still create the user for now.\"\n                />\n              )}\n\n              <YesNo field={statusField} disabled={processing} />\n\n              <div className=\"mt3\">\n                <Button floated=\"right\" color=\"blue\" icon disabled={processing} className=\"ml2\" type=\"submit\">\n                  Add Local User\n                </Button>\n                <Button floated=\"right\" disabled={processing} onClick={onCancel}>\n                  Cancel\n                </Button>\n              </div>\n            </>\n          )}\n        </Form>\n      </Segment>\n    );\n  }\n\n  renderWarning() {\n    return (\n      <Message\n        warning\n        icon=\"warning\"\n        header=\"Not for production usage\"\n        content=\"Creating local users is not meant to be used in production environments.\"\n      />\n    );\n  }\n}\n\ndecorate(AddSingleLocalUser, {\n  projectsStore: computed,\n  userRolesStore: computed,\n  usersStore: computed,\n  stores: observable,\n  form: observable,\n  handleCancel: action,\n  handleFormSubmission: action,\n});\n\nexport default inject('projectsStore', 'userRolesStore', 'usersStore')(withRouter(observer(AddSingleLocalUser)));\n","/* eslint-disable import/prefer-default-export */\nimport { createForm } from '../../helpers/form';\n\nconst addUserFormFields = {\n  email: {\n    label: 'Username',\n    placeholder: 'Type email address as username for the user',\n    extra: { explain: 'Username in email format' },\n    rules: 'required|email|string',\n  },\n  password: {\n    label: 'Password',\n    placeholder: 'Type default password for the user',\n    explain: `The password must be between 4 and 2048 characters long.`,\n    rules: 'required|string|between:4,2048',\n  },\n  firstName: {\n    label: 'First Name',\n    placeholder: 'Type first name of the user',\n    rules: 'required|string|between:1,500',\n  },\n  lastName: {\n    label: 'Last Name',\n    placeholder: 'Type last name of the user',\n    rules: 'required|string|between:1,500',\n  },\n  userRole: {\n    label: 'UserRole',\n    extra: { explain: \"Select user's role\" },\n    rules: 'required',\n  },\n  projectId: {\n    label: 'Projects',\n    extra: { explain: 'Select projects that this user are associated with' },\n  },\n  status: {\n    label: 'Status',\n    extra: {\n      explain: 'Active users can log into the Research Portal',\n      yesLabel: 'Active',\n      noLabel: 'Inactive',\n      yesValue: 'active',\n      noValue: 'inactive',\n    },\n    rules: 'required',\n  },\n};\n\nfunction getAddUserForm() {\n  return createForm(addUserFormFields);\n}\n\nexport { getAddUserForm };\n","import React, { Component } from 'react';\nimport _ from 'lodash';\nimport { withRouter } from 'react-router-dom';\nimport { Divider, Popup, Button } from 'semantic-ui-react';\nimport { observer } from 'mobx-react';\n\nimport { gotoFn } from '@aws-ee/base-ui/src/helpers/routing';\n\n/**\n * A plugin component that adds \"Test Launch\" and \"Test launch with data\" buttons on the environment type card for\n * non-approved env types to allow admins to test before approving them\n */\n// expected props\n// - envType\nclass EnvTypeCardMetaActions extends Component {\n  render() {\n    const isApproved = _.toLower(this.props.envType.status) === 'approved';\n    return (\n      !isApproved && (\n        <>\n          <Divider />\n          <Popup\n            trigger={\n              <Button basic onClick={this.handleTestClick}>\n                Test launch\n              </Button>\n            }\n            content=\"Create a test Workspace\"\n          />\n          <Popup\n            trigger={\n              <Button basic onClick={this.handleTestWithDataClick}>\n                Test launch with data\n              </Button>\n            }\n            content=\"Create a test Workspace with data\"\n          />\n        </>\n      )\n    );\n  }\n\n  handleTestClick = () => {\n    const envType = this.props.envType;\n    const goto = gotoFn(this);\n    goto(`/workspaces/create/type/${encodeURIComponent(envType.id)}`);\n  };\n\n  handleTestWithDataClick = () => {\n    const envType = this.props.envType;\n    const goto = gotoFn(this);\n    goto(`/studies/workspace-type/${encodeURIComponent(envType.id)}`);\n  };\n}\n\nexport default withRouter(observer(EnvTypeCardMetaActions));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nfunction createLinkWithSearch({ location, pathname, search }) {\n  return {\n    pathname,\n    search: search || location.search,\n    hash: location.hash,\n    state: location.state,\n  };\n}\n\nfunction createLink({ location, pathname }) {\n  return {\n    pathname,\n    hash: location.hash,\n    state: location.state,\n  };\n}\n\nfunction reload() {\n  setTimeout(() => {\n    window.location.reload();\n  }, 150);\n}\n\n/**\n * A generic goto function creator function that returns a go to function bound to the given react component.\n *\n * See below snippet as an example for using this function from within some react component\n * containing \"location\" and \"history\" props.\n *\n * const goto = gotoFn(this);\n * goto('/some-path');\n *\n * @param reactComponent A react component that has \"location\" and \"history\" props as injected via the \"withRouter\" function.\n * @returns {{new(...args: any[]): any} | ((...args: any[]) => any) | OmitThisParameter<goto> | goto | any | {new(...args: any[]): any} | ((...args: any[]) => any)}\n */\nfunction gotoFn(reactComponent) {\n  function goto(pathname) {\n    const location = reactComponent.props.location;\n    const link = createLink({ location, pathname });\n\n    reactComponent.props.history.push(link);\n  }\n  return goto.bind(reactComponent);\n}\n\nexport { createLink, createLinkWithSearch, reload, gotoFn };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Container, Divider } from 'semantic-ui-react';\n\nimport EnvTypeCandidatesList from './EnvTypeCandidatesList';\nimport EnvTypesList from './EnvTypesList';\n\nfunction EnvTypesManagement() {\n  return (\n    <Container className=\"mt3\">\n      <EnvTypeCandidatesList />\n      <Divider />\n      <EnvTypesList />\n    </Container>\n  );\n}\n\nexport default observer(EnvTypesManagement);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React, { Component } from 'react';\nimport { action, computed, decorate, observable, runInAction } from 'mobx';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Container, Header, Card, Icon, Divider, Checkbox, Label, Segment, Button, Image } from 'semantic-ui-react';\n\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport {\n  isStoreEmpty,\n  isStoreError,\n  isStoreLoading,\n  isStoreNotEmpty,\n  isStoreReady,\n} from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { envMgmtRoleName } from '../../helpers/settings';\nimport awsServiceCatalogIcon from '../../../images/AWS-Service-Catalog.svg';\n\n// expected props\n// - envTypeCandidatesStore (via injection)\nclass EnvTypeCandidatesList extends Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.showAllVersions = false;\n    });\n  }\n\n  componentDidMount() {\n    swallowError(this.envTypeCandidatesStore.load());\n  }\n\n  get envTypeCandidatesStore() {\n    return this.props.envTypeCandidatesStore;\n  }\n\n  render() {\n    const store = this.envTypeCandidatesStore;\n    let content;\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0 mb3\" />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder />;\n    } else if (isStoreReady(store) && isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (isStoreReady(store) && isStoreNotEmpty(store)) {\n      const list = this.envTypeCandidatesList;\n      if (_.isEmpty(list)) {\n        // The store may not be empty (there may be older versions of the AWS Service Catalog Product)\n        // but if the user selected to show only latest versions that are not imported yet then that list\n        // may be empty so checking for \"isEmpty\" here in addition to \"isStoreEmpty\"\n        // check above\n        content = this.renderEmpty();\n      } else {\n        content = this.renderMain();\n      }\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3 mb4\">\n        {this.renderTitle()}\n        {content}\n      </Container>\n    );\n  }\n\n  renderTitle() {\n    const renderCount = () => {\n      const store = this.envTypeCandidatesStore;\n      const showCount = isStoreReady(store) && isStoreNotEmpty(store);\n      return (\n        showCount && (\n          <Label circular size=\"medium\">\n            {this.envTypeCandidatesList.length}\n          </Label>\n        )\n      );\n    };\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          {/* <Icon name=\"computer\" className=\"align-top\" /> */}\n          <Image src={awsServiceCatalogIcon} />\n          <Header.Content className=\"left-align\">\n            AWS Service Catalog Products\n            {renderCount()}\n          </Header.Content>\n          <Header.Subheader className=\"mt2\">\n            Available AWS Service Catalog Product Versions not imported yet\n          </Header.Subheader>\n        </Header>\n        <div>\n          <Checkbox\n            toggle\n            checked={this.showAllVersions}\n            onClick={() => this.handleShowAllVersionsToggle()}\n            label={this.showAllVersions ? 'All Versions' : 'Latest Versions'}\n          />\n        </div>\n      </div>\n    );\n  }\n\n  handleShowAllVersionsToggle = () => {\n    this.showAllVersions = !this.showAllVersions;\n  };\n\n  handleImportButtonClick = id => {\n    const goto = gotoFn(this);\n    goto(`/workspace-types-management/import/${encodeURIComponent(id)}`);\n  };\n\n  renderEmpty() {\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"computer\" />\n          No AWS Service Catalog Product Versions available for importing\n          <Header.Subheader className=\"mt2\">\n            Please create AWS Service Catalog Product Version and share the Portfolio with the AWS IAM role{' '}\n            <strong>{envMgmtRoleName}</strong>.\n          </Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderMain() {\n    const list = this.envTypeCandidatesList;\n    if (_.isEmpty(list)) {\n      // The store may not be empty (there may be older versions of the AWS Service Catalog Product)\n      // but if the user selected to show only latest versions that are not imported yet then that list\n      // may be empty so checking for \"isEmpty\" here in addition to isStoreEmpty check in the render method\n      return this.renderEmpty();\n    }\n    return (\n      <Card.Group stackable itemsPerRow={3}>\n        {_.map(list, envTypeCandidate => (\n          <Card key={`etc-${envTypeCandidate.id}`} raised className=\"mb3\">\n            <Card.Content>\n              <Header as=\"h4\">{envTypeCandidate.name}</Header>\n              <Card.Meta>{_.get(envTypeCandidate, 'provisioningArtifact.name')}</Card.Meta>\n              <Divider />\n              <Card.Description>\n                <div className=\"mb3 pr1 pl1 pb1\">\n                  {/* Yes, we are doing dangerouslySetInnerHTML, the content was already sanitized by showdownjs */}\n                  {/* eslint-disable-next-line react/no-danger */}\n                  <div dangerouslySetInnerHTML={{ __html: envTypeCandidate.descHtml }} />\n                </div>\n              </Card.Description>\n            </Card.Content>\n            <Card.Content extra>\n              <Button\n                basic\n                icon\n                color=\"blue\"\n                onClick={() => this.handleImportButtonClick(envTypeCandidate.id)}\n                labelPosition=\"right\"\n                floated=\"right\"\n                size=\"mini\"\n              >\n                Import\n                <Icon name=\"arrow down\" />\n              </Button>\n            </Card.Content>\n          </Card>\n        ))}\n      </Card.Group>\n    );\n  }\n\n  get envTypeCandidatesList() {\n    return this.showAllVersions\n      ? this.envTypeCandidatesStore.listAllVersions\n      : this.envTypeCandidatesStore.listLatestVersions;\n  }\n}\n\ndecorate(EnvTypeCandidatesList, {\n  envTypeCandidatesList: computed,\n  envTypeCandidatesStore: computed,\n\n  showAllVersions: observable,\n\n  handleShowAllVersionsToggle: action,\n  handleImportButtonClick: action,\n});\n\nexport default inject('envTypeCandidatesStore')(withRouter(observer(EnvTypeCandidatesList)));\n","module.exports = __webpack_public_path__ + \"static/media/AWS-Service-Catalog.1ed0286e.svg\";","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { action, computed, decorate, observable, runInAction } from 'mobx';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Container, Header, Card, Icon, Label, Segment, Radio } from 'semantic-ui-react';\n\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport {\n  isStoreEmpty,\n  isStoreError,\n  isStoreLoading,\n  isStoreNotEmpty,\n  isStoreReady,\n} from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { envMgmtRoleName } from '../../helpers/settings';\nimport * as EnvTypeStatusEnum from '../../models/environment-types/EnvTypeStatusEnum';\nimport EnvTypeCard from './EnvTypeCard';\n\n// expected props\n// - envTypesStore (via injection)\nclass EnvTypesList extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.statusFilter = '*';\n    });\n  }\n\n  componentDidMount() {\n    swallowError(this.envTypesStore.load());\n  }\n\n  get envTypesStore() {\n    return this.props.envTypesStore;\n  }\n\n  render() {\n    const store = this.envTypesStore;\n    let content;\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0 mb3\" />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder />;\n    } else if (isStoreReady(store) && isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (isStoreReady(store) && isStoreNotEmpty(store)) {\n      const list = this.envTypesList;\n      if (_.isEmpty(list)) {\n        // The store may not be empty (there may be env types) but if the user selected to show only approved or\n        // not-approved versions then that list may be empty so checking for \"isEmpty\" here in addition to \"isStoreEmpty\"\n        // check above\n        content = this.renderEmpty();\n      } else {\n        content = this.renderMain();\n      }\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3 mb4\">\n        {this.renderTitle()}\n        {content}\n      </Container>\n    );\n  }\n\n  renderTitle() {\n    const renderCount = () => {\n      const store = this.envTypesStore;\n      const showCount = isStoreReady(store) && isStoreNotEmpty(store);\n      return (\n        showCount && (\n          <Label circular size=\"medium\">\n            {this.envTypesList.length}\n          </Label>\n        )\n      );\n    };\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"computer\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">\n            Workspace Types\n            {renderCount()}\n          </Header.Content>\n          <Header.Subheader className=\"mt2\">\n            AWS Service Catalog Product Versions imported as Environment Types\n          </Header.Subheader>\n        </Header>\n        <div>\n          <Radio\n            label=\"Approved\"\n            name=\"statusFilter\"\n            checked={EnvTypeStatusEnum.isApproved(this.statusFilter)}\n            value={EnvTypeStatusEnum.approved}\n            onChange={this.handleStatusFilterChange}\n            className=\"mr2\"\n          />\n          <Radio\n            label=\"Not Approved\"\n            name=\"statusFilter\"\n            checked={EnvTypeStatusEnum.isNotApproved(this.statusFilter)}\n            value={EnvTypeStatusEnum.notApproved}\n            onChange={this.handleStatusFilterChange}\n            className=\"mr2\"\n          />\n          <Radio\n            label=\"All\"\n            name=\"statusFilter\"\n            checked={this.statusFilter === '*'}\n            value=\"*\"\n            onChange={this.handleStatusFilterChange}\n            className=\"mr2\"\n          />\n        </div>\n      </div>\n    );\n  }\n\n  handleStatusFilterChange = (e, { value }) => {\n    this.statusFilter = value;\n  };\n\n  renderEmpty() {\n    const getEmptyMessage = () => {\n      let msg;\n      if (EnvTypeStatusEnum.isApproved(this.statusFilter)) {\n        msg = <>No approved Environment Types found</>;\n      } else if (EnvTypeStatusEnum.isNotApproved(this.statusFilter)) {\n        msg = <>No Environments Types found that require approval</>;\n      } else {\n        msg = (\n          <>\n            No AWS Service Catalog Product Versions imported yet\n            <Header.Subheader className=\"mt2\">\n              Start by importing an AWS Service Catalog Product Version as Environment Type. AWS Service Catalog\n              Products that are part of AWS Service Catalog Portfolio shared with AWS IAM role{' '}\n              <strong>{envMgmtRoleName}</strong> are eligible for importing.\n            </Header.Subheader>\n          </>\n        );\n      }\n      return msg;\n    };\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"computer\" />\n          {getEmptyMessage()}\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderMain() {\n    const list = this.envTypesList;\n    return (\n      <Card.Group stackable itemsPerRow={3}>\n        {_.map(list, envType => {\n          return <EnvTypeCard key={envType.id} envType={envType} envTypesStore={this.envTypesStore} />;\n        })}\n      </Card.Group>\n    );\n  }\n\n  get envTypesList() {\n    let list = [];\n    if (EnvTypeStatusEnum.isApproved(this.statusFilter)) {\n      list = this.envTypesStore.listApproved;\n    } else if (EnvTypeStatusEnum.isNotApproved(this.statusFilter)) {\n      list = this.envTypesStore.listNotApproved;\n    } else {\n      list = this.envTypesStore.list;\n    }\n    return list;\n  }\n}\n\ndecorate(EnvTypesList, {\n  envTypesList: computed,\n  envTypesStore: computed,\n\n  statusFilter: observable,\n\n  handleStatusFilterChange: action,\n});\n\nexport default inject('envTypesStore')(withRouter(observer(EnvTypesList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React, { Component } from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Button, Card, Divider, Header, Icon, Label, Modal } from 'semantic-ui-react';\nimport { action, computed, decorate, observable, runInAction } from 'mobx';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\n\nimport * as EnvTypeStatusEnum from '../../models/environment-types/EnvTypeStatusEnum';\n\nclass EnvTypeCard extends Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.processing = false;\n      this.shouldShowDeleteDialog = false;\n    });\n  }\n\n  render() {\n    const envType = this.props.envType;\n    const isApproved = EnvTypeStatusEnum.isApproved(envType.status);\n\n    const pluginRegistry = this.props.pluginRegistry;\n    const defaultMetaActions = [];\n    const metaActions = pluginRegistry.visitPlugins(\n      'env-type-management',\n      'getEnvTypeCardMetaActions',\n      {\n        payload: defaultMetaActions,\n      },\n      envType,\n    );\n\n    const defaultMgmtActions = [\n      <Button\n        key=\"env-type-mgmt-action-edit\"\n        basic\n        color=\"blue\"\n        onClick={() => this.handleEditClick(envType.id)}\n        floated=\"right\"\n        size=\"mini\"\n        disabled={this.processing}\n      >\n        Edit\n      </Button>,\n      <Button\n        key=\"env-type-mgmt-action-delete\"\n        basic\n        color=\"red\"\n        onClick={() => this.showDeleteDialog()}\n        floated=\"right\"\n        size=\"mini\"\n        disabled={this.processing}\n      >\n        Delete\n      </Button>,\n      this.renderDeleteConfirmation(envType),\n      <Button\n        key=\"env-type-mgmt-action-revoke-or-approve\"\n        basic\n        color={isApproved ? 'red' : 'blue'}\n        onClick={() => this.handleApproveRevokeClick(envType.id, isApproved)}\n        floated=\"right\"\n        size=\"mini\"\n        disabled={this.processing}\n      >\n        {isApproved ? 'Revoke' : 'Approve'}\n      </Button>,\n    ];\n    const mgmtActions = pluginRegistry.visitPlugins(\n      'env-type-management',\n      'getEnvTypeCardMgmtActions',\n      {\n        payload: defaultMgmtActions,\n      },\n      envType,\n    );\n\n    return (\n      <Card key={`et-${envType.id}`} raised className=\"mb3\">\n        <Card.Content>\n          <Header as=\"h4\">{envType.name}</Header>\n          <Card.Meta className=\"flex\">\n            <span className=\"fs-8 color-grey mr2\">{envType.id}</span>\n            <Label className=\"ml1\" size=\"mini\" color={isApproved ? 'green' : 'red'}>\n              {isApproved ? 'Approved' : 'Not Approved'}\n            </Label>\n          </Card.Meta>\n          {_.map(metaActions, c => c)}\n          <Divider />\n          <Card.Description>\n            <div className=\"mb3 pr1 pl1 pb1\">\n              {/* Yes, we are doing dangerouslySetInnerHTML, the content was already sanitized by showdownjs */}\n              {/* eslint-disable-next-line react/no-danger */}\n              <div dangerouslySetInnerHTML={{ __html: envType.descHtml }} />\n            </div>\n          </Card.Description>\n        </Card.Content>\n        <Card.Content extra>{_.map(mgmtActions, c => c)}</Card.Content>\n      </Card>\n    );\n  }\n\n  renderDeleteConfirmation(envType) {\n    const shouldShowDeleteDialog = this.shouldShowDeleteDialog;\n    const processing = this.processing;\n    return (\n      <Modal\n        key=\"env-type-mgmt-action-delete-confirmation\"\n        open={shouldShowDeleteDialog}\n        onClose={this.hideDeleteDialog}\n        closeOnDimmerClick={!processing}\n      >\n        <Modal.Header>Delete {envType.name}</Modal.Header>\n        <Modal.Content>\n          <p>Are you sure you want to delete {envType.name}?</p>\n          <p>\n            Once you delete environment type, users will not be able launch them. You will need to re-import it from the\n            AWS Service Catalog Product.\n          </p>\n          <p>Is it okay to delete?</p>\n        </Modal.Content>\n        <Modal.Actions>\n          <Button\n            basic\n            icon\n            color=\"grey\"\n            labelPosition=\"right\"\n            size=\"mini\"\n            disabled={this.processing}\n            onClick={this.hideDeleteDialog}\n          >\n            <Icon name=\"close\" />\n            Cancel\n          </Button>\n          <Button\n            basic\n            icon\n            color=\"red\"\n            labelPosition=\"right\"\n            size=\"mini\"\n            disabled={this.processing}\n            onClick={() => this.handleDeleteClick(envType.id)}\n          >\n            <Icon name=\"trash\" /> Delete\n          </Button>\n        </Modal.Actions>\n      </Modal>\n    );\n  }\n\n  showDeleteDialog = () => {\n    this.shouldShowDeleteDialog = true;\n    this.processing = false;\n  };\n\n  hideDeleteDialog = () => {\n    if (this.processing) return;\n    this.shouldShowDeleteDialog = false;\n  };\n\n  handleApproveRevokeClick = async (id, revoking = false) => {\n    this.processing = true;\n    const store = this.envTypesStore;\n    try {\n      if (revoking) {\n        await store.revokeEnvType(id);\n      } else {\n        await store.approveEnvType(id);\n      }\n    } catch (error) {\n      displayError(error);\n    }\n    runInAction(() => {\n      this.processing = false;\n    });\n  };\n\n  handleDeleteClick = async id => {\n    this.processing = true;\n    const store = this.envTypesStore;\n    try {\n      await store.deleteEnvType(id);\n    } catch (error) {\n      displayError(error);\n    }\n    runInAction(() => {\n      this.processing = false;\n      this.hideDeleteDialog();\n    });\n  };\n\n  handleEditClick = async id => {\n    const goto = gotoFn(this);\n    goto(`/workspace-types-management/edit/${encodeURIComponent(id)}`);\n  };\n\n  get envTypesStore() {\n    return this.props.envTypesStore;\n  }\n}\n\ndecorate(EnvTypeCard, {\n  processing: observable,\n  envTypesStore: computed,\n  shouldShowDeleteDialog: observable,\n\n  handleEditClick: action,\n  handleDeleteClick: action,\n  handleApproveRevokeClick: action,\n  showDeleteDialog: action,\n  hideDeleteDialog: action,\n});\nexport default inject('pluginRegistry')(withRouter(observer(EnvTypeCard)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { inject, observer, Observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { computed, decorate, observable, runInAction } from 'mobx';\nimport { Container, Header, Icon, Step, Tab } from 'semantic-ui-react';\n\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport { isStoreLoading, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { createWizard } from '@aws-ee/base-ui/dist/models/Wizard';\nimport BasicInfoStep from './env-type-editor-steps/BasicInfoStep';\nimport ConfigStep from './env-type-editor-steps/ConfigStep';\n\n// This component is used with the TabPane to replace the default Segment wrapper since\n// we don't want to display the border.\nfunction TabPaneWrapper(props) {\n  return <>{props.children}</>;\n}\n\nclass EnvTypeEditor extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.stores = new Stores([this.envTypeCandidatesStore, this.envTypesStore]);\n      this.wizardModel = createWizard([\n        {\n          key: 'basic_information',\n          title: 'Basic Information',\n          desc: 'Enter basic information about the Environment Type',\n          isComplete: false,\n        },\n        {\n          key: 'configurations',\n          title: 'Configurations',\n          desc: 'Define configurations with predefined set of AWS CloudFormation Input Parameter values',\n          isComplete: false,\n        },\n      ]);\n    });\n  }\n\n  componentDidMount() {\n    swallowError(this.stores.load());\n  }\n\n  render() {\n    const stores = this.stores;\n    let content = null;\n    if (stores.hasError) {\n      content = <ErrorBox error={stores.error} className=\"p0 mb3\" />;\n    } else if (isStoreLoading(stores)) {\n      content = <BasicProgressPlaceholder />;\n    } else if (isStoreReady(stores)) {\n      content = this.renderContent();\n    } else {\n      content = null;\n    }\n\n    return <Container className=\"mt3 mb4\">{content}</Container>;\n  }\n\n  renderTitle = () => {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"computer\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">\n            {this.isEditAction() ? 'Edit' : 'Import'} Workspace Type\n          </Header.Content>\n          <Header.Subheader className=\"mt2\">{_.get(this.envType, 'name')}</Header.Subheader>\n        </Header>\n      </div>\n    );\n  };\n\n  renderContent = () => {\n    return (\n      <>\n        {this.renderTitle()}\n        {// When importing new env type, render the wizard as steps with linear flow\n        // When updating existing env type, render the wizard steps as tabs to allow random access\n        this.isImportAction() ? (\n          <>\n            {this.renderStepProgress()}\n            {this.renderCurrentStep()}\n          </>\n        ) : (\n          this.renderStepTabs()\n        )}\n      </>\n    );\n  };\n\n  renderStepProgress = () => {\n    return (\n      <Step.Group ordered className=\"container\">\n        {_.map(this.wizardModel.steps, step => {\n          const stepAttribs = {\n            key: step.key,\n            completed: step.isComplete,\n            active: this.wizardModel.isStepActive(step.key),\n          };\n          return (\n            <Step {...stepAttribs}>\n              <Step.Content>\n                <Step.Title>{step.title}</Step.Title>\n                <Step.Description>{step.desc}</Step.Description>\n              </Step.Content>\n            </Step>\n          );\n        })}\n      </Step.Group>\n    );\n  };\n\n  renderStepTabs = () => {\n    const stepPanes = _.map(this.wizardModel.steps, step => ({\n      menuItem: step.title,\n      render: () => (\n        <Tab.Pane attached={false} key={step.key} as={TabPaneWrapper}>\n          <Observer>{() => this.renderEnvTypeStep(step.key)}</Observer>\n        </Tab.Pane>\n        // <Observer>{() => this.renderEnvTypeStep(step.key)}</Observer>\n      ),\n    }));\n    return <Tab className=\"mt3\" menu={{ secondary: true, pointing: true }} renderActiveOnly panes={stepPanes} />;\n  };\n\n  renderCurrentStep = () => {\n    return this.renderEnvTypeStep(this.wizardModel.currentStep.key);\n  };\n\n  renderEnvTypeStep(stepKey) {\n    switch (stepKey) {\n      case 'basic_information':\n        return (\n          <BasicInfoStep\n            envTypesStore={this.envTypesStore}\n            envType={this.envType}\n            wizardModel={this.wizardModel}\n            workspaceTypeAction={this.getAction()}\n            onCancel={this.handleCancel}\n            onEnvTypeSaveComplete={this.handleDone}\n          />\n        );\n      case 'configurations':\n        return (\n          <ConfigStep\n            envType={this.envType}\n            envTypeConfigsStore={this.getEnvTypeConfigsStore()}\n            wizardModel={this.wizardModel}\n            workspaceTypeAction={this.getAction()}\n            onCancel={this.handleCancel}\n            onEnvTypeSaveComplete={this.handleDone}\n          />\n        );\n      default:\n        return undefined;\n    }\n  }\n\n  handleCancel = () => {\n    const goto = gotoFn(this);\n    goto(`/workspace-types-management`);\n  };\n\n  handleDone = () => {\n    this.handleCancel();\n  };\n\n  isEditAction() {\n    return this.getAction() === 'edit';\n  }\n\n  isImportAction() {\n    return this.getAction() === 'import';\n  }\n\n  getEnvTypeConfigsStore() {\n    return this.envTypesStore.getEnvTypeConfigsStore(this.getEnvTypeId());\n  }\n\n  getEnvTypeId() {\n    return decodeURIComponent((this.props.match.params || {}).id);\n  }\n\n  getAction() {\n    return decodeURIComponent((this.props.match.params || {}).action);\n  }\n\n  get envType() {\n    const id = this.getEnvTypeId();\n    // env type\n    const envType = this.envTypesStore.getEnvType(id);\n    if (!envType && this.isImportAction()) {\n      // Importing env type candidate as new env type, the envType may not exist yet in that case (if this is the first step in the wizard)\n      // Returning env type candidate in that case containing subset of env type information\n      const envTypeCandidate = this.envTypeCandidatesStore.getEnvTypeCandidate(id);\n      return envTypeCandidate;\n    }\n    return envType;\n  }\n\n  get envTypeCandidatesStore() {\n    return this.props.envTypeCandidatesStore;\n  }\n\n  get envTypesStore() {\n    return this.props.envTypesStore;\n  }\n}\n\ndecorate(EnvTypeEditor, {\n  envTypesStore: computed,\n  envType: computed,\n  envTypeCandidatesStore: computed,\n  stores: observable,\n\n  steps: observable,\n  currentStepNo: observable,\n});\n\nexport default inject('envTypesStore', 'envTypeCandidatesStore')(withRouter(observer(EnvTypeEditor)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { runInAction } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { Button, Segment } from 'semantic-ui-react';\n\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\n\nimport { displayError, displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { getAddEnvTypeBasicInfoForm } from '../../../models/forms/EnvTypeBasicInfoForm';\nimport EnvTypeStatusEnum from '../../../models/environment-types/EnvTypeStatusEnum';\n\nclass BasicInfoStep extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.form = getAddEnvTypeBasicInfoForm(props.envType);\n    });\n  }\n\n  render() {\n    const form = this.form;\n    return (\n      <Segment clearing className=\"mt3 p3\">\n        <Form form={form} onCancel={this.props.onCancel} onSuccess={this.handleFormSubmission}>\n          {({ processing, onCancel }) => (\n            <>\n              {this.renderFormFields({ form, processing, onCancel })}\n              {this.renderActionButtons({ processing, onCancel })}\n            </>\n          )}\n        </Form>\n      </Segment>\n    );\n  }\n\n  renderActionButtons({ processing, onCancel }) {\n    const isEditing = this.isEditAction();\n    return (\n      <div className=\"right-align\">\n        <Button basic color=\"grey\" disabled={processing} onClick={onCancel}>\n          Cancel\n        </Button>\n        <Button\n          className=\"ml2\"\n          primary\n          content={isEditing ? 'Save Workspace Type' : 'Import Workspace Type'}\n          disabled={processing}\n          // Every wizard step page has has it's own form\n          // The submit handler is responsible for saving the information and/or navigating to the next step (if there is next step)\n          type=\"submit\"\n        />\n      </div>\n    );\n  }\n\n  isEditAction() {\n    return this.props.workspaceTypeAction === 'edit';\n  }\n\n  isImportAction() {\n    return this.props.workspaceTypeAction === 'import';\n  }\n\n  renderFormFields({ form, processing }) {\n    const nameField = form.$('name');\n    const descField = form.$('desc');\n    return (\n      <>\n        <Input field={nameField} disabled={processing} />\n        <TextArea field={descField} disabled={processing} />\n      </>\n    );\n  }\n\n  handleFormSubmission = async form => {\n    const envType = this.props.envType;\n    const envTypesStore = this.props.envTypesStore;\n\n    const name = form.$('name').value;\n    const desc = form.$('desc').value;\n\n    let savedEnvType;\n    try {\n      if (this.isImportAction()) {\n        // if importing new env type then call \"create\"\n        savedEnvType = await envTypesStore.createEnvType({\n          id: envType.id,\n          name,\n          desc,\n          status: EnvTypeStatusEnum.notApproved,\n          product: envType.product,\n          provisioningArtifact: envType.provisioningArtifact,\n          params: envType.params,\n        });\n        displaySuccess(`Imported Workspace Type ${envType.name} successfully`);\n\n        // Navigate to next step (if there is) or call onEnvTypeSaveComplete to notify\n        // that this was last step and we are done creating env type\n        const wizardModel = this.props.wizardModel;\n        if (wizardModel.hasNext) {\n          wizardModel.next();\n        } else {\n          await this.props.onEnvTypeSaveComplete(savedEnvType);\n        }\n      } else {\n        // if updating existing env type then call \"update\" and call onEnvTypeSaveComplete to notify that we are done\n        // saving env type\n        savedEnvType = await envTypesStore.updateEnvType({\n          ...envType,\n          name,\n          desc,\n        });\n        displaySuccess(`Updated Workspace Type ${envType.name} successfully`);\n\n        await this.props.onEnvTypeSaveComplete(savedEnvType);\n      }\n    } catch (error) {\n      displayError(error);\n    }\n  };\n}\nexport default observer(BasicInfoStep);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { createForm } from '@aws-ee/base-ui/dist/helpers/form';\n\nfunction getAddEnvTypeBasicInfoForm(envType) {\n  const addEnvTypeBasicInfoFormFields = {\n    name: {\n      label: 'Name',\n      placeholder: 'Name for this workspace type',\n      extra: {\n        explain:\n          'Easily identifiable name for this workspace type. ' +\n          'It must be an alpha numeric string starting with an alphabet and ' +\n          'may contain underscore ( _ ) and/or dash ( - ).',\n      },\n      value: _.get(envType, 'name') || '',\n      rules: ['required', 'min:2', 'max:16383', 'regex:/^[a-zA-Z0-9_\\\\-]*/'],\n    },\n    desc: {\n      label: 'Description',\n      placeholder: 'Description for this workspace type',\n      extra: { explain: 'Description for this workspace type. Markdown syntax is supported' },\n      value: _.get(envType, 'desc') || '',\n      rules: 'max:8191|string',\n    },\n  };\n\n  return createForm(addEnvTypeBasicInfoFormFields);\n}\n\n// eslint-disable-next-line import/prefer-default-export\nexport { getAddEnvTypeBasicInfoForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Button, Card, Container, Header, Icon, Modal, Segment } from 'semantic-ui-react';\nimport { action, computed, decorate, observable, runInAction } from 'mobx';\nimport { withRouter } from 'react-router-dom';\n\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport {\n  isStoreEmpty,\n  isStoreError,\n  isStoreLoading,\n  isStoreNotEmpty,\n  isStoreReady,\n} from '@aws-ee/base-ui/dist/models/BaseStore';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport EnvTypeConfigCard from '../env-type-config/EnvTypeConfigCard';\nimport EnvTypeConfigEditor from '../env-type-config/EnvTypeConfigEditor';\n\nclass ConfigStep extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.processing = false;\n      this.shouldShowEnvTypeConfigDialog = false;\n    });\n  }\n\n  componentDidMount() {\n    swallowError(this.envTypeConfigsStore.load());\n  }\n\n  render() {\n    const store = this.envTypeConfigsStore;\n    let content;\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0 mb3\" />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder />;\n    } else if (isStoreReady(store) && isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (isStoreReady(store) && isStoreNotEmpty(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return <Container className=\"mt3 mb4\">{content}</Container>;\n  }\n\n  renderEmpty() {\n    return (\n      <>\n        {!this.shouldShowEnvTypeConfigDialog && (\n          <Segment placeholder>\n            <Header icon className=\"color-grey\">\n              <Icon name=\"settings\" />\n              No Configurations for this Workspace Type yet\n              <Header.Subheader className=\"mt2\">\n                <p>\n                  Configurations are predefined set of Input Parameter values for the AWS Service Catalog Product. The\n                  configurations are presented as preset options when launching workspaces of this type.\n                </p>\n                <Button basic color=\"blue\" onClick={this.showEnvTypeConfigDialog}>\n                  Add Configuration\n                </Button>\n              </Header.Subheader>\n            </Header>\n          </Segment>\n        )}\n        {this.shouldShowEnvTypeConfigDialog && this.renderConfigEditorDialog()}\n        <div className=\"right-align\">\n          <Button basic color=\"grey\" onClick={this.props.onCancel}>\n            Cancel\n          </Button>\n        </div>\n      </>\n    );\n  }\n\n  renderMain() {\n    return (\n      <>\n        <Segment basic>\n          {!this.shouldShowEnvTypeConfigDialog && (\n            <Button className=\"ml3\" basic color=\"blue\" floated=\"right\" onClick={this.showEnvTypeConfigDialog}>\n              Add Configuration\n            </Button>\n          )}\n          {this.renderEnvTypeConfigs()}\n          {this.shouldShowEnvTypeConfigDialog && this.renderConfigEditorDialog()}\n          {!this.shouldShowEnvTypeConfigDialog && this.renderActionButtons({ onCancel: this.props.onCancel })}\n        </Segment>\n      </>\n    );\n  }\n\n  renderConfigEditorDialog() {\n    // return (\n    //   <EnvTypeConfigEditor onCancel={this.hideEnvTypeConfigDialog} envTypeConfigsStore={this.envTypeConfigsStore} onEnvTypeConfigSaveComplete={this.hideEnvTypeConfigDialog}/>\n    // );\n    const shouldShowEnvTypeConfigDialog = this.shouldShowEnvTypeConfigDialog;\n    return (\n      <Modal\n        closeIcon\n        open={shouldShowEnvTypeConfigDialog}\n        onClose={this.hideEnvTypeConfigDialog}\n        closeOnDimmerClick={false}\n        closeOnEscape={false}\n        size=\"large\"\n      >\n        <EnvTypeConfigEditor\n          onCancel={this.hideEnvTypeConfigDialog}\n          envTypeConfigsStore={this.envTypeConfigsStore}\n          envType={this.props.envType}\n          onEnvTypeConfigSaveComplete={this.hideEnvTypeConfigDialog}\n          action=\"create\"\n        />\n      </Modal>\n    );\n  }\n\n  showEnvTypeConfigDialog = () => {\n    this.shouldShowEnvTypeConfigDialog = true;\n    this.processing = false;\n  };\n\n  hideEnvTypeConfigDialog = () => {\n    if (this.processing) return;\n    this.shouldShowEnvTypeConfigDialog = false;\n  };\n\n  renderEnvTypeConfigs() {\n    const list = this.envTypeConfigsStore.listAll;\n    return (\n      <Card.Group stackable itemsPerRow={3}>\n        {_.map(list, envTypeConfig => {\n          return (\n            <EnvTypeConfigCard\n              key={envTypeConfig.id}\n              envTypeConfig={envTypeConfig}\n              envType={this.props.envType}\n              envTypeConfigsStore={this.envTypeConfigsStore}\n            />\n          );\n        })}\n      </Card.Group>\n    );\n  }\n\n  renderActionButtons({ processing, onCancel }) {\n    return (\n      <div className=\"mt3\">\n        <div className=\"right-align\">\n          <Button basic color=\"grey\" onClick={onCancel}>\n            Cancel\n          </Button>\n          <Button className=\"ml2\" primary content=\"Done\" disabled={processing} onClick={this.onNext} />\n        </div>\n      </div>\n    );\n  }\n\n  isImportAction() {\n    return this.props.workspaceTypeAction === 'import';\n  }\n\n  onNext = async () => {\n    const wizardModel = this.props.wizardModel;\n    const onEnvTypeSaveComplete = this.props.onEnvTypeSaveComplete;\n    if (this.isImportAction() && wizardModel.hasNext) {\n      wizardModel.next();\n    } else if (_.isFunction(onEnvTypeSaveComplete)) {\n      await onEnvTypeSaveComplete();\n    }\n  };\n\n  get envTypeConfigsStore() {\n    return this.props.envTypeConfigsStore;\n  }\n}\ndecorate(ConfigStep, {\n  envTypeConfigsStore: computed,\n\n  processing: observable,\n  shouldShowEnvTypeConfigDialog: observable,\n\n  showEnvTypeConfigDialog: action,\n  hideEnvTypeConfigDialog: action,\n});\n\nexport default withRouter(observer(ConfigStep));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React, { Component } from 'react';\nimport { observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Button, Card, Divider, Header, Icon, Modal } from 'semantic-ui-react';\nimport { action, computed, decorate, observable, runInAction } from 'mobx';\n\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport EnvTypeConfigEditor from './EnvTypeConfigEditor';\n\nclass EnvTypeConfigCard extends Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.processing = false;\n      this.shouldShowDeleteDialog = false;\n      this.shouldShowEditorDialog = false;\n      this.cloning = false;\n    });\n  }\n\n  render() {\n    const envTypeConfig = this.props.envTypeConfig;\n    return (\n      <Card key={`etConfig-${envTypeConfig.id}`} raised className=\"mb3\">\n        <Card.Content>\n          <Header as=\"h4\">{envTypeConfig.name}</Header>\n          <Card.Meta className=\"flex\">\n            <span className=\"flex-auto\">{_.get(envTypeConfig, 'id')}</span>\n            <Button\n              basic\n              color=\"grey\"\n              onClick={() => this.showCloneDialog()}\n              floated=\"right\"\n              size=\"mini\"\n              disabled={this.processing}\n            >\n              Clone\n            </Button>\n          </Card.Meta>\n          <Divider />\n          <Card.Description>\n            <div className=\"mb3 pr1 pl1 pb1\">\n              {/* Yes, we are doing dangerouslySetInnerHTML, the content was already sanitized by showdownjs */}\n              {/* eslint-disable-next-line react/no-danger */}\n              <div dangerouslySetInnerHTML={{ __html: envTypeConfig.descHtml }} />\n            </div>\n          </Card.Description>\n        </Card.Content>\n        <Card.Content extra>\n          <Button\n            basic\n            color=\"blue\"\n            onClick={() => this.showEditorDialog()}\n            floated=\"right\"\n            size=\"mini\"\n            disabled={this.processing}\n          >\n            Edit\n          </Button>\n          <Button\n            basic\n            color=\"red\"\n            onClick={() => this.showDeleteDialog()}\n            floated=\"right\"\n            size=\"mini\"\n            disabled={this.processing}\n          >\n            Delete\n          </Button>\n          {this.renderDeleteConfirmation(envTypeConfig)}\n          {this.renderEditorPopup(envTypeConfig)}\n        </Card.Content>\n      </Card>\n    );\n  }\n\n  renderEditorPopup(envTypeConfig) {\n    const shouldShowEditorDialog = this.shouldShowEditorDialog;\n    const mode = this.cloning ? 'clone' : 'edit';\n    const envTypeConfigForEditor = this.cloning\n      ? { ...envTypeConfig, id: `${envTypeConfig.id}-copy`, name: `${envTypeConfig.name}-copy` }\n      : envTypeConfig;\n    return (\n      <Modal\n        closeIcon\n        open={shouldShowEditorDialog}\n        onClose={this.hideEditorDialog}\n        closeOnDimmerClick={false}\n        closeOnEscape={false}\n        size=\"large\"\n      >\n        <EnvTypeConfigEditor\n          onCancel={this.hideEditorDialog}\n          envTypeConfig={envTypeConfigForEditor}\n          envType={this.props.envType}\n          envTypeConfigsStore={this.envTypeConfigsStore}\n          onEnvTypeConfigSaveComplete={this.hideEditorDialog}\n          action={mode}\n        />\n      </Modal>\n    );\n  }\n\n  renderDeleteConfirmation(envTypeConfig) {\n    const shouldShowDeleteDialog = this.shouldShowDeleteDialog;\n    const processing = this.processing;\n    return (\n      <Modal open={shouldShowDeleteDialog} onClose={this.hideDeleteDialog} closeOnDimmerClick={!processing}>\n        <Modal.Header>\n          Delete Configuration: <strong>{envTypeConfig.name}</strong>\n        </Modal.Header>\n        <Modal.Content>\n          <p>\n            Are you sure you want to delete <strong>{envTypeConfig.name}</strong> configuration?\n          </p>\n          <p>\n            Once you delete environment type configuration, users will not be able launch workspaces using that\n            configuration. You will need to re-create the configuration.\n          </p>\n          <p>Is it okay to delete?</p>\n        </Modal.Content>\n        <Modal.Actions>\n          <Button\n            basic\n            icon\n            color=\"grey\"\n            labelPosition=\"right\"\n            size=\"mini\"\n            disabled={this.processing}\n            onClick={this.hideDeleteDialog}\n          >\n            <Icon name=\"close\" />\n            Cancel\n          </Button>\n          <Button\n            basic\n            icon\n            color=\"red\"\n            labelPosition=\"right\"\n            size=\"mini\"\n            disabled={this.processing}\n            onClick={() => this.handleDeleteClick(envTypeConfig.id)}\n          >\n            <Icon name=\"trash\" /> Delete\n          </Button>\n        </Modal.Actions>\n      </Modal>\n    );\n  }\n\n  showDeleteDialog = () => {\n    this.shouldShowDeleteDialog = true;\n    this.processing = false;\n  };\n\n  hideDeleteDialog = () => {\n    if (this.processing) return;\n    this.shouldShowDeleteDialog = false;\n  };\n\n  showCloneDialog = () => {\n    this.cloning = true;\n    this.showEditorDialog();\n  };\n\n  showEditorDialog = () => {\n    this.shouldShowEditorDialog = true;\n    this.processing = false;\n  };\n\n  hideEditorDialog = () => {\n    if (this.processing) return;\n    this.shouldShowEditorDialog = false;\n    this.cloning = false;\n  };\n\n  handleDeleteClick = async id => {\n    this.processing = true;\n    const store = this.envTypeConfigsStore;\n    try {\n      await store.deleteEnvTypeConfig(id);\n    } catch (error) {\n      displayError(error);\n    }\n    runInAction(() => {\n      this.processing = false;\n      this.hideDeleteDialog();\n    });\n  };\n\n  get envTypeConfigsStore() {\n    return this.props.envTypeConfigsStore;\n  }\n}\n\ndecorate(EnvTypeConfigCard, {\n  processing: observable,\n  envTypeConfigsStore: computed,\n\n  shouldShowDeleteDialog: observable,\n  shouldShowEditorDialog: observable,\n  cloning: observable,\n\n  handleDeleteClick: action,\n\n  showDeleteDialog: action,\n  hideDeleteDialog: action,\n\n  showCloneDialog: action,\n\n  showEditorDialog: action,\n  hideEditorDialog: action,\n});\nexport default withRouter(observer(EnvTypeConfigCard));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { createForm } from '@aws-ee/base-ui/dist/helpers/form';\n\nfunction getEnvTypeConfigForm(envTypeConfig) {\n  const fields = {\n    id: {\n      label: 'Id',\n      placeholder: 'Unique identifier for this Configuration',\n      extra: {\n        explain:\n          'Unique identifier for this Configuration. ' +\n          'It must be an alpha numeric string between 2 and 128 characters long may contain underscore (_) and/or dash (-).',\n      },\n      value: _.get(envTypeConfig, 'id', ''),\n      rules: ['required', 'min:2', 'max:128', 'regex:/^[A-Za-z0-9-_]+$/'],\n    },\n    name: {\n      label: 'Name',\n      placeholder: 'Name for this Configuration',\n      extra: {\n        explain:\n          'Easily identifiable name for this Configuration. ' +\n          'It must be an alpha numeric string between 2 and 128 characters long may contain space, underscore (_) and/or dash (-).',\n      },\n      value: _.get(envTypeConfig, 'name', ''),\n      rules: ['required', 'min:2', 'max:128', 'regex:/^[A-Za-z0-9-_ ]+$/'],\n    },\n    desc: {\n      label: 'Description',\n      placeholder: 'Description for this Configuration',\n      extra: { explain: 'Description for this Configuration. Markdown syntax is supported' },\n      value: _.get(envTypeConfig, 'desc', ''),\n      rules: 'max:8191|string',\n    },\n    estimatedCostInfo: {\n      label: 'Estimate Costs',\n      placeholder: 'Information about estimated costs when using this Configuration',\n      extra: {\n        explain: 'Provide information about estimated cost. Markdown syntax is supported',\n      },\n      value: _.get(envTypeConfig, 'estimatedCostInfo', ''),\n      rules: 'max:1024|string',\n    },\n    allowRoleIds: {\n      label: 'Roles Allowed',\n      extra: {\n        explain: 'User roles allowed to launch workspaces with this Configuration',\n      },\n      value: _.get(envTypeConfig, 'allowRoleIds', []),\n    },\n    denyRoleIds: {\n      label: 'Roles Not Allowed',\n      extra: {\n        explain: 'User roles not allowed to launch workspaces with this Configuration',\n      },\n      value: _.get(envTypeConfig, 'denyRoleIds', []),\n    },\n\n    // The params field is not rendered directly, the InputParamsStep renders other form specifically for CFN\n    // input params and dynamically sets this field value on submit of that form\n    // This field is not used directly for display\n    params: {\n      label: 'AWS CloudFormation Input Params',\n      value: JSON.stringify(_.get(envTypeConfig, 'params', [])),\n    },\n\n    // The tags field is not rendered directly, the TagsStep renders other form specifically for tags and dynamically\n    // sets this field value on submit of that form\n    // This field is not used directly for display\n    tags: {\n      label: 'Resource Tags',\n      value: JSON.stringify(_.get(envTypeConfig, 'tags', [])),\n    },\n  };\n\n  return createForm(fields);\n}\n\n// eslint-disable-next-line import/prefer-default-export\nexport { getEnvTypeConfigForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\nimport BaseEnvTypeConfigStep from './BaseEnvTypeConfigStep';\n\nclass BasicInfoStep extends BaseEnvTypeConfigStep {\n  renderFormFields({ form, processing }) {\n    const isUpdating = this.isEditAction();\n\n    const idField = form.$('id');\n    const nameField = form.$('name');\n    const descField = form.$('desc');\n    const estimatedCostInfoField = form.$('estimatedCostInfo');\n\n    return (\n      <>\n        {!isUpdating && <Input field={idField} disabled={processing} />}\n        <Input field={nameField} disabled={processing} />\n        <TextArea field={descField} disabled={processing} />\n        <TextArea field={estimatedCostInfoField} disabled={processing} />\n      </>\n    );\n  }\n}\n\nexport default observer(BasicInfoStep);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport { computed, decorate } from 'mobx';\n\nimport DropDown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\nimport BaseEnvTypeConfigStep from './BaseEnvTypeConfigStep';\n\nclass AccessControlStep extends BaseEnvTypeConfigStep {\n  renderFormFields({ form, processing }) {\n    const allowRoleIdsField = form.$('allowRoleIds') || [];\n    const denyRoleIdsField = form.$('denyRoleIds') || [];\n\n    const userRoleOptions = _.filter(\n      this.userRolesStore.dropdownOptions,\n      // Also currently not supporting external roles i.e., guest and external-researcher so exclude them from\n      // \"allow\" or \"deny\" list\n      r => !_.includes(['external-researcher', 'guest'], _.toLower(r.value)),\n    );\n    return (\n      <>\n        <DropDown field={allowRoleIdsField} options={userRoleOptions} selection multiple fluid disabled={processing} />\n        <DropDown field={denyRoleIdsField} options={userRoleOptions} selection multiple fluid disabled={processing} />\n      </>\n    );\n  }\n\n  get userRolesStore() {\n    return this.props.userRolesStore;\n  }\n}\n\ndecorate(AccessControlStep, {\n  userRolesStore: computed,\n});\nexport default inject('userRolesStore')(observer(AccessControlStep));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { action, decorate, runInAction } from 'mobx';\nimport { Header, Segment } from 'semantic-ui-react';\n\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport DropDown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\n\nimport { sessionStore } from '@aws-ee/base-ui/dist/models/SessionStore';\nimport { getCfnParamsForm } from '../../../../models/forms/CfnParamsForm';\nimport BaseEnvTypeConfigStep from './BaseEnvTypeConfigStep';\n\nclass InputParamsStep extends BaseEnvTypeConfigStep {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      const cfnParams = _.get(props.envType, 'params');\n      const existingParamValues = _.get(props.envTypeConfig, 'params');\n\n      const keyPrefix = this.props.wizardTempStoreKeyPrefix;\n      const key = `${keyPrefix}-InputParamsStep`;\n      let cfnParamsForm = sessionStore.get(key);\n      if (!cfnParamsForm) {\n        // Create and save the cfn params form outside of the component (in session store)\n        // to make sure the form values are not wiped out on unmount\n        // without this if the user clicks next and then previous all entered values will be wiped\n        cfnParamsForm = getCfnParamsForm(cfnParams, existingParamValues);\n        sessionStore.set(key, cfnParamsForm);\n      }\n\n      this.cfnParamsForm = cfnParamsForm;\n    });\n  }\n\n  render() {\n    // The cfnParamsForm below is different from \"this.form\".\n    // cfnParamsForm is specifically for the CloudFormation params and the \"this.form\" is for the EnvTypeConfig.\n    // When the inner form \"cfnParamsForm\" is submitted, the values from \"cfnParamsForm\" are read and the field named \"params\" of\n    // the outer EnvTypeConfig form (i.e., \"this.form\") is set as JSON string\n    // See \"handleCfnParamsFormSubmit\" method for details\n    const cfnParamsForm = this.cfnParamsForm;\n    return (\n      <Segment clearing className=\"mt3 p3\">\n        <Form form={cfnParamsForm} onCancel={this.props.onCancel} onSuccess={this.handleCfnParamsFormSubmit}>\n          {({ processing, onCancel }) => (\n            <>\n              {this.renderFormFields({ form: cfnParamsForm, processing, onCancel })}\n              {this.renderActionButtons({ processing, onCancel })}\n            </>\n          )}\n        </Form>\n      </Segment>\n    );\n  }\n\n  handleCfnParamsFormSubmit = cfnParamsForm => {\n    const cfnParams = [];\n    cfnParamsForm.each(field => cfnParams.push({ key: field.key, value: field.value }));\n\n    // Set the params field on the form passed in via props\n    const paramsField = this.form.$('params');\n    paramsField.value = JSON.stringify(cfnParams);\n\n    this.props.onSubmit(this.form);\n  };\n\n  renderFormFields({ form, processing }) {\n    const configVarOptions = [];\n    const envTypeConfigVars = this.props.envTypeConfigsStore.envTypeConfigVars;\n    envTypeConfigVars.forEach(v => {\n      configVarOptions.push({\n        key: v.name,\n        value: `$\\{${v.name}}`,\n        text: `$\\{${v.name}}`,\n        content: <Header as=\"h5\" content={v.name} subheader={v.desc} />,\n      });\n    });\n\n    const fields = [];\n    form.each(field => fields.push(field));\n    return _.map(fields, field => {\n      // if custom literal value was entered instead of selecting from available config vars then field's value may not\n      // be in the available options so adding an option for field.value (without this custom drop down values will not\n      // pre-populate when editing or when navigating to the step again with \"previous\")\n      const options = _.uniqBy(\n        [{ key: field.key, value: field.value, text: field.value }, ...configVarOptions],\n        'value',\n      );\n      return (\n        <DropDown\n          key={field.key}\n          field={field}\n          options={options}\n          disabled={processing}\n          search\n          selection\n          fluid\n          allowAdditions\n          clearable\n        />\n      );\n    });\n  }\n}\n\ndecorate(InputParamsStep, {\n  handleCfnParamsFormSubmit: action,\n});\nexport default observer(InputParamsStep);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { createForm } from '@aws-ee/base-ui/dist/helpers/form';\n\n/**\n * Creates a MobX React Form with field for each cfn param. The fields are pre-populated with existing values.\n * @param cfnParams Array of AWS CloudFormation Input Parameters. See below example for the shape of this object\n *    [{\n            \"DefaultValue\": \"ml.t3.xlarge\",\n            \"IsNoEcho\": false,\n            \"ParameterConstraints\": {\n                \"AllowedValues\": []\n            },\n            \"ParameterType\": \"String\",\n            \"Description\": \"EC2 instance type to launch\",\n            \"ParameterKey\": \"InstanceType\"\n        }]\n *\n * @param existingParamValues Array containing key/value pairs for existing values for the params. Has the shape [{key,value}]\n */\nfunction getCfnParamsForm(cfnParams, existingParamValues) {\n  const fields = {};\n  _.forEach(cfnParams, ({ ParameterKey, Description, DefaultValue }) => {\n    const existingValue = _.get(_.find(existingParamValues, { key: ParameterKey }), 'value') || DefaultValue;\n    fields[ParameterKey] = {\n      label: ParameterKey,\n      extra: { explain: Description },\n      value: existingValue,\n      rules: 'required',\n    };\n  });\n  return createForm(fields);\n}\n\n// eslint-disable-next-line import/prefer-default-export\nexport { getCfnParamsForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { action, decorate, observable, runInAction } from 'mobx';\nimport { Button, Dimmer, Header, Icon, Segment, Table } from 'semantic-ui-react';\n\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport NameValuesEditor from '@aws-ee/base-ui/dist/parts/helpers/fields/NameValuesEditor';\nimport BaseEnvTypeConfigStep from './BaseEnvTypeConfigStep';\n\nclass TagsStep extends BaseEnvTypeConfigStep {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.processing = false;\n      this.shouldEnableActionButtons = true;\n    });\n  }\n\n  render() {\n    const form = this.form;\n    return (\n      <Segment clearing className=\"mt3\">\n        <Dimmer active={this.processing} inverted />\n        {this.renderFormFields({ form })}\n        <Form form={form} onCancel={this.props.onCancel} onSuccess={this.props.onSubmit}>\n          {({ processing, onCancel }) => <>{this.renderActionButtons({ processing, onCancel })}</>}\n        </Form>\n      </Segment>\n    );\n  }\n\n  // eslint-disable-next-line no-unused-vars\n  renderFormFields({ form }) {\n    const tagsField = form.$('tags');\n    return (\n      <div className=\"mb3\">\n        <div className=\"ml1 mb2\">\n          Click plus (+) button below to add resource tags. These tags will be applied to the environment resources that\n          are launched using this configuration. Additionally, some standard tags for cost allocation will be\n          automatically applied even if you do not configure any other resource tags here.\n        </div>\n        <NameValuesEditor\n          field={tagsField}\n          onEnterEditMode={this.disableActionButtons}\n          onExitEditMode={this.enableActionButtons}\n          emptyRenderer={() => (\n            <Table.Row key=\"empty-row\" textAlign=\"center\">\n              <Table.Cell colSpan={3}>\n                <Header icon className=\"color-grey\">\n                  <Icon name=\"tags\" />\n                  No resource tags are added yet\n                </Header>\n              </Table.Cell>\n            </Table.Row>\n          )}\n        />\n      </div>\n    );\n  }\n\n  renderActionButtons({ processing, onCancel }) {\n    const isUpdating = this.isEditAction();\n    const submitButtonTitle = isUpdating ? 'Save' : this.props.wizardModel.hasNext ? 'Next' : 'Add';\n    return (\n      <div className=\"clearfix\">\n        <Button\n          onClick={action(() => {\n            this.processing = true;\n          })}\n          className=\"ml2 mb3\"\n          primary\n          content={submitButtonTitle}\n          disabled={processing || !this.shouldEnableActionButtons}\n          type=\"submit\"\n          floated=\"right\"\n        />\n        {!isUpdating && this.props.wizardModel.hasPrevious && (\n          <Button\n            className=\"ml2 mb3\"\n            primary\n            content=\"Previous\"\n            disabled={processing || !this.shouldEnableActionButtons}\n            floated=\"right\"\n            onClick={this.props.onPrevious}\n          />\n        )}\n        <Button\n          basic\n          color=\"grey\"\n          disabled={processing || !this.shouldEnableActionButtons}\n          onClick={onCancel}\n          floated=\"left\"\n        >\n          Cancel\n        </Button>\n      </div>\n    );\n  }\n\n  disableActionButtons = () => {\n    this.shouldEnableActionButtons = false;\n  };\n\n  enableActionButtons = () => {\n    this.shouldEnableActionButtons = true;\n  };\n}\n\ndecorate(TagsStep, {\n  disableActionButtons: action,\n  enableActionButtons: action,\n\n  processing: observable,\n  shouldEnableActionButtons: observable,\n});\nexport default observer(TagsStep);\n","import React from 'react';\nimport _ from 'lodash';\nimport { observer } from 'mobx-react';\nimport { action, decorate, observable, runInAction } from 'mobx';\nimport { Button, Icon, Table } from 'semantic-ui-react';\n\nimport EditableNameValueRow from './EditableNameValueRow';\n\n// expected props\n// - field (via props) -- this is the mobx form field object. The field's value is a JSON string representation\n//   of the object in shape [{key,value}]\n// - nameHeader (via props) -- (optional) The label to display for the name column\n// - valueHeader (via props) -- (optional) The label to display for the value column\n// - actionHeader (via props) -- (optional) The label to display for the action column\n// - onEnterEditMode -- (optional) function to notify when row enters edit mode.\n//                      The function is passed the \"rowKey\" that is entering the edit mode.\n// - onExitEditMode -- (optional) function to notify when row exists edit mode. (due to clicking cancel or save).\n//                      The function is passed the \"rowKey\" that is entering the edit mode.\nclass NameValuesEditor extends React.Component {\n  componentDidMount() {\n    runInAction(() => {\n      // The value of this field as string\n      this.value = this.props.field.value || '[]';\n\n      // An array containing {key, value} or { name, value } objects\n      const fromKeyValueToNameValue = keyValue => {\n        const name = keyValue.key || keyValue.name;\n        return { name, value: keyValue.value };\n      };\n\n      // This object's JSON string representation is used as the value for this field.\n      const keyValues = JSON.parse(this.value || '[]') || [];\n      this.nameValues = _.map(keyValues, fromKeyValueToNameValue);\n\n      this.shouldShowAddRowButton = true;\n      this.shouldShowCreateRow = false;\n    });\n  }\n\n  render() {\n    const nameHeader = _.isNil(this.props.nameHeader) ? 'Name' : this.props.nameHeader;\n    const valueHeader = _.isNil(this.props.valueHeader) ? 'Value' : this.props.valueHeader;\n    const actionHeader = _.isNil(this.props.actionHeader) ? 'Action' : this.props.actionHeader;\n\n    const rows = _.map(this.nameValues, ({ name, value }, rowIdx) => this.renderNameValueLine({ rowIdx, name, value }));\n\n    if (this.shouldShowCreateRow) {\n      const rowIdx = this.nameValues.length;\n      rows.push(\n        <EditableNameValueRow\n          key={rowIdx}\n          name=\"\"\n          value=\"\"\n          editorOn\n          onSubmit={form => {\n            this.handleNameValueChange({ rowIdx, nameValueForm: form });\n          }}\n          onDelete={this.hideCreateRow}\n          onEnterEditMode={this.onEnterEditMode}\n          onExitEditMode={this.onExitEditMode}\n        />,\n      );\n    }\n    if (_.isEmpty(rows)) {\n      const emptyMessage = _.isFunction(this.props.emptyRenderer) ? (\n        this.props.emptyRenderer()\n      ) : (\n        <Table.Row key=\"empty-row\">\n          <Table.Cell colSpan={3}>No name/value pairs. Click + to add one.</Table.Cell>\n        </Table.Row>\n      );\n      rows.push(emptyMessage);\n    }\n    return (\n      <Table celled>\n        <Table.Header>\n          <Table.Row>\n            <Table.HeaderCell>{nameHeader}</Table.HeaderCell>\n            <Table.HeaderCell>{valueHeader}</Table.HeaderCell>\n            <Table.HeaderCell width={2}>{actionHeader}</Table.HeaderCell>\n          </Table.Row>\n        </Table.Header>\n        <Table.Body>{rows}</Table.Body>\n        <Table.Footer fullWidth>\n          <Table.Row>\n            {this.shouldShowAddRowButton && (\n              <Table.HeaderCell colSpan=\"3\">\n                <Button icon color=\"blue\" size=\"tiny\" className=\"ml1\" onClick={this.showCreateRow}>\n                  <Icon name=\"plus\" />\n                </Button>\n              </Table.HeaderCell>\n            )}\n            {!this.shouldShowAddRowButton && <Table.HeaderCell colSpan=\"3\" className=\"pb3\" />}\n          </Table.Row>\n        </Table.Footer>\n      </Table>\n    );\n  }\n\n  renderNameValueLine({ rowIdx, name, value }) {\n    return (\n      <EditableNameValueRow\n        key={rowIdx}\n        rowKey={rowIdx}\n        name={name}\n        value={value}\n        onSubmit={form => this.handleNameValueChange({ rowIdx, nameValueForm: form })}\n        onDelete={() => this.handleNameValueDelete({ rowIdx })}\n        onEnterEditMode={this.onEnterEditMode}\n        onExitEditMode={this.onExitEditMode}\n      />\n    );\n  }\n\n  onEnterEditMode = rowKey => {\n    this.hideShowAddRowButton();\n    const onEnterEditMode = this.props.onEnterEditMode;\n    if (onEnterEditMode) {\n      onEnterEditMode(rowKey);\n    }\n  };\n\n  onExitEditMode = rowKey => {\n    this.showAddRowButton();\n    const onExitEditMode = this.props.onExitEditMode;\n    if (onExitEditMode) {\n      onExitEditMode(rowKey);\n    }\n  };\n\n  handleNameValueChange = ({ rowIdx, nameValueForm }) => {\n    const nameField = nameValueForm.$('name');\n    const valueField = nameValueForm.$('value');\n    this.nameValues[rowIdx] = { name: nameField.value, value: valueField.value };\n    this.syncField();\n    this.showAddRowButton();\n  };\n\n  handleNameValueDelete = ({ rowIdx }) => {\n    this.nameValues.splice(rowIdx, 1);\n    this.syncField();\n  };\n\n  hideShowAddRowButton = () => {\n    this.shouldShowAddRowButton = false;\n  };\n\n  showAddRowButton = () => {\n    this.shouldShowAddRowButton = true;\n    this.hideCreateRow();\n  };\n\n  hideCreateRow = () => {\n    this.shouldShowCreateRow = false;\n  };\n\n  showCreateRow = () => {\n    this.shouldShowCreateRow = true;\n    this.hideShowAddRowButton();\n  };\n\n  syncField = () => {\n    // The nameValues is the JavaScript object representation of the specified field\n    // so convert it to value by stringifying it and then sync the given form field value\n    this.value = JSON.stringify(this.nameValues);\n    const sync = this.props.field.sync;\n    sync(this.value);\n  };\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(NameValuesEditor, {\n  nameValues: observable,\n  shouldShowAddRowButton: observable,\n  shouldShowCreateRow: observable,\n\n  hideShowAddRowButton: action,\n  showAddRowButton: action,\n  hideCreateRow: action,\n  showCreateRow: action,\n\n  handleNameValueChange: action,\n  handleNameValueDelete: action,\n});\n\nexport default observer(NameValuesEditor);\n","import React from 'react';\nimport { action, runInAction } from 'mobx';\nimport { Icon, Table } from 'semantic-ui-react';\nimport { observer } from 'mobx-react';\nimport _ from 'lodash';\nimport { getNameValueForm } from '../../../models/forms/NameValueForm';\nimport EditableField from './EditableField';\nimport Input from './Input';\n\n// expected props\n// - rowKey (via props) -- The key to identify this row\n// - name (via props) -- The name in the { name, value } pair\n// - value (via props) -- The value in the { name, value } pair\n// - editorOn (via props) -- Flag indicating if the row should be displayed in\n//                            edit more or view mode (true - edit mode, false - view mode)\n// - onSubmit (via props) -- Function to call when save is clicked on the row\n// - onCancel (via props) -- Function to call when cancel is clicked on the row\n// - onDelete (via props) -- Function to call when delete is clicked on the row\n// - onEnterEditMode -- (optional) function to notify when row enters edit mode.\n//                      The function is passed the \"rowKey\" that is entering the edit mode.\n// - onExitEditMode -- (optional) function to notify when row exists edit mode. (due to clicking cancel or save).\n//                      The function is passed the \"rowKey\" that is entering the edit mode.\nclass EditableNameValueRow extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.form = getNameValueForm({ name: props.name, value: props.value });\n      if (props.editorOn) {\n        this.handleEditClick();\n      }\n    });\n  }\n\n  render() {\n    const form = this.form;\n    const nameField = form.$('name');\n    const valueField = form.$('value');\n    const onDelete = this.props.onDelete;\n\n    return (\n      <EditableField\n        form={form}\n        showDimmer={false}\n        showErrorPanel={false}\n        renderFormAs={\n          // Do not want the EditableField to render a \"form\" tag so rendering\n          // the content of the form as is without the \"form\".\n          // This is done because the row is rendered inside table.body\n          // rendering form directly in the table body is invalid structure\n          formContent => <>{formContent}</>\n        }\n        editorOn={this.props.editorOn}\n        onSubmit={this.handleSubmit}\n        onCancel={this.handleCancel}\n        renderFieldForView={({ onEditorOn: onClickEdit }) => (\n          <Table.Row>\n            <Table.Cell>{this.props.name}</Table.Cell>\n            <Table.Cell>{this.props.value}</Table.Cell>\n            <Table.Cell>\n              <Icon\n                name=\"pencil\"\n                className=\"ml1 cursor-pointer\"\n                color=\"grey\"\n                onClick={() => {\n                  onClickEdit();\n                  this.handleEditClick(this.props.rowKey);\n                }}\n              />\n              <Icon name=\"trash\" className=\"ml1 cursor-pointer\" color=\"grey\" onClick={onDelete} />\n            </Table.Cell>\n          </Table.Row>\n        )}\n        renderFieldForEdit={({ processing, onSubmit: submit, onCancel }) => (\n          <Table.Row>\n            <Table.Cell>\n              <Input field={nameField} className=\"mb0\" showHeader={false} disabled={processing} />\n            </Table.Cell>\n            <Table.Cell>\n              <Input field={valueField} className=\"mb0\" showHeader={false} disabled={processing} />\n            </Table.Cell>\n            <Table.Cell>\n              <Icon name=\"close\" className=\"ml1 cursor-pointer\" color=\"grey\" onClick={onCancel} />\n              <Icon name=\"check\" className=\"ml1 cursor-pointer\" color=\"grey\" onClick={submit} />\n            </Table.Cell>\n          </Table.Row>\n        )}\n      />\n    );\n  }\n\n  handleEditClick = action(async key => {\n    await this.notifyHandler(this.props.onEnterEditMode, key);\n  });\n\n  handleSubmit = action(async form => {\n    await this.notifyHandler(this.props.onExitEditMode, this.props.rowKey);\n    await this.notifyHandler(this.props.onSubmit, form);\n    runInAction(() => {\n      this.form = getNameValueForm({ name: this.props.name, value: this.props.value });\n    });\n  });\n\n  handleCancel = action(async form => {\n    await this.notifyHandler(this.props.onExitEditMode, this.props.rowKey);\n    await this.notifyHandler(this.props.onCancel, form);\n    runInAction(() => {\n      this.form = getNameValueForm({ name: this.props.name, value: this.props.value });\n    });\n  });\n\n  notifyHandler = async (handlerFn, ...args) => {\n    const handlerFnToNotify = handlerFn || _.noop;\n    await handlerFnToNotify(...args);\n  };\n}\nexport default observer(EditableNameValueRow);\n","import _ from 'lodash';\nimport { createForm } from '../../helpers/form';\n\nfunction getNameValueForm({ name, value, nameLabel, namePlaceholder, valueLabel, valuePlaceholder }) {\n  const fields = {\n    name: {\n      label: _.isNil(nameLabel) ? 'Name' : nameLabel,\n      placeholder: _.isNil(namePlaceholder) ? 'Name' : namePlaceholder,\n      rules: 'required',\n      value: name,\n    },\n    value: {\n      label: _.isNil(valueLabel) ? 'Value' : valueLabel,\n      placeholder: _.isNil(valuePlaceholder) ? 'Value' : valuePlaceholder,\n      rules: 'required',\n      value,\n    },\n  };\n  return createForm(fields);\n}\n\n// eslint-disable-next-line import/prefer-default-export\nexport { getNameValueForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { observer } from 'mobx-react';\nimport React from 'react';\nimport { decorate, action, observable, runInAction } from 'mobx';\nimport _ from 'lodash';\n\nimport { displayError } from '../../../helpers/notification';\nimport Form from './Form';\n\n// expected props\n// - form -- A single field Mobx Form specific to this field.\n// - renderFieldForView -- Called to render the field in \"view\" mode.\n// - renderFieldForEdit -- Called to render the field in \"edit\" mode.\n// - onSubmit - optional -- Called when form specific to this field is submitted\n// - onCancel - optional -- Called when the field is being canceled for edit (i.e., transitioning from edit mode to view mode)\n// - onError - optional -- Called when any error occurs when processing the form (may be validation errors)\n/**\n * A field component that can be used for places where you require single field edits (such as inline edits).\n * The field handles switching between \"view\" mode and \"edit\" mode.\n */\nclass EditableField extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.editorOn = _.isNil(props.editorOn) ? false : props.editorOn;\n    });\n  }\n\n  render() {\n    if (this.editorOn) return this.renderEditMode();\n    return this.renderViewMode();\n  }\n\n  renderEditMode() {\n    const form = this.props.form;\n    const renderFieldForEdit = this.props.renderFieldForEdit;\n    return (\n      <Form\n        form={form}\n        dimmer={this.props.showDimmer}\n        showErrorPanel={this.props.showErrorPanel}\n        renderFormAs={this.props.renderFormAs}\n        onCancel={this.handleCancel}\n        onSuccess={this.handleFormSubmission}\n        onError={this.handleFormError}\n      >\n        {({ processing, onSubmit, onCancel }) => renderFieldForEdit({ processing, onSubmit, onCancel })}\n      </Form>\n    );\n  }\n\n  renderViewMode() {\n    return this.props.renderFieldForView({ onEditorOn: this.handleEditorOn });\n  }\n\n  handleEditorOn = action(() => {\n    this.editorOn = true;\n  });\n\n  handleFormSubmission = action(async form => {\n    try {\n      await this.notifyHandler(this.props.onSubmit, form);\n      runInAction(() => {\n        this.editorOn = false;\n      });\n    } catch (error) {\n      displayError(error);\n      form.clear();\n      runInAction(() => {\n        this.editorOn = false;\n      });\n    }\n  });\n\n  handleCancel = action(async () => {\n    this.editorOn = false;\n\n    // notify onCancel\n    await this.notifyHandler(this.props.onCancel);\n  });\n\n  handleFormError = action(async (form, errors) => {\n    await this.notifyHandler(this.props.onError, form, errors);\n  });\n\n  notifyHandler = async (handlerFn, ...args) => {\n    const handlerFnToNotify = handlerFn || _.noop;\n    await handlerFnToNotify(...args);\n  };\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(EditableField, {\n  editorOn: observable,\n});\n\nexport default observer(EditableField);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { getEnv, types } from 'mobx-state-tree';\n\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport _ from 'lodash';\nimport { consolidateToMap, mapToArray } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { EnvType } from './EnvType';\nimport {\n  getAllEnvTypes,\n  approveEnvType,\n  revokeEnvType,\n  deleteEnvType,\n  createEnvType,\n  updateEnvType,\n} from '../../helpers/api';\nimport { EnvTypeConfigsStore } from './EnvTypeConfigsStore';\nimport { EnvTypeStore } from './EnvTypeStore';\n\n// ==================================================================\n// EnvTypesStore\n// ==================================================================\nconst EnvTypesStore = BaseStore.named('EnvTypesStore')\n  .props({\n    // map of EnvTypes with key = id, value = EnvType MST model instance\n    envTypes: types.optional(types.map(EnvType), {}),\n\n    // map of EnvTypeStores with key = id, value = EnvTypeStore MST model instance\n    envTypeStores: types.optional(types.map(EnvTypeStore), {}),\n\n    // map of EnvTypeConfigsStores with key = id, value = EnvTypeConfigsStore MST model instance\n    envTypeConfigsStores: types.optional(types.map(EnvTypeConfigsStore), {}),\n\n    tickPeriod: 60 * 1000, // 1 minute\n  })\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const envTypes = (await getAllEnvTypes()) || [];\n        self.runInAction(() => {\n          consolidateToMap(self.envTypes, envTypes, (exiting, newItem) => {\n            exiting.setEnvType(newItem);\n          });\n        });\n      },\n\n      addEnvType(rawEnvType) {\n        const id = rawEnvType.id;\n        const previous = self.envTypes.get(id);\n\n        if (!previous) {\n          self.envTypes.put(rawEnvType);\n        } else {\n          previous.setEnvType(rawEnvType);\n        }\n      },\n\n      async createEnvType(envType) {\n        const createdEnvType = await createEnvType(envType);\n        self.runInAction(() => {\n          // TODO replace this with a call to self.addEnvType() above\n          // Add newly created env type to env types map\n          const createdEnvTypeModel = EnvType.create(createdEnvType);\n          self.envTypes.set(createdEnvTypeModel.id, createdEnvTypeModel);\n        });\n        // Addition or deletion of env type impacts env type candidates store\n        // because imported env types are no longer candidates for import\n        // let candidate store know that env type candidate is imported\n        const appContext = getEnv(self);\n        await appContext.envTypeCandidatesStore.onEnvTypeCandidateImport(envType.id);\n      },\n\n      async deleteEnvType(id) {\n        await deleteEnvType(id);\n        self.runInAction(() => {\n          self.envTypes.delete(id);\n        });\n        // Addition or deletion of env type impacts env type candidates store\n        // because delete env types are candidates for import again\n        // reload env type candidates store as well\n        const appContext = getEnv(self);\n        await appContext.envTypeCandidatesStore.load();\n      },\n\n      async updateEnvType(envType) {\n        const updatedEnvType = await updateEnvType(envType);\n        self.runInAction(() => {\n          const previousEnvType = self.envTypes.get(updatedEnvType.id);\n          previousEnvType.setEnvType(updatedEnvType);\n        });\n      },\n\n      async approveEnvType(id) {\n        const previous = self.getEnvType(id);\n        const updated = await approveEnvType(id, previous.rev);\n        previous.setEnvType(updated);\n      },\n\n      async revokeEnvType(id) {\n        const previous = self.getEnvType(id);\n        const updated = await revokeEnvType(id, previous.rev);\n        previous.setEnvType(updated);\n      },\n\n      getEnvTypeStore(envTypeId) {\n        let entry = self.envTypeStores.get(envTypeId);\n        if (!entry) {\n          // Lazily create the store\n          self.envTypeStores.set(envTypeId, EnvTypeStore.create({ envTypeId }));\n          entry = self.envTypeStores.get(envTypeId);\n        }\n\n        return entry;\n      },\n\n      getEnvTypeConfigsStore(envTypeId) {\n        let envTypeConfigsStore = self.envTypeConfigsStores.get(envTypeId);\n        if (!envTypeConfigsStore) {\n          self.envTypeConfigsStores.set(envTypeId, EnvTypeConfigsStore.create({ id: envTypeId }));\n          envTypeConfigsStore = self.envTypeConfigsStores.get(envTypeId);\n        }\n        return envTypeConfigsStore;\n      },\n\n      cleanup: () => {\n        self.envTypes.clear();\n        self.envTypeStores.clear();\n        self.envTypeConfigsStores.clear();\n        superCleanup();\n      },\n    };\n  })\n  .views(self => ({\n    get list() {\n      return _.sortBy(mapToArray(self.envTypes), c => -1 * _.get(c, 'provisioningArtifact.createdTime'));\n    },\n    get listApproved() {\n      return _.filter(self.list, 'isApproved');\n    },\n    get listNotApproved() {\n      return _.filter(self.list, 'isNotApproved');\n    },\n    get empty() {\n      return _.isEmpty(self.list);\n    },\n    getEnvType(id) {\n      return self.envTypes.get(id);\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.envTypesStore = EnvTypesStore.create({}, appContext);\n}\n\nexport { EnvTypesStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types, applySnapshot } from 'mobx-state-tree';\n\nimport { EnvTypeCandidate } from './EnvTypeCandidate';\nimport { getValidStatuses, isApproved, isNotApproved } from './EnvTypeStatusEnum';\n\n// ====================================================================================================================================\n// EnvType -- (is an EnvTypeCandidate that's already imported)\n// ====================================================================================================================================\nconst EnvType = EnvTypeCandidate.named('EnvType')\n  .props({\n    rev: 0,\n    status: types.enumeration('EnvTypeStatus', getValidStatuses()),\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n  })\n  .actions(self => ({\n    setEnvType(envType) {\n      applySnapshot(self, envType);\n    },\n  }))\n  .views(self => ({\n    get isApproved() {\n      return isApproved(self.status);\n    },\n    get isNotApproved() {\n      return isNotApproved(self.status);\n    },\n  }));\n\nexport default EnvType;\nexport { EnvType };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\n\nimport { consolidateToMap, mapToArray } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport {\n  createEnvTypeConfig,\n  deleteEnvTypeConfig,\n  getAllEnvTypeConfigs,\n  getEnvTypeConfigVars,\n  updateEnvTypeConfig,\n} from '../../helpers/api';\nimport { EnvTypeConfig } from './EnvTypeConfig';\nimport { EnvTypeConfigVar } from './EnvTypeConfigVar';\n\n// ==================================================================\n// EnvTypeConfigsStore\n// ==================================================================\nconst EnvTypeConfigsStore = BaseStore.named('EnvTypeConfigsStore')\n  .props({\n    // Id of the EnvType\n    id: types.identifier,\n\n    // map of EnvTypeConfig with key = EnvTypeConfig.id, value = EnvTypeConfig MST model instance\n    envTypeConfigs: types.optional(types.map(EnvTypeConfig), {}),\n\n    // map of EnvTypeConfigVar with key = EnvTypeConfigVar.name, value = EnvTypeConfigVar MST model instance\n    envTypeConfigVars: types.optional(types.map(EnvTypeConfigVar), {}),\n\n    tickPeriod: 60 * 1000, // 1 minute\n  })\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const [envTypeConfigs, envTypeConfigVars] = await Promise.all([\n          getAllEnvTypeConfigs(self.id),\n          getEnvTypeConfigVars(self.id),\n        ]);\n\n        self.runInAction(() => {\n          consolidateToMap(self.envTypeConfigs, envTypeConfigs || [], (exiting, newItem) => {\n            exiting.setEnvTypeConfig(newItem);\n          });\n          consolidateToMap(\n            self.envTypeConfigVars,\n            envTypeConfigVars || [],\n            (exiting, newItem) => {\n              exiting.setEnvTypeConfigVar(newItem);\n            },\n            'name',\n          );\n        });\n      },\n\n      cleanup: () => {\n        self.envTypes.clear();\n        superCleanup();\n      },\n\n      async createEnvTypeConfig(envTypeConfig) {\n        const createdEnvTypeConfig = await createEnvTypeConfig(self.id, envTypeConfig);\n        self.runInAction(() => {\n          // Add newly created env type to env types map\n          const createdEnvTypeConfigModel = EnvTypeConfig.create(createdEnvTypeConfig);\n          self.envTypeConfigs.set(createdEnvTypeConfigModel.id, createdEnvTypeConfigModel);\n        });\n      },\n\n      async updateEnvTypeConfig(envTypeConfig) {\n        const updatedEnvTypeConfig = await updateEnvTypeConfig(self.id, envTypeConfig);\n        self.runInAction(() => {\n          const previous = self.envTypeConfigs.get(updatedEnvTypeConfig.id);\n          previous.setEnvTypeConfig(updatedEnvTypeConfig);\n        });\n      },\n\n      async deleteEnvTypeConfig(envTypeConfigId) {\n        await deleteEnvTypeConfig(self.id, envTypeConfigId);\n        self.runInAction(() => {\n          self.envTypeConfigs.delete(envTypeConfigId);\n        });\n      },\n    };\n  })\n  .views(self => ({\n    get list() {\n      const arr = _.filter(mapToArray(self.envTypeConfigs), c => c.allowedToUse);\n      return _.orderBy(arr, ['createdAt', 'name'], ['asc', 'asc']);\n    },\n    get listAll() {\n      const arr = mapToArray(self.envTypeConfigs);\n      return _.orderBy(arr, ['createdAt', 'name'], ['asc', 'asc']);\n    },\n    get empty() {\n      return _.isEmpty(self.listAll);\n    },\n    getEnvTypeConfig(id) {\n      return self.envTypeConfigs.get(id);\n    },\n  }));\n\n// Note: Do NOT register this in the appContext, if you want to gain access to an instance\n//       use EnvTypesStore.getEnvTypeConfigsStore()\nexport default EnvTypeConfigsStore;\nexport { EnvTypeConfigsStore };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types, applySnapshot, getEnv } from 'mobx-state-tree';\n\nconst KeyValuePair = types.model('KeyValuePair', {\n  key: '',\n  value: '',\n});\n\n// ====================================================================================================================================\n// EnvTypeConfig\n// ====================================================================================================================================\nconst EnvTypeConfig = types\n  .model('EnvTypeConfig', {\n    id: types.identifier,\n    name: '',\n    desc: '',\n    estimatedCostInfo: '',\n    allowRoleIds: types.optional(types.array(types.string), []),\n    denyRoleIds: types.optional(types.array(types.string), []),\n    params: types.optional(types.array(KeyValuePair), []),\n    tags: types.optional(types.array(KeyValuePair), []),\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n\n    // flag indicating if the env type config is allowed to be used\n    // defaulting this to true as the API only returns those env type configs that are usable\n    // except for admins when include=all is passed in the query param, it returns all env type configs\n    // including the ones the user is not allowed to use when launching an environment\n    allowedToUse: types.optional(types.boolean, true),\n  })\n  .actions(self => ({\n    setEnvTypeConfig(envTypeConfig) {\n      applySnapshot(self, envTypeConfig);\n    },\n  }))\n  .views(self => ({\n    get descHtml() {\n      const showdown = getEnv(self).showdown;\n      return showdown.convert(self.desc);\n    },\n    get estimatedCostInfoHtml() {\n      const showdown = getEnv(self).showdown;\n      return showdown.convert(self.estimatedCostInfo);\n    },\n  }));\n\nexport default EnvTypeConfig;\nexport { EnvTypeConfig };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types, applySnapshot, getEnv } from 'mobx-state-tree';\n\n// ====================================================================================================================================\n// EnvTypeConfigVar\n// ====================================================================================================================================\nconst EnvTypeConfigVar = types\n  .model('EnvTypeConfigVar', {\n    name: '',\n    desc: '',\n  })\n  .actions(self => ({\n    setEnvTypeConfigVar(envTypeConfigVar) {\n      applySnapshot(self, envTypeConfigVar);\n    },\n  }))\n  .views(self => ({\n    get descHtml() {\n      const showdown = getEnv(self).showdown;\n      return showdown.convert(self.desc);\n    },\n  }));\n\nexport default EnvTypeConfigVar;\nexport { EnvTypeConfigVar };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { getParent } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getEnvType } from '../../helpers/api';\n\n// ==================================================================\n// EnvTypeStore\n// ==================================================================\nconst EnvTypeStore = BaseStore.named('EnvTypeStore')\n  .props({\n    envTypeId: '',\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const parent = getParent(self, 2);\n        const rawEnv = await getEnvType(self.envTypeId);\n        parent.addEnvType(rawEnv);\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get envType() {\n      const parent = getParent(self, 2);\n      const envType = parent.getEnvType(self.envTypeId);\n      return envType;\n    },\n  }));\n\n// Note: Do NOT register this in the global context, if you want to gain access to an instance\n//       use envTypesStore.getEnvTypeStore()\n// eslint-disable-next-line import/prefer-default-export\nexport { EnvTypeStore };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { detach, types } from 'mobx-state-tree';\n\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { consolidateToMap, mapToArray } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { getAllEnvTypeCandidatesNotImported } from '../../helpers/api';\nimport { EnvTypeCandidate } from './EnvTypeCandidate';\n\n// ==================================================================\n// EnvTypeCandidatesStore\n// ==================================================================\nconst EnvTypeCandidatesStore = BaseStore.named('EnvTypeCandidatesStore')\n  .props({\n    envTypeCandidates: types.optional(types.map(EnvTypeCandidate), {}),\n    tickPeriod: 60 * 1000, // 1 minute\n  })\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const envTypeCandidates = (await getAllEnvTypeCandidatesNotImported()) || [];\n        self.runInAction(() => {\n          consolidateToMap(self.envTypeCandidates, envTypeCandidates, (exiting, newItem) => {\n            exiting.setEnvTypeCandidate(newItem);\n          });\n        });\n      },\n\n      cleanup: () => {\n        self.envTypeCandidates.clear();\n        superCleanup();\n      },\n\n      async onEnvTypeCandidateImport(id) {\n        // Addition or deletion of env type impacts env type candidates store\n        // because imported env types are no longer candidates for import\n        // reload env type candidates store as well\n        const envTypeCandidateImported = self.envTypeCandidates.get(id);\n\n        // The self.envTypeCandidatesStore.load() will result in envTypeCandidateImported being deleted from the map (i.e., deleted from the tree)\n        // at this point if we are on any view that is referencing envTypeCandidateImported we will get\n        // \"You are trying to read or write to an object that is no longer part of a state tree\" mobx-state-tree error\n        // to avoid this, detach the node first\n        detach(envTypeCandidateImported);\n\n        await self.load();\n      },\n    };\n  })\n  .views(self => ({\n    get list() {\n      return _.sortBy(mapToArray(self.envTypeCandidates), c => -1 * _.get(c, 'provisioningArtifact.createdTime'));\n      // return [];\n    },\n    get listLatestVersions() {\n      return _.filter(self.list, 'isLatest');\n    },\n    get listAllVersions() {\n      return self.list;\n    },\n    get empty() {\n      return _.isEmpty(self.list);\n    },\n    getEnvTypeCandidate(id) {\n      return self.envTypeCandidates.get(id);\n    },\n  }));\nfunction registerContextItems(appContext) {\n  appContext.envTypeCandidatesStore = EnvTypeCandidatesStore.create({}, appContext);\n}\n\nexport { EnvTypeCandidatesStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable import/prefer-default-export */\nimport _ from 'lodash';\nimport { httpApiGet, httpApiPost, httpApiPut, httpApiDelete } from '@aws-ee/base-ui/dist/helpers/api';\nimport { removeNulls } from '@aws-ee/base-ui/dist/helpers/utils';\n\nfunction getUserRoles() {\n  return httpApiGet('api/user-roles');\n}\n\nfunction getAwsAccounts() {\n  return httpApiGet('api/aws-accounts');\n}\n\n// Note the accountUUID used here is the 'id' column in dbAwsAccounts table and 'id' attribute in AwsAccount.js, not AWS account id\nfunction getAwsAccount(accountUUID) {\n  return httpApiGet(`api/aws-accounts/${accountUUID}`);\n}\n\n// Note the accountUUID used here is the 'id' column in dbAwsAccounts table and 'id' attribute in AwsAccount.js, not AWS account id\nfunction getAwsAccountBudget(accountUUID) {\n  return httpApiGet(`api/budgets/aws-account/${accountUUID}`);\n}\n\nfunction createAwsAccountBudget(budgetConfiguration) {\n  return httpApiPut(`api/budgets/aws-account`, { data: budgetConfiguration });\n}\n\nfunction updateAwsAccountBudget(budgetConfiguration) {\n  return httpApiPost(`api/budgets/aws-account`, { data: budgetConfiguration });\n}\n\nfunction addUsers(users) {\n  return httpApiPost('api/users/bulk', { data: users });\n}\n\nfunction addAwsAccount(awsAccount) {\n  return httpApiPost('api/aws-accounts', { data: awsAccount });\n}\n\nfunction createAwsAccount(awsAccount) {\n  return httpApiPost('api/aws-accounts/provision', { data: awsAccount });\n}\n\nfunction addIndex(index) {\n  return httpApiPost('api/indexes', { data: index });\n}\n\nfunction updateUserApplication(user) {\n  // Remove nulls and omit extra fields from the payload before calling the API\n  // The user is identified by the uid in the url\n  const data = removeNulls(\n    _.omit(\n      _.clone(user),\n      'uid',\n      'authenticationProviderId',\n      'identityProviderName',\n      'username',\n      'ns',\n      'createdBy',\n      'updatedBy',\n    ),\n  );\n  if (!data.userType) {\n    // if userType is specified as empty string then make sure to delete it\n    // the api requires this to be only one of the supported values (currently only supported value is 'root')\n    delete data.userType;\n  }\n  return httpApiPut(`api/user`, { data });\n}\n\nasync function deleteUser(user) {\n  return httpApiDelete(`api/users/${user.uid}`);\n}\n\nfunction getStudies(category) {\n  return httpApiGet('api/studies', { params: { category } });\n}\n\nfunction getStudy(id) {\n  return httpApiGet(`api/studies/${id}`);\n}\n\nfunction createStudy(body) {\n  return httpApiPost('api/studies', { data: body });\n}\n\nfunction listStudyFiles(studyId) {\n  return httpApiGet(`api/studies/${studyId}/files`);\n}\n\nfunction getPresignedStudyUploadRequests(studyId, filenames) {\n  if (Array.isArray(filenames)) {\n    filenames = filenames.join(',');\n  }\n  return httpApiGet(`api/studies/${studyId}/upload-requests`, { params: { filenames } });\n}\n\nfunction getStudyPermissions(studyId) {\n  return httpApiGet(`api/studies/${studyId}/permissions`);\n}\n\nfunction updateStudyPermissions(studyId, updateRequest) {\n  return httpApiPut(`api/studies/${studyId}/permissions`, { data: updateRequest });\n}\n\nasync function getStepTemplates() {\n  return httpApiGet('api/step-templates');\n}\n\nfunction getEnvironments() {\n  return httpApiGet('api/workspaces/built-in');\n}\n\nfunction getEnvironmentCost(id, numberDaysInPast, groupByService = true, groupByUser = false) {\n  return httpApiGet(\n    `api/costs?env=${id}&numberOfDaysInPast=${numberDaysInPast}&groupByService=${groupByService}&groupByUser=${groupByUser}`,\n  );\n}\n\nfunction getAllProjCostGroupByUser(numberDaysInPast) {\n  return httpApiGet(`api/costs?proj=ALL&groupByUser=true&numberOfDaysInPast=${numberDaysInPast}`);\n}\n\nfunction getAllProjCostGroupByEnv(numberDaysInPast) {\n  return httpApiGet(`api/costs?proj=ALL&groupByEnv=true&numberOfDaysInPast=${numberDaysInPast}`);\n}\n\nfunction getEnvironment(id) {\n  return httpApiGet(`api/workspaces/built-in/${id}`);\n}\n\nfunction deleteEnvironment(id) {\n  return httpApiDelete(`api/workspaces/built-in/${id}`);\n}\n\nfunction createEnvironment(body) {\n  return httpApiPost('api/workspaces/built-in', { data: body });\n}\n\nfunction updateEnvironment(body) {\n  return httpApiPut('api/workspaces/built-in', { data: body });\n}\n\nfunction stopEnvironment(id) {\n  return httpApiPut(`api/workspaces/built-in/${id}/stop`);\n}\n\nfunction startEnvironment(id) {\n  return httpApiPut(`api/workspaces/built-in/${id}/start`);\n}\n\nfunction getEnvironmentKeypair(id) {\n  return httpApiGet(`api/workspaces/built-in/${id}/keypair`);\n}\n\nfunction getEnvironmentPasswordData(id) {\n  return httpApiGet(`api/workspaces/built-in/${id}/password`);\n}\n\nfunction getEnvironmentUrl(id) {\n  return httpApiGet(`api/workspaces/built-in/${id}/url`);\n}\n\nfunction getEnvironmentSpotPriceHistory(type) {\n  return httpApiGet(`api/workspaces/built-in/pricing/${type}`);\n}\n\nfunction getExternalTemplate(key) {\n  return httpApiGet(`api/template/${key}`);\n}\n\nfunction getIndexes() {\n  return httpApiGet('api/indexes');\n}\n\nfunction getIndex(indexId) {\n  return httpApiGet(`api/indexes/${indexId}`);\n}\n\nfunction getProjects() {\n  return httpApiGet('api/projects');\n}\n\nfunction getProject(id) {\n  return httpApiGet(`api/projects/${id}`);\n}\n\nfunction deleteProject(id) {\n  return httpApiDelete(`api/projects/${id}`);\n}\n\nfunction addProject(project) {\n  return httpApiPost('api/projects', { data: project });\n}\n\nfunction updateProject(project) {\n  return httpApiPut(`api/projects/${project.id}`, { data: project });\n}\n\nfunction getAccounts() {\n  return httpApiGet('api/accounts');\n}\n\nfunction getAccount(id) {\n  return httpApiGet(`api/accounts/${id}`);\n}\n\nfunction removeAccountInfo(id) {\n  return httpApiDelete(`api/accounts/${id}`);\n}\n\nfunction getComputePlatforms() {\n  return httpApiGet(`api/compute/platforms`);\n}\n\nfunction getComputeConfigurations(platformId) {\n  return httpApiGet(`api/compute/platforms/${platformId}/configurations`);\n}\n\nfunction getClientIpAddress() {\n  return httpApiGet(`api/ip`);\n}\n\nfunction getScEnvironmentCost(id, numberDaysInPast, groupByService = true, groupByUser = false) {\n  return httpApiGet(\n    `api/costs?scEnv=${id}&numberOfDaysInPast=${numberDaysInPast}&groupByService=${groupByService}&groupByUser=${groupByUser}`,\n  );\n}\n\nfunction getScEnvironments() {\n  return httpApiGet(`api/workspaces/service-catalog/`);\n}\n\nfunction getScEnvironment(id) {\n  return httpApiGet(`api/workspaces/service-catalog/${id}`);\n}\n\nfunction createScEnvironment(scEnvironment) {\n  return httpApiPost('api/workspaces/service-catalog/', { data: scEnvironment });\n}\n\nfunction createScEnvironmentConnectionUrl(envId, connectionId) {\n  return httpApiPost(`api/workspaces/service-catalog/${envId}/connections/${connectionId}/url`);\n}\n\nfunction deleteScEnvironment(id) {\n  return httpApiDelete(`api/workspaces/service-catalog/${id}`);\n}\n\nfunction stopScEnvironment(id) {\n  return httpApiPut(`api/workspaces/service-catalog/${id}/stop`);\n}\n\nfunction startScEnvironment(id) {\n  return httpApiPut(`api/workspaces/service-catalog/${id}/start`);\n}\n\nfunction getScEnvironmentConnections(envId) {\n  return httpApiGet(`api/workspaces/service-catalog/${envId}/connections/`);\n}\n\nfunction sendSshKey(envId, connectionId, keyPairId) {\n  return httpApiPost(`api/workspaces/service-catalog/${envId}/connections/${connectionId}/send-ssh-public-key`, {\n    data: { keyPairId },\n  });\n}\n\nfunction getWindowsRpInfo(envId, connectionId) {\n  return httpApiGet(`api/workspaces/service-catalog/${envId}/connections/${connectionId}/windows-rdp-info`);\n}\n\n// API Functions Insertion Point (do not change this text, it is being used by hygen cli)\n\nexport {\n  addIndex,\n  addUsers,\n  removeAccountInfo,\n  deleteUser,\n  getUserRoles,\n  getAwsAccounts,\n  getAwsAccount,\n  getAwsAccountBudget,\n  createAwsAccountBudget,\n  updateAwsAccountBudget,\n  getStudies,\n  getStudy,\n  createStudy,\n  listStudyFiles,\n  getPresignedStudyUploadRequests,\n  getStudyPermissions,\n  updateStudyPermissions,\n  addAwsAccount,\n  createAwsAccount,\n  getStepTemplates,\n  getEnvironments,\n  getEnvironment,\n  getEnvironmentCost,\n  deleteEnvironment,\n  createEnvironment,\n  updateEnvironment,\n  stopEnvironment,\n  startEnvironment,\n  getEnvironmentKeypair,\n  getEnvironmentPasswordData,\n  getEnvironmentUrl,\n  getEnvironmentSpotPriceHistory,\n  getExternalTemplate,\n  getAllProjCostGroupByUser,\n  getIndexes,\n  getIndex,\n  getAllProjCostGroupByEnv,\n  updateUserApplication,\n  getProjects,\n  getProject,\n  addProject,\n  updateProject,\n  deleteProject,\n  getAccounts,\n  getAccount,\n  getComputePlatforms,\n  getComputeConfigurations,\n  getClientIpAddress,\n  getScEnvironmentCost,\n  getScEnvironments,\n  createScEnvironment,\n  createScEnvironmentConnectionUrl,\n  deleteScEnvironment,\n  stopScEnvironment,\n  startScEnvironment,\n  getScEnvironment,\n  getScEnvironmentConnections,\n  sendSshKey,\n  getWindowsRpInfo,\n};\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, applySnapshot, getEnv, getSnapshot } from 'mobx-state-tree';\n\nimport { InputManifest, applyMarkdown, visit } from '@aws-ee/base-ui/dist/models/forms/InputManifest';\n\n// ==================================================================\n// Helpers\n// ==================================================================\n\n// Given an input manifest we want to derive an admin input manifest from it, this is done by doing the following:\n// - combining all the sections into one\n// - removing all conditions in all input entries\n// - removing 'required' from rules attributes\nfunction deriveAdminInputManifest(inputManifest = {}) {\n  const admin = _.cloneDeep(inputManifest);\n  const visitFn = item => {\n    if (_.isString(item.rules)) {\n      item.rules = item.rules.replace(/\\|required\\|/, '');\n      item.rules = item.rules.replace(/required\\|/, '');\n      item.rules = item.rules.replace(/\\|required/, '');\n      item.rules = item.rules.replace(/required/, '');\n    }\n    delete item.condition;\n    return item;\n  };\n  const sections = _.map(admin.sections, (section = {}) => visit(section.children, visitFn));\n\n  admin.sections = [{ children: _.flatten(sections) }];\n  return admin;\n}\n\n// ==================================================================\n// StepTemplateVersion\n// ==================================================================\nconst StepTemplateVersion = types\n  .model('StepTemplateVersion', {\n    id: '',\n    v: types.maybeNull(types.number),\n    title: '',\n    desc: '',\n    skippable: types.maybe(types.boolean),\n    inputManifest: types.maybe(InputManifest),\n    adminInputManifest: types.maybe(InputManifest),\n  })\n  .actions(self => {\n    function transformManifest(manifest) {\n      // We now apply markdown\n      const showdown = getEnv(self).showdown;\n      const assets = {}; // TODO resolve the assets of the step template (assets is a map of the name\n      // of the asset and the url of the asset), an asset is just an image file.\n      if (manifest) {\n        return applyMarkdown({ inputManifest: manifest, showdown, assets });\n      }\n      return manifest;\n    }\n\n    return {\n      afterCreate() {\n        self.inputManifest = transformManifest(self.inputManifest);\n        if (self.adminInputManifest) {\n          self.adminInputManifest = transformManifest(self.adminInputManifest);\n        } else if (self.inputManifest) {\n          self.adminInputManifest = deriveAdminInputManifest(getSnapshot(self.inputManifest));\n        }\n      },\n\n      setStepTemplateVersion(template) {\n        applySnapshot(self, template);\n        self.afterCreate();\n      },\n    };\n  })\n\n  .views(_self => ({}));\n\n// ==================================================================\n// StepTemplate\n// ==================================================================\nconst StepTemplate = types\n  .model('StepTemplate', {\n    id: types.identifier,\n    versions: types.optional(types.array(StepTemplateVersion), []),\n  })\n  .actions(self => ({\n    setStepTemplate(template) {\n      // we try to preserve any existing version objects and update their content instead\n      const mapOfExisting = _.keyBy(self.versions, version => version.v.toString());\n      const processed = [];\n\n      _.forEach(template.versions, templateVersion => {\n        const existing = mapOfExisting[templateVersion.v];\n        if (existing) {\n          existing.setStepTemplateVersion(templateVersion);\n          processed.push(existing);\n        } else {\n          processed.push(StepTemplateVersion.create(templateVersion));\n        }\n      });\n\n      self.versions.replace(processed);\n    },\n  }))\n\n  .views(self => ({\n    get latest() {\n      // we loop through all 'v' numbers and pick the template with the largest 'v' value\n      let largestVersion = self.versions[0];\n      _.forEach(self.versions, version => {\n        if (version.v > largestVersion.v) {\n          largestVersion = version;\n        }\n      });\n      return largestVersion;\n    },\n\n    getVersion(v) {\n      return _.find(self.versions, ['v', v]);\n    },\n\n    get versionNumbers() {\n      return _.map(self.versions, version => version.v);\n    },\n  }));\n\nexport { StepTemplate, StepTemplateVersion };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getStepTemplates } from '../../helpers/api';\nimport { StepTemplate } from './StepTemplate';\n\n// ==================================================================\n// StepTemplatesStore\n// ==================================================================\nconst StepTemplatesStore = BaseStore.named('StepTemplatesStore')\n  .props({\n    templates: types.optional(types.map(StepTemplate), {}),\n    tickPeriod: 900 * 1000, // 15 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const versions = await getStepTemplates();\n        const templates = toTemplates(versions);\n\n        // we try to preserve existing template versions data and merge the new data instead\n        self.runInAction(() => {\n          const previousKeys = {};\n          self.templates.forEach((value, key) => {\n            previousKeys[key] = true;\n          });\n          templates.forEach(template => {\n            const id = template.id;\n            const hasPrevious = self.templates.has(id);\n\n            self.addTemplate(template);\n\n            if (hasPrevious) {\n              delete previousKeys[id];\n            }\n          });\n\n          _.forEach(previousKeys, (value, key) => {\n            self.templates.delete(key);\n          });\n        });\n      },\n\n      addTemplate(rawTemplate) {\n        const id = rawTemplate.id;\n        const previous = self.templates.get(id);\n\n        if (!previous) {\n          self.templates.put(rawTemplate);\n        } else {\n          previous.setStepTemplate(rawTemplate);\n        }\n      },\n\n      cleanup: () => {\n        self.templates.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.templates.size === 0;\n    },\n\n    get total() {\n      return self.templates.size;\n    },\n\n    get list() {\n      const result = [];\n      self.templates.forEach(template => result.push(template));\n\n      return _.sortBy(result, ['latest.title']);\n    },\n\n    getTemplate(id) {\n      return self.templates.get(id);\n    },\n  }));\n\n// Given an array of [ { id: tmp1, v: 0, ... }, { id: tmp1, v:1, ... } ]\n// return an array of the grouping of the template versions based on their ids\n// [ { id, versions: [ ... ] }, { id, versions: [ ... ] }, ...]\nfunction toTemplates(versions) {\n  const map = {};\n  _.forEach(versions, version => {\n    const id = version.id;\n    const entry = map[id] || { id, versions: [] };\n    entry.versions.push(version);\n    map[id] = entry;\n  });\n\n  return _.values(map);\n}\n\nfunction registerContextItems(appContext) {\n  appContext.stepTemplatesStore = StepTemplatesStore.create({}, appContext);\n}\n\nexport { StepTemplatesStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { createForm } from '@aws-ee/base-ui/dist/helpers/form';\n\nconst editWorkflowTemplateDraftMetaFields = templateVersion => {\n  const { title = '', desc = '', instanceTtl, runSpec = {}, propertyOverrideSummaryRows = [] } = templateVersion;\n  const result = [\n    {\n      name: 'templateTitle',\n      label: 'Workflow Template Title',\n      placeholder: 'Type a title for the workflow template',\n      extra: {\n        explain: `This is a required field and the number of characters must be between 3 and 255.\n      The title is shown in many places in the UI.`,\n      },\n      value: title,\n      rules: 'required|string|between:3,255',\n    },\n\n    {\n      name: 'templateDesc',\n      label: 'Workflow Template Description',\n      placeholder: 'Type a description for the workflow template',\n      extra: {\n        explain: `The description can be written in markdown but must be between 3 and 4000 characters.`,\n      },\n      value: desc,\n      rules: 'required|string|between:3,4000',\n    },\n\n    {\n      name: 'instanceTtl',\n      label: 'Time to Live (TTL) for instances of the workflow',\n      placeholder: 'Type the number of days',\n      extra: {\n        explain: `The number of days for which a record of a workflow instance is kept in the database.\n      Leave it empty or type -1 if you don't want to have a time limit on the record.`,\n      },\n      value: instanceTtl,\n      rules: 'integer',\n    },\n\n    {\n      name: 'runSpecSize',\n      label: 'Runtime lambda size',\n      extra: {\n        options: [\n          {\n            value: 'small',\n            text: 'Small',\n          },\n          {\n            value: 'medium',\n            text: 'Medium',\n          },\n          {\n            value: 'large',\n            text: 'Large',\n          },\n        ],\n      },\n      value: runSpec.size || 'small',\n      rules: 'required|in:small,medium,large',\n    },\n\n    {\n      name: 'runSpecTarget',\n      label: 'Runtime target',\n      extra: {\n        options: [\n          {\n            value: 'stepFunctions',\n            text: 'Step Functions',\n          },\n          {\n            value: 'workerLambda',\n            text: 'Worker Lambda',\n          },\n          {\n            value: 'inPlace',\n            text: 'In Place',\n          },\n        ],\n      },\n      value: runSpec.target || 'stepFunctions',\n      rules: 'required|in:stepFunctions,workerLambda,inPlace',\n    },\n  ];\n\n  const propsOverrideFields = _.map(propertyOverrideSummaryRows, ({ name, title_, allowed = false }) => ({\n    name: `propsOverride_${name}`,\n    label: title_,\n    value: allowed,\n    default: allowed,\n  }));\n\n  return [...result, ...propsOverrideFields];\n};\n\nfunction getEditWorkflowTemplateDraftMetaForm(template) {\n  const fields = editWorkflowTemplateDraftMetaFields(template);\n\n  return createForm(fields);\n}\n\nexport default getEditWorkflowTemplateDraftMetaForm;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '@aws-ee/base-ui/dist/helpers/form';\n\nconst workflowStepDescFields = (step, { isTemplate = true } = {}) => {\n  const { title = '', desc = '', derivedTitle = '', derivedDesc = '' } = step;\n  const propsOverrideOption = step.propsOverrideOption || { allowed: [] };\n  const warnMessage = 'The workflow template used by this workflow does not allow you to modify this field';\n  const canOverride = prop => isTemplate || propsOverrideOption.allowed.includes(prop);\n  const warnIfCanNotOverride = (prop, text = warnMessage) => (canOverride(prop) ? undefined : text);\n\n  return {\n    stepTitle: {\n      label: 'Title',\n      placeholder: 'Type a title for the step',\n      extra: {\n        explain: `This is a required field and the number of characters must be between 3 and 255.\n        The title is shown in many places in the UI.`,\n        warn: warnIfCanNotOverride('title'),\n      },\n      value: title || derivedTitle,\n      rules: 'required|string|between:3,255',\n      disabled: !canOverride('title'),\n    },\n\n    stepDesc: {\n      label: 'Description',\n      placeholder: 'Type a description for the step',\n      extra: {\n        explain: `The description can be written in markdown but must be between 3 and 4000 characters.`,\n        warn: warnIfCanNotOverride('desc'),\n      },\n      value: desc || derivedDesc,\n      rules: 'required|string|between:3,4000',\n      disabled: !canOverride('desc'),\n    },\n  };\n};\n\nfunction getWorkflowStepDescForm(step, options) {\n  const fields = workflowStepDescFields(step, options);\n  return createForm(fields);\n}\n\nexport default getWorkflowStepDescForm;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '@aws-ee/base-ui/dist/helpers/form';\n\nconst workflowStepPropsFields = (step, { isTemplate = true } = {}) => {\n  const { skippable } = step;\n  const propsOverrideOption = step.propsOverrideOption || { allowed: [] };\n  const warnMessage = 'The workflow template used by this workflow does not allow you to modify this field';\n  const canOverride = prop => isTemplate || propsOverrideOption.allowed.includes(prop);\n  const warnIfCanNotOverride = (prop, text = warnMessage) => (canOverride(prop) ? undefined : text);\n\n  return {\n    skippable: {\n      label: 'Skip this step if pervious steps failed?',\n      extra: {\n        explain: 'If a previous step failed, should this step still run by the workflow engine?',\n        warn: warnIfCanNotOverride('skippable'),\n      },\n      value: skippable,\n      rules: 'required|boolean',\n      disabled: !canOverride('skippable'),\n    },\n  };\n};\n\nfunction getWorkflowStepPropsForm(step, options) {\n  const fields = workflowStepPropsFields(step, options);\n\n  return createForm(fields);\n}\n\nexport default getWorkflowStepPropsForm;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { createForm } from '@aws-ee/base-ui/dist/helpers/form';\n\nconst workflowStepConfigOverrideFields = step => {\n  const rows = step.configOverrideSummaryRows || [];\n  return _.map(rows, ({ name, title, allowed = false }) => ({\n    name,\n    label: title,\n    value: allowed,\n    default: allowed,\n  }));\n};\n\nfunction getWorkflowStepConfigOverrideForm(step) {\n  const fields = workflowStepConfigOverrideFields(step);\n  return createForm(fields);\n}\n\nexport default getWorkflowStepConfigOverrideForm;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { createForm } from '@aws-ee/base-ui/dist/helpers/form';\n\nconst workflowStepPropsOverrideFields = step => {\n  const rows = step.propertyOverrideSummaryRows || [];\n  return _.map(rows, ({ name, title, allowed = false }) => ({\n    name,\n    label: title,\n    value: allowed,\n    default: allowed,\n  }));\n};\n\nfunction getWorkflowStepPropsOverrideForm(step) {\n  const fields = workflowStepPropsOverrideFields(step);\n  return createForm(fields);\n}\n\nexport default getWorkflowStepPropsOverrideForm;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types, getEnv, clone } from 'mobx-state-tree';\nimport { uiEventBus } from '@aws-ee/base-ui/dist/models/SessionStore';\n\nimport getEditWorkflowTemplateDraftMetaForm from '../../../forms/EditWorkflowTemplateDraftMetaForm';\nimport WorkflowTemplateStepEditor from './WorkflowTemplateStepEditor';\n\nlet globals; // a reference to the appContext\n\n// ==================================================================\n// WorkflowTemplateDraftEditor\n// ==================================================================\nconst WorkflowTemplateDraftEditor = types\n  .model('WorkflowTemplateDraftEditor', {\n    draftId: '',\n    currentPage: 0, // there are only two pages, one for meta editing and one for steps editing\n    numPages: 3,\n    stepEditors: types.optional(types.map(WorkflowTemplateStepEditor), {}),\n  })\n\n  .volatile(_self => ({\n    draftCopy: undefined,\n    draftMetaForm: undefined,\n  }))\n\n  .actions(self => {\n    // private\n    function makeDraftCopy() {\n      self.runInAction(() => {\n        const draft = self.originalDraft;\n        self.draftCopy = clone(draft);\n        self.draftMetaForm = getEditWorkflowTemplateDraftMetaForm(self.draftCopy.template);\n      });\n    }\n\n    return {\n      // I had issues using runInAction from mobx\n      // the issue is discussed here https://github.com/mobxjs/mobx-state-tree/issues/915\n      runInAction(fn) {\n        return fn();\n      },\n\n      afterCreate() {\n        makeDraftCopy();\n      },\n\n      nextPage() {\n        if (self.currentPage < self.numPages - 1) self.currentPage += 1;\n        else self.currentPage = self.numPages - 1;\n        return self.currentPage;\n      },\n\n      previousPage() {\n        if (self.currentPage > 0) self.currentPage -= 1;\n        else self.currentPage = 0;\n        return self.currentPage;\n      },\n\n      cancel() {\n        // We make a fresh copy in case the existing copy one was used\n        makeDraftCopy();\n        self.currentPage = 0;\n      },\n\n      getStepEditor(step) {\n        const stepId = step.id;\n        const entry = self.stepEditors.get(stepId) || WorkflowTemplateStepEditor.create({ stepId }, getEnv(self));\n\n        self.stepEditors.set(stepId, entry);\n        return entry;\n      },\n\n      removeStepEditor(stepId) {\n        self.stepEditors.delete(stepId);\n      },\n\n      addStep(step) {\n        const template = self.draft.template;\n        template.addStep(step);\n      },\n\n      async update(draft) {\n        const updatedDraft = await self.workflowTemplateDraftsStore.updateDraft(draft);\n        // The following code is not the greatest idea, but okay for this scenario, the correct approach would have\n        // been to call makeDraftCopy(), however, this will result in losing some of the ui states in the draft card\n        self.draft.setRev(updatedDraft.rev);\n      },\n\n      async publish(draft) {\n        const result = await self.workflowTemplateDraftsStore.publishDraft(draft);\n\n        // Remove the wizard from the session store, if there were no errors\n        if (!result.hasErrors) {\n          await uiEventBus.fireEvent('workflowTemplateDraftDeleted', draft);\n        }\n\n        return result;\n      },\n    };\n  })\n\n  .views(self => ({\n    get workflowTemplateDraftsStore() {\n      return getEnv(self).workflowTemplateDraftsStore;\n    },\n\n    get hasNextPage() {\n      return self.currentPage < self.numPages - 1;\n    },\n\n    get hasPreviousPage() {\n      return self.currentPage > 0;\n    },\n\n    get originalDraft() {\n      const store = self.workflowTemplateDraftsStore;\n      return store.getDraft(self.draftId);\n    },\n\n    get draft() {\n      return self.draftCopy;\n    },\n\n    // Returns a WorkflowTemplateVersion model object\n    get version() {\n      return self.draft.template;\n    },\n\n    get metaForm() {\n      return self.draftMetaForm;\n    },\n\n    // Returns true if at least one step editor is in edit mode\n    get stepEditorsEditing() {\n      let found = false;\n      /* eslint-disable no-restricted-syntax, no-unused-vars */\n      for (const editor of self.stepEditors.values()) {\n        if (editor.editing) {\n          found = true;\n          break;\n        }\n      }\n      /* eslint-enable no-restricted-syntax, no-unused-vars */\n      return found;\n    },\n  }));\n\nfunction getWorkflowTemplateDraftEditor(draftId) {\n  const sessionStore = globals.sessionStore;\n  const id = encodeId(draftId);\n  const entry = sessionStore.map.get(id) || WorkflowTemplateDraftEditor.create({ draftId }, globals);\n\n  sessionStore.map.set(id, entry);\n  return entry;\n}\n\nfunction encodeId(draftId) {\n  return `WorkflowTemplateDraftEditor-${draftId}`;\n}\n\nfunction removeWizard(draftId) {\n  const sessionStore = globals.sessionStore;\n  const id = encodeId(draftId);\n\n  sessionStore.removeStartsWith(id);\n}\n\nfunction registerContextItems(appContext) {\n  // we are not actually registering anything here, just getting a reference to the appContext\n  globals = appContext;\n\n  uiEventBus.listenTo('workflowTemplateDraftDeleted', {\n    id: 'WorkflowTemplateDraftEditor',\n    listener: async event => {\n      // event will be the draft object\n      removeWizard(event.id);\n    },\n  });\n}\n\nexport { WorkflowTemplateDraftEditor, getWorkflowTemplateDraftEditor, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getSnapshot, applySnapshot } from 'mobx-state-tree';\n\nimport { createForm } from '../../helpers/form';\nimport { InputManifest, toMobxFormFields, isConditionTrue } from '../forms/InputManifest';\n\n// ==================================================================\n// ConfigurationEditor\n// ==================================================================\nconst ConfigurationEditor = types\n  .model('ConfigurationEditor', {\n    currentSectionIndex: 0, // IMPORTANT section index start from 0 not 1\n    review: false,\n    inputManifest: types.maybe(InputManifest),\n    configuration: types.optional(\n      types.map(types.union(types.null, types.undefined, types.integer, types.number, types.boolean, types.string)),\n      {},\n    ),\n    mode: types.optional(types.enumeration('Mode', ['create', 'edit']), 'create'), // mode - either \"create\" or \"edit\"\n  })\n\n  .volatile(_self => ({\n    originalConfig: undefined,\n    originalSectionConfig: undefined, // the key/value object for the original section config after next()\n  }))\n\n  .actions(() => ({\n    // I had issues using runInAction from mobx\n    // the issue is discussed here https://github.com/mobxjs/mobx-state-tree/issues/915\n    runInAction(fn) {\n      return fn();\n    },\n  }))\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    // If the value of a form field is an object, then make the value a json string instead\n    const normalizeForm = obj => {\n      return _.transform(\n        obj,\n        (result, value, key) => {\n          result[key] = _.isObject(value) ? JSON.stringify(value) : value;\n        },\n        {},\n      );\n    };\n\n    // Returns a key/value object for configuration keys that are part of the given input manifest section\n    const getSectionConfig = inputManifestSection => {\n      const config = {};\n      const section = inputManifestSection;\n      if (section === undefined) return config;\n      const flattened = self.inputManifest.getSectionFlattened(section) || [];\n      flattened.forEach(item => {\n        const key = item.name;\n        if (self.configuration.has(key)) config[key] = _.cloneDeep(self.configuration.get(key));\n      });\n\n      return config;\n    };\n\n    const resetOriginalSectionConfig = () => {\n      self.originalSectionConfig = getSectionConfig(self.inputManifestSection);\n    };\n\n    // Returns all config keys (if any) that belong to input manifest sections after the given index\n    const configKeysAfter = index => {\n      const sections = _.slice(_.get(self.inputManifest, 'sections', []), Math.max(index + 1, 0));\n      const keys = [];\n      _.forEach(sections, section => {\n        const config = getSectionConfig(section);\n        const configKeys = _.keys(config) || [];\n        if (!_.isEmpty(configKeys)) keys.push(...configKeys);\n      });\n\n      return keys;\n    };\n\n    return {\n      afterCreate() {\n        // We keep the original values of the configuration object so that when we do cancel, we simply restore the original copy\n        self.originalConfig = getSnapshot(self.configuration);\n        resetOriginalSectionConfig();\n      },\n\n      cleanup() {\n        superCleanup();\n      },\n\n      next(form) {\n        const configuration = self.configuration;\n        configuration.merge(normalizeForm(form.values()));\n\n        const changed = !_.isEqual(self.originalSectionConfig, getSectionConfig(self.inputManifestSection));\n        const keysAfter = configKeysAfter(self.currentSectionIndex);\n        const nextSectionIndex = self.nextSectionIndex;\n        const before = self.currentSectionIndex;\n\n        if (nextSectionIndex !== -1) self.currentSectionIndex = nextSectionIndex;\n        const after = self.currentSectionIndex;\n\n        resetOriginalSectionConfig();\n\n        // If the configuration keys changed, then it is time to clear all configuration keys (if any) after the current section\n        // In case of edit mode, do not clear any section (we need to pre-populate all sections with existing values)\n        if (!self.isEditMode && changed) {\n          _.forEach(keysAfter, key => {\n            self.configuration.delete(key);\n          });\n        }\n\n        // If the section index didn't move forward, it means that we don't have any more sections\n        // for input and it is time to show the review content\n        self.review = before === after;\n      },\n\n      previous(_form) {\n        if (self.review) {\n          self.review = false;\n          return;\n        }\n        // const configuration = self.configuration;\n        // configuration.merge(normalizeForm(form.values()));\n        const previousSectionIndex = self.previousSectionIndex;\n        if (previousSectionIndex !== -1) self.currentSectionIndex = previousSectionIndex;\n        resetOriginalSectionConfig();\n      },\n\n      clearConfigs() {\n        self.configuration.clear();\n      },\n\n      clearSectionConfigs() {\n        // We only clear configuration keys that belong to the current section\n        if (self.empty) {\n          self.configuration.clear();\n          return;\n        }\n\n        const section = self.inputManifestSection;\n        if (section === undefined) return;\n        const flattened = self.inputManifest.getSectionFlattened(section) || [];\n        flattened.forEach(item => {\n          self.configuration.delete(item.name);\n        });\n      },\n\n      applyChanges() {\n        self.originalConfig = getSnapshot(self.configuration);\n      },\n\n      cancel() {\n        self.review = false;\n        self.currentSectionIndex = 0;\n        if (self.originalConfig) {\n          applySnapshot(self.configuration, self.originalConfig);\n        }\n\n        resetOriginalSectionConfig();\n      },\n\n      restart() {\n        self.cancel();\n      },\n    };\n  })\n\n  .views(self => ({\n    get isEditMode() {\n      return self.mode === 'edit';\n    },\n\n    get inputManifestSection() {\n      if (self.inputManifest === undefined) return undefined;\n      const sections = self.inputManifest.sections;\n      const index = self.currentSectionIndex;\n      if (index > self.totalSections) return undefined;\n      if (index >= sections.length) return undefined;\n      return sections[index];\n    },\n\n    // A list of objects, where each object represents a configuration name/entry that is not undefined\n    // [ {name: 'xyz', title: '...', value: 'true', etc}, {name: 'abc', title: '...', value: 'something', etc}, ... ]\n    get definedConfigList() {\n      if (self.inputManifest === undefined) return [];\n      const inputEntries = self.inputManifest.flattened;\n      const configMap = self.configuration;\n      const list = [];\n      _.forEach(inputEntries, entry => {\n        let value = configMap.get(entry.name);\n        if (_.isUndefined(value)) value = entry.value;\n        if (!_.isUndefined(value)) list.push({ ...entry, value });\n      });\n\n      return list;\n    },\n\n    // A map of all names in inputManifest with their values from the configuration object if they exist\n    // or from the inputManifest if they exist, otherwise undefined is given as the value for the key\n    // An example of returned object shape: { 'configName': 'demo', 'doYouWantThis': undefined }\n    get merged() {\n      const inputEntries = self.inputManifest.flattened;\n      const map = {};\n      _.forEach(inputEntries, entry => {\n        map[entry.name] = entry.value;\n      });\n\n      /* eslint-disable no-restricted-syntax */\n      for (const [key, value] of self.configuration.entries()) {\n        map[key] = value;\n      }\n      /* eslint-enable no-restricted-syntax */\n\n      return map;\n    },\n\n    get formFields() {\n      const index = self.currentSectionIndex;\n      if (self.totalSections < index) return [];\n      const input = self.inputManifestSection;\n      if (_.isUndefined(input)) return [];\n\n      return toMobxFormFields(input.children, self.merged);\n    },\n\n    get form() {\n      return createForm(self.formFields);\n    },\n\n    get totalSections() {\n      if (self.inputManifest === undefined) return 0;\n      return self.inputManifest.sections.length;\n    },\n\n    get hasNext() {\n      return self.nextSectionIndex !== -1 && !self.review;\n    },\n\n    get hasPrevious() {\n      return self.previousSectionIndex !== -1 || self.review;\n    },\n\n    // Returns the next section index\n    // if the current section is the last section, return -1\n    // walk through the remaining sections and return the index of the first one\n    // that has condition === true, otherwise return -1\n    get nextSectionIndex() {\n      if (self.totalSections < self.currentSectionIndex) return -1;\n      if (self.inputManifest === undefined) return -1;\n      const sections = self.inputManifest.sections;\n      const merged = self.merged;\n      let found = false;\n      let index = self.currentSectionIndex + 1;\n\n      while (!found && index < self.totalSections) {\n        const entry = sections[index];\n        found = isConditionTrue(entry.condition, merged);\n        if (!found) index += 1;\n      }\n\n      return found ? index : -1;\n    },\n\n    // Returns the previous section index\n    // if the current section is 0, return -1\n    // walk through the previous sections and return the index of the first one\n    // that has condition === true, otherwise return -1\n    get previousSectionIndex() {\n      if (self.currentSectionIndex === 0) return -1;\n      const sections = self.inputManifest.sections;\n      const merged = self.merged;\n      let found = false;\n      let index = self.currentSectionIndex - 1;\n\n      while (!found && index >= 0) {\n        const entry = sections[index];\n        found = isConditionTrue(entry.condition, merged);\n        if (!found) index -= 1;\n      }\n\n      return found ? index : -1;\n    },\n\n    get sectionsTitles() {\n      const sections = self.inputManifest.sections;\n      return _.map(sections, index => index.title);\n    },\n\n    get empty() {\n      if (self.inputManifest === undefined) return true;\n      return self.inputManifest.empty;\n    },\n  }));\n\n// Note: Do NOT register ConfigurationEditor in the global context\n\nexport default ConfigurationEditor;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getParent, getEnv, clone, getSnapshot } from 'mobx-state-tree';\n\nimport getWorkflowStepDescForm from '../../../forms/WorkflowStepDescForm';\nimport getWorkflowStepPropsForm from '../../../forms/WorkflowStepPropsForm';\nimport getWorkflowStepConfigOverrideForm from '../../../forms/WorkflowStepConfigOverrideForm';\nimport getWorkflowStepPropsOverrideForm from '../../../forms/WorkflowStepPropsOverrideForm';\nimport ConfigurationEditor from '../../../configuration/ConfigurationEditor';\n\n// ==================================================================\n// WorkflowTemplateStepEditor\n// ==================================================================\nconst WorkflowTemplateStepEditor = types\n  .model('WorkflowTemplateStepEditor', {\n    stepId: '', // The step Id for the workflow template step\n    contentExpanded: false,\n    configEdit: false, // If we are editing mode or not for the configuration section\n    configOverrideEdit: false, // If we are editing mode or not for the configuration override section\n    descEdit: false, // If we are editing mode or not for the description section\n    propsEdit: false, // If we are editing mode or not for the props section\n    propsOverrideEdit: false, // If we are editing mode or not for the props override section\n  })\n\n  .volatile(_self => ({\n    configurationEditor: undefined,\n    stepDescForm: undefined,\n    stepConfigOverrideForm: undefined,\n    stepPropsForm: undefined,\n    stepPropsOverrideForm: undefined,\n  }))\n\n  .actions(self => {\n    return {\n      // I had issues using runInAction from mobx\n      // the issue is discussed here https://github.com/mobxjs/mobx-state-tree/issues/915\n      runInAction(fn) {\n        return fn();\n      },\n\n      afterAttach() {\n        if (self.configurationEditor !== undefined) return;\n        const step = self.step;\n        const inputManifest = _.get(step, 'stepTemplate.adminInputManifest');\n        const defaults = getSnapshot(step.defaults);\n\n        self.configurationEditor = ConfigurationEditor.create(\n          {\n            inputManifest: _.isUndefined(inputManifest) ? undefined : clone(inputManifest),\n            configuration: defaults,\n          },\n          getEnv(self),\n        );\n\n        self.stepConfigOverrideForm = getWorkflowStepConfigOverrideForm(step);\n        self.stepDescForm = getWorkflowStepDescForm(step);\n        self.stepPropsForm = getWorkflowStepPropsForm(step);\n        self.stepPropsOverrideForm = getWorkflowStepPropsOverrideForm(step);\n      },\n\n      setContentExpanded(flag) {\n        self.contentExpanded = !!flag; // !! will simply turn any type to a boolean type\n      },\n\n      setConfigEdit(flag) {\n        self.configEdit = flag;\n      },\n\n      setConfigOverrideEdit(flag) {\n        self.configOverrideEdit = flag;\n      },\n\n      setDescEdit(flag) {\n        self.descEdit = flag;\n      },\n\n      setPropsEdit(flag) {\n        self.propsEdit = flag;\n      },\n\n      setPropsOverrideEdit(flag) {\n        self.propsOverrideEdit = flag;\n      },\n\n      applyDefaults(configs = {}) {\n        self.step.setDefaults(configs);\n      },\n\n      applyConfigOverrides(configOverrides = []) {\n        self.step.setConfigOverrideOption({\n          allowed: configOverrides,\n        });\n        self.stepConfigOverrideForm = getWorkflowStepConfigOverrideForm(self.step);\n      },\n\n      applyPropsOverrides(propsOverrides = []) {\n        self.step.setPropsOverrideOption({\n          allowed: propsOverrides,\n        });\n        self.stepPropsOverrideForm = getWorkflowStepPropsOverrideForm(self.step);\n      },\n\n      applyDescAndTitle(desc, title) {\n        self.step.setDesc(desc);\n        self.step.setTitle(title);\n        self.stepDescForm = getWorkflowStepDescForm(self.step);\n      },\n\n      applySkippable(skippable) {\n        self.step.setSkippable(skippable);\n        self.stepPropsForm = getWorkflowStepPropsForm(self.step);\n      },\n    };\n  })\n\n  .views(self => ({\n    get step() {\n      const version = self.version;\n      return version.getStep(self.stepId);\n    },\n\n    get version() {\n      const parentEditor = getParent(self, 2);\n      return parentEditor.version;\n    },\n\n    get configOverrideForm() {\n      return self.stepConfigOverrideForm;\n    },\n\n    get descForm() {\n      return self.stepDescForm;\n    },\n\n    get propsForm() {\n      return self.stepPropsForm;\n    },\n\n    get propsOverrideForm() {\n      return self.stepPropsOverrideForm;\n    },\n\n    get editing() {\n      return self.configEdit || self.descEdit || self.propsEdit || self.configOverrideEdit || self.propsOverrideEdit;\n    },\n  }));\n\nexport default WorkflowTemplateStepEditor;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getEnv, getParent, applySnapshot, getSnapshot } from 'mobx-state-tree';\n\nimport { StepTemplateVersion } from '../workflow-step-templates/StepTemplate';\n\nconst titles = {\n  title: 'Title',\n  desc: 'Description',\n  skippable: 'Skip this step if pervious steps failed',\n};\n\nconst supportedPropsOverrideKeys = ['title', 'desc', 'skippable'];\n\n// ==================================================================\n// PropsOverrideOption\n// ==================================================================\nconst PropsOverrideOption = types\n  .model('PropsOverrideOption', {\n    allowed: types.optional(types.array(types.string), []),\n  })\n  .actions(self => ({\n    setAllowed(allowed = []) {\n      self.allowed.replace(allowed);\n    },\n  }))\n  .views(self => ({\n    get overrideSummaryRows() {\n      const canOverride = prop => self.allowed.includes(prop);\n\n      const result = [\n        { title: titles.title, allowed: canOverride('title'), name: 'title' },\n        { title: titles.desc, allowed: canOverride('desc'), name: 'desc' },\n        { title: titles.skippable, allowed: canOverride('skippable'), name: 'skippable' },\n      ];\n\n      _.forEach(self.allowed, (prop, index) => {\n        if (supportedPropsOverrideKeys.includes(prop)) return;\n        result.push({ title: prop, allowed: true, name: `${index}-${prop}` });\n      });\n\n      return result;\n    },\n  }));\n\n// ==================================================================\n// ConfigOverrideOption\n// ==================================================================\nconst ConfigOverrideOption = types\n  .model('ConfigOverrideOption', {\n    allowed: types.optional(types.array(types.string), []),\n  })\n  .actions(self => ({\n    setAllowed(allowed = []) {\n      self.allowed.replace(allowed);\n    },\n  }))\n  .views(self => ({\n    get overrideSummaryRows() {\n      const result = _.cloneDeep(getParent(self).configSummaryRows || []);\n      const map = _.keyBy(result, 'name');\n      self.allowed.forEach(key => {\n        const entry = map[key];\n        if (entry !== undefined) {\n          entry.allowed = true;\n        } else {\n          result.push({ name: key, allowed: true });\n        }\n      });\n\n      return result;\n    },\n  }));\n\n// ==================================================================\n// WorkflowTemplateStep\n// ==================================================================\nconst WorkflowTemplateStep = types\n  .model('WorkflowTemplateStep', {\n    id: '',\n    stepTemplateId: '',\n    stepTemplateVer: types.maybeNull(types.number),\n    title: types.maybe(types.string),\n    desc: types.maybe(types.string),\n    propsOverrideOption: types.optional(PropsOverrideOption, {}),\n    configOverrideOption: types.optional(ConfigOverrideOption, {}),\n    stepTemplate: StepTemplateVersion,\n    skippable: types.maybe(types.boolean),\n    defaults: types.optional(\n      types.map(types.union(types.null, types.undefined, types.integer, types.number, types.boolean, types.string)),\n      {},\n    ),\n  })\n  .actions(self => ({\n    afterCreate() {\n      if (_.isEmpty(self.id))\n        console.warn(`There is no id provided for this workflow template step`, getSnapshot(self));\n    },\n\n    setDesc(desc) {\n      if (desc === self.stepTemplate.desc) self.desc = undefined;\n      else self.desc = desc;\n    },\n\n    setTitle(title) {\n      if (title === self.stepTemplate.title) self.title = undefined;\n      else self.title = title;\n    },\n\n    setDefaults(defaults = {}) {\n      self.defaults.replace(defaults);\n    },\n\n    setSkippable(skippable) {\n      self.skippable = skippable;\n    },\n\n    setConfigOverrideOption(option) {\n      applySnapshot(self.configOverrideOption, option);\n    },\n\n    setPropsOverrideOption(option) {\n      applySnapshot(self.propsOverrideOption, option);\n    },\n  }))\n\n  .views(self => ({\n    get templateId() {\n      return self.stepTemplateId;\n    },\n\n    get templateVer() {\n      return self.stepTemplateVer;\n    },\n\n    get derivedTitle() {\n      return self.title || self.stepTemplate.title;\n    },\n\n    get derivedDesc() {\n      return self.desc || self.stepTemplate.desc;\n    },\n\n    get descHtml() {\n      const showdown = getEnv(self).showdown;\n      return showdown.convert(self.derivedDesc, self.assets); // TODO declare assets\n    },\n\n    get propertyOverrideSummaryRows() {\n      if (_.isNil(self.propsOverrideOption)) return [];\n      return self.propsOverrideOption.overrideSummaryRows;\n    },\n\n    get propertySummaryRows() {\n      return [\n        {\n          title: titles.skippable,\n          value: self.skippable,\n        },\n      ];\n    },\n\n    get configSummaryRows() {\n      // First, we build a map of all the input manifest entries\n      // Then, for entries where we actually have a config value in the 'defaults', we\n      // populate the value attribute in the entry.\n      const inputManifest = self.stepTemplate.inputManifest;\n\n      // We use 'additional' to keep track of entries that was not part of the inputManifest but yet there is a key in 'configs' for it.\n      // The order of the rows might be useful, so we try to preserve it by keeping track of additional\n      const additional = [];\n      let flattened = [];\n      let map = {};\n\n      if (inputManifest) {\n        flattened = _.cloneDeep(inputManifest.flattened || []);\n        map = _.keyBy(flattened, 'name');\n      }\n\n      /* eslint-disable no-restricted-syntax, no-unused-vars */\n      for (const [k, v] of self.defaults) {\n        let entry = map[k];\n        if (entry === undefined) {\n          entry = { name: k };\n          additional.push(entry);\n        }\n        entry.value = v;\n        map[k] = entry;\n      }\n      /* eslint-enable no-restricted-syntax, no-unused-vars */\n\n      return [...flattened, ...additional];\n    },\n\n    get configOverrideSummaryRows() {\n      if (_.isNil(self.configOverrideOption)) return [];\n      return self.configOverrideOption.overrideSummaryRows;\n    },\n  }));\n\nexport { WorkflowTemplateStep, PropsOverrideOption, ConfigOverrideOption, supportedPropsOverrideKeys };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getEnv, applySnapshot, detach, clone } from 'mobx-state-tree';\nimport { generateId } from '@aws-ee/base-ui/dist/helpers/utils';\n\nimport { WorkflowTemplateStep } from './WorkflowTemplateStep';\n\nconst titles = {\n  instanceTtl: 'Time to Live (TTL) for instances of the workflow',\n  runSpecSize: 'Runtime lambda size',\n  runSpecTarget: 'Runtime target',\n  title: 'Title',\n  desc: 'Description',\n  steps: 'Add, remove, and rearrange steps',\n};\n\nconst supportedPropsOverrideKeys = ['runSpecSize', 'runSpecTarget', 'instanceTtl', 'title', 'desc', 'steps'];\n\n// ==================================================================\n// PropsOverrideOption\n// ==================================================================\nconst PropsOverrideOption = types\n  .model('PropsOverrideOption', {\n    allowed: types.optional(types.array(types.string), []),\n  })\n  .views(self => ({\n    get overrideSummaryRows() {\n      const canOverride = prop => self.allowed.includes(prop);\n\n      const result = [\n        { title: titles.steps, allowed: canOverride('steps'), name: 'steps' },\n        { title: titles.instanceTtl, allowed: canOverride('instanceTtl'), name: 'instanceTtl' },\n        { title: titles.runSpecSize, allowed: canOverride('runSpecSize'), name: 'runSpecSize' },\n        { title: titles.runSpecTarget, allowed: canOverride('runSpecTarget'), name: 'runSpecTarget' },\n        { title: titles.title, allowed: canOverride('title'), name: 'title' },\n        { title: titles.desc, allowed: canOverride('desc'), name: 'desc' },\n      ];\n\n      _.forEach(self.allowed, prop => {\n        if (supportedPropsOverrideKeys.includes(prop)) return;\n        result.push({ title: prop, allowed: true });\n      });\n\n      return result;\n    },\n\n    canOverride(prop) {\n      return self.allowed.includes(prop);\n    },\n  }));\n\n// ==================================================================\n// RunSpec\n// ==================================================================\nconst RunSpec = types\n  .model('RunSpec', {\n    size: '',\n    target: '',\n  })\n  .views(self => ({\n    get propertySummaryRows() {\n      return [\n        { title: titles.runSpecSize, value: self.size },\n        { title: titles.runSpecTarget, value: self.target },\n      ];\n    },\n  }));\n\n// ==================================================================\n// WorkflowTemplateVersion\n// ==================================================================\nconst WorkflowTemplateVersion = types\n  .model('WorkflowTemplateVersion', {\n    id: '',\n    v: types.number,\n    rev: types.maybeNull(types.number),\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n    title: '',\n    desc: '',\n    instanceTtl: types.maybeNull(types.number),\n    runSpec: RunSpec,\n    propsOverrideOption: types.maybe(PropsOverrideOption),\n    selectedSteps: types.optional(types.array(WorkflowTemplateStep), []),\n  })\n  .actions(self => ({\n    setWorkflowTemplateVersion(template) {\n      applySnapshot(self, template);\n    },\n\n    setTitle(title) {\n      self.title = title;\n    },\n\n    setDescription(desc) {\n      self.desc = desc;\n    },\n\n    setInstanceTtl(value) {\n      let answer = null;\n      if (_.isString(value)) {\n        const parsed = parseInt(value, 10);\n        if (_.isNaN(parsed)) answer = null;\n        else answer = parsed;\n      } else if (_.isNumber(value)) {\n        answer = value;\n      }\n\n      self.instanceTtl = answer;\n    },\n\n    setRunSpec(runSpec) {\n      applySnapshot(self.runSpec, runSpec);\n    },\n\n    setPropsOverrideOption(option) {\n      applySnapshot(self.propsOverrideOption, option);\n    },\n\n    reinsertStep(currentIndex, targetIndex) {\n      const current = self.selectedSteps[currentIndex];\n\n      detach(current);\n      self.selectedSteps.splice(targetIndex, 0, current);\n    },\n\n    removeStep(idOrStep) {\n      const step = _.isString(idOrStep) ? self.getStep(idOrStep) : idOrStep;\n      self.selectedSteps.remove(step);\n    },\n\n    addStep(step) {\n      const { id, v, skippable, title, desc } = step;\n      const workflowStep = WorkflowTemplateStep.create(\n        {\n          id: generateId('wt-step'),\n          stepTemplateId: id,\n          stepTemplateVer: v,\n          title,\n          desc,\n          skippable,\n          stepTemplate: clone(step),\n        },\n        getEnv(self),\n      );\n\n      self.selectedSteps.push(workflowStep);\n\n      return workflowStep;\n    },\n  }))\n\n  .views(self => ({\n    getStep(id) {\n      return _.find(self.selectedSteps, step => step.id === id);\n    },\n\n    get descHtml() {\n      const showdown = getEnv(self).showdown;\n      return showdown.convert(self.desc, self.assets); // TODO declare assets\n    },\n\n    get system() {\n      return self.createdBy === '_system_';\n    },\n\n    get propertySummaryRows() {\n      return [\n        {\n          title: titles.instanceTtl,\n          value: self.instanceTtl,\n        },\n        ...self.runSpec.propertySummaryRows,\n      ];\n    },\n\n    get propertyOverrideSummaryRows() {\n      if (_.isNil(self.propsOverrideOption)) return [];\n      return self.propsOverrideOption.overrideSummaryRows;\n    },\n\n    // A workflow template can always rearrange its steps, don't confuse this with 'canWorkflowRearrangeSteps'\n    get canRearrangeSteps() {\n      return true;\n    },\n\n    get canWorkflowRearrangeSteps() {\n      return self.canWorkflowOverrideProp('steps');\n    },\n\n    canWorkflowOverrideProp(prop) {\n      return self.propsOverrideOption.canOverride(prop);\n    },\n  }));\n\n// ==================================================================\n// WorkflowTemplate\n// ==================================================================\nconst WorkflowTemplate = types\n  .model('WorkflowTemplate', {\n    id: types.identifier,\n    versions: types.optional(types.array(WorkflowTemplateVersion), []),\n  })\n  .actions(self => ({\n    setWorkflowTemplate(template) {\n      // we try to preserve any existing version objects and update their content instead\n      const mapOfExisting = _.keyBy(self.versions, version => version.v.toString());\n      const processed = [];\n\n      _.forEach(template.versions, templateVersion => {\n        const existing = mapOfExisting[templateVersion.v];\n        if (existing) {\n          existing.setWorkflowTemplateVersion(templateVersion);\n          processed.push(existing);\n        } else {\n          processed.push(WorkflowTemplateVersion.create(templateVersion));\n        }\n      });\n\n      self.versions.replace(processed);\n    },\n  }))\n\n  .views(self => ({\n    get latest() {\n      // we loop through all 'v' numbers and pick the template with the largest 'v' value\n      let largestVersion = self.versions[0];\n      _.forEach(self.versions, version => {\n        if (version.v > largestVersion.v) {\n          largestVersion = version;\n        }\n      });\n      return largestVersion;\n    },\n\n    getVersion(v) {\n      return _.find(self.versions, ['v', v]);\n    },\n\n    get versionNumbers() {\n      return _.map(self.versions, version => version.v);\n    },\n  }));\n\nexport { WorkflowTemplate, WorkflowTemplateVersion, RunSpec };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types, applySnapshot } from 'mobx-state-tree';\nimport { WorkflowTemplateVersion } from '../WorkflowTemplate';\n\n// ==================================================================\n// WorkflowTemplateDraft\n// ==================================================================\nconst WorkflowTemplateDraft = types\n  .model('WorkflowTemplateDraft', {\n    id: types.identifier,\n    rev: types.maybe(types.number),\n    uid: '',\n    username: types.maybeNull(types.optional(types.string, '')),\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n    templateId: '',\n    template: WorkflowTemplateVersion,\n  })\n  .actions(self => ({\n    setWorkflowTemplateDraft(draft) {\n      applySnapshot(self, draft);\n    },\n\n    setRev(rev) {\n      self.rev = rev;\n    },\n  }))\n\n  .views(_self => ({}));\n\nexport default WorkflowTemplateDraft;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getSnapshot, getEnv } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport {\n  getWorkflowTemplateDrafts,\n  createWorkflowTemplateDraft,\n  updateWorkflowTemplateDraft,\n  publishWorkflowTemplateDraft,\n  deleteWorkflowTemplateDraft,\n} from '../../../helpers/api';\nimport WorkflowTemplateDraft from './WorkflowTemplateDraft';\n\n// ==================================================================\n// WorkflowTemplateDraftsStore\n// ==================================================================\nconst WorkflowTemplateDraftsStore = BaseStore.named('WorkflowTemplateDraftsStore')\n  .props({\n    drafts: types.optional(types.map(WorkflowTemplateDraft), {}),\n    tickPeriod: 900 * 1000, // 15 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    // private\n    function normalizeForSubmission(draft) {\n      const normalizedDraft = _.cloneDeep(getSnapshot(draft));\n      _.forEach(normalizedDraft.template.selectedSteps, step => {\n        delete step.stepTemplate;\n      });\n\n      return normalizedDraft;\n    }\n\n    return {\n      async doLoad() {\n        const drafts = await getWorkflowTemplateDrafts();\n\n        // We try to preserve existing drafts data and merge the new data instead\n        // We could have used self.drafts.replace(), but it will do clear().merge()\n        self.runInAction(() => {\n          const previousKeys = {};\n          self.drafts.forEach((value, key) => {\n            previousKeys[key] = true;\n          });\n          drafts.forEach(draft => {\n            const id = draft.id;\n            const hasPrevious = self.drafts.has(id);\n\n            self.addDraft(draft);\n\n            if (hasPrevious) {\n              delete previousKeys[id];\n            }\n          });\n\n          _.forEach(previousKeys, (value, key) => {\n            self.drafts.delete(key);\n          });\n        });\n      },\n\n      addDraft(rawDraft) {\n        const id = rawDraft.id;\n        const previous = self.drafts.get(id);\n\n        if (!previous) {\n          self.drafts.put(rawDraft);\n        } else {\n          previous.setWorkflowTemplateDraft(rawDraft);\n        }\n      },\n\n      async updateDraft(draft) {\n        const id = draft.id;\n        const previous = self.drafts.get(id);\n        if (previous === undefined) throw new Error(`Workflow Template Draft \"${id}\" does not exist`);\n\n        const updated = await updateWorkflowTemplateDraft(normalizeForSubmission(draft));\n        previous.setWorkflowTemplateDraft(updated);\n\n        return previous;\n      },\n\n      async createDraft({ isNewTemplate, templateId, templateTitle }) {\n        const draft = await createWorkflowTemplateDraft({ isNewTemplate, templateId, templateTitle });\n        self.addDraft(draft);\n\n        return draft;\n      },\n\n      async publishDraft(draft) {\n        const id = draft.id;\n        const previous = self.drafts.get(id);\n        if (previous === undefined) throw new Error(`Workflow Template Draft \"${id}\" does not exist`);\n\n        const publishResult = await publishWorkflowTemplateDraft(normalizeForSubmission(draft));\n\n        self.runInAction(() => {\n          if (!publishResult.hasErrors) self.drafts.delete(id);\n        });\n\n        return publishResult;\n      },\n\n      async deleteDraft(draft) {\n        const uiEventBus = getEnv(self).uiEventBus;\n        await deleteWorkflowTemplateDraft(draft);\n        await uiEventBus.fireEvent('workflowTemplateDraftDeleted', draft);\n        self.runInAction(() => {\n          self.drafts.delete(draft.id);\n        });\n      },\n\n      cleanup: () => {\n        self.drafts.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.drafts.size === 0;\n    },\n\n    get total() {\n      return self.drafts.size;\n    },\n\n    get list() {\n      const result = [];\n      self.drafts.forEach(drafts => result.push(drafts));\n\n      return _.reverse(_.sortBy(result, ['createdAt', 'title']));\n    },\n\n    hasTemplate(templateId) {\n      let found = false;\n      /* eslint-disable no-restricted-syntax, no-unused-vars */\n      for (const draft of self.drafts.values()) {\n        if (draft.template.id === templateId) {\n          found = true;\n          break;\n        }\n      }\n      /* eslint-enable no-restricted-syntax, no-unused-vars */\n\n      return found;\n    },\n\n    hasDraft(draftId) {\n      return self.drafts.has(draftId);\n    },\n\n    getDraft(id) {\n      return self.drafts.get(id);\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.workflowTemplateDraftsStore = WorkflowTemplateDraftsStore.create({}, appContext);\n}\n\nexport { WorkflowTemplateDraftsStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { uiEventBus } from '@aws-ee/base-ui/dist/models/SessionStore';\n\nimport { getWorkflowTemplates } from '../../helpers/api';\nimport { WorkflowTemplate } from './WorkflowTemplate';\n\n// ==================================================================\n// WorkflowTemplatesStore\n// ==================================================================\nconst WorkflowTemplatesStore = BaseStore.named('WorkflowTemplatesStore')\n  .props({\n    templates: types.optional(types.map(WorkflowTemplate), {}),\n    tickPeriod: 900 * 1000, // 15 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const versions = await getWorkflowTemplates();\n        const templates = toTemplates(versions);\n\n        // we try to preserve existing template versions data and merge the new data instead\n        self.runInAction(() => {\n          const previousKeys = {};\n          self.templates.forEach((_value, key) => {\n            previousKeys[key] = true;\n          });\n          templates.forEach(template => {\n            const id = template.id;\n            const hasPrevious = self.templates.has(id);\n\n            self.addTemplate(template);\n\n            if (hasPrevious) {\n              delete previousKeys[id];\n            }\n          });\n\n          _.forEach(previousKeys, (_value, key) => {\n            self.templates.delete(key);\n          });\n        });\n      },\n\n      addTemplate(rawTemplate) {\n        const id = rawTemplate.id;\n        const previous = self.templates.get(id);\n\n        if (!previous) {\n          self.templates.put(rawTemplate);\n        } else {\n          previous.setWorkflowTemplate(rawTemplate);\n        }\n      },\n\n      cleanup: () => {\n        self.templates.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.templates.size === 0;\n    },\n\n    get total() {\n      return self.templates.size;\n    },\n\n    get list() {\n      const result = [];\n      self.templates.forEach(template => result.push(template));\n\n      return _.reverse(_.sortBy(result, ['latest.createdAt', 'title']));\n      // return result;\n    },\n\n    getTemplate(id) {\n      return self.templates.get(id);\n    },\n  }));\n\n// Given an array of [ { id: tmp1, v: 0, ... }, { id: tmp1, v:1, ... } ]\n// return an array of the grouping of the template versions based on their ids\n// [ { id, versions: [ ... ] }, { id, versions: [ ... ] }, ...]\nfunction toTemplates(versions) {\n  const map = {};\n  _.forEach(versions, version => {\n    const id = version.id;\n    const entry = map[id] || { id, versions: [] };\n    entry.versions.push(version);\n    map[id] = entry;\n  });\n\n  return _.values(map);\n}\n\nfunction registerContextItems(appContext) {\n  appContext.workflowTemplatesStore = WorkflowTemplatesStore.create({}, appContext);\n\n  uiEventBus.listenTo('workflowTemplatePublished', {\n    id: 'WorkflowTemplatesStore',\n    listener: async _event => {\n      appContext.workflowTemplatesStore.cleanup();\n    },\n  });\n}\n\nexport { WorkflowTemplatesStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '@aws-ee/base-ui/dist/helpers/form';\n\nconst editWorkflowDraftMetaFields = version => {\n  const { title = '', desc = '', instanceTtl, runSpec = {} } = version;\n  const warnMessage = 'The workflow template used by this workflow does not allow you to modify this field';\n  const warnIfCanNotOverride = (prop, text = warnMessage) => (version.canOverrideProp(prop) ? undefined : text);\n  const canOverride = prop => version.canOverrideProp(prop);\n\n  const result = [\n    {\n      name: 'title',\n      label: 'Workflow Title',\n      placeholder: 'Type a title for the workflow',\n      extra: {\n        explain: `This is a required field and the number of characters must be between 3 and 255.\n      The title is shown in many places in the UI.`,\n        warn: warnIfCanNotOverride('title'),\n      },\n      value: title,\n      rules: 'required|string|between:3,255',\n      disabled: !canOverride('title'),\n    },\n\n    {\n      name: 'desc',\n      label: 'Workflow Description',\n      placeholder: 'Type a description for the workflow',\n      extra: {\n        explain: `The description can be written in markdown but must be between 3 and 4000 characters.`,\n        warn: warnIfCanNotOverride('desc'),\n      },\n      value: desc,\n      rules: 'required|string|between:3,4000',\n      disabled: !canOverride('desc'),\n    },\n\n    {\n      name: 'instanceTtl',\n      label: 'Time to Live (TTL) for instances of the workflow',\n      placeholder: 'Type the number of days',\n      extra: {\n        explain: `The number of days for which a record of a workflow instance is kept in the database.\n      Leave it empty or type -1 if you don't want to have a time limit on the record.`,\n        warn: warnIfCanNotOverride('instanceTtl'),\n      },\n      value: instanceTtl,\n      rules: 'integer',\n      disabled: !canOverride('instanceTtl'),\n    },\n\n    {\n      name: 'runSpecSize',\n      label: 'Runtime lambda size',\n      extra: {\n        warn: warnIfCanNotOverride('runSpecSize'),\n        options: [\n          {\n            value: 'small',\n            text: 'Small',\n          },\n          {\n            value: 'medium',\n            text: 'Medium',\n          },\n          {\n            value: 'large',\n            text: 'Large',\n          },\n        ],\n      },\n      value: runSpec.size || 'small',\n      rules: 'required|in:small,medium,large',\n      disabled: !canOverride('runSpecSize'),\n    },\n\n    {\n      name: 'runSpecTarget',\n      label: 'Runtime target',\n      extra: {\n        warn: warnIfCanNotOverride('runSpecTarget'),\n        options: [\n          {\n            value: 'stepFunctions',\n            text: 'Step Functions',\n          },\n          {\n            value: 'workerLambda',\n            text: 'Worker Lambda',\n          },\n          {\n            value: 'inPlace',\n            text: 'In Place',\n          },\n        ],\n      },\n      value: runSpec.target || 'stepFunctions',\n      rules: 'required|in:stepFunctions,workerLambda,inPlace',\n      disabled: !canOverride('runSpecTarget'),\n    },\n  ];\n\n  return [...result];\n};\n\nfunction getEditWorkflowDraftMetaForm(template) {\n  const fields = editWorkflowDraftMetaFields(template);\n\n  return createForm(fields);\n}\n\nexport default getEditWorkflowDraftMetaForm;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getParent, getEnv, getSnapshot } from 'mobx-state-tree';\nimport { visit } from '@aws-ee/base-ui/dist/models/forms/InputManifest';\n\nimport getWorkflowStepDescForm from '../../../forms/WorkflowStepDescForm';\nimport getWorkflowStepPropsForm from '../../../forms/WorkflowStepPropsForm';\nimport ConfigurationEditor from '../../../configuration/ConfigurationEditor';\n\n// ==================================================================\n// WorkflowStepEditor\n// ==================================================================\nconst WorkflowStepEditor = types\n  .model('WorkflowStepEditor', {\n    stepId: '', // The step id for the workflow step\n    contentExpanded: false,\n    configEdit: false, // If we are editing mode or not for the configuration section\n    descEdit: false, // If we are editing mode or not for the description section\n    propsEdit: false, // If we are editing mode or not for the props section\n  })\n\n  .volatile(_self => ({\n    configurationEditor: undefined,\n    stepDescForm: undefined,\n    stepPropsForm: undefined,\n  }))\n\n  .actions(self => {\n    return {\n      // I had issues using runInAction from mobx\n      // the issue is discussed here https://github.com/mobxjs/mobx-state-tree/issues/915\n      runInAction(fn) {\n        return fn();\n      },\n\n      afterAttach() {\n        if (self.configurationEditor !== undefined) return;\n        const step = self.step;\n        const inputManifest = _.get(step, 'stepTemplate.inputManifest');\n        const configs = getSnapshot(step.configs);\n        const allowed = step.configOverrideOption.allowed;\n        const defaults = self.defaults;\n\n        self.configurationEditor = ConfigurationEditor.create(\n          {\n            inputManifest: _.isUndefined(inputManifest)\n              ? undefined\n              : prepareInputManifest(inputManifest, { allowed, defaults }),\n            configuration: configs,\n          },\n          getEnv(self),\n        );\n\n        self.stepDescForm = getWorkflowStepDescForm(step, { isTemplate: false });\n        self.stepPropsForm = getWorkflowStepPropsForm(step, { isTemplate: false });\n      },\n\n      setContentExpanded(flag) {\n        self.contentExpanded = !!flag; // !! will simply turn any type to a boolean type\n      },\n\n      setConfigEdit(flag) {\n        self.configEdit = flag;\n      },\n\n      setDescEdit(flag) {\n        self.descEdit = flag;\n      },\n\n      setPropsEdit(flag) {\n        self.propsEdit = flag;\n      },\n\n      applyConfigs(configs = {}) {\n        self.step.setConfigs(configs);\n      },\n\n      applyDescAndTitle(desc, title) {\n        self.step.setDesc(desc);\n        self.step.setTitle(title);\n        self.stepDescForm = getWorkflowStepDescForm(self.step, { isTemplate: false });\n      },\n\n      applySkippable(skippable) {\n        self.step.setSkippable(skippable);\n        self.stepPropsForm = getWorkflowStepPropsForm(self.step, { isTemplate: false });\n      },\n    };\n  })\n\n  .views(self => ({\n    get step() {\n      const version = self.version;\n      return version.getStep(self.stepId);\n    },\n\n    // WorkflowVersion\n    get version() {\n      const parentEditor = getParent(self, 2);\n      return parentEditor.version;\n    },\n\n    // The workflow template step defaults (if this workflow step has an associated workflow template step with it)\n    get defaults() {\n      const workflowVersion = self.version;\n      if (!workflowVersion) return undefined;\n      const workflowTemplateVersion = workflowVersion.template;\n      if (!workflowTemplateVersion) return undefined;\n      const workflowTemplateStep = workflowTemplateVersion.getStep(self.stepId);\n      if (!workflowTemplateStep) return undefined;\n\n      return workflowTemplateStep.defaults;\n    },\n\n    get descForm() {\n      return self.stepDescForm;\n    },\n\n    get propsForm() {\n      return self.stepPropsForm;\n    },\n\n    get editing() {\n      return self.configEdit || self.descEdit || self.propsEdit;\n    },\n  }));\n\n// Returns a copy of the input manifest (but as a json object), the copy has its entries updated as follows:\n// - If the entry name is not allowed to be overridden, then disabled is turned on with a warn message in the extra section\n// - If there is a default value for the given key, then it is set on the entry\nfunction prepareInputManifest(inputManifest, { allowed = [], defaults: rawDefaults }) {\n  if (_.isEmpty(inputManifest)) return inputManifest;\n  const names = inputManifest.names;\n  const copy = _.cloneDeep(getSnapshot(inputManifest));\n  const defaults = rawDefaults ? getSnapshot(rawDefaults) : {};\n\n  const visitFn = item => {\n    if (!item.name) return undefined;\n    const name = item.name;\n    if (!names.includes(name)) return undefined;\n\n    if (!allowed.includes(name)) {\n      item.disabled = true;\n      _.set(item, 'extra.warn', 'The workflow template used by this workflow does not allow you to modify this field');\n    }\n\n    if (_.has(defaults, name)) {\n      item.default = defaults[name];\n    }\n    return item;\n  };\n\n  _.forEach(copy.sections, section => {\n    visit(section.children, visitFn);\n  });\n\n  return copy;\n}\n\nexport default WorkflowStepEditor;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types, getEnv, clone } from 'mobx-state-tree';\nimport { uiEventBus } from '@aws-ee/base-ui/dist/models/SessionStore';\n\nimport getEditWorkflowDraftMetaForm from '../../../forms/EditWorkflowDraftMetaForm';\nimport WorkflowStepEditor from './WorkflowStepEditor';\n\nlet globals; // a reference to the globals\n\n// ==================================================================\n// WorkflowDraftEditor\n// ==================================================================\nconst WorkflowDraftEditor = types\n  .model('WorkflowDraftEditor', {\n    draftId: '',\n    currentPage: 0, // there are only two pages, one for meta editing and one for steps editing\n    numPages: 3,\n    stepEditors: types.optional(types.map(WorkflowStepEditor), {}),\n  })\n\n  .volatile(_self => ({\n    draftCopy: undefined,\n    draftMetaForm: undefined,\n  }))\n\n  .actions(self => {\n    // private\n    function makeDraftCopy() {\n      self.runInAction(() => {\n        const draft = self.originalDraft;\n        self.draftCopy = clone(draft);\n        self.draftMetaForm = getEditWorkflowDraftMetaForm(self.draftCopy.workflow);\n      });\n    }\n\n    return {\n      // I had issues using runInAction from mobx\n      // the issue is discussed here https://github.com/mobxjs/mobx-state-tree/issues/915\n      runInAction(fn) {\n        return fn();\n      },\n\n      afterCreate() {\n        makeDraftCopy();\n      },\n\n      nextPage() {\n        if (self.currentPage < self.numPages - 1) self.currentPage += 1;\n        else self.currentPage = self.numPages - 1;\n        return self.currentPage;\n      },\n\n      previousPage() {\n        if (self.currentPage > 0) self.currentPage -= 1;\n        else self.currentPage = 0;\n        return self.currentPage;\n      },\n\n      cancel() {\n        // We make a fresh copy in case the existing copy one was used\n        makeDraftCopy();\n        self.currentPage = 0;\n      },\n\n      getStepEditor(step) {\n        const stepId = step.id;\n        const entry = self.stepEditors.get(stepId) || WorkflowStepEditor.create({ stepId }, getEnv(self));\n\n        self.stepEditors.set(stepId, entry);\n        return entry;\n      },\n\n      removeStepEditor(stepId) {\n        self.stepEditors.delete(stepId);\n      },\n\n      addStep(step) {\n        const version = self.version;\n        version.addStep(step);\n      },\n\n      async update(draft) {\n        const updatedDraft = await self.workflowDraftsStore.updateDraft(draft);\n        // The following code is not the greatest idea, but okay for this scenario, the correct approach would have\n        // been to call makeDraftCopy(), however, this will result in losing some of the ui states in the draft card\n        self.draft.setRev(updatedDraft.rev);\n      },\n\n      async publish(draft) {\n        const result = await self.workflowDraftsStore.publishDraft(draft);\n\n        // Remove the editor from the session store, if there were no errors\n        if (!result.hasErrors) {\n          await uiEventBus.fireEvent('workflowDraftDeleted', draft);\n        }\n\n        return result;\n      },\n    };\n  })\n\n  .views(self => ({\n    get workflowDraftsStore() {\n      return getEnv(self).workflowDraftsStore;\n    },\n\n    get hasNextPage() {\n      return self.currentPage < self.numPages - 1;\n    },\n\n    get hasPreviousPage() {\n      return self.currentPage > 0;\n    },\n\n    get originalDraft() {\n      const store = self.workflowDraftsStore;\n      return store.getDraft(self.draftId);\n    },\n\n    get draft() {\n      return self.draftCopy;\n    },\n\n    // Returns a WorkflowVersion model object\n    get version() {\n      return self.draft.workflow;\n    },\n\n    get metaForm() {\n      return self.draftMetaForm;\n    },\n\n    // Returns true if at least one step editor is in edit mode\n    get stepEditorsEditing() {\n      let found = false;\n      /* eslint-disable no-restricted-syntax, no-unused-vars */\n      for (const editor of self.stepEditors.values()) {\n        if (editor.editing) {\n          found = true;\n          break;\n        }\n      }\n      /* eslint-enable no-restricted-syntax, no-unused-vars */\n      return found;\n    },\n  }));\n\nfunction getWorkflowDraftEditor(draftId) {\n  const sessionStore = globals.sessionStore;\n  const id = encodeId(draftId);\n  const entry = sessionStore.map.get(id) || WorkflowDraftEditor.create({ draftId }, globals);\n\n  sessionStore.map.set(id, entry);\n  return entry;\n}\n\nfunction encodeId(draftId) {\n  return `WorkflowDraftEditor-${draftId}`;\n}\n\nfunction removeEditor(draftId) {\n  const sessionStore = globals.sessionStore;\n  const id = encodeId(draftId);\n\n  sessionStore.removeStartsWith(id);\n}\n\nfunction registerContextItems(appContext) {\n  // we are not actually registering anything here, just getting a reference to the appContext\n  globals = appContext;\n\n  uiEventBus.listenTo('workflowDraftDeleted', {\n    id: 'WorkflowDraftEditor',\n    listener: async event => {\n      // event will be the draft object\n      removeEditor(event.id);\n    },\n  });\n}\n\nexport { WorkflowDraftEditor, getWorkflowDraftEditor, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getEnv, getSnapshot } from 'mobx-state-tree';\n\nimport {\n  PropsOverrideOption,\n  ConfigOverrideOption,\n  supportedPropsOverrideKeys,\n} from '../workflow-templates/WorkflowTemplateStep';\n\nconst titles = {\n  title: 'Title',\n  desc: 'Description',\n  skippable: 'Skip this step if pervious steps failed',\n};\n\n// ==================================================================\n// WorkflowStep\n// ==================================================================\nconst WorkflowStep = types\n  .model('WorkflowStep', {\n    id: '',\n    stepTemplateId: '',\n    stepTemplateVer: types.maybeNull(types.number),\n    title: types.maybe(types.string),\n    desc: types.maybe(types.string),\n    propsOverrideOption: types.optional(PropsOverrideOption, {}),\n    configOverrideOption: types.optional(ConfigOverrideOption, {}),\n    skippable: types.maybe(types.boolean),\n    configs: types.optional(\n      types.map(types.union(types.null, types.undefined, types.integer, types.number, types.boolean, types.string)),\n      {},\n    ),\n  })\n  .actions(self => ({\n    afterCreate() {\n      if (_.isEmpty(self.id)) console.warn(`There is no id provided for this workflow step`, getSnapshot(self));\n    },\n\n    setDesc(desc) {\n      self.desc = desc;\n    },\n\n    setTitle(title) {\n      self.title = title;\n    },\n\n    setConfigs(configs = {}) {\n      self.configs.replace(configs);\n    },\n\n    setSkippable(skippable) {\n      self.skippable = skippable;\n    },\n\n    // You should only use this method if the workflow step is added manually by the user (when allowed)\n    // do not make a WorkflowStep that came from the server as new.\n    makeNew() {\n      self.propsOverrideOption.setAllowed(_.slice(supportedPropsOverrideKeys));\n      const stepTemplate = self.stepTemplate;\n      if (!stepTemplate) return;\n      const inputManifest = stepTemplate.inputManifest;\n      if (!inputManifest) return;\n      const names = inputManifest.names;\n      self.configOverrideOption.setAllowed(names);\n    },\n  }))\n\n  .views(self => ({\n    get templateId() {\n      return self.stepTemplateId;\n    },\n\n    get templateVer() {\n      return self.stepTemplateVer;\n    },\n\n    get descHtml() {\n      const showdown = getEnv(self).showdown;\n      return showdown.convert(self.desc, self.assets); // TODO declare assets\n    },\n\n    get stepTemplate() {\n      const id = self.stepTemplateId;\n      const v = self.stepTemplateVer;\n      const stepTemplatesStore = getEnv(self).stepTemplatesStore;\n      if (!stepTemplatesStore) return undefined;\n\n      const stepTemplate = stepTemplatesStore.getTemplate(id);\n      if (!stepTemplate) return undefined;\n      return stepTemplate.getVersion(v);\n    },\n\n    get propertySummaryRows() {\n      return [\n        {\n          title: titles.skippable,\n          value: self.skippable,\n        },\n      ];\n    },\n\n    get configSummaryRows() {\n      // First, we build a map of all the input manifest entries\n      // Then, for entries where we actually have a config value in the 'configs', we\n      // populate the value attribute in the entry.\n      const stepTemplate = self.stepTemplate;\n      if (stepTemplate === undefined) return [];\n      const inputManifest = stepTemplate.inputManifest;\n\n      // We use 'additional' to keep track of entries that was not part of the inputManifest but yet there is a key in 'configs' for it.\n      // The order of the rows might be useful, so we try to preserve it by keeping track of additional\n      const additional = [];\n      let flattened = [];\n      let map = {};\n\n      if (inputManifest) {\n        flattened = _.cloneDeep(inputManifest.flattened || []);\n        map = _.keyBy(flattened, 'name');\n      }\n\n      /* eslint-disable no-restricted-syntax, no-unused-vars */\n      for (const [k, v] of self.configs) {\n        let entry = map[k];\n        if (entry === undefined) {\n          entry = { name: k };\n          additional.push(entry);\n        }\n        entry.value = v;\n        map[k] = entry;\n      }\n      /* eslint-enable no-restricted-syntax, no-unused-vars */\n\n      return [...flattened, ...additional];\n    },\n  }));\n\nexport default WorkflowStep;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getEnv, applySnapshot, detach } from 'mobx-state-tree';\nimport { generateId, consolidateToMap } from '@aws-ee/base-ui/dist/helpers/utils';\n\nimport { RunSpec } from '../workflow-templates/WorkflowTemplate';\nimport WorkflowStep from './WorkflowStep';\n\nconst titles = {\n  instanceTtl: 'Time to Live (TTL) for instances of the workflow',\n  runSpecSize: 'Runtime lambda size',\n  runSpecTarget: 'Runtime target',\n  title: 'Title',\n  desc: 'Description',\n  steps: 'Add, remove, and rearrange steps',\n};\n\nconst statusColorMap = {\n  // 'not_started': '', // to default to grey\n  in_progress: 'orange',\n  error: 'red',\n  done: 'green',\n};\n\n// ==================================================================\n// WorkflowAssignment\n// ==================================================================\nconst WorkflowAssignment = types\n  .model('WorkflowAssignment', {\n    id: '',\n    wf: '',\n    rev: types.number,\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n    triggerType: '',\n    triggerTypeData: '',\n  })\n  .actions(self => ({\n    setWorkflowAssignment(assignment) {\n      applySnapshot(self, assignment);\n    },\n  }))\n\n  .views(self => ({\n    get system() {\n      return self.createdBy.username === '_system_';\n    },\n  }));\n\n// ==================================================================\n// WorkflowInstance\n// ==================================================================\nconst WorkflowInstance = types\n  .model('WorkflowInstance', {\n    id: types.identifier,\n    wfId: '',\n    wfVer: types.number,\n    ttl: types.maybeNull(types.number),\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n    msg: '',\n    wfStatus: '',\n    stStatuses: types.optional(types.frozen(), []),\n    runSpec: RunSpec,\n    input: types.optional(types.frozen(), {}),\n    workflow: types.optional(types.frozen(), {}),\n  })\n  .actions(self => ({\n    setWorkflowInstance(instance) {\n      applySnapshot(self, instance);\n    },\n  }))\n\n  .views(self => ({\n    get system() {\n      return self.createdBy.username === '_system_';\n    },\n\n    // This is the workflow version\n    get version() {\n      const workflowsStore = getEnv(self).workflowsStore;\n      const workflow = workflowsStore.getWorkflow(self.wfId);\n      if (!workflow) return undefined;\n      return workflow.getVersion(self.wfVer);\n    },\n\n    get pending() {\n      return self.wfStatus === 'not_started' || self.wfStatus === 'in_progress';\n    },\n\n    get statusSummary() {\n      const stepSummary = status => {\n        const count = _.size(_.filter(self.stStatuses, item => item.status === status));\n        return {\n          count,\n          statusLabel: _.startCase(status),\n          statusColor: statusColorMap[status],\n        };\n      };\n      const is = value => self.wfStatus === value;\n      const spread = {\n        success: is('done'),\n        error: is('error'),\n        warning: is('in_progress'),\n      };\n\n      return {\n        statusMsg: self.msg,\n        statusLabel: _.startCase(self.wfStatus),\n        statusColor: statusColorMap[self.wfStatus],\n        stepsSummary: [\n          stepSummary('done'),\n          stepSummary('error'),\n          stepSummary('in_progress'),\n          stepSummary('skipped'),\n          stepSummary('not_started'),\n        ],\n        msgSpread: spread,\n      };\n    },\n\n    get steps() {\n      const selectedSteps = self.workflow.selectedSteps || [];\n      const getStep = index => _.nth(selectedSteps, index);\n      const strip = (pre, msg, color) => {\n        if (_.startsWith(msg, pre)) {\n          return {\n            match: true,\n            parsed: msg.substring(pre.length),\n            color,\n          };\n        }\n        return {\n          match: false,\n          parsed: msg,\n        };\n      };\n      const parse = msg => {\n        if (_.isEmpty(msg)) return {};\n        let item = strip('WARN|||', msg, 'orange');\n        if (!item.match) {\n          item = strip('ERR|||', msg, 'red');\n          if (!item.match) {\n            item = strip('INFO|||', msg, 'green');\n          }\n        }\n\n        return item;\n      };\n      const result = [];\n\n      _.forEach(self.stStatuses, (stepStatus, index) => {\n        const step = getStep(index) || {};\n        const msgObj = parse(stepStatus.msg);\n        result.push({\n          statusMsg: msgObj.parsed,\n          statusLabel: _.startCase(stepStatus.status),\n          statusColor: msgObj.color || statusColorMap[stepStatus.status],\n          stepTemplateId: step.stepTemplateId || 'unknown',\n          stepTemplateVer: step.stepTemplateVer,\n          title: step.title || 'Not available',\n          startTime: stepStatus.startTime,\n          endTime: stepStatus.endTime,\n        });\n      });\n\n      return result;\n    },\n  }));\n\n// ==================================================================\n// WorkflowVersion\n// ==================================================================\nconst WorkflowVersion = types\n  .model('WorkflowVersion', {\n    id: '',\n    v: types.number,\n    rev: types.maybe(types.number),\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n    title: '',\n    desc: '',\n    instanceTtl: types.maybeNull(types.number),\n    runSpec: RunSpec,\n    stepsOrderChanged: types.boolean,\n    selectedSteps: types.optional(types.array(WorkflowStep), []),\n    instancesMap: types.optional(types.map(WorkflowInstance), {}),\n    workflowTemplateId: '',\n    workflowTemplateVer: types.maybe(types.number),\n  })\n  .actions(self => ({\n    setWorkflowVersion(version) {\n      const instancesMap = detach(self.instancesMap); // preserve the instances value\n      applySnapshot(self, version);\n      self.instancesMap = instancesMap;\n    },\n\n    // important \"instances\" is expected to be an array\n    setInstances(instances = []) {\n      consolidateToMap(self.instancesMap, instances, (exiting, newItem) => {\n        exiting.setWorkflowInstance(newItem);\n      });\n    },\n\n    setInstance(instance) {\n      self.instancesMap.put(instance);\n    },\n\n    setTitle(title) {\n      self.title = title;\n    },\n\n    setDescription(desc) {\n      self.desc = desc;\n    },\n\n    setInstanceTtl(value) {\n      let answer = null;\n      if (_.isString(value)) {\n        const parsed = parseInt(value, 10);\n        if (_.isNaN(parsed)) answer = null;\n        else answer = parsed;\n      } else if (_.isNumber(value)) {\n        answer = value;\n      }\n\n      self.instanceTtl = answer;\n    },\n\n    setRunSpec(runSpec) {\n      applySnapshot(self.runSpec, runSpec);\n    },\n\n    reinsertStep(currentIndex, targetIndex) {\n      const current = self.selectedSteps[currentIndex];\n\n      detach(current);\n      self.selectedSteps.splice(targetIndex, 0, current); // this will reattach the step\n    },\n\n    removeStep(idOrStep) {\n      const step = _.isString(idOrStep) ? self.getStep(idOrStep) : idOrStep;\n      self.selectedSteps.remove(step);\n    },\n\n    addStep(step) {\n      const { id, v, skippable, title, desc } = step;\n      const workflowStep = WorkflowStep.create(\n        {\n          id: generateId('wf-step'),\n          stepTemplateId: id,\n          stepTemplateVer: v,\n          title,\n          desc,\n          skippable,\n        },\n        getEnv(self),\n      );\n\n      workflowStep.makeNew();\n      self.selectedSteps.push(workflowStep);\n\n      return workflowStep;\n    },\n  }))\n\n  .views(self => ({\n    getStep(stepId) {\n      return _.find(self.selectedSteps, step => step.id === stepId);\n    },\n\n    get instances() {\n      const result = [];\n      self.instancesMap.forEach(value => {\n        // remember instancesMap is a Map not a simple object\n        result.push(value);\n      });\n\n      return result;\n    },\n\n    getInstance(id) {\n      return self.instancesMap.get(id);\n    },\n\n    get descHtml() {\n      const showdown = getEnv(self).showdown;\n      return showdown.convert(self.desc, self.assets); // TODO declare assets\n    },\n\n    get system() {\n      return self.createdBy.username === '_system_';\n    },\n\n    get propertySummaryRows() {\n      return [\n        {\n          title: titles.instanceTtl,\n          value: self.instanceTtl,\n        },\n        ...self.runSpec.propertySummaryRows,\n      ];\n    },\n\n    // This is the workflow template version\n    get template() {\n      const templatesStore = getEnv(self).workflowTemplatesStore;\n      const template = templatesStore.getTemplate(self.workflowTemplateId);\n      if (!template) return undefined;\n      return template.getVersion(self.workflowTemplateVer);\n    },\n\n    get canRearrangeSteps() {\n      const template = self.template;\n      if (!template) return false;\n      return template.canWorkflowRearrangeSteps;\n    },\n\n    canOverrideProp(prop) {\n      const template = self.template;\n      if (!template) return false;\n      return template.canWorkflowOverrideProp(prop);\n    },\n\n    get hasPendingInstances() {\n      return _.some(self.instances, ['pending', true]);\n    },\n  }));\n\n// ==================================================================\n// Workflow\n// ==================================================================\nconst Workflow = types\n  .model('Workflow', {\n    id: types.identifier,\n    versions: types.optional(types.array(WorkflowVersion), []),\n    assignments: types.optional(types.array(WorkflowAssignment), []),\n  })\n  .actions(self => ({\n    setWorkflow(workflow) {\n      // we try to preserve any existing version objects and update their content instead\n      const mapOfExisting = _.keyBy(self.versions, version => version.v.toString());\n      const processed = [];\n\n      _.forEach(workflow.versions, workflowVersion => {\n        const existing = mapOfExisting[workflowVersion.v];\n        if (existing) {\n          existing.setWorkflowVersion(workflowVersion);\n          processed.push(existing);\n        } else {\n          processed.push(WorkflowVersion.create(workflowVersion));\n        }\n      });\n\n      self.versions.replace(processed);\n    },\n\n    setAssignments(assignments) {\n      // we try to preserve any existing assignment objects and update their content instead\n      const mapOfExisting = _.keyBy(self.assignments, 'id');\n      const processed = [];\n\n      _.forEach(assignments, assignment => {\n        const existing = mapOfExisting[assignment.id];\n        if (existing) {\n          existing.setWorkflowAssignment(assignment);\n          processed.push(existing);\n        } else {\n          processed.push(WorkflowAssignment.create(assignment));\n        }\n      });\n\n      self.assignments.replace(processed);\n    },\n  }))\n\n  .views(self => ({\n    get latest() {\n      // we loop through all 'v' numbers and pick the workflow with the largest 'v' value\n      let largestVersion = self.versions[0];\n      _.forEach(self.versions, version => {\n        if (version.v > largestVersion.v) {\n          largestVersion = version;\n        }\n      });\n      return largestVersion;\n    },\n\n    getVersion(v) {\n      return _.find(self.versions, ['v', v]);\n    },\n\n    get versionNumbers() {\n      return _.map(self.versions, version => version.v);\n    },\n  }));\n\n// Given an array of [ { id, v: 0, ... }, { id, v:1, ... } ]\n// return an array of the grouping of the workflow versions based on their ids\n// [ { id, versions: [ ... ] }, { id, versions: [ ... ] }, ...]\nfunction toWorkflows(versions) {\n  const map = {};\n  _.forEach(versions, version => {\n    const id = version.id;\n    const entry = map[id] || { id, versions: [] };\n    entry.versions.push(version);\n    map[id] = entry;\n  });\n\n  return _.values(map);\n}\n\nexport { Workflow, WorkflowVersion, WorkflowInstance, toWorkflows };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types, applySnapshot } from 'mobx-state-tree';\nimport { WorkflowVersion } from '../Workflow';\n\n// ==================================================================\n// WorkflowDraft\n// ==================================================================\nconst WorkflowDraft = types\n  .model('WorkflowDraft', {\n    id: types.identifier,\n    rev: types.maybe(types.number),\n    uid: '',\n    username: types.maybeNull(types.optional(types.string, '')),\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n    workflowId: '',\n    workflowVer: types.maybe(types.number),\n    templateId: '',\n    templateVer: types.maybe(types.number),\n    workflow: WorkflowVersion,\n  })\n  .actions(self => ({\n    setWorkflowDraft(draft) {\n      applySnapshot(self, draft);\n    },\n\n    setRev(rev) {\n      self.rev = rev;\n    },\n  }))\n\n  .views(_self => ({}));\n\nexport default WorkflowDraft;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getSnapshot, getEnv } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport {\n  getWorkflowDrafts,\n  createWorkflowDraft,\n  updateWorkflowDraft,\n  publishWorkflowDraft,\n  deleteWorkflowDraft,\n} from '../../../helpers/api';\nimport WorkflowDraft from './WorkflowDraft';\n\n// ==================================================================\n// WorkflowDraftsStore\n// ==================================================================\nconst WorkflowDraftsStore = BaseStore.named('WorkflowDraftsStore')\n  .props({\n    drafts: types.optional(types.map(WorkflowDraft), {}),\n    tickPeriod: 900 * 1000, // 15 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    // private\n    function normalizeForSubmission(draft) {\n      const normalizedDraft = _.cloneDeep(getSnapshot(draft));\n      _.forEach(normalizedDraft.workflow.selectedSteps, step => {\n        delete step.stepTemplate;\n        delete step.configOverrideOption;\n        delete step.propsOverrideOption;\n      });\n\n      delete normalizedDraft.workflow.stepsOrderChanged;\n      delete normalizedDraft.workflow.instancesMap;\n      return normalizedDraft;\n    }\n\n    return {\n      async doLoad() {\n        const drafts = await getWorkflowDrafts();\n\n        // We try to preserve existing drafts data and merge the new data instead\n        // We could have used self.drafts.replace(), but it will do clear() then merge()\n        self.runInAction(() => {\n          const previousKeys = {};\n          self.drafts.forEach((_value, key) => {\n            previousKeys[key] = true;\n          });\n          drafts.forEach(draft => {\n            const id = draft.id;\n            const hasPrevious = self.drafts.has(id);\n\n            self.addDraft(draft);\n\n            if (hasPrevious) {\n              delete previousKeys[id];\n            }\n          });\n\n          _.forEach(previousKeys, (_value, key) => {\n            self.drafts.delete(key);\n          });\n        });\n      },\n\n      addDraft(rawDraft) {\n        const id = rawDraft.id;\n        const previous = self.drafts.get(id);\n\n        if (!previous) {\n          self.drafts.put(rawDraft);\n        } else {\n          previous.setWorkflowDraft(rawDraft);\n        }\n      },\n\n      async updateDraft(draft) {\n        const id = draft.id;\n        const previous = self.drafts.get(id);\n        if (previous === undefined) throw new Error(`Workflow Draft \"${id}\" does not exist`);\n\n        const updated = await updateWorkflowDraft(normalizeForSubmission(draft));\n        previous.setWorkflowDraft(updated);\n\n        return previous;\n      },\n\n      async createDraft({ isNewWorkflow, workflowId, templateId }) {\n        const draft = await createWorkflowDraft({ isNewWorkflow, workflowId, templateId });\n        self.addDraft(draft);\n\n        return draft;\n      },\n\n      async publishDraft(draft) {\n        const id = draft.id;\n        const previous = self.drafts.get(id);\n        if (previous === undefined) throw new Error(`Workflow Draft \"${id}\" does not exist`);\n\n        const publishResult = await publishWorkflowDraft(normalizeForSubmission(draft));\n        self.runInAction(() => {\n          if (!publishResult.hasErrors) self.drafts.delete(id);\n        });\n\n        return publishResult;\n      },\n\n      async deleteDraft(draft) {\n        const uiEventBus = getEnv(self).uiEventBus;\n        await deleteWorkflowDraft(draft);\n        await uiEventBus.fireEvent('workflowDraftDeleted', draft);\n        self.runInAction(() => {\n          self.drafts.delete(draft.id);\n        });\n      },\n\n      cleanup: () => {\n        self.drafts.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.drafts.size === 0;\n    },\n\n    get total() {\n      return self.drafts.size;\n    },\n\n    get list() {\n      const result = [];\n      self.drafts.forEach(drafts => result.push(drafts));\n\n      return _.reverse(_.sortBy(result, ['createdAt', 'title']));\n    },\n\n    hasWorkflow(workflowId) {\n      let found = false;\n      /* eslint-disable no-restricted-syntax, no-unused-vars */\n      for (const draft of self.drafts.values()) {\n        if (draft.workflow.id === workflowId) {\n          found = true;\n          break;\n        }\n      }\n      /* eslint-enable no-restricted-syntax, no-unused-vars */\n\n      return found;\n    },\n\n    hasDraft(draftId) {\n      return self.drafts.has(draftId);\n    },\n\n    getDraft(id) {\n      return self.drafts.get(id);\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.workflowDraftsStore = WorkflowDraftsStore.create({}, appContext);\n}\n\nexport { WorkflowDraftsStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getParent } from 'mobx-state-tree';\nimport { BaseStore, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getWorkflowInstances, triggerWorkflow } from '../../helpers/api';\n\n// ==================================================================\n// WorkflowInstancesStore\n// ==================================================================\nconst WorkflowInstancesStore = BaseStore.named('WorkflowInstancesStore')\n  .props({\n    workflowId: '',\n    workflowVer: types.number,\n    tickPeriod: 300 * 1000, // 5 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const parent = getParent(self, 2);\n        if (!isStoreReady(parent)) {\n          await parent.load();\n        }\n        const instances = await getWorkflowInstances(self.workflowId, self.workflowVer);\n        self.runInAction(() => {\n          const version = self.version;\n          if (!version) throw new Error(`Workflow \"${self.workflowId}\" v${self.workflowVer} does not exist`);\n          version.setInstances(instances);\n          if (version.hasPendingInstances) {\n            self.setFastTickPeriod();\n          } else {\n            self.setSlowTickPeriod();\n          }\n        });\n      },\n\n      async triggerWorkflow({ input }) {\n        const result = await triggerWorkflow(self.workflowId, self.workflowVer, { input });\n        self.runInAction(() => {\n          const version = self.version;\n          if (!version) throw new Error(`Workflow \"${self.workflowId}\" v${self.workflowVer} does not exist`);\n          version.setInstance(result.instance);\n          if (version.hasPendingInstances) {\n            self.setFastTickPeriod();\n          } else {\n            self.setSlowTickPeriod();\n          }\n        });\n\n        return result;\n      },\n\n      setSlowTickPeriod() {\n        self.changeTickPeriod(300 * 1000); // 5 minutes\n      },\n\n      setFastTickPeriod() {\n        self.changeTickPeriod(5 * 1000); // 5 seconds\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get instances() {\n      const version = self.version;\n      if (!version) return [];\n      return version.instances;\n    },\n\n    get version() {\n      const parent = getParent(self, 2);\n      const workflow = parent.workflow;\n      if (!workflow) return undefined;\n      return workflow.getVersion(self.workflowVer);\n    },\n\n    get empty() {\n      return self.instances.length === 0;\n    },\n\n    get total() {\n      return self.instances.length;\n    },\n\n    get list() {\n      const result = self.instances.slice();\n\n      return _.reverse(_.sortBy(result, ['createdAt']));\n    },\n\n    getInstance(id) {\n      return self.instancesMap.get(id);\n    },\n\n    hasInstance(id) {\n      return self.instancesMap.has(id);\n    },\n  }));\n\n// Note: Do NOT register this in the app context, if you want to gain access to an instance\n//       use WorkflowStore.getWorkflowInstancesStore()\nexport default WorkflowInstancesStore;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types, getParent } from 'mobx-state-tree';\nimport { BaseStore, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getWorkflowInstance } from '../../helpers/api';\n\n// ==================================================================\n// WorkflowInstanceStore\n// ==================================================================\nconst WorkflowInstanceStore = BaseStore.named('WorkflowInstanceStore')\n  .props({\n    workflowId: '',\n    workflowVer: types.number,\n    instanceId: '',\n    tickPeriod: 300 * 1000, // 5 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const parent = getParent(self, 2);\n        if (!isStoreReady(parent)) {\n          await parent.load();\n        }\n        const instance = await getWorkflowInstance(self.workflowId, self.workflowVer, self.instanceId);\n        self.runInAction(() => {\n          const version = self.version;\n          if (!version) throw new Error(`Workflow \"${self.workflowId}\" v${self.workflowVer} does not exist`);\n          version.setInstance(instance);\n          const instanceMst = version.getInstance(self.instanceId);\n          if (instanceMst && instanceMst.pending) {\n            self.setFastTickPeriod();\n          } else {\n            self.setSlowTickPeriod();\n          }\n        });\n      },\n\n      setSlowTickPeriod() {\n        self.changeTickPeriod(300 * 1000); // 5 minutes\n      },\n\n      setFastTickPeriod() {\n        self.changeTickPeriod(5 * 1000); // 5 seconds\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get version() {\n      const parent = getParent(self, 2);\n      const workflow = parent.workflow;\n      if (!workflow) return undefined;\n      return workflow.getVersion(self.workflowVer);\n    },\n  }));\n\n// Note: Do NOT register this in the app context, if you want to gain access to an instance\n//       use WorkflowStore.getWorkflowInstanceStore()\nexport default WorkflowInstanceStore;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { getParent } from 'mobx-state-tree';\nimport { BaseStore, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getWorkflowAssignments } from '../../helpers/api';\n\n// ==================================================================\n// WorkflowAssignmentsStore\n// ==================================================================\nconst WorkflowAssignmentsStore = BaseStore.named('WorkflowAssignmentsStore')\n  .props({\n    workflowId: '',\n    tickPeriod: 300 * 1000, // 5 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const parent = getParent(self, 2);\n        if (!isStoreReady(parent)) {\n          await parent.load();\n        }\n        const assignments = await getWorkflowAssignments(self.workflowId);\n        self.runInAction(() => {\n          const workflow = self.workflow;\n          if (!workflow) throw new Error(`Workflow \"${self.workflowId}\" does not exist`);\n          workflow.setAssignments(assignments);\n        });\n      },\n\n      cleanup: () => {\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get assignments() {\n      const workflow = self.workflow;\n      if (!workflow) return [];\n      return workflow.assignments;\n    },\n\n    get workflow() {\n      const parent = getParent(self, 2);\n      return parent.workflow;\n    },\n\n    get empty() {\n      return self.assignments.length === 0;\n    },\n\n    get total() {\n      return self.assignments.length;\n    },\n\n    get list() {\n      const result = self.assignments.slice();\n\n      return _.reverse(_.sortBy(result, ['createdAt']));\n    },\n  }));\n\n// Note: Do NOT register this in the app context, if you want to gain access to an instance\n//       use WorkflowStore.getWorkflowAssignmentsStore()\nexport default WorkflowAssignmentsStore;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getParent } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getWorkflow } from '../../helpers/api';\nimport { toWorkflows } from './Workflow';\nimport WorkflowInstancesStore from './WorkflowInstancesStore';\nimport WorkflowInstanceStore from './WorkflowInstanceStore';\nimport WorkflowAssignmentsStore from './WorkflowAssignmentsStore';\n\n// ==================================================================\n// WorkflowStore\n// ==================================================================\nconst WorkflowStore = BaseStore.named('WorkflowStore')\n  .props({\n    workflowId: '',\n    instancesStores: types.optional(types.map(WorkflowInstancesStore), {}),\n    instanceStores: types.optional(types.map(WorkflowInstanceStore), {}),\n    assignmentsStore: types.optional(types.map(WorkflowAssignmentsStore), {}),\n    tickPeriod: 300 * 1000, // 5 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const parent = getParent(self, 2);\n        const workflowRaw = await getWorkflow(self.workflowId);\n        const workflow = _.first(toWorkflows(workflowRaw));\n        parent.addWorkflow(workflow);\n      },\n\n      getInstancesStore: (workflowId, workflowVer) => {\n        const encodedId = `${workflowId}__${workflowVer}`;\n        let entry = self.instancesStores.get(encodedId);\n        if (!entry) {\n          // Lazily create a WorkflowInstancesStore for each workflow version\n          self.instancesStores.set(encodedId, WorkflowInstancesStore.create({ workflowId, workflowVer }));\n          entry = self.instancesStores.get(encodedId);\n        }\n\n        return entry;\n      },\n\n      getInstanceStore: (workflowVer, instanceId) => {\n        const workflowId = self.workflowId;\n        const encodedId = `${workflowId}__${workflowVer}__${instanceId}`;\n        let entry = self.instanceStores.get(encodedId);\n        if (!entry) {\n          // Lazily create a WorkflowInstanceStore for each workflow version\n          self.instanceStores.set(encodedId, WorkflowInstanceStore.create({ workflowId, workflowVer, instanceId }));\n          entry = self.instanceStores.get(encodedId);\n        }\n\n        return entry;\n      },\n\n      getAssignmentsStore: () => {\n        const workflowId = self.workflowId;\n        let entry = self.assignmentsStore.get(workflowId);\n        if (!entry) {\n          // Lazily create a WorkflowAssignmentsStore for each workflow\n          self.assignmentsStore.set(workflowId, WorkflowAssignmentsStore.create({ workflowId }));\n          entry = self.assignmentsStore.get(workflowId);\n        }\n\n        return entry;\n      },\n\n      cleanup: () => {\n        self.instancesStores.clear();\n        self.instanceStores.clear();\n        self.assignmentsStore.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get workflow() {\n      const parent = getParent(self, 2);\n      const w = parent.getWorkflow(self.workflowId);\n      return w;\n    },\n  }));\n\n// Note: Do NOT register this in the global context, if you want to gain access to an instance\n//       use WorkflowsStore.getWorkflowStore()\nexport default WorkflowStore;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { uiEventBus } from '@aws-ee/base-ui/dist/models/SessionStore';\n\nimport { getWorkflows } from '../../helpers/api';\nimport { Workflow, toWorkflows } from './Workflow';\nimport WorkflowStore from './WorkflowStore';\n\n// ==================================================================\n// WorkflowsStore\n// ==================================================================\nconst WorkflowsStore = BaseStore.named('WorkflowsStore')\n  .props({\n    workflows: types.optional(types.map(Workflow), {}),\n    workflowStores: types.optional(types.map(WorkflowStore), {}),\n    tickPeriod: 900 * 1000, // 15 minutes\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const versions = await getWorkflows();\n        const workflows = toWorkflows(versions);\n\n        // we try to preserve existing workflow versions data and merge the new data instead\n        self.runInAction(() => {\n          const previousKeys = {};\n          self.workflows.forEach((_value, key) => {\n            previousKeys[key] = true;\n          });\n          workflows.forEach(workflow => {\n            const id = workflow.id;\n            const hasPrevious = self.workflows.has(id);\n\n            self.addWorkflow(workflow);\n\n            if (hasPrevious) {\n              delete previousKeys[id];\n            }\n          });\n\n          _.forEach(previousKeys, (_value, key) => {\n            self.workflows.delete(key);\n          });\n        });\n      },\n\n      addWorkflow(rawWorkflow) {\n        if (!rawWorkflow) return;\n        const id = rawWorkflow.id;\n        const previous = self.workflows.get(id);\n\n        if (!previous) {\n          self.workflows.put(rawWorkflow);\n        } else {\n          previous.setWorkflow(rawWorkflow);\n        }\n      },\n\n      getWorkflowStore: workflowId => {\n        let entry = self.workflowStores.get(workflowId);\n        if (!entry) {\n          // Lazily create the store\n          self.workflowStores.set(workflowId, WorkflowStore.create({ workflowId }));\n          entry = self.workflowStores.get(workflowId);\n        }\n\n        return entry;\n      },\n\n      cleanup: () => {\n        self.workflows.clear();\n        self.workflowStores.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.workflows.size === 0;\n    },\n\n    get total() {\n      return self.workflows.size;\n    },\n\n    get list() {\n      const result = [];\n      self.workflows.forEach(workflow => result.push(workflow));\n\n      return _.reverse(_.sortBy(result, ['latest.createdAt', 'title']));\n    },\n\n    getWorkflow(id) {\n      return self.workflows.get(id);\n    },\n\n    hasWorkflow(id) {\n      return self.workflows.has(id);\n    },\n\n    asDropDownOptions() {\n      const result = [];\n      self.workflows.forEach(wf => {\n        const latestWfVersion = wf.latest.v;\n        wf.versions.forEach(wfv => {\n          result.push({\n            key: wf.id,\n            value: JSON.stringify({ wid: wf.id, wrv: wfv.v }),\n            text: wfv.v === latestWfVersion ? `${wf.id} (latest)` : `${wf.id} (v${wfv.v})`,\n            // content:\n            //   wfv.v === latestWfVersion ? (\n            //     <Label as=\"a\" color=\"blue\" image>\n            //       {wf.id}\n            //       <Label.Detail>latest version</Label.Detail>\n            //     </Label>\n            //   ) : (\n            //     <Label as=\"a\" color=\"grey\" image>\n            //       {wf.id}\n            //       <Label.Detail>v{wfv.v}</Label.Detail>\n            //     </Label>\n            //   ),\n          });\n        });\n      });\n      return result;\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.workflowsStore = WorkflowsStore.create({}, appContext);\n\n  uiEventBus.listenTo('workflowPublished', {\n    id: 'WorkflowsStore',\n    listener: async _event => {\n      appContext.workflowsStore.cleanup();\n    },\n  });\n}\n\nexport { WorkflowsStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport * as envTypesStore from '../models/environment-types/EnvTypesStore';\nimport * as envTypeCandidatesStore from '../models/environment-types/EnvTypeCandidatesStore';\n\n// eslint-disable-next-line no-unused-vars\nfunction registerAppContextItems(appContext) {\n  envTypesStore.registerContextItems(appContext);\n  envTypeCandidatesStore.registerContextItems(appContext);\n}\n\n// eslint-disable-next-line no-unused-vars\nfunction postRegisterAppContextItems(appContext) {\n  // No impl at this level\n}\n\nconst plugin = {\n  registerAppContextItems,\n  postRegisterAppContextItems,\n};\n\nexport default plugin;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\n/**\n * Adds workflow navigation menu items to the given itemsMap.\n *\n * @param itemsMap A Map containing navigation items. This object is a Map that has route paths (urls) as\n * keys and menu item object with the following shape\n *\n *   {\n *    title: STRING, // Title for the navigation menu item\n *    icon: STRING, // semantic ui icon name fot the navigation menu item\n *    shouldShow: BOOLEAN || FUNCTION, // A flag or a function that returns a flag indicating whether to show the item or not (useful when showing menu items conditionally)\n *    render: OPTIONAL FUNCTION, // Optional function that returns rendered menu item component. Use this ONLY if you want to control full rendering of the menu item.\n *   }\n *\n * @param context A context object containing all various stores\n *\n * @returns Map<*> Returns A Map containing navigation menu items with the same shape as \"itemsMap\"\n */\n// eslint-disable-next-line no-unused-vars\nfunction registerMenuItems(itemsMap, { location, appContext }) {\n  const isAdmin = _.get(appContext, 'userStore.user.isAdmin');\n  const showEnvTypeManagement = _.get(appContext, 'showEnvTypeManagement', true);\n  const items = new Map([\n    ...itemsMap,\n    [\n      '/workspace-types-management',\n      {\n        title: (\n          <>\n            Workspace\n            <br />\n            Types\n          </>\n        ),\n        icon: 'computer',\n        shouldShow: isAdmin && showEnvTypeManagement,\n      },\n    ],\n  ]);\n\n  return items;\n}\nconst plugin = {\n  registerMenuItems,\n};\nexport default plugin;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\nimport { sessionStore, uiEventBus } from '@aws-ee/base-ui/dist/models/SessionStore';\n\nconst WorkflowCommonUIState = types\n  .model('WorkflowCommonUIState', {\n    versionNumber: -1,\n    mainTabIndex: 0,\n  })\n  .actions(self => ({\n    setVersionNumber(v) {\n      self.versionNumber = v;\n    },\n    setMainTabIndex(index) {\n      self.mainTabIndex = index;\n    },\n  }));\n\nfunction getUIState(idSuffix) {\n  const id = `WorkflowCommonUIState-${idSuffix}`;\n  const entry = sessionStore.map.get(id) || WorkflowCommonUIState.create();\n\n  sessionStore.map.set(id, entry);\n  return entry;\n}\n\nuiEventBus.listenTo('workflowTemplatePublished', {\n  id: 'WorkflowCommonUIState',\n  listener: async event => {\n    sessionStore.removeStartsWith(`WorkflowCommonUIState-${event.id}`);\n  },\n});\n\nuiEventBus.listenTo('workflowPublished', {\n  id: 'WorkflowCommonUIState',\n  listener: async event => {\n    sessionStore.removeStartsWith(`WorkflowCommonUIState-${event.id}`);\n  },\n});\n\nexport default getUIState;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Table } from 'semantic-ui-react';\n\n// expected props\n// - rows (via props), an array of objects, [ { title, value }, { title, value }, ... ]\n// - className (via props)\nconst Component = observer(({ rows = [], className = '' }) => {\n  if (rows.length === 0) return null;\n\n  return (\n    <Table basic=\"very\" className={`animated ${className}`}>\n      <Table.Header>\n        <Table.Row>\n          <Table.HeaderCell width={10}>Property</Table.HeaderCell>\n          <Table.HeaderCell width={6}>Value</Table.HeaderCell>\n        </Table.Row>\n      </Table.Header>\n      <Table.Body>\n        {_.map(rows, (item, index) => (\n          <Table.Row key={index}>\n            <Table.Cell width={10}>{item.title}</Table.Cell>\n            <Table.Cell width={6}>{convert(item.value)}</Table.Cell>\n          </Table.Row>\n        ))}\n      </Table.Body>\n    </Table>\n  );\n});\n\nfunction convert(value) {\n  return _.isNil(value) ? 'Not Provided' : value.toString();\n}\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Table, Icon } from 'semantic-ui-react';\nimport c from 'classnames';\nimport Toggle from '@aws-ee/base-ui/dist/parts/helpers/fields/Toggle';\n\n// expected props\n// - rows (via props), an array of objects, [ { name, title, allowed }, { name, title, allowed }, ... ], if editable = false\n//                     otherwise the array is expected to be an array of mobx form fields instances\n// - editable (via props), is this a toggle table?\n// - className (via props)\nconst Component = observer(({ rows = [], className = '', editable = false, processing = false }) => {\n  if (rows.length === 0) return null;\n  const getTitle = item => (editable ? item.label : item.title);\n\n  return (\n    <Table basic=\"very\" className={c('animated', className)}>\n      <Table.Header>\n        <Table.Row>\n          <Table.HeaderCell width={10}>Property</Table.HeaderCell>\n          <Table.HeaderCell width={6}>Can be changed?</Table.HeaderCell>\n        </Table.Row>\n      </Table.Header>\n      <Table.Body>\n        {_.map(rows, (item, index) => (\n          <Table.Row key={`${index}-${getTitle(item)}`}>\n            <Table.Cell>{getTitle(item)}</Table.Cell>\n            <Table.Cell>\n              {!editable && convert(item.allowed)}\n              {editable && <Toggle field={item} disabled={processing} show=\"toggleOnly\" className=\"mb0\" />}\n            </Table.Cell>\n          </Table.Row>\n        ))}\n      </Table.Body>\n    </Table>\n  );\n});\n\nfunction convert(allowed) {\n  if (allowed)\n    return (\n      <span className=\"op-3\">\n        <Icon name=\"toggle on\" color=\"blue\" size=\"large\" className=\"mr1\" />\n        Yes\n      </span>\n    );\n  return (\n    <span className=\"op-3\">\n      <Icon name=\"toggle off\" size=\"large\" color=\"grey\" className=\"mr1\" />\n      No\n    </span>\n  );\n}\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Segment } from 'semantic-ui-react';\n\nimport PropertyTable from './PropertyTable';\nimport PropertyOverrideTable from './PropertyOverrideTable';\n\n// expected props\n// - model (via props) with two properties: propertySummaryRows and propertyOverrideSummaryRows\n// - message (via props), a message to display when both rows are empty\n// - className (via props)\nconst Component = observer(({ model = {}, className = '', message = 'No properties are available' }) => {\n  const propertyRows = model.propertySummaryRows || [];\n  const hasPropertyRows = propertyRows.length > 0;\n  const propertyOverrideRows = model.propertyOverrideSummaryRows || [];\n  const hasPropertyOverrideRows = propertyOverrideRows.length > 0;\n  const empty = !hasPropertyRows && !hasPropertyOverrideRows;\n\n  return (\n    <>\n      {hasPropertyRows && (\n        <Segment padded>\n          <PropertyTable rows={propertyRows} />\n        </Segment>\n      )}\n      {hasPropertyOverrideRows && (\n        <Segment padded>\n          <PropertyOverrideTable rows={propertyOverrideRows} />\n        </Segment>\n      )}\n      {empty && <div className={`${className}`}>{message}</div>}\n    </>\n  );\n});\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Table, Icon } from 'semantic-ui-react';\nimport c from 'classnames';\nimport Toggle from '@aws-ee/base-ui/dist/parts/helpers/fields/Toggle';\n\n// expected props\n// - rows (via props), an array of objects, [ { name, title, allowed }, { name, title, allowed }, ... ], if editable = false\n//                     otherwise the array is expected to be an array of mobx form fields instances\n// - editable (via props), is this a toggle table?\n// - className (via props)\nconst Component = observer(({ rows = [], className = '', editable = false, processing = false }) => {\n  if (rows.length === 0) return null;\n  const getTitle = item => (editable ? item.label : item.title);\n\n  return (\n    <Table basic=\"very\" className={c('animated', className)}>\n      <Table.Header>\n        <Table.Row>\n          <Table.HeaderCell width={10}>Key</Table.HeaderCell>\n          <Table.HeaderCell width={6}>Can be changed?</Table.HeaderCell>\n        </Table.Row>\n      </Table.Header>\n      <Table.Body>\n        {_.map(rows, (item, index) => (\n          <Table.Row key={`${index}-${getTitle(item)}`}>\n            <Table.Cell>{renderKey({ name: item.name, title: getTitle(item) })}</Table.Cell>\n            <Table.Cell>\n              {!editable && renderValue(item)}\n              {editable && <Toggle field={item} disabled={processing} show=\"toggleOnly\" className=\"mb0\" />}\n            </Table.Cell>\n          </Table.Row>\n        ))}\n      </Table.Body>\n    </Table>\n  );\n});\n\nfunction renderValue({ allowed }) {\n  if (allowed)\n    return (\n      <span className=\"op-3\">\n        <Icon name=\"toggle on\" color=\"blue\" size=\"large\" className=\"mr1\" />\n        Yes\n      </span>\n    );\n  return (\n    <span className=\"op-3\">\n      <Icon name=\"toggle off\" size=\"large\" color=\"grey\" className=\"mr1\" />\n      No\n    </span>\n  );\n}\n\nfunction renderKey({ title = '', name }) {\n  const hasTitle = !_.isEmpty(title);\n\n  if (hasTitle) {\n    return (\n      <>\n        <div>{title}</div>\n        <div className=\"fs-7 color-grey\">{name}</div>\n      </>\n    );\n  }\n  return <div>{name}</div>;\n}\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Segment } from 'semantic-ui-react';\nimport ConfigTable from '@aws-ee/base-ui/dist/parts/configuration/ConfigTable';\n\nimport ConfigOverrideTable from './ConfigOverrideTable';\n\n// expected props\n// - model (via props) with two properties: configSummaryRows and configOverrideSummaryRows\n// - message (via props), a message to display when both rows are empty\n// - className (via props)\nconst Component = observer(({ model = {}, className = '', message = 'No configuration entries are available' }) => {\n  const configRows = model.configSummaryRows || [];\n  const hasConfigRows = configRows.length > 0;\n  const configOverrideRows = model.configOverrideSummaryRows || [];\n  const hasConfigOverrideRows = configOverrideRows.length > 0;\n  const empty = !hasConfigRows && !hasConfigOverrideRows;\n\n  return (\n    <>\n      {hasConfigRows && (\n        <Segment padded>\n          <ConfigTable rows={configRows} />\n        </Segment>\n      )}\n      {hasConfigOverrideRows && (\n        <Segment padded>\n          <ConfigOverrideTable rows={configOverrideRows} />\n        </Segment>\n      )}\n      {empty && <div className={`${className}`}>{message}</div>}\n    </>\n  );\n});\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, runInAction, action, observable } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport { Accordion, Icon, Divider } from 'semantic-ui-react';\n\nimport PropertySection from './PropertySection';\nimport ConfigSection from './ConfigSection';\n\n// expected props\n// - step - an instance of WorkflowTemplateStep model (via props)\n// - location (from react router)\nclass WorkflowTemplateStep extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.expanded = false;\n    });\n  }\n\n  getWorkflowTemplateStep() {\n    return this.props.step;\n  }\n\n  getStepTemplate() {\n    return this.getWorkflowTemplateStep().stepTemplate;\n  }\n\n  handleOnExpand = () => {\n    this.expanded = !this.expanded;\n  };\n\n  render() {\n    const step = this.getWorkflowTemplateStep();\n    const expanded = this.expanded;\n    return (\n      <Accordion className=\"flex-auto overflow-hidden pr1\">\n        <Accordion.Title active={expanded} index={0} onClick={this.handleOnExpand}>\n          <div className=\"flex mt1 mb1\">\n            <Icon name=\"dropdown\" className=\"inline-block\" style={{ marginTop: '3px' }} />\n            <div className=\"ellipsis flex-auto\">{step.derivedTitle || step.title}</div>\n            <div className=\"ellipsis pl1 pr1 breakout fs-9 color-grey\">\n              {step.templateId} v{step.templateVer}\n            </div>\n          </div>\n        </Accordion.Title>\n        <Accordion.Content active={expanded} className=\"animated pt3 pl2 pr2 pb2 mb2\">\n          {this.renderDescriptionSection(step)}\n          {this.renderConfigurationSection(step)}\n          {this.renderPropertiesSection(step)}\n        </Accordion.Content>\n      </Accordion>\n    );\n  }\n\n  renderDescriptionSection(step) {\n    /* eslint-disable react/no-danger */\n    return (\n      <>\n        <Icon name=\"file alternate outline\" className=\"mr1 color-grey\" />\n        <b>Description</b>\n        <Divider className=\"mt1\" />\n        <div className=\"mb4\" dangerouslySetInnerHTML={{ __html: step.descHtml }} />\n      </>\n    );\n    /* eslint-enable react/no-danger */\n  }\n\n  renderConfigurationSection(step) {\n    return (\n      <div className=\"mb4\">\n        <Icon name=\"cog\" className=\"mr1 color-grey\" />\n        <b>Configuration</b>\n        <Divider className=\"mt1 mb3\" />\n        <ConfigSection model={step} />\n      </div>\n    );\n  }\n\n  renderPropertiesSection(step) {\n    return (\n      <>\n        <Icon name=\"list alternate outline\" className=\"mr1 color-grey\" />\n        <b>Properties</b>\n        <Divider className=\"mt1 mb3\" />\n        <PropertySection model={step} />\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowTemplateStep, {\n  expanded: observable,\n  handleOnExpand: action,\n});\n\nexport default inject()(withRouter(observer(WorkflowTemplateStep)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject, Observer } from 'mobx-react';\nimport { decorate, action } from 'mobx';\nimport { Tab, Grid, Label, Segment } from 'semantic-ui-react';\n\nimport PropertySection from './PropertySection';\n\nimport WorkflowTemplateStep from './WorkflowTemplateStep';\n\n// expected props\n// - template - either a WorkflowTemplateVersion model instance (via props)\n// - uiState - to keep track of the active tab (via props)\n// - className (via props)\nclass WorkflowTemplateCardTabs extends React.Component {\n  getState() {\n    return this.props.uiState;\n  }\n\n  selectedMainTabIndex() {\n    return this.getState().mainTabIndex;\n  }\n\n  getTemplate() {\n    return this.props.template;\n  }\n\n  handleOnTabChange = (_event, data) => {\n    this.getState().setMainTabIndex(data.activeIndex);\n  };\n\n  render() {\n    const className = this.props.className || 'mt0';\n    const template = this.getTemplate();\n\n    const activeIndex = this.selectedMainTabIndex();\n    /* eslint-disable react/no-danger */\n    const panes = [\n      {\n        menuItem: 'Description',\n        render: () => (\n          <Tab.Pane basic attached={false}>\n            <Observer>\n              {() => <div className=\"animated\" dangerouslySetInnerHTML={{ __html: template.descHtml }} />}\n            </Observer>\n          </Tab.Pane>\n        ),\n      },\n      {\n        menuItem: 'Steps',\n        render: () => (\n          <Tab.Pane basic attached={false}>\n            <Observer>{() => this.renderSteps(template)}</Observer>\n          </Tab.Pane>\n        ),\n      },\n      {\n        menuItem: 'Properties',\n        render: () => (\n          <Tab.Pane basic attached={false}>\n            <PropertySection model={template} />\n          </Tab.Pane>\n        ),\n      },\n    ];\n    /* eslint-enable react/no-danger */\n\n    return (\n      <Tab\n        className={className}\n        activeIndex={activeIndex}\n        menu={{ secondary: true, pointing: true }}\n        panes={panes}\n        onTabChange={this.handleOnTabChange}\n      />\n    );\n  }\n\n  renderSteps(template) {\n    const steps = template.selectedSteps || [];\n\n    if (steps.length === 0) {\n      return <span>No steps are provided</span>;\n    }\n\n    return (\n      <Grid padded={false} className=\"animated\">\n        {_.map(steps, (step, index) => (\n          <Grid.Row key={index} className=\"pb0\">\n            <Grid.Column width={1}>\n              <Label circular className=\"mt1 mb1\">\n                {index + 1}\n              </Label>\n            </Grid.Column>\n            <Grid.Column width={15}>\n              <Segment className=\"p0 pl1 flex\">\n                <WorkflowTemplateStep step={step} />\n              </Segment>\n            </Grid.Column>\n          </Grid.Row>\n        ))}\n      </Grid>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowTemplateCardTabs, {\n  handleOnTabChange: action,\n});\n\nexport default inject()(observer(WorkflowTemplateCardTabs));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, runInAction, action } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport TimeAgo from 'react-timeago';\nimport { Header, Dropdown, Label } from 'semantic-ui-react';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\n\nimport getUIState from '../workflow-common/component-states/WorkflowCommonCardState';\nimport WorkflowTemplateCardTabs from './WorkflowTemplateCardTabs';\n\n// expected props\n// - template - a WorkflowTemplate model instance (via props)\n// - v - the selected version number, will default to latest or existing state (via props)\n// - userDisplayName (via injection)\n// - location (from react router)\nclass WorkflowTemplateCard extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      const state = this.getState();\n      const versionSpecified = !_.isNil(this.props.v);\n      let v;\n\n      if (versionSpecified) {\n        v = this.props.v;\n      } else if (state.versionNumber === -1) {\n        v = this.props.template.latest.v;\n      } else {\n        v = state.versionNumber;\n      }\n      state.setVersionNumber(v);\n    });\n  }\n\n  getState() {\n    return getUIState(this.getTemplate().id);\n  }\n\n  selectedVersionNumber() {\n    return this.getState().versionNumber;\n  }\n\n  getTemplate() {\n    return this.props.template;\n  }\n\n  getTemplateVersion() {\n    const template = this.getTemplate();\n    const v = this.selectedVersionNumber();\n    const version = template.getVersion(v);\n    if (_.isEmpty(version)) {\n      // This is an error\n      displayError(`Version ${v} of this workflow template is not valid`);\n      return {};\n    }\n\n    return version;\n  }\n\n  getUserDisplayName() {\n    return this.props.userDisplayName;\n  }\n\n  handleOnVersionChange = ({ value = 1 }) => {\n    this.getState().setVersionNumber(value);\n  };\n\n  render() {\n    const templateVersion = this.getTemplateVersion();\n    const { id, v, title, createdAt, createdBy } = templateVersion;\n    const userDisplayName = this.getUserDisplayName();\n    const isSystem = userDisplayName.isSystem({ uid: createdBy });\n    const by = () =>\n      isSystem ? '' : <span className=\"ml1\">by {userDisplayName.getDisplayName({ uid: createdBy })}</span>;\n\n    return (\n      <>\n        <Label attached=\"top left\">Template</Label>\n        <div className=\"flex mb1\">\n          <Header as=\"h3\" color=\"grey\" className=\"mt0 flex-auto ellipsis\">\n            {title}\n            <Header.Subheader className=\"fs-9\">\n              created <TimeAgo date={createdAt} /> {by()}\n            </Header.Subheader>\n          </Header>\n          <div className=\"ml1\">\n            <span className=\"ellipsis pr1 fs-9 breakout color-grey\">{id}</span> {this.renderVersionDropdown(v)}\n          </div>\n        </div>\n        {this.renderMainTabs(templateVersion)}\n      </>\n    );\n  }\n\n  renderVersionDropdown(currentVersion) {\n    const template = this.getTemplate();\n    const versions = template.versionNumbers;\n    const options = _.map(versions, version => ({ text: `v${version}`, value: version }));\n\n    if (versions.length === 1) return <span className=\"bold color-grey pr2\">v{template.latest.v}</span>;\n\n    return (\n      <Dropdown\n        className=\"color-grey\"\n        inline\n        options={options}\n        value={currentVersion}\n        onChange={(e, data) => this.handleOnVersionChange(data)}\n      />\n    );\n  }\n\n  renderMainTabs(template) {\n    const uiState = this.getState();\n    return <WorkflowTemplateCardTabs template={template} uiState={uiState} />;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowTemplateCard, {\n  handleOnVersionChange: action,\n});\n\nexport default inject('userDisplayName')(withRouter(observer(WorkflowTemplateCard)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { Segment, Placeholder, Divider } from 'semantic-ui-react';\n\n// expected props\n// - segmentCount (via props)\n// - className (via props)\nconst Component = ({ segmentCount = 1 }) => {\n  const segment = index => (\n    <Segment key={index} className=\"p3 mb2\">\n      <Placeholder fluid>\n        <Placeholder.Header>\n          <Placeholder.Line length=\"full\" />\n        </Placeholder.Header>\n        <Placeholder.Paragraph>\n          <Placeholder.Line length=\"short\" />\n        </Placeholder.Paragraph>\n      </Placeholder>\n      <Divider className=\"mt3\" />\n      <Placeholder fluid>\n        <Placeholder.Line length=\"full\" />\n        <Placeholder.Line length=\"full\" />\n        <Placeholder.Line length=\"full\" />\n        <Placeholder.Line length=\"full\" />\n      </Placeholder>\n    </Segment>\n  );\n\n  return _.map(_.times(segmentCount, String), index => segment(index));\n};\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Header, Icon, Segment } from 'semantic-ui-react';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport {\n  isStoreLoading,\n  isStoreReady,\n  isStoreEmpty,\n  isStoreNotEmpty,\n  isStoreError,\n} from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport WorkflowTemplateCard from '../WorkflowTemplateCard';\nimport ProgressPlaceHolder from '../../workflow-common/ProgressPlaceholder';\n\n// expected props\n// - workflowTemplatesStore (via injection)\n// - location (from react router)\nclass WorkflowPublishedTemplatesList extends React.Component {\n  componentDidMount() {\n    const store = this.getStore();\n    swallowError(store.load());\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.getStore();\n    store.stopHeartbeat();\n  }\n\n  getStore() {\n    return this.props.workflowTemplatesStore;\n  }\n\n  goto(pathname) {\n    const location = this.props.location;\n    const link = createLink({ location, pathname });\n\n    this.props.history.push(link);\n  }\n\n  render() {\n    const store = this.getStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder segmentCount={3} />;\n    } else if (isStoreReady(store) && isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (isStoreReady(store) && isStoreNotEmpty(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <div className=\"mb4\">\n        {this.renderTitle()}\n        {content}\n      </div>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"clipboard outline\" />\n          No published workflow templates\n          <Header.Subheader>\n            To create a workflow template, start by creating a draft and then publish the draft.\n          </Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"list alternate outline\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Published Workflow Templates</Header.Content>\n        </Header>\n      </div>\n    );\n  }\n\n  renderMain() {\n    const store = this.getStore();\n    const list = store.list;\n\n    return (\n      <div>\n        {list.map(template => (\n          <Segment className=\"p3 mb2\" clearing key={template.id}>\n            <WorkflowTemplateCard template={template} />\n          </Segment>\n        ))}\n      </div>\n    );\n  }\n}\n\nexport default inject('workflowTemplatesStore')(withRouter(observer(WorkflowPublishedTemplatesList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, observable, runInAction } from 'mobx';\nimport TimeAgo from 'react-timeago';\nimport { Header, Label, Button, Icon, Modal } from 'semantic-ui-react';\nimport c from 'classnames';\nimport { displayError, displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\n\nimport getUIState from '../component-states/WorkflowCommonCardState';\n\n// expected props\n// - draft - a WorkflowTemplateDraft or WorkflowDraft model instance (via props)\n// - draftsStore (via props) (either workflowTemplateDraftsStore or workflowDraftsStore)\n// - onEdit (via props) called with (draft)\n// - userDisplayName (via injection)\n// - className (via props)\nclass WorkflowCommonDraftCard extends React.Component {\n  constructor(props) {\n    super(props);\n\n    runInAction(() => {\n      this.shouldShowDeleteDialog = false;\n      this.deletingInProgress = false;\n    });\n  }\n\n  getDraftsStore() {\n    return this.props.draftsStore;\n  }\n\n  getState() {\n    return getUIState(this.getDraft().id);\n  }\n\n  selectedMainTabIndex() {\n    return this.getState().mainTabIndex;\n  }\n\n  getDraft() {\n    return this.props.draft;\n  }\n\n  getVersion() {\n    const draft = this.getDraft();\n    return draft.template || draft.workflow;\n  }\n\n  getUserDisplayName() {\n    return this.props.userDisplayName;\n  }\n\n  handleOnTabChange = (_event, data) => {\n    this.getState().setMainTabIndex(data.activeIndex);\n  };\n\n  handleEditDraft = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n    const draft = this.getDraft();\n    if (this.props.onEdit) return this.props.onEdit(draft);\n    return undefined;\n  };\n\n  showDeleteDialog = () => {\n    this.shouldShowDeleteDialog = true;\n    this.deletingInProgress = false;\n  };\n\n  hideDeleteDialog = () => {\n    if (this.deletingInProgress) return;\n    this.shouldShowDeleteDialog = false;\n  };\n\n  handleDeleteDraft = async () => {\n    const clean = () => {\n      runInAction(() => {\n        this.shouldShowDeleteDialog = false;\n        this.deletingInProgress = false;\n      });\n    };\n\n    const draft = this.getDraft();\n    const draftsStore = this.getDraftsStore();\n\n    try {\n      this.deletingInProgress = true;\n      await draftsStore.deleteDraft(draft);\n      clean();\n      displaySuccess('Draft deleted successfully');\n    } catch (error) {\n      clean();\n      displayError(error);\n    }\n  };\n\n  render() {\n    const className = this.props.className;\n    const draft = this.getDraft();\n    const version = this.getVersion();\n    const isTemplate = draft.template !== undefined;\n    const { id, title } = version;\n    const { createdAt, createdBy } = draft;\n    const userDisplayName = this.getUserDisplayName();\n    const by = () => <span className=\"ml1\">by {userDisplayName.getDisplayName({ uid: createdBy })}</span>;\n\n    return (\n      <>\n        <Label attached=\"top left\">{isTemplate && 'Template '} Draft</Label>\n        <div className={c(className)}>\n          <div className=\"flex\">\n            <Header as=\"h3\" color=\"grey\" className=\"mt0 flex-auto ellipsis\">\n              {title}\n              <Header.Subheader className=\"fs-9 color-grey\">\n                <div>\n                  <span className=\"ellipsis breakout\">{id}</span>\n                </div>\n                <div>\n                  created <TimeAgo date={createdAt} /> {by()}\n                </div>\n              </Header.Subheader>\n            </Header>\n            <div>{this.renderActionButtons()}</div>\n          </div>\n          {this.renderMainTabs(version)}\n        </div>\n        {this.renderDeleteDialog(version)}\n      </>\n    );\n  }\n\n  renderDeleteDialog(version) {\n    const shouldShowDeleteDialog = this.shouldShowDeleteDialog;\n    const { id } = version;\n    const progress = this.deletingInProgress;\n\n    return (\n      <Modal open={shouldShowDeleteDialog} size=\"tiny\" onClose={this.hideDeleteDialog} closeOnDimmerClick={!progress}>\n        <Header content=\"Delete Draft\" />\n        <Modal.Content>\n          <p>Are you sure you want to delete draft &quot;{id}&quot; ?</p>\n        </Modal.Content>\n        <Modal.Actions>\n          <Button disabled={progress} onClick={this.hideDeleteDialog}>\n            Cancel\n          </Button>\n          <Button loading={progress} disabled={progress} color=\"red\" onClick={this.handleDeleteDraft}>\n            <Icon name=\"remove\" /> Delete\n          </Button>\n        </Modal.Actions>\n      </Modal>\n    );\n  }\n\n  renderActionButtons() {\n    return (\n      <Button.Group basic size=\"mini\">\n        <Button icon=\"edit\" onClick={this.handleEditDraft} />\n        <Button icon=\"trash\" onClick={this.showDeleteDialog} />\n      </Button.Group>\n    );\n  }\n\n  renderMainTabs(version) {\n    const renderer = _.isFunction(this.props.children) ? this.props.children : _.noop;\n    const uiState = this.getState();\n    return renderer({\n      uiState,\n      version,\n    });\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowCommonDraftCard, {\n  showDeleteDialog: action,\n  hideDeleteDialog: action,\n  handleDeleteDraft: action,\n  handleEditDraft: action,\n  shouldShowDeleteDialog: observable,\n  deletingInProgress: observable,\n});\n\nexport default inject('userDisplayName')(observer(WorkflowCommonDraftCard));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '@aws-ee/base-ui/dist/helpers/form';\n\nconst createWorkflowTemplateDraftFields = {\n  templateId: {\n    label: 'Workflow Template Id',\n    placeholder: 'Type a unique id for this template',\n    extra: {\n      explain: `This is a required field and the number of characters must be between 3 and 50 and no spaces. Only\n      alpha-numeric characters and dashes are allowed. Once a draft is created you can not change the template id.`,\n    },\n    value: 'tempValue',\n    rules: 'required|string|between:3,50|alpha_dash',\n  },\n\n  templateTitle: {\n    label: 'Workflow Template Title',\n    placeholder: 'Type a title for the workflow template',\n    extra: {\n      explain: `This is a required field and the number of characters must be between 3 and 255.\n      The title is shown in many places in the UI.`,\n    },\n    value: 'tempValue',\n    rules: 'required|string|between:3,255',\n  },\n\n  draftFor: {\n    label: 'Draft For',\n    placeholder: 'Select one',\n    extra: {\n      explain: 'Decide if you want to create a new workflow template or edit an existing one.',\n    },\n    rules: 'required|string',\n  },\n};\n\nfunction getCreateDraftForm() {\n  return createForm(createWorkflowTemplateDraftFields);\n}\n\nexport default getCreateDraftForm;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport { Label, Segment, Button } from 'semantic-ui-react';\nimport { createLink } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { isStoreLoading, isStoreReady, isStoreError } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport DropDown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\n\nimport getCreateDraftForm from '../../../models/forms/CreateWorkflowTemplateDraftForm';\nimport ProgressPlaceHolder from '../../workflow-common/ProgressPlaceholder';\n\n// expected props\n// - onCancel (via prop) called on cancel\n// - workflowTemplateDraftsStore (via injection)\n// - workflowTemplatesStore (via injection)\n// - className (via props)\n// - location (from react router)\nclass CreateWorkflowTemplateDraft extends React.Component {\n  constructor(props) {\n    super(props);\n    this.form = getCreateDraftForm();\n  }\n\n  getStore() {\n    return this.props.workflowTemplateDraftsStore;\n  }\n\n  getTemplatesStore() {\n    return this.props.workflowTemplatesStore;\n  }\n\n  getDropdownOptions() {\n    const store = this.getTemplatesStore();\n    const draftsStore = this.getStore();\n    const templates = store.list;\n    const options = [];\n\n    _.forEach(templates, template => {\n      if (!draftsStore.hasTemplate(template.id)) {\n        options.push({\n          text: template.latest.title || '',\n          value: template.id,\n          content: (\n            <div>\n              <Label color=\"teal\" horizontal size=\"mini\">\n                Existing\n              </Label>{' '}\n              {template.latest.title} <span className=\"ml1 fs-7 color-grey\">{template.id}</span>\n            </div>\n          ),\n        });\n      }\n    });\n\n    options.unshift({\n      text: 'New Workflow Template',\n      value: '-1',\n      content: (\n        <div>\n          <Label color=\"blue\" horizontal size=\"mini\">\n            New\n          </Label>{' '}\n          Workflow Template\n        </div>\n      ),\n    });\n\n    return options;\n  }\n\n  goto(pathname) {\n    const location = this.props.location;\n    const link = createLink({ location, pathname });\n\n    this.props.history.push(link);\n  }\n\n  handleSelectionChange = templateId => {\n    const form = this.form;\n    const templateIdField = form.$('templateId');\n    const templateTitleField = form.$('templateTitle');\n    const clear = () => {\n      templateIdField.clear();\n      templateTitleField.clear();\n    };\n    const set = template => {\n      templateIdField.set(template.id);\n      templateTitleField.set(template.latest.title);\n    };\n\n    if (templateId === '-1') {\n      clear();\n    } else {\n      const store = this.getTemplatesStore();\n      const template = store.getTemplate(templateId);\n      if (_.isNil(template)) {\n        displayError(`The template \"${templateId}\" is no longer available.`);\n        clear();\n      } else {\n        set(template);\n      }\n    }\n  };\n\n  handleCancel = () => {\n    const onCancel = this.props.onCancel || _.noop;\n    onCancel();\n  };\n\n  handleFormError = (_form, _errors) => {\n    // We don't need to do anything here\n  };\n\n  handleFormSubmission = async form => {\n    const values = form.values();\n    const isNewTemplate = values.draftFor === '-1';\n    const templateId = values.templateId;\n    const templateTitle = isNewTemplate ? values.templateTitle : undefined;\n    const store = this.getStore();\n\n    try {\n      const draft = await store.createDraft({ isNewTemplate, templateId, templateTitle });\n      form.clear();\n      this.goto(`/workflow-templates/drafts/edit/${encodeURIComponent(draft.id)}`);\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  render() {\n    const store = this.getStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0 mb3\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder />;\n    } else if (isStoreReady(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return content;\n  }\n\n  renderMain() {\n    const form = this.form;\n    const dropDownOptions = this.getDropdownOptions();\n    const dropDownField = form.$('draftFor');\n    const templateIdField = form.$('templateId');\n    const templateTitleField = form.$('templateTitle');\n    const draftForValue = dropDownField.value;\n    const isNew = draftForValue === '-1';\n\n    return (\n      <Segment clearing className=\"p3\">\n        <Form\n          form={form}\n          onCancel={this.handleCancel}\n          onSuccess={this.handleFormSubmission}\n          onError={this.handleFormError}\n        >\n          {({ processing, _onSubmit, onCancel }) => (\n            <>\n              <DropDown\n                field={dropDownField}\n                options={dropDownOptions}\n                fluid\n                selection\n                disabled={processing}\n                onChange={this.handleSelectionChange}\n              />\n              {isNew && (\n                <>\n                  <Input field={templateIdField} disabled={processing} />\n                  <Input field={templateTitleField} disabled={processing} />\n                </>\n              )}\n              <div className=\"mt3\">\n                <Button floated=\"right\" color=\"blue\" icon disabled={processing} className=\"ml2\" type=\"submit\">\n                  Create Draft\n                </Button>\n                <Button floated=\"right\" disabled={processing} onClick={onCancel}>\n                  Cancel\n                </Button>\n              </div>\n            </>\n          )}\n        </Form>\n      </Segment>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(CreateWorkflowTemplateDraft, {\n  handleCancel: action,\n  handleFormSubmission: action,\n  handleFormError: action,\n});\n\nexport default inject(\n  'workflowTemplateDraftsStore',\n  'workflowTemplatesStore',\n)(withRouter(observer(CreateWorkflowTemplateDraft)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, runInAction, observable } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport { Header, Icon, Segment, Button } from 'semantic-ui-react';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport {\n  isStoreLoading,\n  isStoreReady,\n  isStoreEmpty,\n  isStoreNotEmpty,\n  isStoreError,\n} from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport WorkflowCommonDraftCard from '../../workflow-common/drafts/WorkflowCommonDraftCard';\nimport ProgressPlaceHolder from '../../workflow-common/ProgressPlaceholder';\nimport CreateDraftWizard from './CreateWorkflowTemplateDraft';\nimport WorkflowTemplateCardTabs from '../WorkflowTemplateCardTabs';\n\n// expected props\n// - workflowTemplateDraftsStore (via injection)\n// - location (from react router)\nclass WorkflowTemplateDraftsList extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.showCreateDraftWizard = false;\n    });\n  }\n\n  componentDidMount() {\n    const store = this.getStore();\n    swallowError(store.load());\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.getStore();\n    store.stopHeartbeat();\n  }\n\n  getStore() {\n    return this.props.workflowTemplateDraftsStore;\n  }\n\n  handleCreateDraftClick() {\n    this.showCreateDraftWizard = true;\n  }\n\n  handleCreateDraftCancel() {\n    this.showCreateDraftWizard = false;\n  }\n\n  handleEditDraft = async draft => {\n    const goto = gotoFn(this);\n    goto(`/workflow-templates/drafts/edit/${encodeURIComponent(draft.id)}`);\n  };\n\n  render() {\n    const store = this.getStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder />;\n    } else if (isStoreReady(store) && isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (isStoreReady(store) && isStoreNotEmpty(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <div className=\"mb4\">\n        {this.renderTitle()}\n        {this.renderWizard()}\n        {content}\n      </div>\n    );\n  }\n\n  renderEmpty() {\n    const show = this.showCreateDraftWizard;\n    if (show) return null;\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"edit outline\" />\n          No workflow template drafts\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderTitle() {\n    const disabled = this.showCreateDraftWizard;\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"edit outline\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Workflow Template Drafts</Header.Content>\n        </Header>\n        <div>\n          <Button basic color=\"blue\" disabled={disabled} onClick={() => this.handleCreateDraftClick()}>\n            Create Draft\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  renderWizard() {\n    const show = this.showCreateDraftWizard;\n    if (!show) return null;\n    return <CreateDraftWizard onCancel={() => this.handleCreateDraftCancel()} />;\n  }\n\n  renderMain() {\n    const store = this.getStore();\n    const list = store.list;\n\n    return (\n      <div>\n        {_.map(list, draft => (\n          <Segment className=\"mb2\" clearing key={draft.id}>\n            <WorkflowCommonDraftCard\n              draft={draft}\n              draftsStore={store}\n              onEdit={this.handleEditDraft}\n              className=\"pt0 pl2 pr2 pb2\"\n            >\n              {({ uiState, version }) => <WorkflowTemplateCardTabs template={version} uiState={uiState} />}\n            </WorkflowCommonDraftCard>\n          </Segment>\n        ))}\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowTemplateDraftsList, {\n  handleCreateDraftClick: action,\n  handleCreateDraftCancel: action,\n  handleEditDraft: action,\n  showCreateDraftWizard: observable,\n});\n\nexport default inject('workflowTemplateDraftsStore')(withRouter(observer(WorkflowTemplateDraftsList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Container } from 'semantic-ui-react';\n\nimport WorkflowPublishedTemplatesList from './published/WorkflowPublishedTemplatesList';\nimport WorkflowTemplateDraftsList from './drafts/WorkflowTemplateDraftsList';\n\n// expected props\n// - location (from react router)\nclass WorkflowTemplatesList extends React.Component {\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  render() {\n    return (\n      <Container className=\"mt3\">\n        <WorkflowPublishedTemplatesList />\n        <WorkflowTemplateDraftsList />\n      </Container>\n    );\n  }\n}\n\nexport default inject()(withRouter(observer(WorkflowTemplatesList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, runInAction, observable } from 'mobx';\nimport { Button, Header, Divider, Icon, Segment } from 'semantic-ui-react';\n\nimport { displayError, displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport DropDown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\nimport PropsOverrideTable from '../../PropertyOverrideTable';\n\n// expected props\n// - editor (via props) an instance of the WorkflowTemplateDraftEditor model\n// - onCancel (via props)\nclass WorkflowTemplateDraftMetaEditor extends React.Component {\n  constructor(props) {\n    super(props);\n\n    runInAction(() => {\n      this.clickedOnNext = false;\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  // WorkflowTemplateDraftEditor\n  getEditor() {\n    return this.props.editor;\n  }\n\n  getWorkflowTemplate() {\n    return this.getEditor().draft.template;\n  }\n\n  getMetaForm() {\n    return this.getEditor().metaForm;\n  }\n\n  resetFlags() {\n    // we use these flags to tell the difference between clicking on 'save' vs 'next' because\n    // 'next' will result in saving the form\n    this.clickedOnNext = false;\n  }\n\n  handleCancel = () => {\n    this.resetFlags();\n    const onCancel = this.props.onCancel || _.noop;\n    onCancel();\n  };\n\n  handlePrevious = event => {\n    // we don't save the form in this case\n    this.resetFlags();\n    event.preventDefault();\n    event.stopPropagation();\n    this.getEditor().previousPage();\n  };\n\n  handleOnSubmitNext(event, onSubmit) {\n    event.preventDefault();\n    event.stopPropagation();\n    this.resetFlags();\n    this.clickedOnNext = true;\n\n    onSubmit(event); // this will eventually call handleFormSubmission()\n  }\n\n  handleFormSubmission = async form => {\n    const editor = this.getEditor();\n    const { templateTitle, templateDesc, instanceTtl, runSpecSize, runSpecTarget } = form.values();\n    const { draft } = editor;\n    const template = draft.template;\n    const allowed = [];\n    const toPropsOverride = (key, value) => {\n      const item = key.replace(/^propsOverride_/, '');\n      if (_.startsWith(key, 'propsOverride_') && !_.isEmpty(item) && value === true) allowed.push(item);\n    };\n\n    _.forEach(form.values(), (value, key) => toPropsOverride(key, value));\n\n    template.setTitle(templateTitle);\n    template.setDescription(templateDesc);\n    template.setInstanceTtl(instanceTtl);\n    template.setRunSpec({\n      size: runSpecSize,\n      target: runSpecTarget,\n    });\n    template.setPropsOverrideOption({ allowed });\n\n    try {\n      await editor.update(draft);\n      if (this.clickedOnNext) {\n        this.getEditor().nextPage();\n        return;\n      }\n      displaySuccess('The workflow template draft is saved successfully');\n    } catch (error) {\n      runInAction(() => {\n        this.resetFlags();\n      });\n      displayError(error);\n    }\n  };\n\n  handleFormErrors = () => {\n    window.scrollTo(0, 0);\n  };\n\n  render() {\n    const editor = this.getEditor();\n    const hasPrevious = editor.hasPreviousPage;\n    const form = this.getMetaForm();\n    const templateTitleField = form.$('templateTitle');\n    const templateDescField = form.$('templateDesc');\n    const instanceTtlField = form.$('instanceTtl');\n    const runSpecSizeField = form.$('runSpecSize');\n    const runSpecTargetField = form.$('runSpecTarget');\n    const rows = this.getWorkflowTemplate().propertyOverrideSummaryRows || [];\n    const fields = _.map(rows, item => form.$(`propsOverride_${item.name}`));\n\n    return (\n      <Form\n        form={form}\n        onCancel={this.handleCancel}\n        onSuccess={this.handleFormSubmission}\n        onError={this.handleFormErrors}\n      >\n        {({ processing, onSubmit, onCancel }) => (\n          <>\n            <Input field={templateTitleField} disabled={processing} />\n            <TextArea field={templateDescField} rows={6} disabled={processing} />\n            <Divider horizontal className=\"mb3\">\n              <Header as=\"h4\" className=\"color-grey\">\n                <Icon name=\"list alternate outline\" className=\"color-grey\" />\n                Properties\n              </Header>\n            </Divider>\n            <Input field={instanceTtlField} disabled={processing} />\n            <DropDown field={runSpecSizeField} disabled={processing} fluid={false} selection />\n            <DropDown field={runSpecTargetField} disabled={processing} fluid={false} selection />\n            <Divider horizontal className=\"mb3\">\n              <Header as=\"h4\" className=\"color-grey\">\n                <Icon name=\"list alternate outline\" className=\"color-grey\" />\n                Properties Override\n              </Header>\n            </Divider>\n            <Segment padded>\n              <PropsOverrideTable rows={fields} editable processing={processing} />\n            </Segment>\n            <div className=\"mt4\">\n              <Button\n                floated=\"right\"\n                color=\"teal\"\n                icon=\"right arrow\"\n                labelPosition=\"right\"\n                disabled={processing}\n                className=\"ml2\"\n                content=\"Next\"\n                onClick={e => this.handleOnSubmitNext(e, onSubmit)}\n              />\n              {hasPrevious && (\n                <Button\n                  floated=\"right\"\n                  icon=\"left arrow\"\n                  labelPosition=\"left\"\n                  disabled={processing}\n                  className=\"ml3\"\n                  content=\"previous\"\n                  onClick={this.handlePrevious}\n                />\n              )}\n              <Button\n                floated=\"right\"\n                color=\"blue\"\n                icon=\"save\"\n                labelPosition=\"left\"\n                disabled={processing}\n                className=\"ml2\"\n                content=\"Save\"\n              />\n              <Button floated=\"left\" disabled={processing} onClick={onCancel}>\n                Cancel\n              </Button>\n            </div>\n          </>\n        )}\n      </Form>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowTemplateDraftMetaEditor, {\n  handleCancel: action,\n  handleOnSubmitNext: action,\n  handleFormSubmission: action,\n  handleFormErrors: action,\n  handlePrevious: action,\n  resetFlags: action,\n  clickedOnNext: observable,\n});\n\nexport default inject()(observer(WorkflowTemplateDraftMetaEditor));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, runInAction, observable } from 'mobx';\nimport { Dropdown } from 'semantic-ui-react';\nimport c from 'classnames';\n\n// expected props\n// - stepTemplatesStore (via props)\n// - onSelected (via props) (optional), a function that receives (step)\n// - disabled (via props) (optional), default to false\n// - className (via props)\nclass AddStepDropDown extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.selectedStep = undefined;\n    });\n  }\n\n  getStore() {\n    return this.props.stepTemplatesStore;\n  }\n\n  getSelectedStep() {\n    return this.selectedStep;\n  }\n\n  getStepDropDownOptions() {\n    const store = this.getStore();\n    const list = store.list;\n    const options = _.map(list, template => ({\n      text: template.latest.title,\n      value: template.id,\n    }));\n\n    return options;\n  }\n\n  handleChange = (_event, { value }) => {\n    if (_.isEmpty(value)) {\n      this.selectedStep = undefined;\n      return;\n    }\n\n    const store = this.getStore();\n    const step = store.getTemplate(value);\n    if (step === undefined) {\n      this.selectedStep = undefined;\n      return;\n    }\n    this.selectedStep = step.latest;\n  };\n\n  handleClose = (e, _d) => {\n    const onSelected = this.props.onSelected || _.noop;\n    const step = this.selectedStep;\n\n    this.selectedStep = undefined;\n    if (e === undefined) return; // this means the escape key was clicked\n    onSelected(step);\n  };\n\n  render() {\n    const disabled = this.props.disabled || false;\n    const className = this.props.className;\n    const step = this.getSelectedStep();\n    const options = this.getStepDropDownOptions();\n    const isEmpty = _.isEmpty(step);\n    const text = isEmpty ? 'Add Step' : step.title;\n    const value = isEmpty ? '' : step.id;\n\n    return (\n      <Dropdown\n        button\n        className={c('icon', className)}\n        fluid\n        labeled\n        icon=\"plus\"\n        options={options}\n        search\n        color=\"blue\"\n        text={text}\n        value={value}\n        onChange={this.handleChange}\n        onClose={this.handleClose}\n        disabled={disabled}\n      />\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(AddStepDropDown, {\n  selectedStep: observable,\n  handleChange: action,\n  handleClose: action,\n});\n\nexport default inject('stepTemplatesStore')(observer(AddStepDropDown));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject, Observer } from 'mobx-react';\nimport { decorate, action, runInAction, observable } from 'mobx';\nimport { Button, Header, Dimmer, Loader, Message } from 'semantic-ui-react';\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\nimport c from 'classnames';\nimport { displayError, displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\n\nimport AddStepDropDown from '../../../workflow-step-templates/AddStepDropDown';\n\n// expected props\n// - editor (via prop) an instance of the WorkflowTemplateDraftEditor model or WorkflowDraftEditor model\n// - stepEditor (vai props) an instance of the WorkflowTemplateStepEditor react component or WorkflowStepEditor reactComponent\nclass WorkflowCommonDraftStepsEditor extends React.Component {\n  constructor(props) {\n    super(props);\n\n    runInAction(() => {\n      this.processing = false;\n      this.clickedOnNext = false;\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  getEditor() {\n    return this.props.editor;\n  }\n\n  getStepEditorComponent() {\n    return this.props.stepEditor;\n  }\n\n  getVersion() {\n    return this.getEditor().version;\n  }\n\n  getSelectedSteps() {\n    return this.getVersion().selectedSteps;\n  }\n\n  handleAddStep = step => {\n    if (!step) return;\n    this.getEditor().addStep(step);\n  };\n\n  handleCancel = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.clickedOnNext = false;\n    this.processing = false;\n    const onCancel = this.props.onCancel || _.noop;\n    onCancel();\n  };\n\n  handleDelete = step => {\n    const editor = this.getEditor();\n    const version = this.getVersion();\n    const id = step.id;\n\n    version.removeStep(step);\n    setTimeout(() => {\n      editor.removeStepEditor(id);\n    }, 150);\n  };\n\n  handleNext = async event => {\n    this.clickedOnNext = true;\n    return this.handleSave(event);\n  };\n\n  handlePrevious = event => {\n    // we don't save the form in this case\n    event.preventDefault();\n    event.stopPropagation();\n    this.clickedOnNext = false;\n    this.getEditor().previousPage();\n  };\n\n  handleSave = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const editor = this.getEditor();\n    const { draft } = editor;\n\n    this.processing = true;\n\n    try {\n      await editor.update(draft);\n      runInAction(() => {\n        this.processing = false;\n      });\n      if (this.clickedOnNext) {\n        this.getEditor().nextPage();\n        return;\n      }\n      displaySuccess('Saved successfully');\n    } catch (error) {\n      runInAction(() => {\n        this.processing = false;\n        this.clickedOnNext = false;\n      });\n      displayError(error);\n    }\n  };\n\n  handleStepSave = async () => {\n    const editor = this.getEditor();\n    const { draft } = editor;\n\n    this.processing = true;\n\n    try {\n      await editor.update(draft);\n      runInAction(() => {\n        this.processing = false;\n      });\n      displaySuccess('Saved successfully');\n    } catch (error) {\n      runInAction(() => {\n        this.processing = false;\n      });\n      displayError(error);\n    }\n  };\n\n  onDragEnd = result => {\n    const version = this.getVersion();\n    if (!version.canRearrangeSteps) return;\n\n    // see https://egghead.io/lessons/react-persist-list-reordering-with-react-beautiful-dnd-using-the-ondragend-callback\n    const { draggableId, destination, source } = result;\n    const isSource = source.droppableId === 'selected-steps';\n    const isDestination = destination && destination.droppableId === 'selected-steps';\n    const isStep = !!version.getStep(draggableId);\n\n    if (!destination) {\n      // we don't support removal of a step by dragging it out of its container\n      return;\n    }\n\n    if (destination.droppableId === source.droppableId && destination.index === source.index) {\n      // we don't need to do anything here\n      return;\n    }\n\n    if (isSource && isDestination && isStep) {\n      // we are dealing with reordering of the steps\n      version.reinsertStep(source.index, destination.index);\n    }\n  };\n\n  render() {\n    const processing = this.processing;\n    const editor = this.getEditor();\n    const editing = editor.stepEditorsEditing;\n    const hasPrevious = editor.hasPreviousPage;\n    const version = this.getVersion();\n    const canRearrange = version.canRearrangeSteps;\n\n    return (\n      <>\n        <Dimmer.Dimmable dimmed={processing}>\n          <Dimmer active={processing} inverted>\n            <Loader inverted>Processing</Loader>\n          </Dimmer>\n          <Header as=\"h3\" color=\"grey\" className=\"mt0\">\n            Steps\n          </Header>\n          {!canRearrange && (\n            <Message warning>\n              <b className=\"mr1\">Warning</b> The workflow template used by this workflow does <b>not</b> allow for steps\n              to be deleted, added or rearranged\n            </Message>\n          )}\n          {canRearrange && (\n            <DragDropContext onDragEnd={this.onDragEnd}>\n              <Droppable droppableId=\"selected-steps\">\n                {(provided, snapshot) => (\n                  <Observer>\n                    {() => (\n                      <div\n                        {...provided.droppableProps}\n                        ref={provided.innerRef}\n                        className={c('mb3', snapshot.isDraggingOver ? 'bg-lightgreen' : '')}\n                      >\n                        {this.renderSelectedSteps()}\n                        {provided.placeholder}\n                      </div>\n                    )}\n                  </Observer>\n                )}\n              </Droppable>\n            </DragDropContext>\n          )}\n          {!canRearrange && <div className=\"mb3\">{this.renderSelectedSteps()}</div>}\n          <AddStepDropDown className=\"mb3\" onSelected={this.handleAddStep} disabled={!canRearrange} />\n        </Dimmer.Dimmable>\n        {!editing && (\n          <div>\n            <Button\n              floated=\"right\"\n              color=\"teal\"\n              icon=\"right arrow\"\n              labelPosition=\"right\"\n              disabled={processing}\n              className=\"ml2\"\n              content=\"Next\"\n              onClick={this.handleNext}\n            />\n            {hasPrevious && (\n              <Button\n                floated=\"right\"\n                icon=\"left arrow\"\n                labelPosition=\"left\"\n                disabled={processing}\n                className=\"ml3\"\n                content=\"previous\"\n                onClick={this.handlePrevious}\n              />\n            )}\n            <Button\n              floated=\"right\"\n              color=\"blue\"\n              icon=\"save\"\n              labelPosition=\"left\"\n              disabled={processing}\n              className=\"ml2\"\n              content=\"Save\"\n              onClick={this.handleSave}\n            />\n            <Button floated=\"left\" disabled={processing} onClick={this.handleCancel}>\n              Cancel\n            </Button>\n          </div>\n        )}\n      </>\n    );\n  }\n\n  renderSelectedSteps() {\n    const selectedSteps = this.getSelectedSteps();\n    const size = selectedSteps.length;\n\n    if (size === 0) {\n      return null;\n    }\n\n    const version = this.getVersion();\n    const canRearrange = version.canRearrangeSteps;\n    const editor = this.getEditor();\n    const getStepEditor = step => editor.getStepEditor(step);\n    const StepEditorComponent = this.getStepEditorComponent();\n\n    if (!canRearrange)\n      return _.map(selectedSteps, step => (\n        <div key={step.id} className=\"mb3\">\n          <Observer>\n            {() => (\n              <StepEditorComponent\n                stepEditor={getStepEditor(step)}\n                onDelete={this.handleDelete}\n                onSave={this.handleStepSave}\n                canMove={canRearrange}\n                canDelete={canRearrange}\n              />\n            )}\n          </Observer>\n        </div>\n      ));\n\n    return _.map(selectedSteps, (step, index) => (\n      <Draggable key={step.id} draggableId={step.id} index={index}>\n        {(provided, _snapshot) => (\n          <div {...provided.dragHandleProps} ref={provided.innerRef} {...provided.draggableProps} className=\"mb3\">\n            <StepEditorComponent\n              stepEditor={getStepEditor(step)}\n              onDelete={this.handleDelete}\n              onSave={this.handleStepSave}\n              canMove={canRearrange}\n              canDelete={canRearrange}\n            />\n          </div>\n        )}\n      </Draggable>\n    ));\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowCommonDraftStepsEditor, {\n  onDragEnd: action,\n  handleAddStep: action,\n  handleCancel: action,\n  handleDelete: action,\n  handleSave: action,\n  handleStepSave: action,\n  handleNext: action,\n  handlePrevious: action,\n  clickedOnNext: observable,\n  processing: observable,\n});\n\nexport default inject()(observer(WorkflowCommonDraftStepsEditor));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, computed } from 'mobx';\nimport { Segment, Icon, Accordion } from 'semantic-ui-react';\n\n// expected props\n// - stepEditor - a WorkflowStepEditor model or a WorkflowTemplateStepEditor model (via props)\n// - onDelete - called when the step is to be deleted, passed (step) (via props)\n// - canDelete (via props) defaults to true\n// - canMove (via props) defaults to true\n// - className (via props)\nclass WorkflowCommonStepEditorCard extends React.Component {\n  get contentExpanded() {\n    return this.getStepEditor().contentExpanded;\n  }\n\n  getStepEditor() {\n    return this.props.stepEditor;\n  }\n\n  getStep() {\n    return this.getStepEditor().step;\n  }\n\n  get canDelete() {\n    return this.props.canDelete === undefined ? true : this.props.canDelete;\n  }\n\n  get canMove() {\n    return this.props.canMove === undefined ? true : this.props.canMove;\n  }\n\n  handleExpandContent = event => {\n    event.stopPropagation();\n    event.preventDefault();\n\n    const editor = this.getStepEditor();\n    editor.setContentExpanded(!this.contentExpanded);\n  };\n\n  handleDelete = event => {\n    event.stopPropagation(); // this was needed, otherwise, the handleClick was called after\n    // which resulted in mobx state tree warning about instance being accessed after being deleted\n    const onDelete = this.props.onDelete || _.noop;\n\n    onDelete(this.getStep());\n  };\n\n  render() {\n    const className = this.props.className || 'p0 pl1';\n    const step = this.getStep();\n\n    return (\n      <Segment size=\"small\" className={className} clearing>\n        {this.renderContent(step)}\n      </Segment>\n    );\n  }\n\n  renderContent(step) {\n    const opened = this.contentExpanded;\n    const canDelete = this.canDelete;\n    const canMove = this.canMove;\n\n    return (\n      <Accordion className=\"overflow-hidden pr1\">\n        <Accordion.Title active={opened} index={0} onClick={this.handleExpandContent}>\n          <div className=\"flex\">\n            {canMove && (\n              <div className=\"ml1 mr1 mt1 cursor-grab\">\n                <Icon name=\"align justify\" color=\"grey\" />\n              </div>\n            )}\n            {!canMove && <div className=\"ml1 mr1 mt1\" />}\n            <Icon name=\"dropdown\" className=\"mt75\" />\n            <div className=\"ellipsis flex-auto mt1\">\n              <div className=\"ellipsis\">{step.derivedTitle || step.title}</div>\n              <div className=\"ellipsis pr1 breakout fs-9 color-grey\">\n                {step.templateId} v{step.templateVer}\n              </div>\n            </div>\n            {canDelete && (\n              <div className=\"pl1 pr1 pt1\" onClick={this.handleDelete}>\n                <Icon name=\"trash alternate outline\" className=\"cursor-pointer\" />\n              </div>\n            )}\n          </div>\n        </Accordion.Title>\n        <Accordion.Content active={opened} className=\"p2 pt3 mb1 cursor-default\">\n          {this.props.children}\n        </Accordion.Content>\n      </Accordion>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowCommonStepEditorCard, {\n  contentExpanded: computed,\n  canDelete: computed,\n  canMove: computed,\n  handleDelete: action,\n  handleExpandContent: action,\n});\n\nexport default inject()(observer(WorkflowCommonStepEditorCard));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, computed } from 'mobx';\nimport { Segment, Icon, Divider, Header } from 'semantic-ui-react';\nimport ConfigTable from '@aws-ee/base-ui/dist/parts/configuration/ConfigTable';\nimport ConfigurationEditor from '@aws-ee/base-ui/dist/parts/configuration/ConfigurationEditor';\nimport ConfigurationReview from '@aws-ee/base-ui/dist/parts/configuration/ConfigurationReview';\n\n// expected props\n// - stepEditor - a WorkflowStepEditor or a WorkflowTemplateStepEditor model instance (via props)\n// - onSave - called when the configuration is saved (via props)\n// - className (via props)\nclass WorkflowCommonStepConfigEditor extends React.Component {\n  getStepEditor() {\n    return this.props.stepEditor;\n  }\n\n  getStep() {\n    return this.getStepEditor().step;\n  }\n\n  get editing() {\n    return this.getStepEditor().configEdit;\n  }\n\n  handleEditOn = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setConfigEdit(true);\n  };\n\n  handleEditOff = () => {\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setConfigEdit(false);\n  };\n\n  handleSave = async configs => {\n    const onSave = this.props.onSave || _.noop;\n    const stepEditorModel = this.getStepEditor();\n\n    await onSave(configs);\n    stepEditorModel.setConfigEdit(false);\n  };\n\n  render() {\n    const editing = this.editing;\n    const step = this.getStep();\n    const configRows = step.configSummaryRows || [];\n    const hasConfigRows = configRows.length > 0;\n    const canEdit = !editing && hasConfigRows;\n\n    return (\n      <div className={this.props.className}>\n        {!editing && (\n          <div className=\"flex animated\">\n            <div className=\"flex-auto\">\n              <Icon name=\"cog\" className=\"mr1 color-grey\" />\n              <b>Configuration</b>\n            </div>\n            {canEdit && (\n              <div className=\"pl1 pr0\" onClick={this.handleEditOn}>\n                <Icon name=\"edit\" color=\"grey\" className=\"cursor-pointer\" />\n              </div>\n            )}\n          </div>\n        )}\n        <Divider className=\"mt1 mb2\" />\n        {editing && this.renderConfigEditingContent()}\n        {!editing && this.renderConfigContent()}\n      </div>\n    );\n  }\n\n  renderConfigContent() {\n    const step = this.getStep();\n    const configRows = step.configSummaryRows || [];\n    const hasConfigRows = configRows.length > 0;\n\n    return (\n      <>\n        {hasConfigRows && (\n          <Segment padded className=\"animated\">\n            <ConfigTable rows={configRows} />\n          </Segment>\n        )}\n        {!hasConfigRows && <div>No configuration entries are available</div>}\n      </>\n    );\n  }\n\n  renderConfigEditingContent() {\n    const model = this.getStepEditor().configurationEditor;\n    const review = model.review;\n\n    if (review) {\n      return (\n        <>\n          <Header textAlign=\"center\" as=\"h2\" color=\"grey\" className=\"mt1 mb3\">\n            Review Configuration Changes\n          </Header>\n          <ConfigurationReview model={model} onCancel={this.handleEditOff} onSave={this.handleSave} dimmer={false} />\n        </>\n      );\n    }\n\n    return (\n      <>\n        <Header textAlign=\"center\" as=\"h2\" color=\"grey\" className=\"mt1 mb3\">\n          Change Configuration\n        </Header>\n        <ConfigurationEditor model={model} onCancel={this.handleEditOff} />\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowCommonStepConfigEditor, {\n  editing: computed,\n  handleEditOn: action,\n  handleEditOff: action,\n  handleSave: action,\n});\n\nexport default inject()(observer(WorkflowCommonStepConfigEditor));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, computed } from 'mobx';\nimport { Icon, Divider, Header, Button } from 'semantic-ui-react';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\n\n// expected props\n// - stepEditor - a WorkflowStepEditor or a WorkflowTemplateStepEditor model instance (via props)\n// - onSave - called when the desc/title are saved (via props)\n// - className (via props)\nclass WorkflowCommonStepDescEditor extends React.Component {\n  getStepEditor() {\n    return this.props.stepEditor;\n  }\n\n  getStep() {\n    return this.getStepEditor().step;\n  }\n\n  getDescForm() {\n    return this.getStepEditor().descForm;\n  }\n\n  get editing() {\n    return this.getStepEditor().descEdit;\n  }\n\n  handleEditOn = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setDescEdit(true);\n  };\n\n  handleEditOff = () => {\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setDescEdit(false);\n  };\n\n  handleSave = async form => {\n    const onSave = this.props.onSave || _.noop;\n    const stepEditorModel = this.getStepEditor();\n    const { stepTitle, stepDesc } = form.values();\n\n    stepEditorModel.applyDescAndTitle(stepDesc, stepTitle);\n\n    await onSave();\n    stepEditorModel.setDescEdit(false);\n  };\n\n  render() {\n    const editing = this.editing;\n    const canEdit = !editing;\n\n    return (\n      <div className={this.props.className}>\n        {!editing && (\n          <div className=\"flex animated\">\n            <div className=\"flex-auto\">\n              <Icon name=\"file alternate outline\" className=\"mr1 color-grey\" />\n              <b>Description</b>\n            </div>\n            {canEdit && (\n              <div className=\"pl1 pr0\" onClick={this.handleEditOn}>\n                <Icon name=\"edit\" color=\"grey\" className=\"cursor-pointer\" />\n              </div>\n            )}\n          </div>\n        )}\n        <Divider className=\"mt1 mb2\" />\n        {editing && this.renderEditingContent()}\n        {!editing && this.renderReadOnlyContent()}\n      </div>\n    );\n  }\n\n  renderReadOnlyContent() {\n    const step = this.getStep();\n\n    return <div className=\"animated\" dangerouslySetInnerHTML={{ __html: step.descHtml }} />; // eslint-disable-line react/no-danger\n  }\n\n  renderEditingContent() {\n    const form = this.getDescForm();\n    const stepTitleField = form.$('stepTitle');\n    const stepDescField = form.$('stepDesc');\n\n    return (\n      <>\n        <Header textAlign=\"center\" as=\"h2\" color=\"grey\" className=\"mt1 mb3\">\n          Change Title &amp; Description\n        </Header>\n        <Form form={form} dimmer={false} onCancel={this.handleEditOff} onSuccess={this.handleSave}>\n          {({ processing, _onSubmit, onCancel }) => (\n            <>\n              <Input field={stepTitleField} disabled={processing} />\n              <TextArea field={stepDescField} rows={6} disabled={processing} />\n              <div className=\"mt3 clearfix\">\n                <Button\n                  floated=\"right\"\n                  color=\"blue\"\n                  icon=\"save\"\n                  labelPosition=\"left\"\n                  disabled={processing}\n                  className=\"ml2\"\n                  type=\"submit\"\n                  content=\"Save\"\n                />\n                <Button floated=\"left\" disabled={processing} onClick={onCancel}>\n                  Cancel\n                </Button>\n              </div>\n            </>\n          )}\n        </Form>\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowCommonStepDescEditor, {\n  editing: computed,\n  handleEditOn: action,\n  handleEditOff: action,\n  handleSave: action,\n});\n\nexport default inject()(observer(WorkflowCommonStepDescEditor));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, computed } from 'mobx';\nimport { Icon, Divider, Button, Segment, Header } from 'semantic-ui-react';\n\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport Toggle from '@aws-ee/base-ui/dist/parts/helpers/fields/Toggle';\nimport PropertyTable from '../../../workflow-templates/PropertyTable';\n\n// expected props\n// - stepEditor - a WorkflowStepEditor or aWorkflowTemplateStepEditor model instance (via props)\n// - onSave - called when the props are saved (via props)\n// - className (via props)\nclass WorkflowCommonStepPropsEditor extends React.Component {\n  getStepEditor() {\n    return this.props.stepEditor;\n  }\n\n  getStep() {\n    return this.getStepEditor().step;\n  }\n\n  getPropsForm() {\n    return this.getStepEditor().propsForm;\n  }\n\n  get editing() {\n    return this.getStepEditor().propsEdit;\n  }\n\n  handleEditOn = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setPropsEdit(true);\n  };\n\n  handleEditOff = () => {\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setPropsEdit(false);\n  };\n\n  handleSave = async form => {\n    const onSave = this.props.onSave || _.noop;\n    const stepEditorModel = this.getStepEditor();\n    const { skippable } = form.values();\n\n    stepEditorModel.applySkippable(skippable);\n\n    await onSave();\n    stepEditorModel.setPropsEdit(false);\n  };\n\n  render() {\n    const editing = this.editing;\n    const canEdit = !editing;\n\n    return (\n      <div className={this.props.className}>\n        {!editing && (\n          <div className=\"flex animated\">\n            <div className=\"flex-auto\">\n              <Icon name=\"file alternate outline\" className=\"mr1 color-grey\" />\n              <b>Properties</b>\n            </div>\n            {canEdit && (\n              <div className=\"pl1 pr0\" onClick={this.handleEditOn}>\n                <Icon name=\"edit\" color=\"grey\" className=\"cursor-pointer\" />\n              </div>\n            )}\n          </div>\n        )}\n        <Divider className=\"mt1 mb2\" />\n        {editing && this.renderEditingContent()}\n        {!editing && this.renderReadOnlyContent()}\n      </div>\n    );\n  }\n\n  renderReadOnlyContent() {\n    const step = this.getStep();\n    const propertyRows = step.propertySummaryRows || [];\n    return (\n      <Segment padded className=\"animated\">\n        <PropertyTable rows={propertyRows} />\n      </Segment>\n    );\n  }\n\n  renderEditingContent() {\n    const form = this.getPropsForm();\n    const skippableField = form.$('skippable');\n\n    return (\n      <>\n        <Header textAlign=\"center\" as=\"h2\" color=\"grey\" className=\"mt1 mb3\">\n          Change Properties\n        </Header>\n        <Form form={form} dimmer={false} onCancel={this.handleEditOff} onSuccess={this.handleSave}>\n          {({ processing, _onSubmit, onCancel }) => (\n            <div className=\"mt3\">\n              <Toggle field={skippableField} disabled={processing} />\n              <div className=\"mt3 clearfix\">\n                <Button\n                  floated=\"right\"\n                  color=\"blue\"\n                  icon=\"save\"\n                  labelPosition=\"left\"\n                  disabled={processing}\n                  className=\"ml2\"\n                  type=\"submit\"\n                  content=\"Save\"\n                />\n                <Button floated=\"left\" disabled={processing} onClick={onCancel}>\n                  Cancel\n                </Button>\n              </div>\n            </div>\n          )}\n        </Form>\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowCommonStepPropsEditor, {\n  editing: computed,\n  handleEditOn: action,\n  handleEditOff: action,\n  handleSave: action,\n});\n\nexport default inject()(observer(WorkflowCommonStepPropsEditor));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, computed } from 'mobx';\nimport { Icon, Divider, Button, Segment, Header } from 'semantic-ui-react';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\n\nimport ConfigOverrideTable from '../../ConfigOverrideTable';\n\n// expected props\n// - stepEditor - a WorkflowTemplateStepEditor model instance (via props)\n// - onSave - called when the props are saved (via props)\n// - className (via props)\nclass WorkflowTemplateStepConfigOverrideEditor extends React.Component {\n  getStepEditor() {\n    return this.props.stepEditor;\n  }\n\n  getStep() {\n    return this.getStepEditor().step;\n  }\n\n  getConfigOverrideForm() {\n    return this.getStepEditor().configOverrideForm;\n  }\n\n  get editing() {\n    return this.getStepEditor().configOverrideEdit;\n  }\n\n  handleEditOn = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setConfigOverrideEdit(true);\n  };\n\n  handleEditOff = () => {\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setConfigOverrideEdit(false);\n  };\n\n  handleSave = async form => {\n    const onSave = this.props.onSave || _.noop;\n    const stepEditorModel = this.getStepEditor();\n    const values = form.values();\n    const allowed = _.filter(_.keys(values), key => values[key] === true);\n\n    stepEditorModel.applyConfigOverrides(allowed);\n\n    await onSave();\n    stepEditorModel.setConfigOverrideEdit(false);\n  };\n\n  render() {\n    const editing = this.editing;\n    const step = this.getStep();\n    const rows = step.configOverrideSummaryRows || [];\n    const hasRows = rows.length > 0;\n    const canEdit = !editing && hasRows;\n\n    return (\n      <div className={this.props.className}>\n        {!editing && (\n          <div className=\"flex\">\n            <div className=\"flex-auto\">\n              <Icon name=\"cog\" className=\"mr1 color-grey\" />\n              <b>Configuration Override</b>\n            </div>\n            {canEdit && (\n              <div className=\"pl1 pr0\" onClick={this.handleEditOn}>\n                <Icon name=\"edit\" color=\"grey\" className=\"cursor-pointer\" />\n              </div>\n            )}\n          </div>\n        )}\n        <Divider className=\"mt1 mb2\" />\n        {editing && this.renderEditingContent()}\n        {!editing && this.renderReadOnlyContent()}\n      </div>\n    );\n  }\n\n  renderReadOnlyContent() {\n    const step = this.getStep();\n    const configOverrideRows = step.configOverrideSummaryRows || [];\n    const hasRows = configOverrideRows.length > 0;\n\n    return (\n      <>\n        {hasRows && (\n          <Segment padded>\n            <ConfigOverrideTable rows={configOverrideRows} />\n          </Segment>\n        )}\n        {!hasRows && <div>No configuration entries are available</div>}\n      </>\n    );\n  }\n\n  renderEditingContent() {\n    const form = this.getConfigOverrideForm();\n    const step = this.getStep();\n    const configOverrideRows = step.configOverrideSummaryRows || [];\n    const fields = _.map(configOverrideRows, item => form.$(item.name));\n\n    return (\n      <>\n        <Header textAlign=\"center\" as=\"h2\" color=\"grey\" className=\"mt1 mb3\">\n          Change Configuration Override\n        </Header>\n        <Form form={form} dimmer={false} onCancel={this.handleEditOff} onSuccess={this.handleSave}>\n          {({ processing, _onSubmit, onCancel }) => (\n            <div className=\"mt3\">\n              <Segment padded>\n                <ConfigOverrideTable rows={fields} editable processing={processing} />\n              </Segment>\n              <div className=\"mt3 clearfix\">\n                <Button\n                  floated=\"right\"\n                  color=\"blue\"\n                  icon=\"save\"\n                  labelPosition=\"left\"\n                  disabled={processing}\n                  className=\"ml2\"\n                  type=\"submit\"\n                  content=\"Save\"\n                />\n                <Button floated=\"left\" disabled={processing} onClick={onCancel}>\n                  Cancel\n                </Button>\n              </div>\n            </div>\n          )}\n        </Form>\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowTemplateStepConfigOverrideEditor, {\n  editing: computed,\n  handleEditOn: action,\n  handleEditOff: action,\n  handleSave: action,\n});\n\nexport default inject()(observer(WorkflowTemplateStepConfigOverrideEditor));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, computed } from 'mobx';\nimport { Icon, Divider, Button, Segment, Header } from 'semantic-ui-react';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\n\nimport PropsOverrideTable from '../../PropertyOverrideTable';\n\n// expected props\n// - stepEditor - a WorkflowTemplateStepEditor model instance (via props)\n// - onSave - called when the props are saved (via props)\n// - className (via props)\nclass WorkflowTemplateStepPropsOverrideEditor extends React.Component {\n  getStepEditor() {\n    return this.props.stepEditor;\n  }\n\n  getStep() {\n    return this.getStepEditor().step;\n  }\n\n  getPropsOverrideForm() {\n    return this.getStepEditor().propsOverrideForm;\n  }\n\n  get editing() {\n    return this.getStepEditor().propsOverrideEdit;\n  }\n\n  handleEditOn = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setPropsOverrideEdit(true);\n  };\n\n  handleEditOff = () => {\n    const stepEditorModel = this.getStepEditor();\n    stepEditorModel.setPropsOverrideEdit(false);\n  };\n\n  handleSave = async form => {\n    const onSave = this.props.onSave || _.noop;\n    const stepEditorModel = this.getStepEditor();\n    const values = form.values();\n    const allowed = _.filter(_.keys(values), key => values[key] === true);\n\n    stepEditorModel.applyPropsOverrides(allowed);\n\n    await onSave();\n    stepEditorModel.setPropsOverrideEdit(false);\n  };\n\n  render() {\n    const editing = this.editing;\n    const canEdit = !editing;\n\n    return (\n      <div className={this.props.className}>\n        {!editing && (\n          <div className=\"flex\">\n            <div className=\"flex-auto\">\n              <Icon name=\"file alternate outline\" className=\"mr1 color-grey\" />\n              <b>Properties Override</b>\n            </div>\n            {canEdit && (\n              <div className=\"pl1 pr0\" onClick={this.handleEditOn}>\n                <Icon name=\"edit\" color=\"grey\" className=\"cursor-pointer\" />\n              </div>\n            )}\n          </div>\n        )}\n        <Divider className=\"mt1 mb2\" />\n        {editing && this.renderEditingContent()}\n        {!editing && this.renderReadOnlyContent()}\n      </div>\n    );\n  }\n\n  renderReadOnlyContent() {\n    const step = this.getStep();\n    const rows = step.propertyOverrideSummaryRows || [];\n    const hasRows = rows.length > 0;\n\n    return (\n      <>\n        {hasRows && (\n          <Segment padded>\n            <PropsOverrideTable rows={rows} />\n          </Segment>\n        )}\n        {!hasRows && <div>No properties are available to override</div>}\n      </>\n    );\n  }\n\n  renderEditingContent() {\n    const form = this.getPropsOverrideForm();\n    const step = this.getStep();\n    const rows = step.propertyOverrideSummaryRows || [];\n    const fields = _.map(rows, item => form.$(item.name));\n\n    return (\n      <>\n        <Header textAlign=\"center\" as=\"h2\" color=\"grey\" className=\"mt1 mb3\">\n          Change Properties Override\n        </Header>\n        <Form form={form} dimmer={false} onCancel={this.handleEditOff} onSuccess={this.handleSave}>\n          {({ processing, _onSubmit, onCancel }) => (\n            <div className=\"mt3\">\n              <Segment padded>\n                <PropsOverrideTable rows={fields} editable processing={processing} />\n              </Segment>\n              <div className=\"mt3 clearfix\">\n                <Button\n                  floated=\"right\"\n                  color=\"blue\"\n                  icon=\"save\"\n                  labelPosition=\"left\"\n                  disabled={processing}\n                  className=\"ml2\"\n                  type=\"submit\"\n                  content=\"Save\"\n                />\n                <Button floated=\"left\" disabled={processing} onClick={onCancel}>\n                  Cancel\n                </Button>\n              </div>\n            </div>\n          )}\n        </Form>\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowTemplateStepPropsOverrideEditor, {\n  editing: computed,\n  handleEditOn: action,\n  handleEditOff: action,\n  handleSave: action,\n});\n\nexport default inject()(observer(WorkflowTemplateStepPropsOverrideEditor));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, computed } from 'mobx';\n\nimport WorkflowCommonStepEditorCard from '../../../workflow-common/drafts/edit/WorkflowCommonStepEditorCard';\nimport WorkflowCommonStepConfigEditor from '../../../workflow-common/drafts/edit/WorkflowCommonStepConfigEditor';\nimport WorkflowCommonStepDescEditor from '../../../workflow-common/drafts/edit/WorkflowCommonStepDescEditor';\nimport WorkflowCommonStepPropsEditor from '../../../workflow-common/drafts/edit/WorkflowCommonStepPropsEditor';\nimport WorkflowTemplateStepConfigOverrideEditor from './WorkflowTemplateStepConfigOverrideEditor';\nimport WorkflowTemplateStepPropsOverrideEditor from './WorkflowTemplateStepPropsOverrideEditor';\n\n// expected props\n// - stepEditor - a WorkflowTemplateStepEditor model instance (via props)\n// - onSave - called when the configuration is saved (via props)\n// - onDelete - called when the step is to be deleted, passed (step) (via props)\n// - canDelete (via props) defaults to true\n// - canMove (via props) defaults to true\n// - className (via props)\nclass WorkflowTemplateStepEditor extends React.Component {\n  getStepEditor() {\n    return this.props.stepEditor;\n  }\n\n  getStep() {\n    return this.getStepEditor().step;\n  }\n\n  get canDelete() {\n    return this.props.canDelete === undefined ? true : this.props.canDelete;\n  }\n\n  get canMove() {\n    return this.props.canMove === undefined ? true : this.props.canMove;\n  }\n\n  handleDelete = step => {\n    const onDelete = this.props.onDelete || _.noop;\n    onDelete(step);\n  };\n\n  handleSave = async () => {\n    const onSave = this.props.onSave || _.noop;\n\n    return onSave();\n  };\n\n  handleConfigSave = async configs => {\n    const onSave = this.props.onSave || _.noop;\n    const stepEditorModel = this.getStepEditor();\n\n    stepEditorModel.applyDefaults(configs);\n\n    return onSave();\n  };\n\n  render() {\n    const className = this.props.className;\n    const stepEditor = this.getStepEditor();\n    const canDelete = this.canDelete;\n    const canMove = this.canMove;\n\n    return (\n      <WorkflowCommonStepEditorCard\n        stepEditor={stepEditor}\n        canDelete={canDelete}\n        canMove={canMove}\n        className={className}\n        onDelete={this.handleDelete}\n      >\n        <>\n          {this.renderDescription()}\n          {this.renderConfiguration()}\n          {this.renderConfigOverride()}\n          {this.renderProps()}\n          {this.renderPropsOverride()}\n        </>\n      </WorkflowCommonStepEditorCard>\n    );\n  }\n\n  renderDescription() {\n    const editorModel = this.getStepEditor();\n    return <WorkflowCommonStepDescEditor stepEditor={editorModel} onSave={this.handleSave} className=\"mb4\" />;\n  }\n\n  renderConfiguration() {\n    const editorModel = this.getStepEditor();\n\n    return <WorkflowCommonStepConfigEditor stepEditor={editorModel} onSave={this.handleConfigSave} className=\"mb4\" />;\n  }\n\n  renderConfigOverride() {\n    const editorModel = this.getStepEditor();\n    return (\n      <WorkflowTemplateStepConfigOverrideEditor stepEditor={editorModel} onSave={this.handleSave} className=\"mb4\" />\n    );\n  }\n\n  renderProps() {\n    const editorModel = this.getStepEditor();\n    return <WorkflowCommonStepPropsEditor stepEditor={editorModel} onSave={this.handleSave} className=\"mb4\" />;\n  }\n\n  renderPropsOverride() {\n    const editorModel = this.getStepEditor();\n    return <WorkflowTemplateStepPropsOverrideEditor stepEditor={editorModel} onSave={this.handleSave} />;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowTemplateStepEditor, {\n  canDelete: computed,\n  canMove: computed,\n  handleDelete: action,\n  handleSave: action,\n  handleConfigSave: action,\n});\n\nexport default inject()(observer(WorkflowTemplateStepEditor));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, runInAction, observable } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport { Button, Header, Dimmer, Loader } from 'semantic-ui-react';\nimport { displayError, displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\n\nimport getUIState from '../../../workflow-common/component-states/WorkflowCommonCardState';\nimport WorkflowTemplateCardTabs from '../../WorkflowTemplateCardTabs';\n\n// expected props\n// - editor (via prop) an instance of the WorkflowTemplateDraftEditor model\n// - uiEventBus (via props)\n// - location (from react router)\nclass WorkflowTemplateDraftPublisher extends React.Component {\n  constructor(props) {\n    super(props);\n\n    runInAction(() => {\n      this.processing = false;\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  getUiEventBus() {\n    return this.props.uiEventBus;\n  }\n\n  getState() {\n    const template = this.getWorkflowTemplate();\n    return getUIState(`${template.id}-draft-publish-page`);\n  }\n\n  // Return WorkflowTemplateDraftEditor\n  getEditor() {\n    return this.props.editor;\n  }\n\n  getWorkflowTemplate() {\n    return this.getEditor().draft.template;\n  }\n\n  handleCancel = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.processing = false;\n    const onCancel = this.props.onCancel || _.noop;\n    onCancel();\n  };\n\n  handlePrevious = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.processing = false;\n    this.getEditor().previousPage();\n  };\n\n  handlePublish = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n    const editor = this.getEditor();\n    const { draft } = editor;\n    const goto = gotoFn(this);\n\n    this.processing = true;\n\n    try {\n      const publishResult = await editor.publish(draft);\n      runInAction(() => {\n        this.processing = false;\n      });\n      // TODO examine the publishResult and figure out if we have validation errors\n      if (publishResult.hasErrors) {\n        throw new Error('There were validation errors in your submission');\n      }\n      const eventBus = this.getUiEventBus();\n      await eventBus.fireEvent('workflowTemplatePublished', publishResult.template);\n      displaySuccess('The workflow template draft is published successfully');\n      goto('/workflow-templates/published');\n      return;\n    } catch (error) {\n      runInAction(() => {\n        this.processing = false;\n      });\n      displayError(error);\n    }\n  };\n\n  render() {\n    const processing = this.processing;\n    const template = this.getWorkflowTemplate();\n    const uiState = this.getState();\n\n    return (\n      <>\n        <Dimmer.Dimmable dimmed={processing}>\n          <Dimmer active={processing} inverted>\n            <Loader inverted>Processing</Loader>\n          </Dimmer>\n          <Header as=\"h3\" color=\"grey\" className=\"mt0 mb3\">\n            Review &amp; Publish\n          </Header>\n          {/* TODO add an elaborate error/validation error panel, showing errors at all levels including workflow template level and step level */}\n          <WorkflowTemplateCardTabs template={template} uiState={uiState} className=\"mb4 mt0\" />\n        </Dimmer.Dimmable>\n        <div>\n          <Button\n            floated=\"right\"\n            color=\"teal\"\n            disabled={processing}\n            className=\"ml2\"\n            content=\"Publish\"\n            onClick={this.handlePublish}\n          />\n          <Button\n            floated=\"right\"\n            icon=\"left arrow\"\n            labelPosition=\"left\"\n            disabled={processing}\n            className=\"ml3\"\n            content=\"previous\"\n            onClick={this.handlePrevious}\n          />\n          <Button floated=\"left\" disabled={processing} onClick={this.handleCancel}>\n            Cancel\n          </Button>\n        </div>\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowTemplateDraftPublisher, {\n  handleCancel: action,\n  handlePublish: action,\n  handlePrevious: action,\n  processing: observable,\n});\n\nexport default inject('uiEventBus')(withRouter(observer(WorkflowTemplateDraftPublisher)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, observable, runInAction } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport TimeAgo from 'react-timeago';\nimport { Header, Container, Breadcrumb, Label, Segment } from 'semantic-ui-react';\nimport c from 'classnames';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { isStoreReady, isStoreEmpty, isStoreNotEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\nimport ProgressPlaceHolder from '../../../workflow-common/ProgressPlaceholder';\nimport { getWorkflowTemplateDraftEditor } from '../../../../models/workflow-templates/drafts/edit/WorkflowTemplateDraftEditor';\nimport WorkflowTemplateDraftMetaEditor from './WorkflowTemplateDraftMetaEditor';\nimport WorkflowCommonDraftStepsEditor from '../../../workflow-common/drafts/edit/WorkflowCommonDraftStepsEditor';\nimport WorkflowTemplateStepEditor from './WorkflowTemplateStepEditor';\nimport WorkflowTemplateDraftPublisher from './WorkflowTemplateDraftPublisher';\n\n// expected props\n// - workflowTemplateDraftsStore (via injection)\n// - stepTemplatesStore (via injection)\n// - draftId (via react router params)\n// - className (via props)\n// - location (from react router)\nclass WorkflowTemplateDraftEditor extends React.Component {\n  constructor(props) {\n    super(props);\n\n    runInAction(() => {\n      this.stores = new Stores([this.getStore(), this.props.stepTemplatesStore]);\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n    this.stores.load();\n  }\n\n  getStore() {\n    return this.props.workflowTemplateDraftsStore;\n  }\n\n  getStores() {\n    return this.stores;\n  }\n\n  getDraftEditor() {\n    return getWorkflowTemplateDraftEditor(this.getDraft().id);\n  }\n\n  getDraftId() {\n    return decodeURIComponent((this.props.match.params || {}).draftId);\n  }\n\n  getDraft() {\n    const store = this.getStore();\n    if (!isStoreReady(store)) return {};\n    const draftId = this.getDraftId();\n\n    if (_.isNil(draftId)) return {};\n    return store.getDraft(draftId) || {};\n  }\n\n  getTemplateVersion() {\n    const draft = this.getDraft();\n    return draft.template || {};\n  }\n\n  getUserDisplayName() {\n    return this.props.userDisplayName;\n  }\n\n  hasDraft() {\n    const store = this.getStore();\n    const draft = this.getDraft();\n    return store.hasDraft(draft.id);\n  }\n\n  handleCancel = () => {\n    const editor = this.getDraftEditor();\n    editor.cancel();\n    const goto = gotoFn(this);\n    goto('/workflow-templates/published');\n  };\n\n  render() {\n    const stores = this.getStores();\n    const store = this.getStore();\n    let content = null;\n\n    if (stores.hasError) {\n      content = <ErrorBox error={stores.error} className=\"p0\" />;\n    } else if (stores.loading) {\n      content = <ProgressPlaceHolder />;\n    } else if (stores.ready && isStoreEmpty(store)) {\n      content = (\n        <ErrorBox error=\"The workflow template draft does not exist or is no longer available\" className=\"p0\" />\n      );\n    } else if (stores.ready && isStoreNotEmpty(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3\">\n        {this.renderBreadcrumb()}\n        {content}\n      </Container>\n    );\n  }\n\n  renderBreadcrumb() {\n    const draftId = this.getDraftId();\n    const goto = gotoFn(this);\n    return (\n      <Breadcrumb className=\"block mb3\">\n        <Breadcrumb.Section link onClick={() => goto('/workflow-templates/published')}>\n          Workflow Template Drafts\n        </Breadcrumb.Section>\n        <Breadcrumb.Divider icon=\"right angle\" />\n        <Breadcrumb.Section active>{draftId}</Breadcrumb.Section>\n      </Breadcrumb>\n    );\n  }\n\n  renderMain() {\n    const hasDraft = this.hasDraft();\n    const draftId = this.getDraftId();\n    const className = this.props.className;\n    const draft = this.getDraft();\n    const templateVersion = this.getTemplateVersion();\n    const { id, title } = templateVersion;\n    const { createdAt, createdBy } = draft;\n    const userDisplayName = this.getUserDisplayName();\n    const by = () => <span className=\"ml1\">by {userDisplayName.getDisplayName({ uid: createdBy })}</span>;\n\n    if (!hasDraft) {\n      return <ErrorBox error={`The workflow template draft \"${draftId}\" is not available`} className=\"p0\" />;\n    }\n\n    return (\n      <div className={c(className)}>\n        <div className=\"flex mb2\">\n          <Header as=\"h3\" color=\"grey\" className=\"mt0 flex-auto ellipsis\">\n            <Label color=\"teal\" className=\"ml0 mr1\">\n              Draft\n            </Label>\n            {title}\n            <Header.Subheader className=\"fs-9 color-grey mt1\">\n              <div>\n                <span className=\"ellipsis breakout\">{id}</span>\n              </div>\n              <div>\n                created <TimeAgo date={createdAt} /> {by()}\n              </div>\n            </Header.Subheader>\n          </Header>\n        </div>\n        <Segment clearing className=\"p3\">\n          {this.renderContent()}\n        </Segment>\n      </div>\n    );\n  }\n\n  renderContent() {\n    const editor = this.getDraftEditor();\n    const currentPage = editor.currentPage;\n\n    if (currentPage === 0) return this.renderMetaContent(editor);\n    if (currentPage === 1) return this.renderStepsContent(editor);\n    if (currentPage === 2) return this.renderPublishContent(editor);\n    return '';\n  }\n\n  renderMetaContent(editor) {\n    return <WorkflowTemplateDraftMetaEditor editor={editor} onCancel={this.handleCancel} />;\n  }\n\n  renderStepsContent(editor) {\n    return (\n      <WorkflowCommonDraftStepsEditor\n        editor={editor}\n        stepEditor={WorkflowTemplateStepEditor}\n        onCancel={this.handleCancel}\n      />\n    );\n  }\n\n  renderPublishContent(editor) {\n    return <WorkflowTemplateDraftPublisher editor={editor} onCancel={this.handleCancel} />;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowTemplateDraftEditor, {\n  handleCancel: action,\n  stores: observable,\n});\n\nexport default inject(\n  'userDisplayName',\n  'workflowTemplateDraftsStore',\n  'stepTemplatesStore',\n)(withRouter(observer(WorkflowTemplateDraftEditor)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, runInAction } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport TimeAgo from 'react-timeago';\nimport { Header, Icon, Segment, Message, Table } from 'semantic-ui-react';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { isStoreEmpty, isStoreNotEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\n// eslint-disable-next-line import/no-useless-path-segments\nimport whiteGradient from '../../../../src/images/white-gradient.png'; // We need this because we are getting the image from src and not dist\nimport ProgressPlaceHolder from '../../workflow-common/ProgressPlaceholder';\n\n// expected props\n// - workflowsStore (via injection)\n// - userDisplayName (via injection)\n// - location (from react router)\nclass WorkflowPublishedList extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.stores = new Stores([this.getStore()]);\n    });\n  }\n\n  componentDidMount() {\n    this.getStores().load({ forceLoad: true });\n    const store = this.getStore();\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.getStore();\n    store.stopHeartbeat();\n  }\n\n  getStores() {\n    return this.stores;\n  }\n\n  getStore() {\n    return this.props.workflowsStore;\n  }\n\n  getUserDisplayName() {\n    return this.props.userDisplayName;\n  }\n\n  handleWorkflowClick = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    // see https://reactjs.org/docs/events.html and https://github.com/facebook/react/issues/5733\n    const workflowId = event.currentTarget.dataset.workflow;\n    const version = event.currentTarget.dataset.version;\n    const goto = gotoFn(this);\n\n    goto(`/workflows/published/id/${workflowId}/v/${version}`);\n  };\n\n  render() {\n    const stores = this.getStores();\n    const store = this.getStore();\n    let content = null;\n\n    if (stores.hasError) {\n      content = <ErrorBox error={stores.error} className=\"p0\" />;\n    } else if (stores.loading) {\n      content = <ProgressPlaceHolder />;\n    } else if (stores.ready && isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (stores.ready && isStoreNotEmpty(store)) {\n      content = this.renderTable();\n    } else {\n      content = null;\n    }\n\n    return (\n      <div className=\"mb4\">\n        {this.renderTitle()}\n        {content}\n      </div>\n    );\n  }\n\n  renderEmpty() {\n    const show = this.showCreateDraftWizard;\n    if (show) return null;\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"fork\" />\n          No workflows\n          <Header.Subheader>\n            To create a workflow, start by creating a draft and then publish the draft.\n          </Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"fork\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Workflows</Header.Content>\n        </Header>\n      </div>\n    );\n  }\n\n  renderTable() {\n    const store = this.getStore();\n    const list = store.list;\n\n    return (\n      <Table selectable padded>\n        <Table.Header>\n          <Table.Row>\n            <Table.HeaderCell singleLine>Workflow</Table.HeaderCell>\n            <Table.HeaderCell>Updated</Table.HeaderCell>\n          </Table.Row>\n        </Table.Header>\n        <Table.Body>{_.map(list, workflow => this.renderWorkflowRow(workflow))}</Table.Body>\n      </Table>\n    );\n  }\n\n  renderWorkflowRow(workflow) {\n    const latest = workflow.latest;\n    if (!latest)\n      return (\n        <Table.Row>\n          <Table.Cell colSpan=\"2\">\n            <Message warning>\n              <p>Workflow &quot;{workflow.id}&quot; does not have any version!</p>\n            </Message>\n          </Table.Cell>\n        </Table.Row>\n      );\n\n    const { id, v, title, updatedAt, updatedBy } = latest;\n    const userDisplayName = this.getUserDisplayName();\n    const isSystem = userDisplayName.isSystem({ uid: updatedBy });\n    const by = () => (isSystem ? '' : <span>{userDisplayName.getDisplayName({ uid: updatedBy })}</span>);\n\n    return (\n      <Table.Row\n        className=\"cursor-pointer\"\n        key={workflow.id}\n        data-workflow={workflow.id}\n        data-version={workflow.latest.v}\n        onClick={this.handleWorkflowClick}\n      >\n        <Table.Cell>\n          <Header as=\"h4\" color=\"grey\">\n            {title}\n            <Header.Subheader className=\"fs-9\">\n              <div>\n                <span className=\"ellipsis breakout color-grey\">\n                  {id} v{v}\n                </span>\n              </div>\n            </Header.Subheader>\n          </Header>\n        </Table.Cell>\n        <Table.Cell collapsing>\n          <div>{by()}</div>\n          <TimeAgo date={updatedAt} />\n        </Table.Cell>\n      </Table.Row>\n    );\n  }\n\n  renderDescription(latest) {\n    /* eslint-disable react/no-danger */\n    return (\n      <>\n        <div className=\"overflow-hidden height-60-px\">\n          <div dangerouslySetInnerHTML={{ __html: latest.descHtml }} />\n        </div>\n        <img src={whiteGradient} alt=\"\" className=\"absolute height-50-px\" style={{ bottom: '0', maxWidth: '100%' }} />\n      </>\n    );\n    /* eslint-enable react/no-danger */\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowPublishedList, {\n  handleWorkflowClick: action,\n});\n\nexport default inject('workflowsStore', 'userDisplayName')(withRouter(observer(WorkflowPublishedList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '@aws-ee/base-ui/dist/helpers/form';\n\nconst createWorkflowDraftFields = [\n  {\n    name: 'draftFor',\n    label: 'Draft For',\n    placeholder: 'Select one',\n    rules: 'required|in:newWorkflow,existingWorkflow',\n  },\n  {\n    name: 'templateId',\n    label: 'Workflow Template',\n    placeholder: 'Select a workflow template to start from',\n    extra: {\n      explain: `To create a workflow, you need to select an existing workflow template as a starting point.`,\n    },\n    rules: 'required|string|between:3,150|alpha_dash',\n  },\n  {\n    name: 'workflowId',\n    label: 'Workflow Id',\n    placeholder: 'Type a unique id for this workflow',\n    extra: {\n      explain: `This is a required field and the number of characters must be between 3 and 100 and no spaces. Only\n    alpha-numeric characters and dashes are allowed. Once a draft is created you can not change the workflow id.`,\n    },\n    rules: 'required|string|between:3,100|alpha_dash',\n  },\n];\n\nfunction getCreateDraftForm() {\n  return createForm(createWorkflowDraftFields);\n}\n\nexport default getCreateDraftForm;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, runInAction, computed } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport { Label, Segment, Button, Message } from 'semantic-ui-react';\nimport { isStoreEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport DropDown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\n\nimport getCreateDraftForm from '../../../models/forms/CreateWorkflowDraftForm';\nimport ProgressPlaceHolder from '../../workflow-common/ProgressPlaceholder';\n\n// expected props\n// - onCancel (via prop) called on cancel\n// - workflowsStore (via injection)\n// - workflowDraftsStore (via injection)\n// - workflowTemplatesStore (via injection)\n// - className (via props)\n// - location (from react router)\nclass CreateWorkflowDraft extends React.Component {\n  constructor(props) {\n    super(props);\n    this.form = getCreateDraftForm();\n    runInAction(() => {\n      this.stores = new Stores([this.getWorkflowsStore(), this.getDraftsStore(), this.getTemplatesStore()]);\n    });\n  }\n\n  componentDidMount() {\n    this.getStores().load();\n  }\n\n  get emptyWorkflows() {\n    const store = this.getWorkflowsStore();\n    return isStoreEmpty(store);\n  }\n\n  get emptyWorkflowTemplates() {\n    const store = this.getTemplatesStore();\n    return isStoreEmpty(store);\n  }\n\n  getStores() {\n    return this.stores;\n  }\n\n  getWorkflowsStore() {\n    return this.props.workflowsStore;\n  }\n\n  getDraftsStore() {\n    return this.props.workflowDraftsStore;\n  }\n\n  getTemplatesStore() {\n    return this.props.workflowTemplatesStore;\n  }\n\n  getDraftForDropDownOptions() {\n    const hasWorkflows = !this.emptyWorkflows;\n    const hasTemplates = !this.emptyWorkflowTemplates;\n    const options = [];\n\n    if (hasWorkflows) {\n      options.push({\n        value: 'existingWorkflow',\n        text: 'An existing workflow',\n        content: (\n          <div>\n            <Label color=\"teal\" horizontal size=\"mini\">\n              Existing\n            </Label>{' '}\n            An existing workflow\n          </div>\n        ),\n      });\n    }\n\n    if (hasTemplates) {\n      options.push({\n        value: 'newWorkflow',\n        text: 'A new workflow',\n        content: (\n          <div>\n            <Label color=\"blue\" horizontal size=\"mini\">\n              New\n            </Label>{' '}\n            An new workflow\n          </div>\n        ),\n      });\n    }\n\n    return options;\n  }\n\n  getWorkflowDropDownOptions() {\n    const workflowsStore = this.getWorkflowsStore();\n    const draftsStore = this.getDraftsStore();\n    const workflows = workflowsStore.list;\n    const options = [];\n\n    // TODO the approach of looping through all the entries in the workflowsStore is not going to scale beyond 5000 workflows, we need an autocomplete approach\n    // for this\n    _.forEach(workflows, workflow => {\n      if (!draftsStore.hasWorkflow(workflow.id)) {\n        options.push({\n          text: workflow.latest.title || '',\n          value: workflow.id,\n          content: (\n            <div>\n              <Label color=\"teal\" horizontal size=\"mini\">\n                Existing\n              </Label>{' '}\n              {workflow.latest.title} <span className=\"ml1 fs-7 color-grey\">{workflow.id}</span>\n            </div>\n          ),\n        });\n      }\n    });\n\n    return options;\n  }\n\n  getWorkflowTemplatesDropDownOptions() {\n    const templatesStore = this.getTemplatesStore();\n    const templates = templatesStore.list;\n    const options = [];\n\n    _.forEach(templates, template => {\n      options.push({\n        text: template.latest.title || '',\n        value: template.id,\n        content: (\n          <div>\n            <Label color=\"teal\" horizontal size=\"mini\">\n              Template\n            </Label>{' '}\n            {template.latest.title} <span className=\"ml1 fs-7 color-grey\">{template.id}</span>\n          </div>\n        ),\n      });\n    });\n\n    return options;\n  }\n\n  handleDraftForSelectionChange = selection => {\n    const form = this.form;\n    const templateIdField = form.$('templateId');\n    const workflowIdField = form.$('workflowId');\n    const clear = () => {\n      templateIdField.clear();\n      workflowIdField.clear();\n    };\n\n    clear();\n\n    if (selection === 'existingWorkflow') {\n      templateIdField.set('__DO_NOT_USE__');\n    }\n  };\n\n  handleCancel = () => {\n    const onCancel = this.props.onCancel || _.noop;\n    onCancel();\n  };\n\n  handleFormError = (_form, _errors) => {\n    // We don't need to do anything here\n  };\n\n  handleFormSubmission = async form => {\n    const values = form.values();\n    const draftForValue = values.draftFor;\n    const isNewWorkflow = draftForValue === 'newWorkflow';\n\n    const templateId = isNewWorkflow ? values.templateId : undefined;\n    const workflowId = values.workflowId;\n    const draftsStore = this.getDraftsStore();\n    const goto = gotoFn(this);\n\n    try {\n      const draft = await draftsStore.createDraft({ isNewWorkflow, workflowId, templateId });\n      form.clear();\n      this.handleCancel();\n      goto(`/workflows/drafts/edit/${encodeURIComponent(draft.id)}`);\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  render() {\n    const stores = this.getStores();\n    let content = null;\n\n    if (stores.hasError) {\n      content = <ErrorBox error={stores.error} className=\"p0 mb3\" />;\n    } else if (stores.loading) {\n      content = <ProgressPlaceHolder />;\n    } else if (stores.ready) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return content;\n  }\n\n  renderMain() {\n    const form = this.form;\n    const draftForDropDownOptions = this.getDraftForDropDownOptions();\n    const workflowDropDownOptions = this.getWorkflowDropDownOptions();\n    const templatesDropDownOptions = this.getWorkflowTemplatesDropDownOptions();\n    const dropDownField = form.$('draftFor');\n    const templateIdField = form.$('templateId');\n    const workflowIdField = form.$('workflowId');\n    const draftForValue = dropDownField.value;\n    const isNewWorkflow = draftForValue === 'newWorkflow';\n    const isExistingWorkflow = draftForValue === 'existingWorkflow';\n    const empty = this.emptyWorkflowTemplates && this.emptyWorkflows;\n\n    return (\n      <Segment clearing className=\"p3\">\n        <Form\n          form={form}\n          onCancel={this.handleCancel}\n          onSuccess={this.handleFormSubmission}\n          onError={this.handleFormError}\n        >\n          {({ processing, _onSubmit, onCancel }) => (\n            <>\n              {empty && this.renderEmptyMessage()}\n              <DropDown\n                field={dropDownField}\n                options={draftForDropDownOptions}\n                selection\n                fluid\n                disabled={processing}\n                onChange={this.handleDraftForSelectionChange}\n              />\n              {!empty && isNewWorkflow && (\n                <>\n                  <DropDown\n                    field={templateIdField}\n                    options={templatesDropDownOptions}\n                    selection\n                    fluid\n                    disabled={processing}\n                  />\n                  <Input field={workflowIdField} disabled={processing} />\n                </>\n              )}\n              {!empty && isExistingWorkflow && (\n                <DropDown\n                  field={workflowIdField}\n                  options={workflowDropDownOptions}\n                  selection\n                  fluid\n                  disabled={processing}\n                />\n              )}\n              <div className=\"mt3\">\n                <Button floated=\"right\" color=\"blue\" icon disabled={processing || empty} className=\"ml2\" type=\"submit\">\n                  Create Draft\n                </Button>\n                <Button floated=\"right\" disabled={processing} onClick={onCancel}>\n                  Cancel\n                </Button>\n              </div>\n            </>\n          )}\n        </Form>\n      </Segment>\n    );\n  }\n\n  renderEmptyMessage() {\n    return (\n      <Message warning style={{ display: 'block' }}>\n        <Message.Header>Brand new system</Message.Header>\n        <p>\n          This is a brand new installation of the data lake. There are no workflow templates or workflows to create a\n          draft from. At least one workflow template needs to be created before you can create a workflow draft.\n        </p>\n      </Message>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(CreateWorkflowDraft, {\n  emptyWorkflows: computed,\n  emptyWorkflowTemplates: computed,\n  handleDraftForSelectionChange: action,\n  handleCancel: action,\n  handleFormSubmission: action,\n  handleFormError: action,\n});\n\nexport default inject(\n  'workflowsStore',\n  'workflowDraftsStore',\n  'workflowTemplatesStore',\n)(withRouter(observer(CreateWorkflowDraft)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, runInAction, observable } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport { Header, Icon, Segment, Button } from 'semantic-ui-react';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreEmpty, isStoreNotEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\nimport WorkflowCommonDraftCard from '../../workflow-common/drafts/WorkflowCommonDraftCard';\nimport ProgressPlaceHolder from '../../workflow-common/ProgressPlaceholder';\nimport CreateDraftWizard from './CreateWorkflowDraft';\nimport WorkflowTemplateCardTabs from '../../workflow-templates/WorkflowTemplateCardTabs';\n\n// expected props\n// - workflowDraftsStore (via injection)\n// - stepTemplatesStore (via injection)\n// - location (from react router)\nclass WorkflowDraftsList extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.showCreateDraftWizard = false;\n      this.stores = new Stores([this.getStore(), this.props.stepTemplatesStore]);\n    });\n  }\n\n  componentDidMount() {\n    this.getStores().load();\n    const store = this.getStore();\n    swallowError(store.load());\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.getStore();\n    store.stopHeartbeat();\n  }\n\n  getStores() {\n    return this.stores;\n  }\n\n  getStore() {\n    return this.props.workflowDraftsStore;\n  }\n\n  handleCreateDraftClick() {\n    this.showCreateDraftWizard = true;\n  }\n\n  handleCreateDraftCancel() {\n    this.showCreateDraftWizard = false;\n  }\n\n  handleEditDraft = async draft => {\n    const goto = gotoFn(this);\n    goto(`/workflows/drafts/edit/${encodeURIComponent(draft.id)}`);\n  };\n\n  render() {\n    const stores = this.getStores();\n    const store = this.getStore();\n    let content = null;\n\n    if (stores.hasError) {\n      content = <ErrorBox error={stores.error} className=\"p0\" />;\n    } else if (stores.loading) {\n      content = <ProgressPlaceHolder />;\n    } else if (stores.ready && isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (stores.ready && isStoreNotEmpty(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <div className=\"mb4\">\n        {this.renderTitle()}\n        {this.renderWizard()}\n        {content}\n      </div>\n    );\n  }\n\n  renderEmpty() {\n    const show = this.showCreateDraftWizard;\n    if (show) return null;\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"edit outline\" />\n          No workflow drafts\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderTitle() {\n    const disabled = this.showCreateDraftWizard;\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"edit outline\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Workflow Drafts</Header.Content>\n        </Header>\n        <div>\n          <Button basic color=\"blue\" disabled={disabled} onClick={() => this.handleCreateDraftClick()}>\n            Create Draft\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  renderWizard() {\n    const show = this.showCreateDraftWizard;\n    if (!show) return null;\n    return <CreateDraftWizard onCancel={() => this.handleCreateDraftCancel()} />;\n  }\n\n  renderMain() {\n    const store = this.getStore();\n    const list = store.list;\n\n    return (\n      <div>\n        {_.map(list, draft => (\n          <Segment className=\"mb2\" clearing key={draft.id}>\n            <WorkflowCommonDraftCard\n              draft={draft}\n              draftsStore={store}\n              onEdit={this.handleEditDraft}\n              className=\"pt0 pl2 pr2 pb2\"\n            >\n              {({ uiState, version }) => <WorkflowTemplateCardTabs template={version} uiState={uiState} />}\n            </WorkflowCommonDraftCard>\n          </Segment>\n        ))}\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowDraftsList, {\n  handleCreateDraftClick: action,\n  handleCreateDraftCancel: action,\n  handleEditDraft: action,\n  showCreateDraftWizard: observable,\n});\n\nexport default inject('workflowDraftsStore', 'stepTemplatesStore')(withRouter(observer(WorkflowDraftsList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Container } from 'semantic-ui-react';\n\nimport WorkflowPublishedList from './published/WorkflowPublishedList';\nimport WorkflowDraftsList from './drafts/WorkflowDraftsList';\n\n// expected props\n// - location (from react router)\nclass WorkflowsList extends React.Component {\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  render() {\n    return (\n      <Container className=\"mt3\">\n        <WorkflowPublishedList />\n        <WorkflowDraftsList />\n      </Container>\n    );\n  }\n}\n\nexport default inject()(withRouter(observer(WorkflowsList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, computed } from 'mobx';\n\nimport WorkflowCommonStepEditorCard from '../../../workflow-common/drafts/edit/WorkflowCommonStepEditorCard';\nimport WorkflowCommonStepDescEditor from '../../../workflow-common/drafts/edit/WorkflowCommonStepDescEditor';\nimport WorkflowCommonStepPropsEditor from '../../../workflow-common/drafts/edit/WorkflowCommonStepPropsEditor';\nimport WorkflowCommonStepConfigEditor from '../../../workflow-common/drafts/edit/WorkflowCommonStepConfigEditor';\n\n// expected props\n// - stepEditor - a WorkflowStepEditor model instance (via props)\n// - onSave - called when the configuration is saved (via props)\n// - onDelete - called when the step is to be deleted, passed (step) (via props)\n// - canDelete (via props) defaults to true\n// - canMove (via props) defaults to true\n// - className (via props)\n// - location (from react router)\nclass WorkflowStepEditor extends React.Component {\n  getStepEditor() {\n    return this.props.stepEditor;\n  }\n\n  getStep() {\n    return this.getStepEditor().step;\n  }\n\n  get canDelete() {\n    return this.props.canDelete === undefined ? true : this.props.canDelete;\n  }\n\n  get canMove() {\n    return this.props.canMove === undefined ? true : this.props.canMove;\n  }\n\n  handleDelete = step => {\n    const onDelete = this.props.onDelete || _.noop;\n    onDelete(step);\n  };\n\n  handleSave = async () => {\n    const onSave = this.props.onSave || _.noop;\n\n    return onSave();\n  };\n\n  handleConfigSave = async configs => {\n    const onSave = this.props.onSave || _.noop;\n    const stepEditorModel = this.getStepEditor();\n\n    stepEditorModel.applyConfigs(configs);\n\n    return onSave();\n  };\n\n  render() {\n    const className = this.props.className;\n    const stepEditor = this.getStepEditor();\n    const canDelete = this.canDelete;\n    const canMove = this.canMove;\n\n    return (\n      <WorkflowCommonStepEditorCard\n        stepEditor={stepEditor}\n        canDelete={canDelete}\n        canMove={canMove}\n        className={className}\n        onDelete={this.handleDelete}\n      >\n        <>\n          {this.renderDescription()}\n          {this.renderConfiguration()}\n          {this.renderProps()}\n        </>\n      </WorkflowCommonStepEditorCard>\n    );\n  }\n\n  renderDescription() {\n    const editorModel = this.getStepEditor();\n    return <WorkflowCommonStepDescEditor stepEditor={editorModel} onSave={this.handleSave} className=\"mb4\" />;\n  }\n\n  renderConfiguration() {\n    const editorModel = this.getStepEditor();\n\n    return <WorkflowCommonStepConfigEditor stepEditor={editorModel} onSave={this.handleConfigSave} className=\"mb4\" />;\n  }\n\n  renderProps() {\n    const editorModel = this.getStepEditor();\n    return <WorkflowCommonStepPropsEditor stepEditor={editorModel} onSave={this.handleSave} className=\"mb2\" />;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowStepEditor, {\n  canDelete: computed,\n  canMove: computed,\n  handleDelete: action,\n  handleSave: action,\n  handleConfigSave: action,\n});\n\nexport default inject()(observer(WorkflowStepEditor));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, runInAction, observable } from 'mobx';\nimport { Button, Header, Divider, Icon } from 'semantic-ui-react';\nimport { displayError, displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport DropDown from '@aws-ee/base-ui/dist/parts/helpers/fields/DropDown';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\n\n// expected props\n// - editor (via props) an instance of the WorkflowDraftEditor model\n// - onCancel (via props)\nclass WorkflowDraftMetaEditor extends React.Component {\n  constructor(props) {\n    super(props);\n\n    runInAction(() => {\n      this.clickedOnNext = false;\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  // Returns WorkflowTemplateDraftEditor\n  getEditor() {\n    return this.props.editor;\n  }\n\n  // Returns WorkflowVersion\n  getVersion() {\n    return this.getEditor().version;\n  }\n\n  getMetaForm() {\n    return this.getEditor().metaForm;\n  }\n\n  resetFlags() {\n    // we use these flags to tell the difference between clicking on 'save' vs 'next' because\n    // 'next' will result in saving the form\n    this.clickedOnNext = false;\n  }\n\n  handleCancel = () => {\n    this.resetFlags();\n    const onCancel = this.props.onCancel || _.noop;\n    onCancel();\n  };\n\n  handlePrevious = event => {\n    // we don't save the form in this case\n    this.resetFlags();\n    event.preventDefault();\n    event.stopPropagation();\n    this.getEditor().previousPage();\n  };\n\n  handleOnSubmitNext(event, onSubmit) {\n    event.preventDefault();\n    event.stopPropagation();\n    this.resetFlags();\n    this.clickedOnNext = true;\n\n    onSubmit(event); // this will eventually call handleFormSubmission()\n  }\n\n  handleFormSubmission = async form => {\n    const editor = this.getEditor();\n    const { title, desc, instanceTtl, runSpecSize, runSpecTarget } = form.values();\n    const { draft } = editor;\n    const version = editor.version;\n\n    version.setTitle(title);\n    version.setDescription(desc);\n    version.setInstanceTtl(instanceTtl);\n    version.setRunSpec({\n      size: runSpecSize,\n      target: runSpecTarget,\n    });\n\n    try {\n      await editor.update(draft);\n      if (this.clickedOnNext) {\n        this.getEditor().nextPage();\n        return;\n      }\n      displaySuccess('The workflow draft is saved successfully');\n    } catch (error) {\n      runInAction(() => {\n        this.resetFlags();\n      });\n      displayError(error);\n    }\n  };\n\n  handleFormErrors = () => {\n    window.scrollTo(0, 0);\n  };\n\n  render() {\n    const editor = this.getEditor();\n    const hasPrevious = editor.hasPreviousPage;\n    const form = this.getMetaForm();\n    const titleField = form.$('title');\n    const descField = form.$('desc');\n    const instanceTtlField = form.$('instanceTtl');\n    const runSpecSizeField = form.$('runSpecSize');\n    const runSpecTargetField = form.$('runSpecTarget');\n\n    return (\n      <Form\n        form={form}\n        onCancel={this.handleCancel}\n        onSuccess={this.handleFormSubmission}\n        onError={this.handleFormErrors}\n      >\n        {({ processing, onSubmit, onCancel }) => (\n          <>\n            <Input field={titleField} disabled={processing} />\n            <TextArea field={descField} rows={6} disabled={processing} />\n            <Divider horizontal className=\"mb3\">\n              <Header as=\"h4\" className=\"color-grey\">\n                <Icon name=\"list alternate outline\" className=\"color-grey\" />\n                Properties\n              </Header>\n            </Divider>\n            <Input field={instanceTtlField} disabled={processing} />\n            <DropDown field={runSpecSizeField} disabled={processing} fluid={false} selection />\n            <DropDown field={runSpecTargetField} disabled={processing} fluid={false} selection />\n            <div className=\"mt4\">\n              <Button\n                floated=\"right\"\n                color=\"teal\"\n                icon=\"right arrow\"\n                labelPosition=\"right\"\n                disabled={processing}\n                className=\"ml2\"\n                content=\"Next\"\n                onClick={e => this.handleOnSubmitNext(e, onSubmit)}\n              />\n              {hasPrevious && (\n                <Button\n                  floated=\"right\"\n                  icon=\"left arrow\"\n                  labelPosition=\"left\"\n                  disabled={processing}\n                  className=\"ml3\"\n                  content=\"previous\"\n                  onClick={this.handlePrevious}\n                />\n              )}\n              <Button\n                floated=\"right\"\n                color=\"blue\"\n                icon=\"save\"\n                labelPosition=\"left\"\n                disabled={processing}\n                className=\"ml2\"\n                content=\"Save\"\n              />\n              <Button floated=\"left\" disabled={processing} onClick={onCancel}>\n                Cancel\n              </Button>\n            </div>\n          </>\n        )}\n      </Form>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowDraftMetaEditor, {\n  handleCancel: action,\n  handleOnSubmitNext: action,\n  handleFormSubmission: action,\n  handleFormErrors: action,\n  handlePrevious: action,\n  resetFlags: action,\n  clickedOnNext: observable,\n});\n\nexport default inject()(observer(WorkflowDraftMetaEditor));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, runInAction, observable } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport { Button, Header, Dimmer, Loader } from 'semantic-ui-react';\nimport { displayError, displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\n\nimport getUIState from '../../../workflow-common/component-states/WorkflowCommonCardState';\nimport WorkflowTemplateCardTabs from '../../../workflow-templates/WorkflowTemplateCardTabs';\n\n// expected props\n// - editor (via prop) an instance of the WorkflowDraftEditor model\n// - uiEventBus (via props)\n// - onCancel (via props)\n// - location (from react router)\nclass WorkflowDraftPublisher extends React.Component {\n  constructor(props) {\n    super(props);\n\n    runInAction(() => {\n      this.processing = false;\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  getUiEventBus() {\n    return this.props.uiEventBus;\n  }\n\n  getState() {\n    const version = this.getVersion();\n    return getUIState(`${version.id}-workflow-draft-publish-page`);\n  }\n\n  // Return WorkflowDraftEditor\n  getEditor() {\n    return this.props.editor;\n  }\n\n  // Returns WorkflowVersion\n  getVersion() {\n    return this.getEditor().version;\n  }\n\n  handleCancel = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.processing = false;\n    const onCancel = this.props.onCancel || _.noop;\n    onCancel();\n  };\n\n  handlePrevious = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.processing = false;\n    this.getEditor().previousPage();\n  };\n\n  handlePublish = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n    const editor = this.getEditor();\n    const { draft } = editor;\n    const goto = gotoFn(this);\n\n    this.processing = true;\n\n    try {\n      const publishResult = await editor.publish(draft);\n      runInAction(() => {\n        this.processing = false;\n      });\n      // TODO examine the publishResult and figure out if we have validation errors\n      if (publishResult.hasErrors) {\n        throw new Error('There were validation errors in your submission');\n      }\n      const eventBus = this.getUiEventBus();\n      await eventBus.fireEvent('workflowPublished', publishResult.workflow);\n      displaySuccess('The workflow draft is published successfully');\n      goto('/workflows/published');\n      return;\n    } catch (error) {\n      runInAction(() => {\n        this.processing = false;\n      });\n      displayError(error);\n    }\n  };\n\n  render() {\n    const processing = this.processing;\n    const version = this.getVersion();\n    const uiState = this.getState();\n\n    return (\n      <>\n        <Dimmer.Dimmable dimmed={processing}>\n          <Dimmer active={processing} inverted>\n            <Loader inverted>Processing</Loader>\n          </Dimmer>\n          <Header as=\"h3\" color=\"grey\" className=\"mt0 mb3\">\n            Review &amp; Publish\n          </Header>\n          {/* TODO add an elaborate error/validation error panel, showing errors at all levels including workflow level and step level */}\n          <WorkflowTemplateCardTabs template={version} uiState={uiState} className=\"mb4 mt0\" />\n        </Dimmer.Dimmable>\n        <div>\n          <Button\n            floated=\"right\"\n            color=\"teal\"\n            disabled={processing}\n            className=\"ml2\"\n            content=\"Publish\"\n            onClick={this.handlePublish}\n          />\n          <Button\n            floated=\"right\"\n            icon=\"left arrow\"\n            labelPosition=\"left\"\n            disabled={processing}\n            className=\"ml3\"\n            content=\"previous\"\n            onClick={this.handlePrevious}\n          />\n          <Button floated=\"left\" disabled={processing} onClick={this.handleCancel}>\n            Cancel\n          </Button>\n        </div>\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowDraftPublisher, {\n  handleCancel: action,\n  handlePublish: action,\n  handlePrevious: action,\n  processing: observable,\n});\n\nexport default inject('uiEventBus')(withRouter(observer(WorkflowDraftPublisher)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, observable, runInAction } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport TimeAgo from 'react-timeago';\nimport { Header, Container, Breadcrumb, Label, Segment } from 'semantic-ui-react';\nimport c from 'classnames';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { isStoreReady, isStoreEmpty, isStoreNotEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\nimport ProgressPlaceHolder from '../../../workflow-common/ProgressPlaceholder';\nimport { getWorkflowDraftEditor } from '../../../../models/workflows/drafts/edit/WorkflowDraftEditor';\nimport WorkflowCommonDraftStepsEditor from '../../../workflow-common/drafts/edit/WorkflowCommonDraftStepsEditor';\nimport WorkflowStepEditor from './WorkflowStepEditor';\nimport WorkflowDraftMetaEditor from './WorkflowDraftMetaEditor';\nimport WorkflowDraftPublisher from './WorkflowDraftPublisher';\n\n// expected props\n// - workflowDraftsStore (via injection)\n// - workflowTemplatesStore (via injection)\n// - stepTemplatesStore (via injection)\n// - userDisplayName (via injection)\n// - draftId (via react router params)\n// - className (via props)\n// - location (from react router)\nclass WorkflowDraftEditor extends React.Component {\n  constructor(props) {\n    super(props);\n\n    runInAction(() => {\n      this.stores = new Stores([this.getStore(), this.props.workflowTemplatesStore, this.props.stepTemplatesStore]);\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n    this.stores.load();\n  }\n\n  getStore() {\n    return this.props.workflowDraftsStore;\n  }\n\n  getStores() {\n    return this.stores;\n  }\n\n  getUserDisplayName() {\n    return this.props.userDisplayName;\n  }\n\n  getWorkflowDraftEditor() {\n    return getWorkflowDraftEditor(this.getDraft().id);\n  }\n\n  getDraftId() {\n    return decodeURIComponent((this.props.match.params || {}).draftId);\n  }\n\n  getDraft() {\n    const store = this.getStore();\n    if (!isStoreReady(store)) return {};\n    const draftId = this.getDraftId();\n\n    if (_.isNil(draftId)) return {};\n    return store.getDraft(draftId) || {};\n  }\n\n  getVersion() {\n    const draftEditor = this.getWorkflowDraftEditor();\n    return draftEditor.version;\n  }\n\n  hasDraft() {\n    const store = this.getStore();\n    const draft = this.getDraft();\n    return store.hasDraft(draft.id);\n  }\n\n  handleCancel = () => {\n    const draftEditor = this.getWorkflowDraftEditor();\n    const goto = gotoFn(this);\n    draftEditor.cancel();\n    goto('/workflows/published');\n  };\n\n  render() {\n    const stores = this.getStores();\n    const store = this.getStore();\n    let content = null;\n\n    if (stores.hasError) {\n      content = <ErrorBox error={stores.error} className=\"p0\" />;\n    } else if (stores.loading) {\n      content = <ProgressPlaceHolder />;\n    } else if (stores.ready && isStoreEmpty(store)) {\n      content = <ErrorBox error=\"The workflow draft does not exist or is no longer available\" className=\"p0\" />;\n    } else if (stores.ready && isStoreNotEmpty(store) && !this.hasDraft()) {\n      content = <ErrorBox error=\"The workflow draft does not exist or is no longer available\" className=\"p0\" />;\n    } else if (stores.ready && isStoreNotEmpty(store) && this.hasDraft()) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3\">\n        {this.renderBreadcrumb()}\n        {content}\n      </Container>\n    );\n  }\n\n  renderBreadcrumb() {\n    const draftId = this.getDraftId();\n    const goto = gotoFn(this);\n\n    return (\n      <Breadcrumb className=\"block mb3\">\n        <Breadcrumb.Section link onClick={() => goto('/workflows/published')}>\n          Workflow Drafts\n        </Breadcrumb.Section>\n        <Breadcrumb.Divider icon=\"right angle\" />\n        <Breadcrumb.Section active>{draftId}</Breadcrumb.Section>\n      </Breadcrumb>\n    );\n  }\n\n  renderMain() {\n    const hasDraft = this.hasDraft();\n    const draftId = this.getDraftId();\n    const className = this.props.className;\n    const draft = this.getDraft();\n    const version = this.getVersion();\n    const { id, title } = version;\n    const { createdAt, createdBy } = draft;\n    const userDisplayName = this.getUserDisplayName();\n    const by = () => <span className=\"ml1\">by {userDisplayName.getDisplayName({ uid: createdBy })}</span>;\n\n    if (!hasDraft) {\n      return <ErrorBox error={`The workflow template draft \"${draftId}\" is not available`} className=\"p0\" />;\n    }\n\n    return (\n      <div className={c(className)}>\n        <div className=\"flex mb2\">\n          <Header as=\"h3\" color=\"grey\" className=\"mt0 flex-auto ellipsis\">\n            <Label color=\"teal\" className=\"ml0 mr1\">\n              Draft\n            </Label>\n            {title}\n            <Header.Subheader className=\"fs-9 color-grey mt1\">\n              <div>\n                <span className=\"ellipsis breakout\">{id}</span>\n              </div>\n              <div>\n                created <TimeAgo date={createdAt} /> {by()}\n              </div>\n            </Header.Subheader>\n          </Header>\n        </div>\n        <Segment clearing className=\"p3\">\n          {this.renderContent()}\n        </Segment>\n      </div>\n    );\n  }\n\n  renderContent() {\n    const draftEditor = this.getWorkflowDraftEditor();\n    const currentPage = draftEditor.currentPage;\n\n    if (currentPage === 0) return this.renderMetaContent(draftEditor);\n    if (currentPage === 1) return this.renderStepsContent(draftEditor);\n    if (currentPage === 2) return this.renderPublishContent(draftEditor);\n    return '';\n  }\n\n  renderMetaContent(editor) {\n    return <WorkflowDraftMetaEditor editor={editor} onCancel={this.handleCancel} />;\n  }\n\n  renderStepsContent(editor) {\n    return (\n      <WorkflowCommonDraftStepsEditor editor={editor} stepEditor={WorkflowStepEditor} onCancel={this.handleCancel} />\n    );\n  }\n\n  renderPublishContent(editor) {\n    return <WorkflowDraftPublisher editor={editor} onCancel={this.handleCancel} />;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowDraftEditor, {\n  handleCancel: action,\n  stores: observable,\n});\n\nexport default inject(\n  'userDisplayName',\n  'workflowDraftsStore',\n  'workflowTemplatesStore',\n  'stepTemplatesStore',\n)(withRouter(observer(WorkflowDraftEditor)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '@aws-ee/base-ui/dist/helpers/form';\n\nconst triggerWorkflowFields = [\n  {\n    name: 'workflowInput',\n    label: 'Workflow Input',\n    placeholder: 'Provide a JSON input',\n    extra: {\n      explain: `This is an advance operation. You will need to provide an input in the form of a json object.`,\n    },\n    rules: 'string',\n  },\n];\n\nfunction getTriggerWorkflowForm() {\n  return createForm(triggerWorkflowFields);\n}\n\nexport default getTriggerWorkflowForm;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action, autorun, runInAction, observable } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport TimeAgo from 'react-timeago';\nimport { Header, Segment, Icon, Statistic, Grid, Label, Button } from 'semantic-ui-react';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { swallowError, niceNumber } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreError, isStoreReady, isStoreLoading, isStoreEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\nimport getTriggerWorkflowForm from '../../../models/forms/TriggerWorkflowForm';\nimport ProgressPlaceHolder from '../../workflow-common/ProgressPlaceholder';\n\n// expected props\n// - workflowVersion (via props)\n// - workflowsStore (via injection)\n// - userDisplayName (via injection)\n// - location (from react router)\nclass WorkflowInstancesList extends React.Component {\n  constructor(props) {\n    super(props);\n    this.form = getTriggerWorkflowForm();\n    runInAction(() => {\n      this.triggerDialogShown = false;\n    });\n  }\n\n  componentDidMount() {\n    if (this.disposer) this.disposer();\n\n    this.disposer = autorun(() => {\n      const store = this.getInstancesStore();\n      if (!isStoreReady(store)) swallowError(store.load());\n    });\n\n    const store = this.getInstancesStore();\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.getInstancesStore();\n    store.stopHeartbeat();\n    if (this.disposer) this.disposer();\n  }\n\n  getWorkflowVersion() {\n    return this.props.workflowVersion;\n  }\n\n  getWorkflowStore() {\n    const workflowVersion = this.getWorkflowVersion();\n    return this.props.workflowsStore.getWorkflowStore(workflowVersion.id);\n  }\n\n  getInstancesStore() {\n    const workflowStore = this.getWorkflowStore();\n    const workflowVersion = this.getWorkflowVersion();\n    return workflowStore.getInstancesStore(workflowVersion.id, workflowVersion.v);\n  }\n\n  getUserDisplayName() {\n    return this.props.userDisplayName;\n  }\n\n  cancelTriggerDialog = () => {\n    this.triggerDialogShown = false;\n  };\n\n  showTriggerDialog = () => {\n    this.triggerDialogShown = true;\n  };\n\n  handleFormSubmission = async form => {\n    const values = form.values();\n    const workflowInputStr = values.workflowInput;\n\n    try {\n      const store = this.getInstancesStore();\n\n      // Convert input JSON string to an input object\n      const input = JSON.parse(workflowInputStr);\n      await store.triggerWorkflow({ input });\n\n      form.clear();\n      this.cancelTriggerDialog();\n    } catch (error) {\n      if (error instanceof SyntaxError) {\n        displayError('Incorrect workflow input. Make sure the workflow input is a well-formed JSON.');\n      } else {\n        displayError(error);\n      }\n    }\n  };\n\n  handleInstanceClick = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    // see https://reactjs.org/docs/events.html and https://github.com/facebook/react/issues/5733\n    const instanceId = event.currentTarget.dataset.instance;\n    const goto = gotoFn(this);\n    const { id, v } = this.getWorkflowVersion();\n\n    goto(`/workflows/published/id/${id}/v/${v}/instances/id/${instanceId}`);\n  };\n\n  render() {\n    const store = this.getInstancesStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder />;\n    } else if (isStoreReady(store) && isStoreEmpty(store)) {\n      content = this.renderEmptyInstances();\n    } else if (isStoreReady(store) && !isStoreEmpty(store)) {\n      content = this.renderMain();\n    } else {\n      // We get here if the store is in the initial state\n      content = null;\n    }\n\n    return (\n      <>\n        {this.renderTriggerDialog()}\n        {content}\n      </>\n    );\n  }\n\n  renderMain() {\n    const store = this.getInstancesStore();\n    const list = store.list;\n\n    return _.map(list, instance => this.renderRow(instance));\n  }\n\n  renderRow(instance) {\n    const { id, createdAt, createdBy, statusSummary } = instance;\n    const userDisplayName = this.getUserDisplayName();\n    const by = () => <span>{userDisplayName.getDisplayName({ uid: createdBy })}</span>;\n    const { statusLabel, statusColor, stepsSummary } = statusSummary;\n\n    return (\n      <Segment\n        clearing\n        padded\n        key={id}\n        className=\"mb3 cursor-pointer\"\n        data-instance={id}\n        onClick={this.handleInstanceClick}\n      >\n        <Grid celled=\"internally\" stackable>\n          <Grid.Row stretched>\n            <Grid.Column width={3} className=\"center pr3\">\n              <Label color={statusColor} className=\"fluid center mb1\">\n                {statusLabel}\n              </Label>\n              <div className=\"mb1\">\n                id <b>{id}</b>\n              </div>\n              <TimeAgo date={createdAt} />\n              {by()}\n            </Grid.Column>\n            <Grid.Column width={13}>\n              <div className=\"mb2 center\">Steps</div>\n              <Statistic.Group widths=\"five\" size=\"tiny\">\n                {_.map(stepsSummary, item => (\n                  <Statistic key={item.statusLabel} color={item.statusColor}>\n                    <Statistic.Value>{niceNumber(item.count)}</Statistic.Value>\n                    <Statistic.Label>{item.statusLabel}</Statistic.Label>\n                  </Statistic>\n                ))}\n              </Statistic.Group>\n            </Grid.Column>\n          </Grid.Row>\n        </Grid>\n      </Segment>\n    );\n  }\n\n  renderEmptyInstances() {\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"copy outline\" />\n          No instances\n          <Header.Subheader>\n            Once the workflow is triggered at least once, you will start seeing information about the instances in this\n            area.\n          </Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderTriggerDialog() {\n    const show = this.triggerDialogShown;\n\n    return (\n      <>\n        {!show && (\n          <div className=\"clearfix mb2\">\n            <Button basic color=\"blue\" floated=\"right\" onClick={this.showTriggerDialog}>\n              Trigger\n            </Button>\n          </div>\n        )}\n        {show && this.renderTriggerDialogContent()}\n      </>\n    );\n  }\n\n  renderTriggerDialogContent() {\n    const form = this.form;\n    const workflowInputField = form.$('workflowInput');\n\n    return (\n      <Segment clearing className=\"p3 mb3 mt3\">\n        <Form\n          form={form}\n          onCancel={this.cancelTriggerDialog}\n          onSuccess={this.handleFormSubmission}\n          onError={this.handleFormError}\n        >\n          {({ processing, _onSubmit, onCancel }) => (\n            <>\n              <TextArea field={workflowInputField} disabled={processing} />\n              <div className=\"mt0\">\n                <Button floated=\"right\" color=\"blue\" icon disabled={processing} className=\"ml2\" type=\"submit\">\n                  Trigger\n                </Button>\n                <Button floated=\"right\" disabled={processing} onClick={onCancel}>\n                  Cancel\n                </Button>\n              </div>\n            </>\n          )}\n        </Form>\n      </Segment>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowInstancesList, {\n  triggerDialogShown: observable,\n  handleInstanceClick: action,\n  showTriggerDialog: action,\n  cancelTriggerDialog: action,\n  handleFormSubmission: action,\n});\n\nexport default inject('workflowsStore', 'userDisplayName')(withRouter(observer(WorkflowInstancesList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport TimeAgo from 'react-timeago';\nimport { Header, Segment, Icon, Table } from 'semantic-ui-react';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreError, isStoreReady, isStoreLoading, isStoreEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\nimport ProgressPlaceHolder from '../../workflow-common/ProgressPlaceholder';\n\n// expected props\n// - workflowVersion (via props)\n// - workflowsStore (via injection)\n// - userDisplayName (via injection)\n// - location (from react router)\nclass WorkflowAssignmentsList extends React.Component {\n  componentDidMount() {\n    const store = this.getAssignmentsStore();\n    swallowError(store.load());\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.getAssignmentsStore();\n    store.stopHeartbeat();\n  }\n\n  getWorkflowVersion() {\n    return this.props.workflowVersion;\n  }\n\n  getWorkflowStore() {\n    const version = this.getWorkflowVersion();\n    return this.props.workflowsStore.getWorkflowStore(version.id);\n  }\n\n  getAssignmentsStore() {\n    const workflowStore = this.getWorkflowStore();\n    return workflowStore.getAssignmentsStore();\n  }\n\n  getUserDisplayName() {\n    return this.props.userDisplayName;\n  }\n\n  render() {\n    const store = this.getAssignmentsStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder />;\n    } else if (isStoreReady(store) && isStoreEmpty(store)) {\n      content = this.renderEmptyAssignments();\n    } else if (isStoreReady(store) && !isStoreEmpty(store)) {\n      content = this.renderMain();\n    } else {\n      // We get here if the store is in the initial state\n      content = null;\n    }\n\n    return <>{content}</>;\n  }\n\n  renderMain() {\n    const store = this.getAssignmentsStore();\n    const assignments = store.list;\n\n    return <Segment padded>{this.renderAssignmentsTable(assignments)}</Segment>;\n  }\n\n  renderAssignmentsTable(assignments) {\n    return (\n      <Table basic=\"very\" className=\"animated\">\n        <Table.Header>\n          <Table.Row>\n            <Table.HeaderCell width={1}>Id</Table.HeaderCell>\n            <Table.HeaderCell width={4}>Trigger</Table.HeaderCell>\n            <Table.HeaderCell width={8}>Configuration</Table.HeaderCell>\n            <Table.HeaderCell width={3}>Updated</Table.HeaderCell>\n          </Table.Row>\n        </Table.Header>\n        <Table.Body>{_.map(assignments, assignment => this.renderAssignmentRow(assignment))}</Table.Body>\n      </Table>\n    );\n  }\n\n  renderAssignmentRow(assignment) {\n    const { id, updatedAt, updatedBy, triggerType, triggerTypeData: config } = assignment;\n    const userDisplayName = this.getUserDisplayName();\n    const isSystem = userDisplayName.isSystem({ uid: updatedBy });\n    const by = () => (isSystem ? '' : <span>by {userDisplayName.getDisplayName({ uid: updatedBy })}</span>);\n\n    return (\n      <Table.Row key={id}>\n        <Table.Cell>{id}</Table.Cell>\n        <Table.Cell>{triggerType}</Table.Cell>\n        <Table.Cell>{config}</Table.Cell>\n        <Table.Cell>\n          <TimeAgo date={updatedAt} />\n          <div>{by()}&nbsp;</div>\n        </Table.Cell>\n      </Table.Row>\n    );\n  }\n\n  renderEmptyAssignments() {\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"chain\" />\n          No assignments\n          <Header.Subheader>\n            Assignments allow you to configure the workflow to be triggered based on different criteria, try it out!\n          </Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowAssignmentsList, {});\n\nexport default inject('workflowsStore', 'userDisplayName')(withRouter(observer(WorkflowAssignmentsList)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject, Observer } from 'mobx-react';\nimport { decorate, action } from 'mobx';\nimport { Tab, Grid, Label, Segment } from 'semantic-ui-react';\n\nimport PropertySection from '../../workflow-templates/PropertySection';\nimport WorkflowTemplateStep from '../../workflow-templates/WorkflowTemplateStep';\nimport WorkflowInstancesList from './WorkflowInstancesList';\nimport WorkflowAssignmentsList from './WorkflowAssignmentsList';\n\n// expected props\n// - workflow - either a WorkflowVersion model instance (via props)\n// - uiState - to keep track of the active tab (via props)\n// - className (via props)\nclass WorkflowDetailTabs extends React.Component {\n  getState() {\n    return this.props.uiState;\n  }\n\n  selectedMainTabIndex() {\n    return this.getState().mainTabIndex;\n  }\n\n  getVersion() {\n    return this.props.workflow;\n  }\n\n  handleTabChange = (event, data) => {\n    this.getState().setMainTabIndex(data.activeIndex);\n  };\n\n  render() {\n    const className = this.props.className || 'mt0';\n    const workflow = this.getVersion();\n    const id = workflow.id;\n    const v = workflow.v;\n\n    const activeIndex = this.selectedMainTabIndex();\n    const panes = [\n      {\n        menuItem: 'Instances',\n        render: () => (\n          <Tab.Pane basic attached={false} className=\"mt0 pt0\">\n            <WorkflowInstancesList workflowVersion={workflow} id={id} v={v} />\n          </Tab.Pane>\n        ),\n      },\n      {\n        menuItem: 'Assignment',\n        render: () => (\n          <Tab.Pane basic attached={false}>\n            <WorkflowAssignmentsList workflowVersion={workflow} />\n          </Tab.Pane>\n        ),\n      },\n      {\n        menuItem: 'Steps',\n        render: () => (\n          <Tab.Pane basic attached={false}>\n            <Observer>{() => this.renderSteps(workflow)}</Observer>\n          </Tab.Pane>\n        ),\n      },\n      {\n        menuItem: 'Properties',\n        render: () => (\n          <Tab.Pane basic attached={false}>\n            <PropertySection model={workflow} />\n          </Tab.Pane>\n        ),\n      },\n    ];\n\n    return (\n      <Tab\n        className={className}\n        activeIndex={activeIndex}\n        menu={{ secondary: true, pointing: true }}\n        panes={panes}\n        onTabChange={this.handleTabChange}\n      />\n    );\n  }\n\n  renderSteps(workflow) {\n    const steps = workflow.selectedSteps || [];\n\n    if (steps.length === 0) {\n      return <span>No steps are provided</span>;\n    }\n\n    return (\n      <Grid padded={false} className=\"animated\">\n        {_.map(steps, (step, index) => (\n          <Grid.Row key={index} className=\"pb0\">\n            <Grid.Column width={1}>\n              <Label circular className=\"mt1 mb1\">\n                {index + 1}\n              </Label>\n            </Grid.Column>\n            <Grid.Column width={15}>\n              <Segment className=\"p0 pl1 flex\">\n                <WorkflowTemplateStep step={step} />\n              </Segment>\n            </Grid.Column>\n          </Grid.Row>\n        ))}\n      </Grid>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowDetailTabs, {\n  handleTabChange: action,\n});\n\nexport default inject()(observer(WorkflowDetailTabs));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate, action } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport TimeAgo from 'react-timeago';\nimport { Header, Label, Breadcrumb, Container, Dropdown } from 'semantic-ui-react';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreError, isStoreReady, isStoreLoading } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\nimport ProgressPlaceHolder from '../../workflow-common/ProgressPlaceholder';\nimport getUIState from '../../workflow-common/component-states/WorkflowCommonCardState';\nimport WorkflowDetailTabs from './WorkflowDetailTabs';\n\n// expected props\n// - workflowsStore (via injection)\n// - userDisplayName (via injection)\n// - location (from react router)\nclass WorkflowDetailPage extends React.Component {\n  componentDidMount() {\n    const store = this.getStore();\n    swallowError(store.load());\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.getStore();\n    store.stopHeartbeat();\n  }\n\n  getState() {\n    return getUIState(`wf-${this.getWorkflowId()}`);\n  }\n\n  getStore() {\n    const workflowId = this.getWorkflowId();\n    return this.props.workflowsStore.getWorkflowStore(workflowId);\n  }\n\n  getUserDisplayName() {\n    return this.props.userDisplayName;\n  }\n\n  getWorkflowId() {\n    return (this.props.match.params || {}).workflowId;\n  }\n\n  getVersionNumber() {\n    return parseInt((this.props.match.params || {}).version, 10);\n  }\n\n  getWorkflow() {\n    const store = this.getStore();\n    if (!isStoreReady(store)) return {};\n    return store.workflow;\n  }\n\n  getVersion() {\n    const workflow = this.getWorkflow();\n    const num = this.getVersionNumber();\n\n    return workflow.getVersion(num);\n  }\n\n  handleVersionChange = ({ value = '' }) => {\n    const goto = gotoFn(this);\n    const workflowId = this.getWorkflowId();\n    goto(`/workflows/published/id/${workflowId}/v/${value}`);\n  };\n\n  render() {\n    const store = this.getStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder />;\n    } else if (isStoreReady(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3\">\n        {this.renderBreadcrumb()}\n        {content}\n      </Container>\n    );\n  }\n\n  renderBreadcrumb() {\n    const workflowId = this.getWorkflowId();\n    const goto = gotoFn(this);\n\n    return (\n      <Breadcrumb className=\"block mb3\">\n        <Breadcrumb.Section link onClick={() => goto('/workflows/published')}>\n          Workflows\n        </Breadcrumb.Section>\n        <Breadcrumb.Divider icon=\"right angle\" />\n        <Breadcrumb.Section active>{workflowId}</Breadcrumb.Section>\n      </Breadcrumb>\n    );\n  }\n\n  renderMain() {\n    const version = this.getVersion();\n    const { id, title, updatedAt, updatedBy, descHtml } = version;\n    const userDisplayName = this.getUserDisplayName();\n    const isSystem = userDisplayName.isSystem({ uid: updatedBy });\n    const by = () =>\n      isSystem ? '' : <span className=\"ml1\">by {userDisplayName.getDisplayName({ uid: updatedBy })}</span>;\n\n    const uiState = this.getState();\n\n    /* eslint-disable react/no-danger */\n    return (\n      <>\n        <div className=\"flex mb2\">\n          <Header as=\"h3\" color=\"grey\" className=\"mt0 flex-auto ellipsis\">\n            <Label color=\"teal\" className=\"ml0 mr1\">\n              Workflow\n            </Label>\n            {title}\n            <Header.Subheader className=\"fs-9 color-grey mt1\">\n              <div>\n                updated <TimeAgo date={updatedAt} /> {by()}\n              </div>\n            </Header.Subheader>\n          </Header>\n          <div className=\"ml1\">\n            <span className=\"ellipsis pr1 fs-9 breakout color-grey\">{id}</span> {this.renderVersionDropdown()}\n          </div>\n        </div>\n        <div className=\"mb3\">\n          <div dangerouslySetInnerHTML={{ __html: descHtml }} />\n        </div>\n        <WorkflowDetailTabs uiState={uiState} workflow={version} />\n      </>\n    );\n    /* eslint-enable react/no-danger */\n  }\n\n  renderVersionDropdown() {\n    const workflow = this.getWorkflow();\n    const versions = workflow.versionNumbers;\n    const currentVersion = this.getVersionNumber();\n    const options = _.map(versions, version => ({ text: `v${version}`, value: version }));\n\n    if (versions.length === 1) return <span className=\"bold color-grey pr2\">v{currentVersion}</span>;\n\n    return (\n      <Dropdown\n        className=\"color-grey\"\n        inline\n        options={options}\n        value={currentVersion}\n        onChange={(_e, data) => this.handleVersionChange(data)}\n      />\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowDetailPage, {\n  handleVersionChange: action,\n});\n\nexport default inject('workflowsStore', 'userDisplayName')(withRouter(observer(WorkflowDetailPage)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable react/no-danger */\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport TimeAgo from 'react-timeago';\nimport { Header, Label, Breadcrumb, Container, Progress, Message, Table } from 'semantic-ui-react';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreError, isStoreReady, isStoreLoading } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\nimport ProgressPlaceHolder from '../../workflow-common/ProgressPlaceholder';\n\n// expected props\n// - workflowsStore (via injection)\n// - userDisplayName (via injection)\n// - location (from react router)\nclass WorkflowInstanceDetailPage extends React.Component {\n  componentDidMount() {\n    const store = this.getInstanceStore();\n    swallowError(store.load());\n    store.startHeartbeat();\n  }\n\n  componentWillUnmount() {\n    const store = this.getInstanceStore();\n    store.stopHeartbeat();\n  }\n\n  getInstanceStore() {\n    const workflowStore = this.getWorkflowStore();\n    const version = this.getVersionNumber();\n    const instanceId = this.getInstanceId();\n    return workflowStore.getInstanceStore(version, instanceId);\n  }\n\n  getWorkflowStore() {\n    const workflowId = this.getWorkflowId();\n    return this.props.workflowsStore.getWorkflowStore(workflowId);\n  }\n\n  getUserDisplayName() {\n    return this.props.userDisplayName;\n  }\n\n  getInstanceId() {\n    return (this.props.match.params || {}).instanceId;\n  }\n\n  getWorkflowId() {\n    return (this.props.match.params || {}).workflowId;\n  }\n\n  getVersionNumber() {\n    return parseInt((this.props.match.params || {}).version, 10);\n  }\n\n  getWorkflow() {\n    const store = this.getWorkflowStore();\n    if (!isStoreReady(store)) return {};\n    return store.workflow;\n  }\n\n  getVersion() {\n    const workflow = this.getWorkflow();\n    const num = this.getVersionNumber();\n\n    return workflow.getVersion(num);\n  }\n\n  getInstance() {\n    const instanceId = this.getInstanceId();\n    const workflowVersion = this.getVersion();\n    return workflowVersion.getInstance(instanceId);\n  }\n\n  render() {\n    const store = this.getInstanceStore();\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder />;\n    } else if (isStoreReady(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3\">\n        {this.renderBreadcrumb()}\n        {content}\n      </Container>\n    );\n  }\n\n  renderBreadcrumb() {\n    const workflowId = this.getWorkflowId();\n    const versionNumber = this.getVersionNumber();\n    const instanceId = this.getInstanceId();\n    const goto = gotoFn(this);\n\n    return (\n      <Breadcrumb className=\"block mb3\">\n        <Breadcrumb.Section link onClick={() => goto('/workflows/published')}>\n          Workflows\n        </Breadcrumb.Section>\n        <Breadcrumb.Divider icon=\"right angle\" />\n        <Breadcrumb.Section link onClick={() => goto(`/workflows/published/id/${workflowId}/v/${versionNumber}`)}>\n          {workflowId}\n        </Breadcrumb.Section>\n        <Breadcrumb.Divider icon=\"right angle\" />\n        <Breadcrumb.Section active>{instanceId}</Breadcrumb.Section>\n      </Breadcrumb>\n    );\n  }\n\n  renderMain() {\n    const version = this.getVersion();\n    const instance = this.getInstance();\n    const { id, title, descHtml } = version;\n    const { updatedAt, updatedBy } = instance;\n    const { statusMsg, statusLabel, statusColor, msgSpread } = instance.statusSummary;\n    const userDisplayName = this.getUserDisplayName();\n    const isSystem = userDisplayName.isSystem({ uid: updatedBy });\n    const by = () =>\n      isSystem ? '' : <span className=\"ml1\">by {userDisplayName.getDisplayName({ uid: updatedBy })}</span>;\n\n    return (\n      <>\n        <div className=\"flex mb2\">\n          <Header as=\"h3\" color=\"grey\" className=\"mt0 flex-auto ellipsis\">\n            <Label color={statusColor} className=\"ml0 mr1\">\n              {statusLabel}\n            </Label>\n            <Label color=\"blue\" className=\"ml0 mr1\">\n              Workflow Instance\n            </Label>\n            {title} - {instance.id}\n            <Header.Subheader className=\"fs-9 color-grey mt1\">\n              <div>\n                updated <TimeAgo date={updatedAt} /> {by()}\n              </div>\n            </Header.Subheader>\n          </Header>\n          <div className=\"ml1\">\n            <span className=\"ellipsis pr1 fs-9 breakout color-grey\">{id}</span>\n            <span className=\"fs-9 color-grey\">{version.v}</span>\n          </div>\n        </div>\n        <div className=\"mb3\">\n          <div dangerouslySetInnerHTML={{ __html: descHtml }} />\n        </div>\n        {this.displayInstanceStatusMsg(statusMsg, msgSpread)}\n        <Progress percent={100} size=\"tiny\" color={statusColor} />\n        {this.renderSteps(instance.steps)}\n      </>\n    );\n  }\n\n  displayInstanceStatusMsg(msg, msgSpread) {\n    if (!msg) return null;\n    return <Message {...msgSpread}>{msg}</Message>;\n  }\n\n  renderSteps(steps) {\n    if (_.isEmpty(steps)) return 'This workflow instance does not have any steps';\n\n    return (\n      <Table basic=\"very\" celled striped stackable>\n        <Table.Header>\n          <Table.Row>\n            <Table.HeaderCell>Step</Table.HeaderCell>\n            <Table.HeaderCell>Status</Table.HeaderCell>\n          </Table.Row>\n        </Table.Header>\n\n        <Table.Body>\n          {_.map(steps, (step, index) => (\n            <Table.Row key={index}>\n              <Table.Cell textAlign=\"left\" className=\"fs-9\">\n                <div>\n                  <span className=\"mr2 bold\">{index + 1}</span> {step.title}\n                </div>\n                {step.statusMsg && (\n                  <div className={`color-${step.statusColor || 'grey'} breakout ml3 mt2`}>{step.statusMsg}</div>\n                )}\n              </Table.Cell>\n              <Table.Cell collapsing textAlign=\"center\" className=\"fs-9\">\n                <Label size=\"tiny\" color={step.statusColor}>\n                  {step.statusLabel}\n                </Label>\n              </Table.Cell>\n            </Table.Row>\n          ))}\n        </Table.Body>\n      </Table>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(WorkflowInstanceDetailPage, {});\n\nexport default inject('workflowsStore', 'userDisplayName')(withRouter(observer(WorkflowInstanceDetailPage)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport withAuth from '@aws-ee/base-ui/dist/withAuth';\n\nimport _ from 'lodash';\nimport EnvTypesManagement from '../parts/environment-types/EnvTypesManagement';\nimport EnvTypeEditor from '../parts/environment-types/EnvTypeEditor';\n\n/**\n * Adds routes to the given routesMap.\n * @param routesMap A Map containing routes. This object is a Map that has route paths as\n * keys and React Component as value.\n *\n * @returns {Promise<*>} Returns a Map with the mapping of base routes vs React Component\n */\n// eslint-disable-next-line no-unused-vars\nfunction registerRoutes(routesMap, { location, appContext }) {\n  const showEnvTypeManagement = _.get(appContext, 'showEnvTypeManagement', true);\n  if (showEnvTypeManagement) {\n    const routes = new Map([\n      ...routesMap,\n      ['/workspace-types-management/:action/:id', withAuth(EnvTypeEditor)],\n      ['/workspace-types-management', withAuth(EnvTypesManagement)],\n    ]);\n    return routes;\n  }\n  return routesMap;\n}\n\nconst plugin = {\n  registerRoutes,\n};\n\nexport default plugin;\n","/* eslint-disable import/prefer-default-export */\nimport { types, applySnapshot } from 'mobx-state-tree';\n\nconst statuses = {\n  active: {\n    color: 'green',\n    display: 'Active',\n    tip: 'You can use this key when connecting to your workspaces.',\n  },\n  inactive: {\n    color: 'grey',\n    display: 'Inactive',\n    tip: 'You can not use this key when connecting to your workspaces.',\n  },\n};\n\n// ==================================================================\n// KeyPair\n// ==================================================================\nconst KeyPair = types\n  .model('KeyPair', {\n    id: types.identifier,\n    rev: types.maybe(types.number),\n    owner: '',\n    name: '',\n    status: '',\n    publicKey: '',\n    desc: types.maybeNull(types.string),\n    updatedAt: '',\n    updatedBy: '',\n    createdAt: '',\n    createdBy: '',\n    privateKey: '', // The server will not return this value\n  })\n  .actions(self => ({\n    setKeyPair(raw) {\n      // Note: if you have partial data vs full data, you need to replace the applySnapshot() with\n      // the appropriate logic\n      applySnapshot(self, raw);\n    },\n  }))\n\n  // eslint-disable-next-line no-unused-vars\n  .views(self => ({\n    get statusInfo() {\n      const entry = statuses[self.status] || {\n        color: 'grey',\n        display: 'Unknown',\n        tip: 'Something not right',\n      };\n      return entry;\n    },\n  }));\n\nexport { KeyPair };\n","import _ from 'lodash';\nimport { values } from 'mobx';\nimport { types } from 'mobx-state-tree';\nimport { consolidateToMap } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { createKeyPair, getKeyPairs, deleteKeyPair } from '../../helpers/api';\nimport { KeyPair } from './KeyPair';\n\n// ==================================================================\n// KeyPairsStore\n// ==================================================================\nconst KeyPairsStore = BaseStore.named('KeyPairsStore')\n  .props({\n    keyPairs: types.optional(types.map(KeyPair), {}),\n    tickPeriod: 30 * 1000, // 30 seconds\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const keyPairs = await getKeyPairs();\n        self.runInAction(() => {\n          consolidateToMap(self.keyPairs, keyPairs, (exiting, newItem) => {\n            exiting.setKeyPair(newItem);\n          });\n        });\n      },\n\n      addKeyPair(raw) {\n        const id = raw.id;\n        const previous = self.keyPairs.get(id);\n\n        if (!previous) {\n          self.keyPairs.put(raw);\n        } else {\n          previous.setKeyPair(raw);\n        }\n      },\n\n      async createKetPair(keyPair) {\n        // keyPair = { name, desc }\n\n        const result = await createKeyPair(keyPair);\n        self.addKeyPair(result);\n        return self.getKeyPair(result.id);\n      },\n\n      async deleteKeyPair(id) {\n        await deleteKeyPair(id);\n        self.runInAction(() => {\n          self.keyPairs.delete(id);\n        });\n      },\n\n      cleanup: () => {\n        self.keyPairs.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.keyPairs.size === 0;\n    },\n\n    get total() {\n      return self.keyPairs.size;\n    },\n\n    get list() {\n      return _.orderBy(values(self.keyPairs), ['createdAt', 'name'], ['desc', 'asc']);\n    },\n\n    get listActive() {\n      return _.filter(self.list, item => item.status === 'active');\n    },\n\n    getKeyPair(id) {\n      return self.keyPairs.get(id);\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.keyPairsStore = KeyPairsStore.create({}, appContext);\n}\n\nexport { KeyPairsStore, registerContextItems };\n","import React from 'react';\nimport { decorate, computed, action, observable, runInAction } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Button, Modal } from 'semantic-ui-react';\n\nimport { displayError, displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\n\n// expected props\n// - keyPair (via prop)\n// - keyPairsStore (via injection)\nclass KeyPairButtons extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      // The name of the button that is clicked recently and resulted in triggering a processing task\n      // The name can be: 'delete', 'activate' or 'deactivate'\n      this.processingButton = '';\n    });\n  }\n\n  get keyPair() {\n    return this.props.keyPair;\n  }\n\n  get keyPairsStore() {\n    return this.props.keyPairsStore;\n  }\n\n  handleDelete = async () => {\n    this.processingButton = 'delete';\n    try {\n      const name = this.keyPair.name;\n      const store = this.keyPairsStore;\n      await store.deleteKeyPair(this.keyPair.id);\n      displaySuccess(`The key \"${name}\" was successfully deleted`);\n    } catch (error) {\n      displayError(error);\n    } finally {\n      runInAction(() => {\n        this.processingButton = '';\n      });\n    }\n  };\n\n  render() {\n    const processing = !!this.processingButton;\n\n    return (\n      <div>\n        <Modal\n          trigger={\n            <Button floated=\"right\" basic color=\"red\" size=\"mini\" className=\"mt1 mb1\" loading={processing}>\n              Delete\n            </Button>\n          }\n          header=\"Are you sure?\"\n          content=\"This action can not be reverted.\"\n          actions={['Cancel', { key: 'delete', content: 'Delete', negative: true, onClick: this.handleDelete }]}\n          size=\"mini\"\n        />\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(KeyPairButtons, {\n  keyPair: computed,\n  keyPairsStore: computed,\n  processingButton: observable,\n  handleDelete: action,\n});\n\nexport default inject('keyPairsStore')(withRouter(observer(KeyPairButtons)));\n","/* eslint-disable max-classes-per-file */\nimport React from 'react';\nimport { decorate, computed } from 'mobx';\nimport { observer, inject, Observer } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Header, Label, Popup, TextArea, Tab, Form, Icon, Segment } from 'semantic-ui-react';\nimport TimeAgo from 'react-timeago';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport By from '@aws-ee/base-ui/dist/parts/helpers/By';\nimport { displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\n\nimport KeyPairButtons from './parts/KeyPairButtons';\n\n// This component is used with the TabPane to replace the default Segment wrapper since\n// we don't want to display the border.\n// eslint-disable-next-line react/prefer-stateless-function\nclass TabPaneWrapper extends React.Component {\n  render() {\n    return <>{this.props.children}</>;\n  }\n}\n\n// expected props\n// - keyPair (via prop)\nclass KeyPairCard extends React.Component {\n  get keyPair() {\n    return this.props.keyPair;\n  }\n\n  render() {\n    const keyPair = this.keyPair;\n\n    return (\n      <>\n        {this.renderStatus(keyPair)}\n        {this.renderTitle(keyPair)}\n        {keyPair.desc || 'No description was provided.'}\n        {this.renderTabs(keyPair)}\n      </>\n    );\n  }\n\n  renderButtons(keyPair) {\n    return <KeyPairButtons keyPair={keyPair} />;\n  }\n\n  renderTabs(keyPair) {\n    const panes = [\n      {\n        menuItem: 'Public Key',\n        render: () => (\n          <Tab.Pane attached={false} key=\"public-key\" as={TabPaneWrapper}>\n            <Observer>{() => this.renderPublicKey(keyPair)}</Observer>\n          </Tab.Pane>\n        ),\n      },\n      {\n        menuItem: 'Private Key',\n        render: () => (\n          <Tab.Pane attached={false} key=\"private-key\" as={TabPaneWrapper}>\n            <Observer>{() => this.renderPrivateKey()}</Observer>\n          </Tab.Pane>\n        ),\n      },\n    ];\n\n    return <Tab className=\"mt2\" menu={{ secondary: true, pointing: true }} renderActiveOnly panes={panes} />;\n  }\n\n  renderDesc(keyPair) {\n    return <p>{keyPair.desc || 'No description was provided.'}</p>;\n  }\n\n  renderPublicKey(keyPair) {\n    return (\n      <div className=\"mt2\">\n        <Form className=\"flex\">\n          <TextArea className=\"flex-auto\" rows={10} value={keyPair.publicKey} />\n          <Popup\n            content=\"Copy\"\n            trigger={\n              <CopyToClipboard\n                className=\"ml2 mr0 mt2\"\n                text={keyPair.publicKey}\n                style={{ cursor: 'pointer' }}\n                onCopy={() => displaySuccess('Copied to clipboard', 'Done')}\n              >\n                <Icon name=\"copy outline\" size=\"large\" />\n              </CopyToClipboard>\n            }\n          />\n        </Form>\n      </div>\n    );\n  }\n\n  renderPrivateKey() {\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"key\" />\n          Not Available\n          <Header.Subheader>\n            The private key is only available for download at the time of creating a key. This application does not\n            store the private key.\n          </Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderStatus(keyPair) {\n    const status = keyPair.statusInfo;\n\n    return (\n      <div style={{ cursor: 'default' }}>\n        <Popup\n          trigger={\n            <Label attached=\"top left\" size=\"mini\" color={status.color}>\n              {status.display}\n            </Label>\n          }\n        >\n          {status.tip}\n        </Popup>\n      </div>\n    );\n  }\n\n  renderTitle(keyPair) {\n    return (\n      <div className=\"clearfix flex\">\n        <Header as=\"h3\" className=\"mt1 flex-auto\">\n          {keyPair.name}\n          <Header.Subheader>\n            <span className=\"fs-8 color-grey\">\n              Created <TimeAgo date={keyPair.createdAt} className=\"mr2\" />{' '}\n              <By uid={keyPair.createdBy} className=\"mr2\" />\n            </span>\n            <span className=\"fs-8 color-grey mr2\"> {keyPair.id}</span>\n          </Header.Subheader>\n        </Header>\n        <KeyPairButtons keyPair={keyPair} />\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(KeyPairCard, {\n  keyPair: computed,\n});\n\nexport default inject()(withRouter(observer(KeyPairCard)));\n","import React from 'react';\nimport _ from 'lodash';\nimport { decorate, computed, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Container, Segment, Header, Icon, Button, Label } from 'semantic-ui-react';\n\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreLoading, isStoreEmpty, isStoreNotEmpty, isStoreError } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport ProgressPlaceHolder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\n\nimport KeyPairCard from './KeyPairCard';\n\n// expected props\n// keyPairsStore (via injection)\nclass KeyPairsList extends React.Component {\n  componentDidMount() {\n    window.scrollTo(0, 0);\n    const store = this.keyPairsStore;\n    swallowError(store.load());\n  }\n\n  get keyPairsStore() {\n    return this.props.keyPairsStore;\n  }\n\n  handleCreateKeyPair = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    const goto = gotoFn(this);\n    goto(`/key-pair-management/create`);\n  };\n\n  render() {\n    const store = this.keyPairsStore;\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"p0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <ProgressPlaceHolder segmentCount={1} />;\n    } else if (isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else if (isStoreNotEmpty(store)) {\n      content = this.renderMain();\n    } else {\n      content = null;\n    }\n\n    return (\n      <Container className=\"mt3 animated fadeIn\">\n        {this.renderTitle()}\n        {content}\n      </Container>\n    );\n  }\n\n  renderMain() {\n    const store = this.keyPairsStore;\n    const list = store.list;\n\n    return (\n      <div>\n        {_.map(list, item => (\n          <Segment className=\"p3 mb4\" clearing key={item.id}>\n            <KeyPairCard keyPair={item} />\n          </Segment>\n        ))}\n      </div>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <Segment placeholder>\n        <Header icon className=\"color-grey\">\n          <Icon name=\"terminal\" />\n          No SSH Keys\n          <Header.Subheader>To create an SSH key, click Create Key.</Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div className=\"mb3 flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"key\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">SSH Keys {this.renderTotal()}</Header.Content>\n        </Header>\n        <div>\n          <Button color=\"blue\" size=\"medium\" basic onClick={this.handleCreateKeyPair}>\n            Create Key\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  renderTotal() {\n    const store = this.keyPairsStore;\n    if (isStoreError(store) || isStoreLoading(store)) return null;\n\n    return <Label circular>{store.total}</Label>;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(KeyPairsList, {\n  keyPairsStore: computed,\n  handleCreateKeyPair: action,\n});\n\nexport default inject('keyPairsStore')(withRouter(observer(KeyPairsList)));\n","import React from 'react';\nimport { decorate } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Container, Breadcrumb, Segment } from 'semantic-ui-react';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\n\nimport KeyPairCreateForm from './parts/KeyPairCreateForm';\n\n// expected props\nclass KeyPairCreate extends React.Component {\n  componentDidMount() {\n    window.scrollTo(0, 0);\n  }\n\n  render() {\n    return (\n      <Container className=\"mt3 animated fadeIn\">\n        {this.renderBreadcrumb()}\n        {this.renderForm()}\n      </Container>\n    );\n  }\n\n  renderForm() {\n    const goto = gotoFn(this);\n    return (\n      <Segment clearing className=\"p3 mb3\">\n        <KeyPairCreateForm onCancel={() => goto('/key-pair-management')} />\n      </Segment>\n    );\n  }\n\n  renderBreadcrumb() {\n    const goto = gotoFn(this);\n\n    return (\n      <Breadcrumb className=\"block mb3\">\n        <Breadcrumb.Section link onClick={() => goto('/key-pair-management')}>\n          SSH Keys\n        </Breadcrumb.Section>\n        <Breadcrumb.Divider icon=\"right angle\" />\n        <Breadcrumb.Section active>Create Key</Breadcrumb.Section>\n      </Breadcrumb>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(KeyPairCreate, {});\n\nexport default inject()(withRouter(observer(KeyPairCreate)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable import/prefer-default-export */\nimport { types } from 'mobx-state-tree';\n\n// A sample model using mobx state tree\nconst Hello = types\n  .model('Hello', {\n    message: '',\n  })\n  .actions(self => ({})) // eslint-disable-line no-unused-vars\n  .views(self => ({})); // eslint-disable-line no-unused-vars\n\nexport { Hello };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { getHelloMessages } from '../../helpers/api';\nimport { Hello } from './Hello';\n\n// ==================================================================\n// HelloStore\n// ==================================================================\nconst HelloStore = BaseStore.named('HelloStore')\n  .props({\n    hellos: types.optional(types.array(Hello), []),\n  })\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const hellos = await getHelloMessages();\n        self.runInAction(() => {\n          // Because this is an example, it is a just quick way to replace the array, but you should\n          // examine each element instead and update or insert each element so that your\n          // React components would update correctly by maintaining the correct references to the model\n          // objects\n          self.hellos.replace(hellos);\n        });\n      },\n\n      cleanup() {\n        self.hellos.clear();\n        superCleanup();\n      },\n    };\n  })\n  .views(self => ({\n    get empty() {\n      return self.hellos.length === 0;\n    },\n\n    get total() {\n      return self.hellos.length;\n    },\n\n    get list() {\n      return _.sortBy(_.slice(self.hellos), 'message');\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.helloStore = HelloStore.create({}, appContext);\n}\n\nexport { HelloStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable import/prefer-default-export */\n// eslint-disable-next-line no-unused-vars\nimport { httpApiGet, httpApiPost, httpApiPut, httpApiDelete } from '@aws-ee/base-ui/dist/helpers/api';\n\nfunction getHelloMessages() {\n  return httpApiGet('api/hello');\n}\n\nexport { getHelloMessages };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport * as helloStore from '../models/hello/HelloStore';\n\n/**\n * Registers your app context items to the given appContext.\n *\n * @param appContext An instance of application context containing various application level objects such as various\n * MobX stores. This is a live reference. Use this function to register context items by setting them directly on\n * the given \"appContext\" reference.  If you need access to the pluginRegistry, you can get it from appContext\n */\n// eslint-disable-next-line no-unused-vars\nfunction registerAppContextItems(appContext) {\n  // This is where you can\n  // 1. register your app context items, such as your own MobX stores. To register your items\n  //\n  //    myStore.registerAppContextItems(appContext); // The \"myStore\" needs to have a method \"registerContextItems\"\n  //                                                 // with implementation of adding itself to the given \"appContext\"\n  //\n  // 2. modify any existing items\n  //\n  //       appContext.itemYouWantToModify = newItem;\n  //\n  // 3. delete any existing item,\n  //\n  //      delete appContext.itemYouWantToRemoveFromContext; OR\n  //      appContext.itemYouWantToRemoveFromContext = undefined;\n  //\n  // Register additional custom context items (such as your custom MobX stores) here\n  helloStore.registerContextItems(appContext);\n}\n\nconst plugin = {\n  registerAppContextItems,\n};\n\nexport default plugin;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/**\n * If you need to add some global UI initialization logic that is specific to the solution, you can do it here. However,\n * It is unlikely that you will need to do so because the base-ui addon takes care of the most common initialization\n * logic needed.\n *\n * @param payload A free form object. Use this object to add any properties that you need to pass to the App model\n * when it is being initialized. The base-ui addon, makes a property named 'tokenInfo' available on this payload object.\n * @param appContext An application context object containing various Mobx Stores, Models etc.\n *\n * @returns {Promise<void>}\n */\n// eslint-disable-next-line no-unused-vars\nasync function init(payload, appContext) {\n  // Write any solution specific initialization logic.\n}\n\n// eslint-disable-next-line no-unused-vars\nasync function postInit(payload, appContext) {\n  // Write any solution specific post initialization logic, such as loading stores\n}\n\nconst plugin = {\n  init,\n  postInit,\n};\n\nexport default plugin;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/**\n * Adds your navigation menu items to the given itemsMap.\n * This function is called last after adding navigation menu items to the itemsMap from all other installed addons.\n *\n * @param itemsMap A Map containing navigation menu items. This object is a Map that has route paths (urls) as\n * keys and menu item object with the following shape\n *\n *   {\n *    title: STRING, // Title for the navigation menu item\n *    icon: STRING, // semantic ui icon name fot the navigation menu item\n *    shouldShow: FUNCTION, // A function that returns a flag indicating whether to show the item or not (useful when showing menu items conditionally)\n *    render: OPTIONAL FUNCTION, // Optional function that returns rendered menu item component. Use this ONLY if you want to control full rendering of the menu item.\n *   }\n *\n * @param appContext An application context object containing all MobX store objects\n *\n * @returns Map<*> Returns A Map containing navigation menu items with the same shape as \"itemsMap\"\n */\n\n// eslint-disable-next-line no-unused-vars\nfunction registerMenuItems(itemsMap, { location, appContext }) {\n  // This is where you can\n  // 1. register your navigation menu items, to register your items\n  //\n  //       const items = new Map([\n  //          ...itemsMap,\n  //          // Add your navigation menu items here\n  //          ['/your/menu/item1/url', {title:'my menu item1',icon:'some-icon-from-semantic-ui'}],\n  //          ['/your/menu/item2/url', {title:'my menu item2',icon:'some-icon-from-semantic-ui',shouldShow:()=>true}],\n  //          ['/your/menu/item3/url', {render:()=>{ // return rendered menu item here }] ]);\n  //       return items;\n  //\n  // 2. modify any existing items\n  //\n  //       items.set('the/menu/item/url/you/want/to/replace',{title:'my menu item1',icon:'some-icon-from-semantic-ui'});\n  //       return routesMap;\n  //\n  // 3. delete any existing route, to delete existing route\n  //\n  //      items.delete('the/menu/item/url/you/want/to/delete');\n  //\n\n  // Register additional custom navigation menu items here\n  // const isAdmin = _.get(appContext, 'userStore.user.isAdmin');\n  const items = new Map([\n    ...itemsMap,\n    // ['/hello', { title: 'Hello', icon: 'hand spock', shouldShow: true /* isAdmin */ }],\n  ]);\n\n  // DO NOT forget to return items here. If you do not return any menu items here then the menu will not show any items\n  return items;\n}\n\nconst plugin = {\n  registerMenuItems,\n};\n\nexport default plugin;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable max-classes-per-file */\nimport _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Container, Icon, Header, Segment } from 'semantic-ui-react';\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { isStoreLoading, isStoreError, isStoreEmpty, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\n// expected props\n// - helloStore (via injection)\nclass HelloPage extends React.Component {\n  componentDidMount() {\n    window.scrollTo(0, 0);\n    const store = this.helloStore;\n    if (!isStoreReady(store)) swallowError(store.load());\n  }\n\n  goto(pathname) {\n    const goto = gotoFn(this);\n    goto(pathname);\n  }\n\n  get helloStore() {\n    return this.props.helloStore;\n  }\n\n  render() {\n    const store = this.helloStore;\n    if (!store) return null;\n\n    // Render loading, error, or tab content\n    let content;\n    if (isStoreError(store)) {\n      content = <ErrorBox error={store.error} className=\"mt3 mr0 ml0\" />;\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder segmentCount={1} className=\"mt3 mr0 ml0\" />;\n    } else if (isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else {\n      content = this.renderContent();\n    }\n\n    return (\n      <Container className=\"mt3\">\n        {this.renderTitle()}\n        {content}\n      </Container>\n    );\n  }\n\n  renderContent() {\n    const list = this.helloStore.list;\n    return (\n      <Segment.Group className=\"mt3\">\n        {_.map(list, (item, index) => (\n          <Segment key={index}>{item.message}</Segment>\n        ))}\n      </Segment.Group>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <Segment placeholder className=\"mt3\">\n        <Header icon className=\"color-grey\">\n          <Icon name=\"coffee\" />\n          Hello\n          <Header.Subheader>Sorry, no hello messages to display</Header.Subheader>\n        </Header>\n      </Segment>\n    );\n  }\n\n  renderTitle() {\n    return (\n      <div className=\"flex\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0 flex-auto\">\n          <Icon name=\"hand spock\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">Hello</Header.Content>\n        </Header>\n      </div>\n    );\n  }\n}\n\ndecorate(HelloPage, {\n  helloStore: computed,\n});\n\nexport default inject('helloStore')(withRouter(observer(HelloPage)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport withAuth from '@aws-ee/base-ui/dist/withAuth';\n\nimport HelloPage from '../parts/hello/HelloPage';\n\n/**\n * Adds your routes to the given routesMap.\n * This function is called last after adding routes to the routesMap from all other installed addons.\n *\n * @param routesMap A Map containing routes. This object is a Map that has route paths as\n * keys and React Component as value.\n *\n * @returns {Promise<*>} Returns a Map with the mapping of routes as keys and their React Component as values\n */\n// eslint-disable-next-line no-unused-vars\nfunction registerRoutes(routesMap, { location, appContext }) {\n  // This is where you can\n  // 1. register your routes, to register your routes\n  //\n  //       const routes = new Map([\n  //          ...routesMap,\n  //          // Add your routes here\n  //          ['/your/routes', SomeReactComponent],\n  //       ]);\n  //       return routes;\n  //\n  // 2. modify any existing routes\n  //\n  //       routesMap.set('the/route/you/want/to/replace',SomeReactComponent);\n  //       return routesMap;\n  //\n  // 3. delete any existing route, to delete existing route\n  //\n  //      routesMap.delete('the/route/you/want/to/delete');\n  //\n\n  // Register additional routes and their React Components as per your solution requirements\n\n  const routes = new Map([...routesMap, ['/hello', withAuth(HelloPage)]]);\n\n  // DO NOT forget to return routes here. If you do not return here, no routes will be configured in React router\n  return routes;\n}\n\n// eslint-disable-next-line no-unused-vars\nfunction getDefaultRouteLocation({ location, appContext }) {\n  // If you want to override the default route location, do it here\n}\n\nconst plugin = {\n  registerRoutes,\n  getDefaultRouteLocation,\n};\n\nexport default plugin;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport baseAppContextItemsPlugin from '@aws-ee/base-ui/dist/plugins/app-context-items-plugin';\nimport baseInitializationPlugin from '@aws-ee/base-ui/dist/plugins/initialization-plugin';\nimport baseAuthenticationPlugin from '@aws-ee/base-ui/dist/plugins/authentication-plugin';\nimport baseAppComponentPlugin from '@aws-ee/base-ui/dist/plugins/app-component-plugin';\nimport baseMenuItemsPlugin from '@aws-ee/base-ui/dist/plugins/menu-items-plugin';\nimport baseRoutesPlugin from '@aws-ee/base-ui/dist/plugins/routes-plugin';\nimport workflowAppContextItemsPlugin from '@aws-ee/base-workflow-ui/dist/plugins/app-context-items-plugin';\nimport workflowMenuItemsPlugin from '@aws-ee/base-workflow-ui/dist/plugins/menu-items-plugin';\nimport workflowRoutesPlugin from '@aws-ee/base-workflow-ui/dist/plugins/routes-plugin';\nimport raasAppContextItemsPlugin from '@aws-ee/base-raas-ui/dist/plugins/app-context-items-plugin';\nimport raasInitializationPlugin from '@aws-ee/base-raas-ui/dist/plugins/initialization-plugin';\nimport raasAppComponentPlugin from '@aws-ee/base-raas-ui/dist/plugins/app-component-plugin';\nimport raasMenuItemsPlugin from '@aws-ee/base-raas-ui/dist/plugins/menu-items-plugin';\nimport raasRoutesPlugin from '@aws-ee/base-raas-ui/dist/plugins/routes-plugin';\nimport raasEnvTypeMgmtPlugin from '@aws-ee/base-raas-ui/dist/plugins/env-type-mgmt-plugin';\n\nimport envMgmtMenuItemsPlugin from '@aws-ee/environment-type-mgmt-ui/dist/plugins/menu-items-plugin';\nimport envMgmtRoutesPlugin from '@aws-ee/environment-type-mgmt-ui/dist/plugins/routes-plugin';\nimport envMgmtAppContextItemsPlugin from '@aws-ee/environment-type-mgmt-ui/dist/plugins/app-context-items-plugin';\n\nimport keyPairAppContextItemsPlugin from '@aws-ee/key-pair-mgmt-ui/dist/plugins/app-context-items-plugin';\nimport keyPairMenuItemsPlugin from '@aws-ee/key-pair-mgmt-ui/dist/plugins/menu-items-plugin';\nimport keyPairRoutesPlugin from '@aws-ee/key-pair-mgmt-ui/dist/plugins/routes-plugin';\n\nimport appContextItemsPlugin from './app-context-items-plugin';\nimport initializationPlugin from './initialization-plugin';\nimport menuItemsPlugin from './menu-items-plugin';\nimport routesPlugin from './routes-plugin';\n\n// baseAppContextItemsPlugin registers app context items (such as base MobX stores etc) provided by the base addon\n// baseInitializationPlugin registers the base initialization logic provided by the base ui addon\n// baseMenuItemsPlugin registers menu items provided by the base addon\n// baseRoutesPlugin registers base routes provided by the base addon\nconst extensionPoints = {\n  'app-context-items': [\n    baseAppContextItemsPlugin,\n    workflowAppContextItemsPlugin,\n    envMgmtAppContextItemsPlugin,\n    keyPairAppContextItemsPlugin,\n    raasAppContextItemsPlugin,\n    appContextItemsPlugin,\n  ],\n  'initialization': [baseInitializationPlugin, raasInitializationPlugin, initializationPlugin],\n  'authentication': [baseAuthenticationPlugin],\n  'app-component': [baseAppComponentPlugin, raasAppComponentPlugin],\n  'menu-items': [\n    baseMenuItemsPlugin,\n    workflowMenuItemsPlugin,\n    envMgmtMenuItemsPlugin,\n    keyPairMenuItemsPlugin,\n    raasMenuItemsPlugin,\n    menuItemsPlugin,\n  ],\n  'routes': [\n    baseRoutesPlugin,\n    workflowRoutesPlugin,\n    envMgmtRoutesPlugin,\n    keyPairRoutesPlugin,\n    raasRoutesPlugin,\n    routesPlugin,\n  ],\n  'env-type-management': [raasEnvTypeMgmtPlugin],\n};\n\nfunction getPlugins(extensionPoint) {\n  return extensionPoints[extensionPoint];\n}\n\nconst registry = {\n  getPlugins,\n};\n\nexport default registry;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { renderAppContainer, renderError, renderProgress } from '@aws-ee/base-ui/dist/render-utils';\nimport bootstrapApp from '@aws-ee/base-ui/dist/bootstrap-app';\nimport pluginRegistry from './plugins/plugin-registry';\n\nimport 'typeface-lato';\nimport './css/basscss-important.css';\nimport './css/semantic.min.css';\nimport 'animate.css/animate.css';\nimport 'toastr/build/toastr.css';\nimport 'react-table/react-table.css';\nimport './css/index.css';\n\nbootstrapApp({\n  renderAppContainer,\n  renderError,\n  renderProgress,\n  pluginRegistry,\n});\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Button } from 'semantic-ui-react';\nimport c from 'classnames';\n\nimport Header from './Header';\nimport Description from './Description';\nimport ErrorPointer from './ErrorPointer';\n\n// expected props\n// - form (via props)\n// - field (via props), this is the mobx form field object\n// - className (via props)\n//\n// The following props are to support existing React Semantic UI props:\n// - disabled (via props), default to false\n// - size (via props), default to small\nconst Component = observer(({ field, disabled = false, size = 'small', className = 'mb4', onClick }) => {\n  const { id, value, sync, error = '', extra = {} } = field;\n  const { yesLabel = 'Yes', noLabel = 'No', yesValue = true, noValue = false, showHeader = true } = extra;\n  const hasError = !_.isEmpty(error); // IMPORTANT do NOT use field.hasError\n  const isDisabled = field.disabled || disabled;\n  const disabledClass = isDisabled ? 'disabled' : '';\n  const errorClass = hasError ? 'error' : '';\n  const yesSelected = value === yesValue;\n  const noSelected = value === noValue;\n  const handleClick = toAssign => event => {\n    event.preventDefault();\n    event.stopPropagation();\n    sync(toAssign);\n    field.validate({ showErrors: true });\n    if (onClick) onClick(toAssign, field);\n  };\n\n  const yesAttributes = {\n    onClick: handleClick(yesValue),\n    disabled: isDisabled,\n  };\n  const noAttributes = {\n    onClick: handleClick(noValue),\n    disabled: isDisabled,\n  };\n\n  if (yesSelected) yesAttributes.color = 'teal';\n  if (noSelected) noAttributes.color = 'teal';\n\n  return (\n    <div className={c(className, errorClass, disabledClass)}>\n      <div className=\"flex flex-wrap mb1\">\n        {showHeader && <Header field={field} className=\"mt1 mb0 mr2\" />}\n        <div>\n          <Button.Group id={id} size={size}>\n            <Button {...yesAttributes}>{yesLabel}</Button>\n            <Button.Or />\n            <Button {...noAttributes}>{noLabel}</Button>\n          </Button.Group>\n        </div>\n      </div>\n      <Description field={field} />\n      <ErrorPointer field={field} />\n    </div>\n  );\n});\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport Validator from 'validatorjs';\n\n/**\n * Transforms fields object from\n {\n  fieldName1: {\n    rules: string,\n  },\n  fieldName2: {\n    rules: string,\n  },\n }\n\n to\n\n {\n  fieldName1: rulesString,\n  fieldName2: rulesString,\n }\n *\n */\nfunction fieldsToValidationRules(fieldsConfig) {\n  return _.transform(\n    fieldsConfig,\n    (rules, config, fieldName) => {\n      if (config.rules) {\n        rules[fieldName] = config.rules;\n      }\n      return rules;\n    },\n    {},\n  );\n}\n\n/**\n * Validates given input data using the form fields configuration\n *\n * @param input The object to validate\n * @param fieldsConfig The field configuration to use for validation. The config must be in the following format.\n {\n  fieldName1: {\n    rules: string,\n  },\n  fieldName2: {\n    rules: string,\n  },\n }\n * @returns {Promise<Validator>}\n */\nasync function validate(input, fieldsConfig) {\n  const validationRules = fieldsToValidationRules(fieldsConfig);\n  let validation;\n  if (validationRules) {\n    validation = new Validator(input, validationRules);\n  }\n  return validation;\n}\n\nexport default validate;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nconst localStorageKeys = {\n  // Name of the id token for Data Lake APIs in local storage\n  appIdToken: 'appIdToken',\n};\n\nexport default localStorageKeys;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Table } from 'semantic-ui-react';\n\n// expected props\n// - rows (via props), an array of objects, [ { name, title, value }, { name, title, value }, ... ]\n// - className (via props)\nconst Component = observer(({ rows = [], className = '' }) => {\n  if (rows.length === 0) return null;\n\n  return (\n    <Table basic=\"very\" className={`animated fadeIn ${className}`}>\n      <Table.Header>\n        <Table.Row>\n          <Table.HeaderCell width={10}>Key</Table.HeaderCell>\n          <Table.HeaderCell width={6}>Value</Table.HeaderCell>\n        </Table.Row>\n      </Table.Header>\n      <Table.Body>\n        {_.map(rows, (item, index) => (\n          <Table.Row key={index}>\n            <Table.Cell width={10}>{renderKey(item)}</Table.Cell>\n            <Table.Cell width={6}>{renderValue(item)}</Table.Cell>\n          </Table.Row>\n        ))}\n      </Table.Body>\n    </Table>\n  );\n});\n\nfunction renderValue({ value }) {\n  const isNil = _.isNil(value);\n  const isEmpty = _.isString(value) && _.isEmpty(value);\n  return isNil || isEmpty ? 'Not Provided' : value.toString();\n}\n\nfunction renderKey({ title = '', name }) {\n  const hasTitle = !_.isEmpty(title);\n\n  if (hasTitle) {\n    return (\n      <>\n        <div>{title}</div>\n        <div className=\"fs-7 color-grey\">{name}</div>\n      </>\n    );\n  }\n  return <div>{name}</div>;\n}\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport numeral from 'numeral';\nimport { observable } from 'mobx';\n\n/**\n * Converts the given Map object to an array of values from the map\n */\nfunction mapToArray(map) {\n  const result = [];\n  // converting map to result array\n  map.forEach(value => result.push(value));\n  return result;\n}\n\nfunction parseError(err) {\n  const message = _.get(err, 'message', 'Something went wrong');\n  const code = _.get(err, 'code');\n  const status = _.get(err, 'status');\n  const requestId = _.get(err, 'requestId');\n  const error = new Error(message);\n\n  error.code = code;\n  error.requestId = requestId;\n  error.root = err;\n  error.status = status;\n\n  return error;\n}\n\nfunction swallowError(promise, fn = () => ({})) {\n  try {\n    return Promise.resolve()\n      .then(() => promise)\n      .catch(err => fn(err));\n  } catch (err) {\n    return fn(err);\n  }\n}\n\nconst storage = observable({\n  clear() {\n    try {\n      if (localStorage) return localStorage.clear();\n      return window.localStorage.clear();\n    } catch (err) {\n      console.log(err);\n      try {\n        if (sessionStorage) return sessionStorage.clear();\n        return window.sessionStorage.clear();\n      } catch (error) {\n        // if we get here, it means no support for localStorage nor sessionStorage, which is a problem\n        return console.log(error);\n      }\n    }\n  },\n\n  getItem(key) {\n    try {\n      if (localStorage) return localStorage.getItem(key);\n      return window.localStorage.getItem(key);\n    } catch (err) {\n      console.log(err);\n      try {\n        if (sessionStorage) return sessionStorage.getItem(key);\n        return window.sessionStorage.getItem(key);\n      } catch (error) {\n        // if we get here, it means no support for localStorage nor sessionStorage, which is a problem\n        return console.log(error);\n      }\n    }\n  },\n\n  setItem(key, value) {\n    try {\n      if (localStorage) return localStorage.setItem(key, value);\n      return window.localStorage.setItem(key, value);\n    } catch (err) {\n      console.log(err);\n      try {\n        if (sessionStorage) return sessionStorage.setItem(key, value);\n        return window.sessionStorage.setItem(key, value);\n      } catch (error) {\n        // if we get here, it means no support for localStorage nor sessionStorage, which is a problem\n        return console.log(error);\n      }\n    }\n  },\n\n  removeItem(key) {\n    try {\n      if (localStorage) return localStorage.removeItem(key);\n      return window.localStorage.removeItem(key);\n    } catch (err) {\n      console.log(err);\n      try {\n        if (sessionStorage) return sessionStorage.removeItem(key);\n        return window.sessionStorage.removeItem(key);\n      } catch (error) {\n        // if we get here, it means no support for localStorage nor sessionStorage, which is a problem\n        return console.log(error);\n      }\n    }\n  },\n});\n\n// a promise friendly delay function\nfunction delay(seconds) {\n  return new Promise(resolve => {\n    _.delay(resolve, seconds * 1000);\n  });\n}\n\nfunction niceNumber(value) {\n  if (_.isNil(value)) return 'N/A';\n  if (_.isString(value) && _.isEmpty(value)) return 'N/A';\n  return numeral(value).format('0,0');\n}\n\nfunction nicePrice(value) {\n  if (_.isNil(value)) return 'N/A';\n  if (_.isString(value) && _.isEmpty(value)) return 'N/A';\n  return numeral(value).format('0,0.00');\n}\n\n// super basic plural logic, laughable\nfunction plural(singleStr, pluralStr, count) {\n  if (count === 1) return singleStr;\n  return pluralStr;\n}\n\nfunction getQueryParam(location, key) {\n  const queryParams = new URL(location).searchParams;\n  return queryParams.get(key);\n}\n\nfunction addQueryParams(location, params) {\n  const url = new URL(location);\n  const queryParams = url.searchParams;\n\n  const keys = _.keys(params);\n  keys.forEach(key => {\n    queryParams.append(key, params[key]);\n  });\n\n  let newUrl = url.origin + url.pathname;\n\n  if (queryParams.toString()) {\n    newUrl += `?${queryParams.toString()}`;\n  }\n\n  newUrl += url.hash;\n  return newUrl;\n}\n\nfunction removeQueryParams(location, keys) {\n  const url = new URL(location);\n  const queryParams = url.searchParams;\n\n  keys.forEach(key => {\n    queryParams.delete(key);\n  });\n\n  let newUrl = url.origin + url.pathname;\n\n  if (queryParams.toString()) {\n    newUrl += `?${queryParams.toString()}`;\n  }\n\n  newUrl += url.hash;\n  return newUrl;\n}\n\nfunction getFragmentParam(location, key) {\n  const fragmentParams = _.get(location, 'hash') || new URL(location).hash;\n  const hashKeyValues = {};\n  const params = fragmentParams.substring(1).split('&');\n  if (params) {\n    params.forEach(param => {\n      const keyValueArr = param.split('=');\n      const currentKey = keyValueArr[0];\n      const value = keyValueArr[1];\n      if (value) {\n        hashKeyValues[currentKey] = value;\n      }\n    });\n  }\n  return hashKeyValues[key];\n}\n\nfunction removeFragmentParams(location, keyNamesToRemove) {\n  const url = new URL(location);\n  const fragmentParams = url.hash;\n  let hashStr = '#';\n  const params = fragmentParams.substring(1).split('&');\n  if (params) {\n    params.forEach(param => {\n      const keyValueArr = param.split('=');\n      const currentKey = keyValueArr[0];\n      const value = keyValueArr[1];\n      // Do not include the currentKey if it is the one specified in the array of keyNamesToRemove\n      if (value && _.indexOf(keyNamesToRemove, currentKey) < 0) {\n        hashStr = `${hashStr}${currentKey}=${value}`;\n      }\n    });\n  }\n  return `${url.protocol}//${url.host}${url.search}${hashStr === '#' ? '' : hashStr}`;\n}\n\nfunction isAbsoluteUrl(url) {\n  // return /^[a-z][a-z\\d+.-]*:/.test(url);\n  return /^https?:/.test(url);\n}\n\nfunction removeNulls(obj = {}) {\n  if (!obj) {\n    return obj;\n  }\n  Object.keys(obj).forEach(key => {\n    if (obj[key] === null) delete obj[key];\n    if (_.isPlainObject(obj[key])) {\n      removeNulls(obj[key]);\n    }\n  });\n\n  return obj;\n}\n\n// remove the \"end\" string from \"str\" if it exists\nfunction chopRight(str = '', end = '') {\n  if (!_.endsWith(str, end)) return str;\n  return str.substring(0, str.length - end.length);\n}\n\nconst isFloat = n => {\n  return n % 1 !== 0;\n};\n\n// input [ { <name>: { label, desc, ..} }, { <name2>: { label, desc } } ]\n// output { <name>: { label, desc, ..}, <name2>: { label, desc } }\nfunction childrenArrayToMap(arr) {\n  const result = {};\n  arr.forEach(item => {\n    const key = _.keys(item)[0];\n    result[key] = item[key];\n  });\n  return result;\n}\n\nlet idGeneratorCount = 0;\n\nfunction generateId(prefix = '') {\n  idGeneratorCount += 1;\n  return `${prefix}_${idGeneratorCount}_${Date.now()}_${_.random(0, 1000)}`;\n}\n\n// Given a Map and an array of items (each item MUST have an \"id\" prop), consolidate\n// the array in the following manner:\n// - if an existing item in the map is no longer in the array of items, remove the item from the map\n// - if an item in the array is not in the map, then add it to the map using the its \"id\" prop\n// - if an item in the array is also in the map, then call 'mergeExistingFn' with the existing item\n//   and the new item. It is expected that this 'mergeExistingFn', will know how to merge the\n//   properties of the new item into the existing item.\nfunction consolidateToMap(map, itemsArray, mergeExistingFn, idFieldName = 'id') {\n  const unprocessedKeys = {};\n\n  map.forEach((_value, key) => {\n    unprocessedKeys[key] = true;\n  });\n\n  itemsArray.forEach(item => {\n    const id = item[idFieldName];\n    const hasExisting = map.has(id);\n    const exiting = map.get(id);\n\n    if (!exiting) {\n      map.set(item[idFieldName], item);\n    } else {\n      mergeExistingFn(exiting, item);\n    }\n\n    if (hasExisting) {\n      delete unprocessedKeys[id];\n    }\n  });\n\n  _.forEach(unprocessedKeys, (_value, key) => {\n    map.delete(key);\n  });\n}\n\n/**\n * Converts an object graph into flat object with key/value pairs.\n * The rules of object graph to flat key value transformation are as follows.\n * 1. An already flat attribute with primitive will not be transformed.\n *    For example,\n *      input = { someKey: 'someValue' } => output = { someKey: 'someValue' }\n * 2. A nested object attribute will be flattened by adding full attribute path '<attributeName>.' (the paths are as per lodash's get and set functions)\n *    For example,\n *      input = { someKey: { someNestedKey: 'someValue' } } => output = { 'someKey.someNestedKey': 'someValue' }\n * 3. An array attribute will be flattened by adding correct path '<attributeName>[<elementIndex>]' prefix. (the paths are as per lodash's get and set functions)\n *    For example,\n *      input = { someKey: [ 'someValue1', 'someValue2' ] } => output = { 'someKey[0]': 'someValue1', 'someKey[1]': 'someValue2' }\n *      input = { someKey: [ 'someValue1', ['someValue2','someValue3'], 'someValue4' ] } => output = { 'someKey[0]': 'someValue1', 'someKey[1][0]': 'someValue2', 'someKey[1][1]': 'someValue3', 'someKey[2]': 'someValue4' }\n *      input = { someKey: [{ someNestedKey: 'someValue' }] } => output = { 'someKey[0].someNestedKey': 'someValue' }\n *\n * @param obj An object to flatten\n * @param filterFn An optional filter function that allows filtering out certain attributes from being included in the flattened result object. The filterFn is called with 3 arguments (result, value, key) and is expected to return true to include\n *   the key in the result or false to exclude the key from the result.\n * @param keyPrefix A optional key prefix to include in all keys in the resultant flattened object.\n * @param accum An optional accumulator to use when performing the transformation\n * @returns {*}\n */\nfunction flattenObject(obj, filterFn = () => true, keyPrefix = '', accum = {}) {\n  function toFlattenedKey(key, idx) {\n    let flattenedKey;\n    if (_.isNil(idx)) {\n      if (_.isNumber(key)) {\n        flattenedKey = keyPrefix ? `${keyPrefix}[${key}]` : `[${key}]`;\n      } else {\n        flattenedKey = keyPrefix ? `${keyPrefix}.${key}` : key;\n      }\n    } else {\n      flattenedKey = keyPrefix ? `${keyPrefix}.${key}[${idx}]` : `${key}[${idx}]`;\n    }\n    return flattenedKey;\n  }\n\n  return _.transform(\n    obj,\n    (result, value, key) => {\n      if (filterFn(result, value, key)) {\n        if (_.isArray(value)) {\n          let idx = 0;\n          _.forEach(value, element => {\n            const flattenedKey = toFlattenedKey(key, idx);\n            if (_.isObject(element)) {\n              flattenObject(element, filterFn, flattenedKey, result);\n            } else {\n              result[flattenedKey] = element;\n            }\n            ++idx;\n          });\n        } else {\n          const flattenedKey = toFlattenedKey(key);\n          if (_.isObject(value)) {\n            flattenObject(value, filterFn, flattenedKey, result);\n          } else {\n            result[flattenedKey] = value;\n          }\n        }\n      }\n      return result;\n    },\n    accum,\n  );\n}\n\n/**\n * Converts an object with key/value pairs into object graph. This function is inverse of flattenObject.\n * i.e., unFlattenObject(flattenObject(obj)) = obj\n *\n * The rules of key/value pairs to object graph transformation are as follows.\n * 1. Key that does not contain delimiter will not be transformed.\n *    For example,\n *      input = { someKey: 'someValue' } => output = { someKey: 'someValue' }\n * 2. Key/Value containing delimiter will be transformed into object path\n *    For example,\n *      input = { someKey_someNestedKey: 'someValue' } => output = { someKey: { someNestedKey: 'someValue' } }\n * 3. Key/Value containing delimiter and integer index will be transformed into object containing array.\n *    For example,\n *      input = { someKey_0: 'someValue1', someKey_1: 'someValue2' } => output = { someKey: [ 'someValue1', 'someValue2' ] }\n *      input = { \"someKey_0\": \"someValue1\", \"someKey_1_0\": \"someValue2\", \"someKey_1_1\": \"someValue3\", \"someKey_2\": \"someValue4\" } => output = { someKey: [ 'someValue1', ['someValue2','someValue3'], 'someValue4' ] }\n *      input = { someKey_0_someNestedKey: 'someValue' } => output = { someKey: [{ someNestedKey: 'someValue' }] }\n *\n * @param obj An object to flatten\n * @param filterFn An optional filter function that allows filtering out certain attributes from being included in the flattened result object. The filterFn is called with 3 arguments (result, value, key) and is expected to return true to include\n *   the key in the result or false to exclude the key from the result.\n * @param keyPrefix A optional key prefix to include in all keys in the resultant flattened object.\n * @returns {*}\n */\nfunction unFlattenObject(keyValuePairs, filterFn = () => true) {\n  return _.transform(\n    keyValuePairs,\n    (result, value, key) => {\n      if (filterFn(result, value, key)) {\n        _.set(result, key, value);\n      }\n      return result;\n    },\n    {},\n  );\n}\n\nfunction toUTCDate(str) {\n  if (_.isEmpty(str)) return str;\n  if (!_.isString(str)) return str;\n  if (_.endsWith(str, 'Z')) return str;\n\n  return `${str}Z`;\n}\n\n/**\n * Given a list of validatorjs rules for a form element, returns valid options\n * by returning elements defined by the \"in\" rule as valid Semantic UI options objects.\n *\n * @param {Array} formRules Rules for the validatorjs library\n * @returns {Array<Object>} Options formatted for a Semantic UI Dropdown\n */\nfunction getOptionsFromRules(formRules) {\n  let options = [];\n  formRules.forEach(rule => {\n    if (typeof rule === 'object' && 'in' in rule) {\n      options = rule.in.map(option => ({ key: option, text: option, value: option }));\n    }\n  });\n  return options;\n}\n\nfunction validRegions() {\n  return [\n    'us-east-2',\n    'us-east-1',\n    'us-west-1',\n    'us-west-2',\n    'ap-east-1',\n    'ap-south-1',\n    'ap-northeast-3',\n    'ap-northeast-2',\n    'ap-southeast-1',\n    'ap-southeast-2',\n    'ap-northeast-1',\n    'ca-central-1',\n    'cn-north-1',\n    'cn-northwest-1',\n    'eu-central-1',\n    'eu-west-1',\n    'eu-west-2',\n    'eu-west-3',\n    'eu-north-1',\n    'me-south-1',\n    'sa-east-1',\n    'us-gov-east-1',\n    'us-gov-west-1',\n  ].sort();\n}\n\n/**\n * Converts bytes to a human-friendly string by representing them as KB, MB, GB,\n * etc., depending on how large the size is.\n * Adapted from https://stackoverflow.com/a/18650828\n *\n * @param {number} bytes The number of bytes to be converted\n * @param {number} decimals How many decimal places should be maintained\n * @returns {string} The human-friendly string form of the passed bytes\n */\nfunction formatBytes(bytes, decimals = 2) {\n  if (bytes === 0) return '0 Bytes';\n\n  const k = 1024;\n  const dm = decimals < 0 ? 0 : decimals;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n  return `${parseFloat((bytes / k ** i).toFixed(dm))} ${sizes[i]}`;\n}\n\n/**\n * A utility function to process given items in sequence of batches. Items in one batch are processed in-parallel but\n * all batches are processed sequentially i..e, processing of the next batch is not started until the previous batch is\n * complete.\n *\n * @param items Array of items to process\n * @param batchSize Number of items in a batch\n * @param processorFn A function to process the batch. The function is called with the item argument.\n * The function is expected to return a Promise with some result of processing the item.\n *\n * @returns {Promise<Array>}\n */\nasync function processInBatches(items, batchSize, processorFn) {\n  const itemBatches = _.chunk(items, batchSize);\n\n  let results = [];\n\n  // Process all items in one batch in parallel and wait for the batch to\n  // complete before moving on to the next batch\n  for (let i = 0; i <= itemBatches.length; i += 1) {\n    const itemsInThisBatch = itemBatches[i];\n    // We need to await for each batch in loop to make sure they are awaited in sequence instead of\n    // firing them in parallel disabling eslint for \"no-await-in-loop\" due to this\n    // eslint-disable-next-line no-await-in-loop\n    const resultsFromThisBatch = await Promise.all(\n      //  Fire promise for each item in this batch and let it be processed in parallel\n      _.map(itemsInThisBatch, processorFn),\n    );\n\n    // push all results from this batch into the main results array\n    results = _.concat(results, resultsFromThisBatch);\n  }\n  return results;\n}\n\n/**\n * A utility function that processes items sequentially. The function uses the specified processorFn to process\n * items in the given order i.e., it does not process next item in the given array until the promise returned for\n * the processing of the previous item is resolved. If the processorFn throws error (or returns a promise rejection)\n * this functions stops processing next item and the error is bubbled up to the caller (via a promise rejection).\n *\n * @param items Array of items to process\n * @param processorFn A function to process the item. The function is called with the item argument.\n * The function is expected to return a Promise with some result of processing the item.\n *\n * @returns {Promise<Array>}\n */\nasync function processSequentially(items, processorFn) {\n  return processInBatches(items, 1, processorFn);\n}\n\nexport {\n  mapToArray,\n  parseError,\n  swallowError,\n  storage,\n  delay,\n  niceNumber,\n  plural,\n  getQueryParam,\n  removeQueryParams,\n  addQueryParams,\n  getFragmentParam,\n  removeFragmentParams,\n  nicePrice,\n  isFloat,\n  removeNulls,\n  chopRight,\n  childrenArrayToMap,\n  isAbsoluteUrl,\n  generateId,\n  consolidateToMap,\n  flattenObject,\n  unFlattenObject,\n  toUTCDate,\n  getOptionsFromRules,\n  validRegions,\n  formatBytes,\n  processInBatches,\n  processSequentially,\n};\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\n\n/**\n * Returns identity provider options that can be used for displaying idp selection options\n * @param providerConfigs An array of authentication provider configuration objects. For details about the shape of\n * the object see \"authenticationProviderConfigs\" property of\n * \"addons/addon-base-ui/packages/base-ui/src/models/authentication/AuthenticationProviderConfigsStore.js\"\n *\n * @returns {[]}\n */\nfunction toIdpOptions(providerConfigs) {\n  const options = [];\n\n  _.forEach(providerConfigs, providerConfig => {\n    const config = providerConfig.config;\n\n    // Each providerConfig (authentication provider) can have zero or more identity providers.\n    if (!_.isEmpty(config.federatedIdentityProviders)) {\n      _.forEach(config.federatedIdentityProviders, idp => {\n        options.push({\n          key: idp.id,\n          text: idp.name,\n\n          // Make sure the authentication provider's information is embedded in the value\n          // along with the idp name. This is required so disambiguate two idps with the same idp name based on which\n          // authentication provider they belong to\n          value: JSON.stringify({ authNProviderId: providerConfig.id, idpName: idp.name }),\n        });\n      });\n    }\n  });\n  return options;\n}\n\n// From string to object\nfunction toIdpFromValue(value) {\n  return JSON.parse(value);\n}\n\n// From object to string\nfunction toValueFromIdp({ authenticationProviderId, identityProviderName }) {\n  return JSON.stringify({ authNProviderId: authenticationProviderId, idpName: identityProviderName });\n}\n\n// eslint-disable-next-line import/prefer-default-export\nexport { toIdpOptions, toIdpFromValue, toValueFromIdp };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { decorate } from 'mobx';\nimport { withRouter } from 'react-router-dom';\nimport c from 'classnames';\n\n// expected props\n// - user (via props)\n// - userDisplayName (via injection)\n// - className (via props)\nclass By extends React.Component {\n  get uid() {\n    return this.props.uid;\n  }\n\n  get userDisplayName() {\n    return this.props.userDisplayName;\n  }\n\n  render() {\n    const uid = this.uid;\n    const userDisplayName = this.userDisplayName;\n    const isSystem = userDisplayName.isSystem({ uid });\n    return isSystem ? (\n      ''\n    ) : (\n      <span className={c(this.props.className)}>by {userDisplayName.getDisplayName({ uid })}</span>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(By, {});\n\nexport default inject('userDisplayName')(withRouter(observer(By)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nfunction isApproved(status) {\n  return status === EnvTypeStatusEnum.approved;\n}\nfunction isNotApproved(status) {\n  // if status is falsy (undefined, null, empty string etc) then interpret\n  // it as notApproved, by default\n  return !status || status === EnvTypeStatusEnum.notApproved;\n}\n\nfunction getValidStatuses() {\n  return [EnvTypeStatusEnum.notApproved, EnvTypeStatusEnum.approved];\n}\n\nconst EnvTypeStatusEnum = {\n  // An AWS Service Catalog Product that is imported in the \"app store\" but not approved for researchers' use yet\n  notApproved: 'not-approved',\n\n  // An AWS Service Catalog Product that is imported in the \"app store\" as an approved \"environment type\" for usage\n  approved: 'approved',\n\n  isApproved,\n  isNotApproved,\n  getValidStatuses,\n};\n\nmodule.exports = EnvTypeStatusEnum;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { runInAction } from 'mobx';\nimport { Button, Segment } from 'semantic-ui-react';\n\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\n\nclass BaseEnvTypeConfigStep extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.form = props.form;\n      this.wizard = props.wizard;\n    });\n  }\n\n  render() {\n    const form = this.props.form;\n    return (\n      <Segment clearing className=\"mt3 p3\">\n        <Form form={form} onCancel={this.props.onCancel} onSuccess={this.props.onSubmit}>\n          {({ processing, onCancel }) => (\n            <>\n              {this.renderFormFields({ form, processing, onCancel })}\n              {this.renderActionButtons({ processing, onCancel })}\n            </>\n          )}\n        </Form>\n      </Segment>\n    );\n  }\n\n  renderActionButtons({ processing, onCancel }) {\n    const isUpdating = this.isEditAction();\n    const submitButtonTitle = isUpdating ? 'Save' : this.props.wizardModel.hasNext ? 'Next' : 'Add';\n    return (\n      <div>\n        <Button\n          className=\"ml2 mb2\"\n          primary\n          content={submitButtonTitle}\n          disabled={processing}\n          type=\"submit\"\n          floated=\"right\"\n        />\n        {!isUpdating && this.props.wizardModel.hasPrevious && (\n          <Button\n            className=\"ml2 mb2\"\n            primary\n            content=\"Previous\"\n            disabled={processing}\n            floated=\"right\"\n            onClick={this.props.onPrevious}\n          />\n        )}\n        <Button basic color=\"grey\" disabled={processing} onClick={onCancel} floated=\"left\">\n          Cancel\n        </Button>\n      </div>\n    );\n  }\n\n  isEditAction() {\n    return this.getAction() === 'edit';\n  }\n\n  getAction() {\n    return this.props.action;\n  }\n\n  getEnvTypeConfig() {\n    return this.props.envTypeConfig;\n  }\n}\nexport default BaseEnvTypeConfigStep;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport toastr from 'toastr';\n\nfunction displayError(msg, error, timeOut = '20000') {\n  toastr.error(toMessage(msg, error), 'We have a problem!', { ...toasterErrorOptions, timeOut });\n  if (error) console.error(msg, error);\n  if (_.isError(msg)) console.error(msg);\n}\n\nfunction displayWarning(msg, error, timeOut = '20000') {\n  toastr.warning(toMessage(msg, error), 'Warning!', { ...toasterWarningOptions, timeOut });\n  if (error) console.error(msg, error);\n  if (_.isError(msg)) console.error(msg);\n}\n\nfunction displaySuccess(msg, title = 'Submitted!') {\n  toastr.success(toMessage(msg), title, toasterSuccessOptions);\n}\n\nfunction displayFormErrors(form) {\n  const map = form.errors();\n  const lines = [];\n  Object.keys(map).forEach(key => {\n    if (map[key]) lines.push(map[key]);\n  });\n\n  if (lines.length === 0) return displayError('The form submission has a problem.', undefined, 3000);\n  const isPlural = lines.length > 1;\n  const message = `There ${isPlural ? 'are issues' : 'is an issue'} with the form:`;\n  return displayError([message, ...lines], undefined, 3000);\n}\n\nfunction toMessage(msg, error) {\n  if (_.isError(msg)) {\n    return `${msg.message || msg.friendly} <br/>&nbsp;`;\n  }\n\n  if (_.isError(error)) {\n    return `${msg} - ${error.message} <br/>&nbsp;`;\n  }\n\n  if (_.isArray(msg)) {\n    const messages = msg;\n    const size = _.size(messages);\n\n    if (size === 0) {\n      return 'Unknown error <br/>&nbsp;';\n    }\n    if (size === 1) {\n      return `${messages[0]}<br/>&nbsp;`;\n    }\n    const result = [];\n    result.push('<br/>');\n    result.push('<ul>');\n    _.forEach(messages, message => {\n      result.push(`<li style=\"margin-left: -20px;\">${message}</li>`);\n    });\n    result.push('</ul><br/>&nbsp;');\n\n    return result.join('');\n  }\n\n  if (_.isEmpty(msg)) return 'Unknown error <br/>&nbsp;';\n\n  return `${msg} <br/>&nbsp;`;\n}\n\n// For details of options, see https://github.com/CodeSeven/toastr\n//\n// closeButton:       Enable a close button\n// debug:             Emit debug logs to the console\n// newestOnTop:       Show newest toast at top or bottom (top is default)\n// progressBar:       Visually indicate how long before a toast expires\n// positionClass:     CSS position style e.g. toast-top-center, toast-bottom-left\n// preventDuplicates: Prevent identical toasts appearing (based on content)\n// timeOut:           How long the toast will display without user interaction (ms)\n// extendedTimeOut:   How long the toast will display after a user hovers over it (ms)\n\nconst toasterErrorOptions = {\n  closeButton: true,\n  debug: false,\n  newestOnTop: true,\n  progressBar: true,\n  positionClass: 'toast-top-right',\n  preventDuplicates: true,\n  timeOut: '20000', // 1000000\n  extendedTimeOut: '50000', // 1000000\n};\n\nconst toasterWarningOptions = {\n  closeButton: true,\n  debug: false,\n  newestOnTop: true,\n  progressBar: true,\n  positionClass: 'toast-top-right',\n  preventDuplicates: true,\n  timeOut: '20000', // 1000000\n  extendedTimeOut: '50000', // 1000000\n};\n\nconst toasterSuccessOptions = {\n  closeButton: true,\n  debug: false,\n  newestOnTop: true,\n  progressBar: true,\n  positionClass: 'toast-top-right',\n  preventDuplicates: true,\n  timeOut: '3000',\n  extendedTimeOut: '10000',\n};\n\nexport { displayError, displayWarning, displaySuccess, displayFormErrors };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'mobx-react';\nimport { BrowserRouter } from 'react-router-dom';\nimport { Message, Icon, Container } from 'semantic-ui-react';\n\n// Render the AppContainer component which will then ask plugins to provide the App component\nfunction renderAppContainer(AppContainer, appContext) {\n  ReactDOM.render(\n    <Provider {...appContext}>\n      <BrowserRouter>\n        <AppContainer />\n      </BrowserRouter>\n    </Provider>,\n    document.getElementById('root'),\n  );\n}\n\n// Render a progress message\nfunction renderProgress(\n  progressContent = (\n    <Message.Content>\n      <Message.Header>Just one second</Message.Header>\n      Great things are now happening, please wait!\n    </Message.Content>\n  ),\n) {\n  ReactDOM.render(\n    <Container text className=\"pt4\">\n      <Message icon>\n        <Icon name=\"circle notched\" loading />\n        {progressContent}\n      </Message>\n    </Container>,\n    document.getElementById('root'),\n  );\n}\n\n// Render an error message\nfunction renderError(err) {\n  const error = _.get(err, 'message', 'Unknown error');\n  ReactDOM.render(\n    <Container text className=\"pt4\">\n      <Message negative>\n        <Message.Header>We have a problem</Message.Header>\n        <p>{error}</p>\n        <p>See if refreshing the browser will resolve your issue</p>\n      </Message>\n    </Container>,\n    document.getElementById('root'),\n  );\n}\n\nexport { renderAppContainer, renderProgress, renderError };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nfunction createLinkWithSearch({ location, pathname, search }) {\n  return {\n    pathname,\n    search: search || location.search,\n    hash: location.hash,\n    state: location.state,\n  };\n}\n\nfunction createLink({ location, pathname }) {\n  return {\n    pathname,\n    hash: location.hash,\n    state: location.state,\n  };\n}\n\nfunction reload() {\n  setTimeout(() => {\n    window.location.reload();\n  }, 150);\n}\n\n/**\n * A generic goto function creator function that returns a go to function bound to the given react component.\n *\n * See below snippet as an example for using this function from within some react component\n * containing \"location\" and \"history\" props.\n *\n * const goto = gotoFn(this);\n * goto('/some-path');\n *\n * @param reactComponent A react component that has \"location\" and \"history\" props as injected via the \"withRouter\" function.\n * @returns {{new(...args: any[]): any} | ((...args: any[]) => any) | OmitThisParameter<goto> | goto | any | {new(...args: any[]): any} | ((...args: any[]) => any)}\n */\nfunction gotoFn(reactComponent) {\n  function goto(pathname) {\n    const location = reactComponent.props.location;\n    const link = createLink({ location, pathname });\n\n    reactComponent.props.history.push(link);\n  }\n  return goto.bind(reactComponent);\n}\n\nexport { createLink, createLinkWithSearch, reload, gotoFn };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Message, Button } from 'semantic-ui-react';\n\n// expected props\n// - error (an object with a \"message\" property  or a string)\n// - className\nclass ErrorBox extends React.Component {\n  handleRetry = () => {\n    Promise.resolve()\n      .then(() => this.props.onRetry())\n      .catch(_err => {\n        /* ignore */\n      });\n  };\n\n  render() {\n    const defaultMessage = 'Hmm... something went wrong';\n    const rawMessage = this.props.error || defaultMessage;\n    const message = _.isString(rawMessage) ? rawMessage : _.get(rawMessage, 'message', defaultMessage);\n    const shouldRetry = _.isFunction(this.props.onRetry);\n    const className = this.props.className ? this.props.className : 'p3';\n\n    return (\n      <div className={`${className}`}>\n        <Message negative className=\"clearfix\">\n          <Message.Header>A problem was encountered</Message.Header>\n          <p>{message}</p>\n          {shouldRetry && (\n            <Button floated=\"right\" basic color=\"red\" onClick={this.handleRetry}>\n              Retry\n            </Button>\n          )}\n        </Message>\n      </div>\n    );\n  }\n}\n\nexport default observer(ErrorBox);\n","import _ from 'lodash';\nimport { values } from 'mobx';\nimport { getEnv, types } from 'mobx-state-tree';\nimport { consolidateToMap } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport {\n  getScEnvironments,\n  createScEnvironment,\n  deleteScEnvironment,\n  startScEnvironment,\n  stopScEnvironment,\n} from '../../helpers/api';\nimport { ScEnvironment } from './ScEnvironment';\nimport { ScEnvironmentStore } from './ScEnvironmentStore';\nimport { ScEnvConnectionStore } from './ScEnvConnectionStore';\n\nconst filterNames = {\n  ALL: 'all',\n  AVAILABLE: 'available',\n  STOPPED: 'stopped',\n  PENDING: 'pending',\n  ERRORED: 'errored',\n  TERMINATED: 'terminated',\n};\n\n// A map, with the key being the filter name and the value being the function that will be used to filter the workspace\nconst filters = {\n  [filterNames.ALL]: () => true,\n  [filterNames.AVAILABLE]: env => env.status === 'COMPLETED' || env.status === 'TAINTED',\n  [filterNames.STOPPED]: env => env.status === 'STOPPED',\n  [filterNames.PENDING]: env =>\n    env.status === 'PENDING' || env.status === 'TERMINATING' || env.status === 'STARTING' || env.status === 'STOPPING',\n  [filterNames.ERRORED]: env =>\n    env.status === 'FAILED' ||\n    env.status === 'TERMINATING_FAILED' ||\n    env.status === 'STARTING_FAILED' ||\n    env.status === 'STOPPING_FAILED',\n  [filterNames.TERMINATED]: env => env.status === 'TERMINATED',\n};\n\n// ==================================================================\n// ScEnvironmentsStore\n// ==================================================================\nconst ScEnvironmentsStore = BaseStore.named('ScEnvironmentsStore')\n  .props({\n    environments: types.optional(types.map(ScEnvironment), {}),\n    environmentStores: types.optional(types.map(ScEnvironmentStore), {}),\n    connectionStores: types.optional(types.map(ScEnvConnectionStore), {}),\n    tickPeriod: 30 * 1000, // 30 seconds\n  })\n\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n\n    return {\n      async doLoad() {\n        const environments = await getScEnvironments();\n        self.runInAction(() => {\n          consolidateToMap(self.environments, environments, (exiting, newItem) => {\n            exiting.setScEnvironment(newItem);\n          });\n        });\n      },\n\n      addScEnvironment(rawEnvironment) {\n        const id = rawEnvironment.id;\n        const previous = self.environments.get(id);\n\n        if (!previous) {\n          self.environments.put(rawEnvironment);\n        } else {\n          previous.setScEnvironment(rawEnvironment);\n        }\n      },\n\n      async createScEnvironment(environment) {\n        // environment = { name, description, projectId, envTypeId, envTypeConfigId, studyIds (optional) }\n        const result = await createScEnvironment(environment);\n        self.addScEnvironment(result);\n        return self.getScEnvironment(result.id);\n      },\n\n      async terminateScEnvironment(id) {\n        await deleteScEnvironment(id);\n        const env = self.getScEnvironment(id);\n        if (!env) return;\n        env.setStatus('TERMINATING');\n      },\n\n      async startScEnvironment(id) {\n        await startScEnvironment(id);\n        const env = self.getScEnvironment(id);\n        if (!env) return;\n        env.setStatus('STARTING');\n      },\n\n      async stopScEnvironment(id) {\n        await stopScEnvironment(id);\n        const env = self.getScEnvironment(id);\n        if (!env) return;\n        env.setStatus('STOPPING');\n      },\n\n      getScEnvironmentStore(envId) {\n        let entry = self.environmentStores.get(envId);\n        if (!entry) {\n          // Lazily create the store\n          self.environmentStores.set(envId, ScEnvironmentStore.create({ envId }));\n          entry = self.environmentStores.get(envId);\n        }\n\n        return entry;\n      },\n\n      getScEnvConnectionStore(envId) {\n        let entry = self.connectionStores.get(envId);\n        if (!entry) {\n          // Lazily create the store\n          self.connectionStores.set(envId, ScEnvConnectionStore.create({ envId }));\n          entry = self.connectionStores.get(envId);\n        }\n\n        return entry;\n      },\n\n      cleanup: () => {\n        self.environments.clear();\n        self.environmentStores.clear();\n        self.connectionStores.clear();\n        superCleanup();\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.environments.size === 0;\n    },\n\n    get total() {\n      return self.environments.size;\n    },\n\n    get list() {\n      return _.orderBy(values(self.environments), ['createdAt', 'name'], ['desc', 'asc']);\n    },\n\n    filtered(filterName) {\n      const filter = filters[filterName] || (() => true);\n      const filtered = _.filter(values(self.environments), filter);\n      return _.orderBy(filtered, ['createdAt', 'name'], ['desc', 'asc']);\n    },\n\n    getScEnvironment(id) {\n      return self.environments.get(id);\n    },\n\n    canChangeState(id) {\n      const outputs = self.environments.get(id).outputs;\n      let result = false;\n      outputs.forEach(output => {\n        if (output.OutputKey === 'Ec2WorkspaceInstanceId' || output.OutputKey === 'NotebookInstanceName') {\n          result = true;\n        }\n      });\n      return result;\n    },\n\n    get user() {\n      return getEnv(self).userStore.user;\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.scEnvironmentsStore = ScEnvironmentsStore.create({}, appContext);\n}\n\nexport { ScEnvironmentsStore, registerContextItems, filterNames };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport Dropzone from 'react-dropzone';\nimport { decorate, observable, runInAction, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Accordion, Header, Icon, Segment, List, Modal, Button, Step, Table } from 'semantic-ui-react';\nimport SyntaxHighlighter from 'react-syntax-highlighter';\nimport { docco } from 'react-syntax-highlighter/dist/esm/styles/hljs';\n\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { awsRegion } from '@aws-ee/base-ui/dist/helpers/settings';\n\nimport { getExternalUserPinForm } from '../../models/forms/ExternalUserPinForm';\nimport CfnService from '../../helpers/cfn-service';\nimport PinInput from '../helpers/PinInput';\n\nconst steps = {\n  IAM_USER: 0,\n  CREDENTIALS: 1,\n  IAM_POLICY: 2,\n  ENCRYPT: 3,\n};\n\nconst OnboardingSteps = [\n  {\n    key: 'user',\n    icon: 'user',\n    title: 'IAM User',\n    description: 'Create a user',\n    active: true,\n  },\n  {\n    key: 'credentials',\n    icon: 'upload',\n    title: 'Credentials',\n    description: 'Attach credentials',\n  },\n  {\n    key: 'policy',\n    icon: 'file alternate outline',\n    title: 'IAM Policy',\n    description: 'Add permissions',\n  },\n  {\n    key: 'encrypt',\n    icon: 'user secret',\n    title: 'Encrypt',\n    description: 'Encrypt credentials',\n  },\n];\n\nconst generateDefaultIAMPolicy = accountId =>\n  `\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"ec2\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ec2:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"cloudformation\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"cloudformation:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"emr\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"elasticmapreduce:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"sagemaker\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sagemaker:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"iamRoleAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:GetRole\",\n        \"iam:CreateRole\",\n        \"iam:TagRole\",\n        \"iam:GetRolePolicy\",\n        \"iam:PutRolePolicy\",\n        \"iam:DeleteRolePolicy\",\n        \"iam:DeleteRole\",\n        \"iam:PassRole\"\n      ],\n      \"Resource\": \"arn:aws:iam::${accountId}:role/analysis-*\"\n    },\n    {\n      \"Sid\": \"iamInstanceProfileAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:AddRoleToInstanceProfile\",\n        \"iam:CreateInstanceProfile\",\n        \"iam:GetInstanceProfile\",\n        \"iam:DeleteInstanceProfile\",\n        \"iam:RemoveRoleFromInstanceProfile\"\n      ],\n      \"Resource\": \"arn:aws:iam::${accountId}:instance-profile/analysis-*\"\n    },\n    {\n      \"Sid\": \"iamRoleServicePolicyAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:AttachRolePolicy\",\n        \"iam:DetachRolePolicy\"\n      ],\n      \"Resource\": \"arn:aws:iam::${accountId}:role/analysis-*\",\n      \"Condition\": {\n        \"ArnLike\": {\n          \"iam:PolicyARN\": \"arn:aws:iam::aws:policy/service-role/AmazonElasticMapReduceRole\"\n        }\n      }\n    },\n    {\n      \"Sid\": \"iamServiceLinkedRoleCreateAccess\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:CreateServiceLinkedRole\",\n        \"iam:PutRolePolicy\"\n      ],\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/elasticmapreduce.amazonaws.com*/AWSServiceRoleForEMRCleanup*\",\n      \"Condition\": {\n        \"StringLike\": {\n          \"iam:AWSServiceName\": [\n            \"elasticmapreduce.amazonaws.com\",\n            \"elasticmapreduce.amazonaws.com.cn\"\n          ]\n        }\n      }\n    },\n    {\n      \"Sid\": \"s3\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"ssm\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"ssm:*\",\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"kms\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"kms:*\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n`.trim();\n\n// Mapping from credentials.csv column names to preferred, short names\nconst mapCredentialsColumns = new Map([\n  ['User name', 'username'],\n  ['Password', 'password'],\n  ['Access key ID', 'accessKeyId'],\n  ['Secret access key', 'secretAccessKey'],\n  ['Console login link', 'console'],\n]);\n\nconst ListOnboardingIAMUser = (\n  <List ordered>\n    <List.Item>\n      Log into the{' '}\n      <a href=\"https://console.aws.amazon.com/console/home?region=us-east-1#\" target=\"_blank\" rel=\"noopener noreferrer\">\n        AWS Console\n      </a>{' '}\n      and navigate to{' '}\n      <a\n        href=\"https://console.aws.amazon.com/iam/home?region=us-east-1#/users\"\n        target=\"_blank\"\n        rel=\"noopener noreferrer\"\n      >\n        IAM Users\n      </a>\n    </List.Item>\n    <List.Item>Click &apos;Add User&apos; and type a new, unique user name</List.Item>\n    <List.Item>Under &apos;Select AWS access type&apos;, check &apos;Programmatic access&apos;</List.Item>\n    <List.Item>\n      Click &apos;Next: Permissions&apos;, then &apos;Next: Tags&apos;, then &apos;Next: Review&apos;\n    </List.Item>\n    {/* <List.Item>Click &apos;Next: Tags&apos;</List.Item>\n    <List.Item>Click &apos;Next: Review&apos;</List.Item> */}\n    <List.Item>Click &apos;Create User&apos;</List.Item>\n    <List.Item>On the &apos;Add User&apos; success page, click &apos;Download .csv&apos;</List.Item>\n    <List.Item>Click &apos;Close&apos;</List.Item>\n  </List>\n);\n\nconst ListOnboardingEncrypt = (\n  <List ordered>\n    <List.Item>Enter a PIN which will be used to encrypt your AWS credentials</List.Item>\n    <List.Item>Remember this PIN because you will need it in future to launch workspaces</List.Item>\n  </List>\n);\n\n// expected props\n// - environmentsStore (via injection)\n// - location (from react router)\nclass UserOnboarding extends React.Component {\n  constructor(props) {\n    super(props);\n    const user = this.getUserStore.user;\n    this.form = getExternalUserPinForm();\n\n    runInAction(() => {\n      this.user = user;\n      this.credentials = undefined;\n      this.credentialsValid = false;\n      this.accountId = '';\n      this.activePolicy = false;\n      this.copiedPolicy = '';\n      this.onboardingStep = 0;\n      this.onboardingSteps = OnboardingSteps.length;\n    });\n  }\n\n  get getUserStore() {\n    return this.props.userStore;\n  }\n\n  get getUsersStore() {\n    return this.props.usersStore;\n  }\n\n  onboardingNext = () => {\n    OnboardingSteps[this.onboardingStep].active = false;\n    OnboardingSteps[this.onboardingStep + 1].active = true;\n    this.onboardingStep += 1;\n  };\n\n  onboardingPrev = () => {\n    OnboardingSteps[this.onboardingStep].active = false;\n    OnboardingSteps[this.onboardingStep - 1].active = true;\n    this.onboardingStep -= 1;\n  };\n\n  onboardingCredentialsPut = async (creds, pin) => {\n    const usersStore = this.getUsersStore;\n    await this.user.setEncryptedCreds(creds, pin);\n    await usersStore.updateUser(this.user);\n    await usersStore.load();\n  };\n\n  onboardingSave = () => {\n    const pin = this.form.$('pin').value;\n    this.onboardingCredentialsPut(this.credentials, pin);\n    this.onboardingClose();\n  };\n\n  onboardingClose = () => {\n    this.resetOnboarding();\n    this.props.onclose();\n  };\n\n  shouldRenderOnboarding = () => this.user.isExternalUser;\n\n  resetOnboarding = () => {\n    OnboardingSteps.forEach(step => {\n      step.active = false;\n    });\n    OnboardingSteps[0].active = true;\n\n    this.credentials = undefined;\n    this.credentialsValid = false;\n    this.copiedPolicy = '';\n    this.onboardingStep = 0;\n  };\n\n  renderOnboardingButtons() {\n    const nextDisabled = this.onboardingStep === steps.CREDENTIALS && !this.credentialsValid;\n    return (\n      <>\n        <Button content=\"Cancel\" className=\"mr2\" onClick={this.onboardingClose} />\n        {this.onboardingStep > 0 && (\n          <Button content=\"Prev\" icon=\"left arrow\" labelPosition=\"left\" color=\"blue\" onClick={this.onboardingPrev} />\n        )}\n        {this.onboardingStep < this.onboardingSteps - 1 && (\n          <Button\n            content=\"Next\"\n            icon=\"right arrow\"\n            labelPosition=\"right\"\n            color=\"blue\"\n            disabled={nextDisabled}\n            onClick={this.onboardingNext}\n          />\n        )}\n        {this.onboardingStep === this.onboardingSteps - 1 && (\n          <Button content=\"Save\" color=\"blue\" onClick={this.onboardingSave} />\n        )}\n      </>\n    );\n  }\n\n  togglePolicy = () => {\n    this.activePolicy = !this.activePolicy;\n  };\n\n  testClipboardWrite = async () => {\n    return new Promise((resolve, _reject) => {\n      navigator.permissions.query({ name: 'clipboard-write' }).then(result => {\n        resolve(result.state === 'granted' || result.state === 'prompt');\n      });\n    });\n  };\n\n  handleCopyPolicy = () => {\n    navigator.clipboard.writeText(generateDefaultIAMPolicy(this.accountId)).then(\n      () => {\n        /* clipboard successfully set */\n        runInAction(() => {\n          this.copiedPolicy = 'copied!';\n        });\n      },\n      () => {\n        /* clipboard write failed */\n        runInAction(() => {\n          this.copiedPolicy = 'copy error!';\n        });\n      },\n    );\n  };\n\n  ListOnboardingIAMPolicy() {\n    return (\n      <List ordered>\n        <List.Item>\n          From the{' '}\n          <a\n            href=\"https://console.aws.amazon.com/iam/home?region=us-east-1#/users\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            IAM user list\n          </a>{' '}\n          page, click the name of the new IAM user that you just created\n        </List.Item>\n        <List.Item>\n          In the &apos;Get started with permissions&apos; block, click the &apos;Add inline policy&apos; button\n        </List.Item>\n        <List.Item>On the &apos;Create Policy&apos; page, click the &apos;JSON&apos; tab</List.Item>\n        <List.Item>Delete the default policy text</List.Item>\n        <List.Item>\n          Click to copy a standard IAM policy{' '}\n          <Icon name=\"copy outline\" link onClick={this.handleCopyPolicy} title=\"Copy IAM policy to the clipboard\" />\n          {this.copiedPolicy}\n        </List.Item>\n        <List.Item>Paste the copied IAM policy into the IAM console</List.Item>\n        <List.Item>Click the &apos;Review Policy&apos; button</List.Item>\n        <List.Item>\n          Supply a name, for example &apos;compute-launch&apos;, and click &apos;Create Policy&apos;\n        </List.Item>\n      </List>\n    );\n  }\n\n  renderOnboardingIAMPolicyText() {\n    const showHide = this.activePolicy ? 'hide' : 'show';\n\n    return (\n      <Accordion>\n        <Accordion.Title active={this.activePolicy} index={0} onClick={this.togglePolicy}>\n          <Icon name=\"dropdown\" />\n          Click to {showHide} the standard IAM policy\n        </Accordion.Title>\n        <Accordion.Content active={this.activePolicy}>\n          <SyntaxHighlighter language=\"json\" style={docco}>\n            {generateDefaultIAMPolicy(this.accountId)}\n          </SyntaxHighlighter>\n        </Accordion.Content>\n      </Accordion>\n    );\n  }\n\n  handleCredentialsReset = () => {\n    this.credentials = undefined;\n    this.credentialsValid = false;\n  };\n\n  renderOnboardingIAMCredentials() {\n    return (\n      <Table compact>\n        <Table.Header>\n          <Table.Row>\n            <Table.HeaderCell>Valid</Table.HeaderCell>\n            <Table.HeaderCell>IAM User Name</Table.HeaderCell>\n            <Table.HeaderCell>Access Key ID</Table.HeaderCell>\n            <Table.HeaderCell>Secret Key ID</Table.HeaderCell>\n            <Table.HeaderCell>Reset</Table.HeaderCell>\n          </Table.Row>\n        </Table.Header>\n        <Table.Body>\n          <Table.Row>\n            <Table.Cell>\n              {this.credentialsValid ? <Icon name=\"check\" color=\"green\" /> : <Icon name=\"delete\" color=\"red\" />}\n            </Table.Cell>\n            <Table.Cell>{this.credentials.username}</Table.Cell>\n            <Table.Cell>{this.credentials.accessKeyId}</Table.Cell>\n            <Table.Cell>********************</Table.Cell>\n            <Table.Cell>\n              <Button\n                basic\n                size=\"mini\"\n                icon=\"trash alternate outline\"\n                color=\"red\"\n                content=\"Reset\"\n                title=\"Reset attached credentials\"\n                onClick={this.handleCredentialsReset}\n              />\n            </Table.Cell>\n          </Table.Row>\n        </Table.Body>\n      </Table>\n    );\n  }\n\n  credentialsCSVtoJSON(csv) {\n    const obj = {};\n    const lines = csv.split(/\\r?\\n/);\n    const headers = lines[0].split(',');\n\n    // We only care about the first line of data following the header\n    for (let ii = 1; ii < lines.length; ii++) {\n      const currentline = lines[ii].split(',');\n\n      for (let jj = 0; jj < headers.length; jj++) {\n        const colname = mapCredentialsColumns.get(headers[jj]) || headers[jj];\n        obj[colname] = currentline[jj];\n      }\n      break;\n    }\n\n    return obj;\n  }\n\n  onCredentialsDrop = files => {\n    const reader = new FileReader();\n\n    reader.onabort = () => {\n      console.log('file reading was aborted');\n      displayError('File reading was aborted.');\n    };\n    reader.onerror = () => {\n      console.log('file reading has failed');\n      displayError('File reading has failed.');\n    };\n    reader.onload = () => {\n      const result = reader.result;\n      const credentials = this.credentialsCSVtoJSON(result);\n      runInAction(() => {\n        this.credentials = credentials;\n        this.credentials.region = awsRegion;\n      });\n\n      // Async IIFE\n      (async () => {\n        try {\n          const rc = await CfnService.validateCredentials(credentials.accessKeyId, credentials.secretAccessKey);\n          runInAction(() => {\n            this.credentialsValid = true;\n            this.accountId = rc.Account;\n          });\n        } catch (e) {\n          displayError(`Credential test failed: ${e}`);\n          runInAction(() => {\n            this.credentialsValid = false;\n          });\n        }\n      })();\n    };\n    files.forEach(file => reader.readAsText(file));\n  };\n\n  renderCredentialsDropzone() {\n    const maxSize = 1000;\n    return (\n      <Segment className=\"mt4 center\">\n        <Header as=\"h4\" color=\"grey\">\n          Drag and drop credentials file here\n        </Header>\n        {/* Note: specifying single accept type causes uiploads to fail on Windows */}\n        {/* Was: accept=\"text/csv\" */}\n        <Dropzone onDrop={this.onCredentialsDrop} minSize={0} maxSize={maxSize} multiple={false}>\n          {({ getRootProps, getInputProps, rejectedFiles, isDragActive }) => {\n            const isFileTooLarge = rejectedFiles.length > 0 && rejectedFiles[0].size > maxSize;\n            return (\n              <div {...getRootProps()}>\n                <input {...getInputProps()} />\n                {isDragActive ? (\n                  <p>Drop the CSV file here ...</p>\n                ) : (\n                  <p>Drag and drop a credentials.csv files here, or click to select a file</p>\n                )}\n                {<Icon name=\"cloud upload\" size=\"huge\" color=\"grey\" />}\n                {isFileTooLarge && <div className=\"text-danger mt-2\">File is too large.</div>}\n              </div>\n            );\n          }}\n        </Dropzone>\n      </Segment>\n    );\n  }\n\n  renderOnboardingIAMUser() {\n    return (\n      <Modal.Content image>\n        <Icon name=\"user\" size=\"massive\" />\n        {/* <Image wrapped size=\"medium\" src=\"https://react.semantic-ui.com/images/avatar/large/rachel.png\" /> */}\n        <Modal.Description>\n          <Header>IAM User</Header>\n          <p>\n            Please execute the following steps to create a new IAM User that you will use to supply credentials to the\n            Research Portal so that we can launch workspaces in your AWS account:\n          </p>\n          {ListOnboardingIAMUser}\n        </Modal.Description>\n      </Modal.Content>\n    );\n  }\n\n  renderOnboardingIAMPolicy() {\n    return (\n      <Modal.Content image>\n        <Icon name=\"file alternate outline\" size=\"massive\" />\n        {/* <Image wrapped size=\"medium\" src=\"https://react.semantic-ui.com/images/avatar/large/matthew.png\" /> */}\n        <Modal.Description>\n          <Header>IAM Policy</Header>\n          <p>\n            Please execute the following steps to create a new IAM Policy that will provide permissions to the Research\n            Portal so that we can launch workspaces in your AWS account:\n          </p>\n          {this.ListOnboardingIAMPolicy()}\n          {this.renderOnboardingIAMPolicyText()}\n        </Modal.Description>\n      </Modal.Content>\n    );\n  }\n\n  renderOnboardingCredentials() {\n    return (\n      <Modal.Content image>\n        <Icon name=\"upload\" size=\"massive\" />\n        {/* <Image wrapped size=\"medium\" src=\"https://react.semantic-ui.com/images/avatar/large/elliot.jpg\" /> */}\n        <Modal.Description>\n          <Header>Credentials</Header>\n          <p>\n            Please attach the credentials file that you downloaded earlier. This contains your new IAM User credentials.\n            The default name for this file is credentials.csv but your browser may have saved it under a different name.\n          </p>\n          {this.credentials && this.renderOnboardingIAMCredentials()}\n          {!this.credentials && this.renderCredentialsDropzone()}\n        </Modal.Description>\n      </Modal.Content>\n    );\n  }\n\n  renderOnboardingEncrypt() {\n    return (\n      <Modal.Content image>\n        <Icon name=\"user secret\" size=\"massive\" />\n        {/* <Image wrapped size=\"medium\" src=\"https://react.semantic-ui.com/images/avatar/large/molly.png\" /> */}\n        <Modal.Description>\n          <Header>Encrypt</Header>\n          <p>\n            Finally, we will locally encrypt your AWS credentials with a PIN and then store the encrypted credentials in\n            the Research Portal. This will allow you to launch research workspaces using just a PIN.\n          </p>\n          {ListOnboardingEncrypt}\n          <Form form={this.form}>{({ _processing, _onSubmit, _onCancel }) => <PinInput form={this.form} />}</Form>\n        </Modal.Description>\n      </Modal.Content>\n    );\n  }\n\n  renderOnboardingStep(step) {\n    switch (step) {\n      case steps.IAM_USER:\n        return this.renderOnboardingIAMUser();\n      case steps.CREDENTIALS:\n        return this.renderOnboardingCredentials();\n      case steps.IAM_POLICY:\n        return this.renderOnboardingIAMPolicy();\n      case steps.ENCRYPT:\n        return this.renderOnboardingEncrypt();\n      default:\n        return `Unexpected step: ${step}`;\n    }\n  }\n\n  render() {\n    return (\n      <>\n        <Modal open onClose={this.onboardingClose} closeIcon>\n          <Modal.Header>Configure AWS Credentials</Modal.Header>\n          <Modal.Content>\n            <Step.Group size=\"tiny\" fluid items={OnboardingSteps} />\n          </Modal.Content>\n          {this.renderOnboardingStep(this.onboardingStep)}\n          <Modal.Actions>{this.renderOnboardingButtons()}</Modal.Actions>\n        </Modal>\n      </>\n    );\n  }\n}\n\ndecorate(UserOnboarding, {\n  onboardingNext: action,\n  onboardingPrev: action,\n  resetOnboarding: action,\n  togglePolicy: action,\n  handleCopyPolicy: action,\n  handleCredentialsReset: action,\n  onCredentialsDrop: action,\n  onRegionChange: action,\n  user: observable,\n  credentials: observable,\n  credentialsValid: observable,\n  activePolicy: observable,\n  copiedPolicy: observable,\n  onboardingStep: observable,\n  onboardingSteps: observable,\n});\nexport default inject('userStore', 'usersStore')(withRouter(observer(UserOnboarding)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { decorate, action } from 'mobx';\nimport { Button, Icon, Segment, Step } from 'semantic-ui-react';\n\nimport Form from '../helpers/fields/Form';\nimport InputEntriesRenderer from './InputEntriesRenderer';\n\n// expected props\n// - model - an instance of the ConfigurationEditor model instance (via props)\n// - onCancel (via props) is called after all the necessary clean up\nclass ConfigurationEditor extends React.Component {\n  getModel() {\n    return this.props.model;\n  }\n\n  getForm() {\n    const model = this.getModel();\n    return model.form;\n  }\n\n  handleCancel = () => {\n    const onCancel = this.props.onCancel || _.noop;\n    const model = this.getModel();\n    model.cancel();\n\n    return onCancel();\n  };\n\n  handleNext = form => {\n    const model = this.getModel();\n    model.next(form);\n  };\n\n  handlePrevious = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    const form = this.getForm();\n    const model = this.getModel();\n\n    model.previous(form);\n  };\n\n  handleClear = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    const form = this.getForm();\n    const model = this.getModel();\n    model.clearSectionConfigs();\n    form.reset();\n  };\n\n  render() {\n    const form = this.getForm();\n    const model = this.getModel();\n    const hasPrevious = model.hasPrevious;\n    const inputManifestSection = model.inputManifestSection || {};\n    const inputEntries = inputManifestSection.children || [];\n    const empty = inputEntries.length === 0;\n\n    return (\n      <Form form={form} onCancel={this.handleCancel} onSuccess={this.handleNext}>\n        {({ processing, errors, _onSubmit, onCancel }) => (\n          <>\n            {!empty && (\n              <div className=\"mt3 clearfix p2\">\n                {this.renderSectionTitles(errors)}\n                <InputEntriesRenderer form={form} inputEntries={inputEntries} processing={processing} />\n              </div>\n            )}\n            {empty && (\n              <Segment padded className=\"mb3\">\n                No configuration values are provided\n              </Segment>\n            )}\n\n            <div className=\"mt0 clearfix\">\n              <Button\n                floated=\"right\"\n                type=\"submit\"\n                color=\"blue\"\n                icon\n                disabled={processing}\n                className=\"ml2\"\n                labelPosition=\"right\"\n              >\n                Next\n                <Icon name=\"right arrow\" />\n              </Button>\n              {hasPrevious && (\n                <Button\n                  floated=\"right\"\n                  className=\"ml2\"\n                  icon\n                  disabled={processing}\n                  labelPosition=\"left\"\n                  onClick={this.handlePrevious}\n                >\n                  Previous\n                  <Icon name=\"left arrow\" />\n                </Button>\n              )}\n              <Button floated=\"right\" disabled={processing} onClick={this.handleClear}>\n                Clear\n              </Button>\n              <Button floated=\"left\" disabled={processing} onClick={onCancel}>\n                Cancel\n              </Button>\n            </div>\n          </>\n        )}\n      </Form>\n    );\n  }\n\n  renderSectionTitles(errors) {\n    const model = this.getModel();\n    const totalSections = model.totalSections;\n    const currentSectionIndex = model.currentSectionIndex;\n    const showSectionTitles = totalSections > 1;\n    const sectionTitles = model.sectionsTitles;\n    const hasError = errors.length > 0;\n    if (!showSectionTitles) return null;\n    if (totalSections < 3) return null; // only show the titles when we have 3 or more sections\n\n    return (\n      <Step.Group size=\"mini\" fluid>\n        {_.times(totalSections, index => (\n          <Step active={index === currentSectionIndex} completed={index < currentSectionIndex}>\n            {hasError && index === currentSectionIndex ? <Icon name=\"times\" /> : <Icon name=\"setting\" />}\n            <Step.Content>\n              <Step.Title>{sectionTitles[index] || ''}</Step.Title>\n            </Step.Content>\n          </Step>\n        ))}\n      </Step.Group>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ConfigurationEditor, {\n  handleNext: action,\n  handlePrevious: action,\n  handleCancel: action,\n  handleClear: action,\n});\n\nexport default observer(ConfigurationEditor);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { Segment, Placeholder, Divider } from 'semantic-ui-react';\n\n// expected props\n// - segmentCount (via props)\n// - className (via props)\nconst Component = ({ segmentCount = 1, className }) => {\n  const segment = index => (\n    <Segment key={index} className=\"p3 mb2\">\n      <Placeholder fluid>\n        <Placeholder.Header>\n          <Placeholder.Line length=\"full\" />\n        </Placeholder.Header>\n        <Placeholder.Paragraph>\n          <Placeholder.Line length=\"short\" />\n        </Placeholder.Paragraph>\n      </Placeholder>\n      <Divider className=\"mt3\" />\n      <Placeholder fluid>\n        <Placeholder.Line length=\"full\" />\n      </Placeholder>\n    </Segment>\n  );\n\n  return <div className={className}>{_.map(_.times(segmentCount, String), index => segment(index))}</div>;\n};\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { decorate, action, runInAction, observable } from 'mobx';\nimport { Button, Icon, Segment, Dimmer, Loader } from 'semantic-ui-react';\n\nimport { displayError } from '../../helpers/notification';\nimport ConfigTable from './ConfigTable';\n\n// expected props\n// - model - an instance of the ConfigurationEditor model instance (via props)\n// - onCancel (via props) is called after all the necessary clean up\n// - onSave (via props) is called with (configuration) which is just an object with key/value pairs\n// - dimmer (via props) default to true, set to false if you don't want to use the dimmer (buttons will still be disabled during processing)\nclass ConfigurationReview extends React.Component {\n  constructor(props) {\n    super(props);\n\n    runInAction(() => {\n      this.processing = false;\n    });\n  }\n\n  getModel() {\n    return this.props.model;\n  }\n\n  getForm() {\n    const model = this.getModel();\n    return model.form;\n  }\n\n  getDimmer() {\n    const dimmer = this.props.dimmer;\n    return _.isUndefined(dimmer) ? true : !!dimmer;\n  }\n\n  handleCancel = () => {\n    this.processing = false;\n    const onCancel = this.props.onCancel || _.noop;\n    const model = this.getModel();\n    model.cancel();\n\n    return onCancel();\n  };\n\n  handleSave = async () => {\n    const onSave = this.props.onSave || _.noop;\n    const model = this.getModel();\n    const configuration = {};\n\n    /* eslint-disable no-restricted-syntax */\n    for (const [key, value] of model.configuration.entries()) {\n      configuration[key] = value;\n    }\n    /* eslint-enable no-restricted-syntax */\n\n    try {\n      this.processing = true;\n      await onSave(configuration);\n      runInAction(() => {\n        this.processing = false;\n      });\n      model.applyChanges();\n      model.restart();\n    } catch (error) {\n      runInAction(() => {\n        this.processing = false;\n      });\n      displayError(error);\n    }\n  };\n\n  handlePrevious = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    const form = this.getForm();\n    const model = this.getModel();\n\n    this.processing = false;\n    model.previous(form);\n  };\n\n  render() {\n    const processing = this.processing;\n    const dimmer = this.getDimmer();\n    const model = this.getModel();\n    const configRows = model.definedConfigList || [];\n    const empty = configRows.length === 0;\n    const review = model.review;\n    const buttons = (\n      <div className=\"mt3 clearfix\">\n        {review && (\n          <Button\n            floated=\"right\"\n            color=\"blue\"\n            icon=\"save\"\n            labelPosition=\"left\"\n            disabled={processing || !review || empty}\n            className=\"ml2\"\n            content=\"Save\"\n            onClick={this.handleSave}\n          />\n        )}\n        <Button floated=\"right\" icon disabled={processing} labelPosition=\"left\" onClick={this.handlePrevious}>\n          Previous\n          <Icon name=\"left arrow\" />\n        </Button>\n        <Button floated=\"left\" disabled={processing} onClick={this.handleCancel}>\n          Cancel\n        </Button>\n      </div>\n    );\n\n    let content = <ConfigTable rows={configRows} />;\n    if (empty) content = 'No configuration values are provided';\n\n    return (\n      <>\n        {review && (\n          <Segment padded>\n            {dimmer && (\n              <Dimmer active={processing} inverted>\n                <Loader inverted>Processing</Loader>\n              </Dimmer>\n            )}\n            {content}\n          </Segment>\n        )}\n        {buttons}\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ConfigurationReview, {\n  processing: observable,\n  handleSave: action,\n  handlePrevious: action,\n  handleCancel: action,\n});\n\nexport default observer(ConfigurationReview);\n","import React from 'react';\nimport { decorate, runInAction, observable, action, computed } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Button, Header, Message } from 'semantic-ui-react';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\nimport Form from '@aws-ee/base-ui/dist/parts/helpers/fields/Form';\nimport Input from '@aws-ee/base-ui/dist/parts/helpers/fields/Input';\nimport TextArea from '@aws-ee/base-ui/dist/parts/helpers/fields/TextArea';\n\nimport { getKeyPairCreateForm } from '../../../models/forms/KeyPairCreateForm';\n\n// expected props\n// - onCancel (via props) a function is called with the user clicks on cancel or done\n// - keyPairsStore (via injection)\nclass KeyPairCreateForm extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.form = getKeyPairCreateForm();\n      this.keyPair = undefined;\n    });\n  }\n\n  get keyPairsStore() {\n    return this.props.keyPairsStore;\n  }\n\n  handleCreate = async form => {\n    const data = form.values();\n    try {\n      const keyPair = await this.keyPairsStore.createKetPair(data);\n      runInAction(() => {\n        this.keyPair = keyPair;\n      });\n    } catch (error) {\n      displayError(error);\n    }\n  };\n\n  handleCancel = () => {\n    this.keyPair = undefined;\n    const onCancel = this.props.onCancel;\n\n    if (onCancel) return onCancel();\n\n    return undefined;\n  };\n\n  handleDownload = () => {\n    const keyPair = this.keyPair;\n    const downloadLink = document.createElement('a');\n    downloadLink.setAttribute('href', `data:application/octet-stream,${encodeURIComponent(keyPair.privateKey)}`);\n    downloadLink.setAttribute('download', `${keyPair.name}.pem`);\n    downloadLink.click();\n  };\n\n  render() {\n    const keyPair = this.keyPair;\n    return keyPair ? this.renderPrivateKey() : this.renderForm();\n  }\n\n  renderForm() {\n    const form = this.form;\n    return (\n      <Form form={form} onCancel={this.handleCancel} onSuccess={this.handleCreate}>\n        {({ processing, /* onSubmit, */ onCancel }) => (\n          <>\n            <Input field={form.$('name')} className=\"mb3\" />\n            <TextArea field={form.$('desc')} />\n\n            <Button floated=\"right\" className=\"ml2\" primary content=\"Create Key\" disabled={processing} type=\"submit\" />\n            <Button floated=\"right\" className=\"ml2\" content=\"Cancel\" disabled={processing} onClick={onCancel} />\n          </>\n        )}\n      </Form>\n    );\n  }\n\n  renderPrivateKey() {\n    return (\n      <>\n        <Header>Private Key</Header>\n        <Message warning>\n          <Message.Header>Warning!</Message.Header>\n          <p>\n            This is your only chance to download the private key. The private key is secret information that should not\n            be shared with others. It should be stored and handled carefully.{' '}\n          </p>\n        </Message>\n        <div className=\"clearfix\">\n          <Button floated=\"right\" className=\"ml2\" content=\"Done\" onClick={this.handleCancel} />\n          <Button floated=\"left\" primary className=\"mr2\" content=\"Download\" onClick={this.handleDownload} />\n        </div>\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(KeyPairCreateForm, {\n  form: observable,\n  keyPair: observable,\n  keyPairsStore: computed,\n  handleCreate: action,\n  handleCancel: action,\n  handleDownload: action,\n});\n\nexport default inject('keyPairsStore')(withRouter(observer(KeyPairCreateForm)));\n","import { createForm } from '@aws-ee/base-ui/dist/helpers/form';\n\nfunction getKeyPairCreateForm() {\n  const fields = {\n    name: {\n      label: 'Name',\n      placeholder: 'Name for this key',\n      extra: {\n        explain:\n          'Easily identifiable name for this key. The name is used for display purposes.' +\n          'It must be an alpha numeric string between 2 and 100 characters long may contain space, underscore (_) and/or dash (-).',\n      },\n      value: '',\n      rules: ['required', 'min:2', 'max:100', 'regex:/^[A-Za-z0-9-_ ]+$/'],\n    },\n    desc: {\n      label: 'Description',\n      placeholder: 'Describe the purpose of this key, up to 1024 characters long.',\n      value: '',\n      rules: 'max:1024|string',\n    },\n  };\n\n  return createForm(fields);\n}\n\n// eslint-disable-next-line import/prefer-default-export\nexport { getKeyPairCreateForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { decorate, action, observable, runInAction } from 'mobx';\nimport { Dimmer, Loader, Message } from 'semantic-ui-react';\nimport c from 'classnames';\n\n// expected props\n// - form (via props) the mobx form instance\n// - onSuccess (via props) is called once mobx form calls on hooks.onSuccess(), receives (form)\n// - onError (via props) is called once mobx form calls on hooks.onError(), receives (form)\n// - onCancel (via props) receives (form)\n// - dimmer (via props) default to true, set to false if you don't want to use the dimmer (buttons will still be disabled during processing)\n// - className (via props)\n// - showErrorPanel (via props) default to true, set to false if you don't want the error panel to be rendered (i.e., if you only want the errors to be displayed next to the fields but not show the main error panel)\nclass Form extends React.Component {\n  constructor(props) {\n    super(props);\n    this.formHooks = {\n      onSuccess: this.handleFormSubmission,\n      onError: this.handleFormErrors,\n    };\n\n    runInAction(() => {\n      this.formProcessing = false;\n    });\n  }\n\n  getForm() {\n    return this.props.form;\n  }\n\n  getDimmer() {\n    const dimmer = this.props.dimmer;\n    return _.isUndefined(dimmer) ? true : !!dimmer;\n  }\n\n  getOnCancel() {\n    return this.props.onCancel || _.noop;\n  }\n\n  getOnSuccess() {\n    return this.props.onSuccess || _.noop;\n  }\n\n  getOnError() {\n    return this.props.onError || _.noop;\n  }\n\n  getFormErrors() {\n    const form = this.getForm();\n    const errorMap = form.errors() || {};\n    const errors = [];\n    const visit = obj => {\n      if (_.isNil(obj)) return;\n      if (_.isString(obj) && !_.isEmpty(obj)) {\n        errors.push(obj);\n        return;\n      }\n      if (_.isArray(obj) || _.isObject(obj)) {\n        _.forEach(obj, value => {\n          visit(value);\n        });\n      }\n    };\n\n    visit(errorMap);\n    return errors;\n  }\n\n  handleFormSubmission = async form => {\n    const onSuccess = this.getOnSuccess();\n    this.formProcessing = true;\n    try {\n      const result = await onSuccess(form);\n      runInAction(() => {\n        this.formProcessing = false;\n      });\n\n      return result;\n    } catch (error) {\n      runInAction(() => {\n        this.formProcessing = false;\n      });\n\n      throw error;\n    }\n  };\n\n  handleFormErrors = async form => {\n    const onError = this.getOnError();\n    this.formProcessing = false;\n    const errors = this.getFormErrors();\n\n    return onError(form, errors);\n  };\n\n  handleSubmit = event => {\n    const form = this.getForm();\n    event.preventDefault();\n    event.stopPropagation();\n    this.formProcessing = true;\n    try {\n      return form.onSubmit(event, this.formHooks);\n    } catch (error) {\n      this.formProcessing = false;\n      throw error;\n    }\n  };\n\n  handleCancel = event => {\n    const form = this.getForm();\n    const onCancel = this.getOnCancel();\n\n    event.preventDefault();\n    event.stopPropagation();\n    this.formProcessing = false;\n    form.reset();\n    onCancel(form);\n  };\n\n  renderErrorPanel() {\n    const errors = this.getFormErrors();\n    const size = errors.length;\n    if (size === 0) return null;\n    const title = `Please Correct The Following Error${size === 1 ? '' : 's'}`;\n    const toMessage = msg => (_.isObject(msg) ? JSON.stringify(msg) : `${msg}`);\n\n    return (\n      <Message className=\"mb3 mt0 animated fadeIn\" negative>\n        <Message.Header>{title}</Message.Header>\n        <Message.List>\n          {_.map(errors, (msg, index) => (\n            <Message.Item key={index}>{toMessage(msg)}</Message.Item>\n          ))}\n        </Message.List>\n      </Message>\n    );\n  }\n\n  render() {\n    const processing = this.formProcessing;\n    const renderer = _.isFunction(this.props.children) ? this.props.children : _.noop;\n    const className = this.props.className;\n    const dimmer = this.getDimmer();\n    const errors = this.getFormErrors();\n\n    const showErrorPanel = _.isNil(this.props.showErrorPanel) || this.props.showErrorPanel;\n\n    const formContent = (\n      <>\n        {dimmer && (\n          <Dimmer active={processing} inverted>\n            <Loader inverted>Processing</Loader>\n          </Dimmer>\n        )}\n        {showErrorPanel && this.renderErrorPanel()}\n        {renderer({\n          processing,\n          errors,\n          onSubmit: this.handleSubmit,\n          onCancel: this.handleCancel,\n        })}\n      </>\n    );\n    const renderFormAs = this.props.renderFormAs;\n    if (_.isFunction(renderFormAs)) {\n      return renderFormAs(formContent);\n    }\n    return (\n      <form className={c('ui fluid form', className)} onSubmit={this.handleSubmit}>\n        {formContent}\n      </form>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(Form, {\n  formProcessing: observable,\n  handleSubmit: action,\n  handleFormSubmission: action,\n  handleFormErrors: action,\n  handleCancel: action,\n});\n\nexport default observer(Form);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Input } from 'semantic-ui-react';\nimport c from 'classnames';\n\nimport Header from './Header';\nimport Description from './Description';\nimport ErrorPointer from './ErrorPointer';\n\n// expected props\n// - field (via props), this is the mobx form field object\n// - className (via props)\n//\n// The following props are to support existing React Semantic UI props:\n// - fluid (via props), default to true\n// - disabled (via props), default to false\n// - autoFocus (via props), default to false\n// - icon (via props)\n// - iconPosition (via props)\nconst Component = observer(\n  ({\n    field,\n    fluid = true,\n    disabled = false,\n    type = 'text',\n    className = 'mb4',\n    autoFocus = false,\n    icon,\n    iconPosition,\n    showHeader = true,\n    dataTestId = '',\n  }) => {\n    const { error = '' } = field;\n    const hasError = !_.isEmpty(error); // IMPORTANT do NOT use field.hasError\n    const isDisabled = field.disabled || disabled;\n    const disabledClass = isDisabled ? 'disabled' : '';\n    const errorClass = hasError ? 'error' : '';\n    const attrs = {\n      fluid,\n      disabled: isDisabled,\n      error: hasError,\n      ..._.omit(field.bind(), ['label']),\n      autoFocus,\n      type,\n      icon,\n      iconPosition,\n    };\n\n    return (\n      <div className={c(className, errorClass, disabledClass)}>\n        {showHeader && <Header field={field} />}\n        <Description field={field} />\n        <Input data-testid={dataTestId} className=\"field\" {...attrs} />\n        <ErrorPointer field={field} />\n      </div>\n    );\n  },\n);\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\n\nconst codes = ['apiError', 'notFound', 'badRequest', 'tokenExpired', 'incorrectImplementation', 'timeout'];\n\nconst boom = {\n  error: (friendlyOrErr, code, friendly = '') => {\n    if (_.isString(friendlyOrErr)) {\n      const e = new Error(friendlyOrErr);\n      e.isBoom = true;\n      e.code = code;\n      e.friendly = friendlyOrErr; // the friendly argument is ignored and friendlyOrErr is used instead\n      return e;\n    }\n    if (_.isError(friendlyOrErr)) {\n      friendlyOrErr.code = code; // eslint-disable-line no-param-reassign\n      friendlyOrErr.isBoom = true; // eslint-disable-line no-param-reassign\n      friendlyOrErr.friendly = friendly || _.startCase(code);\n      return friendlyOrErr;\n    }\n\n    // if we are here, it means that the msgOrErr is an object\n    const err = new Error(JSON.stringify(friendlyOrErr));\n    err.isBoom = true;\n    err.code = code;\n    err.friendly = friendly || _.startCase(code);\n\n    return err;\n  },\n};\n\n// inject all the codes array elements as properties for the boom\n// example 'apiError' injected => produces boom.apiError(errOrFriendlyMsg, friendlyMsg)\n// then you can call boom.apiError(err, 'Error fetching user info')\ncodes.forEach(code => {\n  boom[code] = (errOrFriendlyMsg, friendlyMsg) => boom.error(errOrFriendlyMsg, code, friendlyMsg);\n});\n\nconst isNotFound = error => {\n  return _.get(error, 'code') === 'notFound';\n};\n\nconst isTokenExpired = error => {\n  return _.get(error, 'code') === 'tokenExpired';\n};\n\nconst isForbidden = error => {\n  return _.get(error, 'code') === 'forbidden';\n};\n\nexport { boom, isNotFound, isTokenExpired, isForbidden };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport dvr from 'mobx-react-form/lib/validators/DVR';\nimport validatorjs from 'validatorjs';\nimport MobxReactForm from 'mobx-react-form';\nimport isCidr from 'is-cidr';\nimport * as baseFormHelper from '@aws-ee/base-ui/dist/helpers/form';\n\nconst dvrRules = {\n  cidr: {\n    validatorFn: value => {\n      const result = isCidr(value);\n      return result === 4 || result === 6;\n    },\n    message: 'The :attribute is not in the CIDR format.',\n  },\n};\n\n// Extend base formPlugins and add support for \"cidr\" validation rule\nconst formPlugins = {\n  ...baseFormHelper.formPlugins,\n  dvr: dvr({\n    package: validatorjs,\n    extend: ({ validator }) => {\n      Object.keys(dvrRules).forEach(key => validator.register(key, dvrRules[key].validatorFn, dvrRules[key].message));\n    },\n  }),\n};\n\nconst formOptions = baseFormHelper.formOptions;\n\nfunction createForm(fields, pluginsParam, optionsParam) {\n  const plugins = pluginsParam || formPlugins;\n  const options = optionsParam || formOptions;\n  return new MobxReactForm({ fields }, { plugins, options });\n}\n\nconst createSingleFieldForm = baseFormHelper.createSingleFieldForm;\n\nexport { formPlugins, formOptions, createForm, createSingleFieldForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\nimport _ from 'lodash';\n\nimport { getAuthenticationProviderConfigs, updateAuthenticationProviderConfig } from '../../helpers/api';\nimport { BaseStore } from '../BaseStore';\nimport { flattenObject, mapToArray, unFlattenObject } from '../../helpers/utils';\nimport ConfigurationEditor from '../configuration/ConfigurationEditor';\nimport AuthenticationProviderConfigEditor from './AuthenticationProviderConfigEditor';\n\nconst AuthenticationProviderConfigsStore = BaseStore.named('AuthenticationProviderConfigsStore')\n  .props({\n    // authenticationProviderConfigs: A map of authentication provider configurations. Key = id, Value = authn provider config\n    // Each config in the array has the following shape\n    /*\n    {\n      id: STRING // id of the authentication provider\n      title: STRING // title of the authentication provider\n      ..... // The rest of the fields which differ depending on the type of the authentication provider\n      type: { // An object containing information about the authentication provider type\n        type: STRING // authentication provider type\n        title: STRING // title of the authentication provider type\n        description: STRING // description about the authentication provider type\n        config: { // An object authentication provider type configuration\n          credentialHandlingType: STRING // credentialHandlingType indicating credential handling for the authentication provider\n                                         // Possible values:\n                                         // 'submit' -- The credentials should be submitted to the URL provided by the authentication provider\n                                         // 'redirect' -- The credentials should be NOT be collected and the user should be redirected directly to the\n                                         // URL provided by the authentication provider. For example, in case of SAML auth, the username/password\n                                         // should not be collected by the service provider but the user should be redirected to the identity provider\n\n          inputSchema: OBJECT // An object containing JSON schema that describes all properties of the authentication provider configuration that must be provided as\n                              // input when creating this authentication provider.\n                              // This schema will defer based on authentication provider type.\n          inputManifestForCreate: OBJECT // An object similar to inputSchema containing a manifest that describes all properties of the authentication provider configuration that must be provided as\n                              // input when creating this authentication provider. In addition, the object also has information that can be used by the UI to display inputs\n                              // forms such as which inputs to ask from user in which section of the wizard, which sections to show based on which conditions etc.\n                              // This manifest will defer based on authentication provider type.\n          inputManifestForUpdate: OBJECT // Similar to inputManifestForCreate that describes inputs to be accepted from user when updating an existing authentication provider\n        }\n      }\n    }\n    */\n    authenticationProviderConfigs: types.optional(types.map(types.frozen()), {}),\n\n    /*\n      Key = authenticationProviderConfigId, Value = AuthenticationProviderConfigEditor\n     */\n    authenticationProviderConfigEditors: types.optional(types.map(AuthenticationProviderConfigEditor), {}),\n  })\n  .actions(self => ({\n    async doLoad() {\n      const authenticationProviderConfigs = await getAuthenticationProviderConfigs();\n      self.runInAction(() => {\n        const map = {};\n        authenticationProviderConfigs.forEach(authenticationProviderConfig => {\n          map[authenticationProviderConfig.id] = authenticationProviderConfig;\n        });\n        self.authenticationProviderConfigs.replace(map);\n      });\n    },\n\n    getUpdateAuthenticationProviderConfigEditor(authenticationProviderConfigId) {\n      let authenticationProviderConfigEditor = self.authenticationProviderConfigEditors.get(\n        authenticationProviderConfigId,\n      );\n      if (!authenticationProviderConfigEditor) {\n        authenticationProviderConfigEditor = AuthenticationProviderConfigEditor.create({\n          id: authenticationProviderConfigId,\n        });\n        const authenticationProviderConfig = self.getAuthenticationProviderConfig(authenticationProviderConfigId);\n        authenticationProviderConfigEditor.setConfigEditor(self.getConfigEditorForUpdate(authenticationProviderConfig));\n\n        self.authenticationProviderConfigEditors.put(authenticationProviderConfigEditor);\n      }\n      return authenticationProviderConfigEditor;\n    },\n\n    getConfigEditorForUpdate(authenticationProviderConfig) {\n      const inputManifestForUpdate = authenticationProviderConfig.config.type.config.inputManifestForUpdate;\n      if (inputManifestForUpdate) {\n        const inputManifest = _.cloneDeep(inputManifestForUpdate);\n        // \"id\" is read-only and should not be part of the inputManifestForUpdate when updating an existing provider so remove it\n        const filteredSections = _.map(inputManifest.sections, section => {\n          const filteredChildren = _.filter(section.children, child => child.name !== 'id');\n          section.children = filteredChildren;\n          return section;\n        });\n        inputManifest.sections = filteredSections;\n\n        const configuration = toConfiguration(authenticationProviderConfig.config);\n        return ConfigurationEditor.create({\n          currentSectionIndex: 0,\n          review: false,\n          inputManifest,\n          configuration,\n          mode: 'edit',\n        });\n      }\n      return undefined;\n    },\n\n    async updateAuthenticationProvider(authenticationProviderConfig) {\n      const updated = await updateAuthenticationProviderConfig(authenticationProviderConfig);\n      self.runInAction(() => {\n        self.authenticationProviderConfigs.set(updated.id, updated);\n        const authenticationProviderConfigEditor = self.authenticationProviderConfigEditors.get(updated.id);\n        authenticationProviderConfigEditor.setConfigEditor(self.getConfigEditorForUpdate(updated));\n      });\n    },\n\n    getCreateAuthenticationProviderConfigEditor(_authenticationProviderTypeConfig) {},\n  }))\n  .views(self => ({\n    get empty() {\n      return self.authenticationProviderConfigs.size === 0;\n    },\n    get list() {\n      return mapToArray(self.authenticationProviderConfigs);\n    },\n    getAuthenticationProviderConfig(authenticationProviderConfigId) {\n      return self.authenticationProviderConfigs.get(authenticationProviderConfigId);\n    },\n\n    /**\n     * Method that finds first authentication provider that has an idp with the given idp name\n     * @param idpName Name of the identity provider\n     * @returns {*}\n     */\n    getAuthenticationProviderConfigByIdpName(idpName) {\n      const providerConfig = _.find(self.list, authNProvider => {\n        const idps = _.get(authNProvider, 'config.federatedIdentityProviders');\n        const foundIdp = _.find(idps, { name: idpName });\n        // return true if idp is found under this authentication provider\n        return !!foundIdp;\n      });\n      return providerConfig;\n    },\n  }));\n/**\n * Translates given authenticationProviderConfig into ConfigurationEditor compatible flat \"configuration\" object with key/value pairs.\n * The authenticationProviderConfig may be an object graph but the returned \"configuration\" will be flat object with key/value pairs.\n * @param authenticationProviderConfig\n * @return configuration\n */\nfunction toConfiguration(authenticationProviderConfig) {\n  // Authentication provider \"type\" information is not part of inputs and can be skipped from the configuration\n  const flatObj = flattenObject(authenticationProviderConfig, (_result, _value, key) => key !== 'type');\n\n  // MobX form tries to handle nested object notations using dots and and array notations using\n  // [] and expects nested field structure\n  // Here, we want the keys like 'a.b[0].c[1]' etc to be treated as opaque keys in MobX\n  // So replace . and [] to make sure mobx does not treat them as nested keys\n  const toOpaqueKey = key => {\n    let opaqueKey = _.replace(key, /\\./g, '/');\n    opaqueKey = _.replace(opaqueKey, /\\[/g, '|-');\n    opaqueKey = _.replace(opaqueKey, /]/g, '-|');\n    return opaqueKey;\n  };\n  return _.transform(\n    flatObj,\n    (result, value, key) => {\n      result[toOpaqueKey(key)] = value;\n    },\n    {},\n  );\n}\n\n/**\n * Translates given configuration object containing key/value pairs into authenticationProviderConfig.\n * This function is inverse of toConfiguration function above.\n * @param configuration\n * @return authenticationProviderConfig\n */\nfunction fromConfiguration(configuration) {\n  // MobX form tries to handle nested object notations using dots and and array notations using\n  // [] and expects nested field structure\n  // Here, the configuration may have been translated to use opaque keys with dots replaced by / and\n  // [ replaced by |- and ] replaced with -|\n  // Convert those keys back to use dot and [] notations\n  const fromOpaqueKey = key => {\n    let opaqueKey = _.replace(key, /\\//g, '.');\n    opaqueKey = _.replace(opaqueKey, /(\\|-)/g, '[');\n    opaqueKey = _.replace(opaqueKey, /(-\\|)/g, ']');\n    return opaqueKey;\n  };\n\n  const flatObj = _.transform(\n    configuration,\n    (result, value, key) => {\n      result[fromOpaqueKey(key)] = value;\n    },\n    {},\n  );\n\n  // Authentication provider \"type\" information is not part of inputs and can be skipped from the configuration\n  return unFlattenObject(flatObj, (_result, _value, key) => key !== 'type');\n}\n\nfunction registerContextItems(appContext) {\n  appContext.authenticationProviderConfigsStore = AuthenticationProviderConfigsStore.create({}, appContext);\n}\n\nexport { AuthenticationProviderConfigsStore, registerContextItems, fromConfiguration };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\nimport _ from 'lodash';\nimport { storage, removeNulls } from '@aws-ee/base-ui/dist/helpers/utils';\nimport { aesGcmEncrypt, aesGcmDecrypt } from '../../helpers/crypto';\nimport localStorageKeys from '../constants/local-storage-keys';\n\nconst User = types\n  .model('User', {\n    uid: '',\n    firstName: types.maybeNull(types.optional(types.string, '')),\n    lastName: types.maybeNull(types.optional(types.string, '')),\n    isAdmin: types.optional(types.boolean, false),\n    username: '',\n    ns: types.maybeNull(types.optional(types.string, '')),\n    email: '',\n    userType: '',\n    authenticationProviderId: '', // Id of the authentication provider this user is authenticated against (such as internal, cognito auth provider id etc)\n    identityProviderName: types.maybeNull(types.optional(types.string, '')), // Name of the identity provider this user belongs to (such as Identity Provider Id in cognito user pool in case of Federation etc)\n    status: 'active',\n    rev: 0,\n    userRole: '',\n    projectId: types.array(types.string, []), // TODO this property should be named projectIds\n    isExternalUser: types.optional(types.boolean, false), // TODO we need to consider have this a derived property\n    encryptedCreds: types.maybeNull(types.string),\n    applyReason: '',\n  })\n  .actions(self => ({\n    runInAction(fn) {\n      return fn();\n    },\n    async setEncryptedCreds(unencryptedCreds, pin) {\n      unencryptedCreds.region = unencryptedCreds.region || 'us-east-1';\n      const encryptedCreds = await aesGcmEncrypt(JSON.stringify(unencryptedCreds), pin);\n      // TODO Should we store the pin in the session?\n      storage.setItem(localStorageKeys.pinToken, pin);\n      self.runInAction(() => {\n        self.encryptedCreds = encryptedCreds;\n      });\n    },\n    async clearEncryptedCreds() {\n      self.runInAction(() => {\n        self.encryptedCreds = undefined;\n      });\n    },\n    setUser(rawUser) {\n      removeNulls(rawUser);\n      self.firstName = rawUser.firstName || self.firstName || '';\n      self.lastName = rawUser.lastName || self.lastName || '';\n      self.isAdmin = rawUser.isAdmin || self.isAdmin;\n      self.isExternalUser = rawUser.isExternalUser || self.isExternalUser;\n      self.username = rawUser.username || self.username;\n      self.ns = rawUser.ns || self.ns;\n      self.email = rawUser.email || self.email;\n      self.authenticationProviderId = rawUser.authenticationProviderId || self.authenticationProviderId;\n      self.identityProviderName = rawUser.identityProviderName || self.identityProviderName;\n      self.status = rawUser.status || self.status || 'active';\n      self.createdBy = rawUser.createdBy || self.createdBy;\n      self.rev = rawUser.rev || self.rev || 0;\n      self.userRole = rawUser.userRole || self.userRole;\n      self.projectId = rawUser.projectId || self.projectId || [];\n      self.encryptedCreds = rawUser.encryptedCreds || self.encryptedCreds;\n      self.applyReason = rawUser.applyReason || self.applyReason || '';\n      // we don't update the other fields because they are being populated by a separate store\n    },\n  }))\n  .views(self => ({\n    get displayName() {\n      return `${self.firstName} ${self.lastName}`;\n    },\n\n    get longDisplayName() {\n      if (self.unknown) {\n        return `${self.username}??`;\n      }\n      const fullName = `${self.firstName} ${self.lastName}`;\n      if (self.email) {\n        return `${fullName} (${self.email})`;\n      }\n      return fullName;\n    },\n\n    get unknown() {\n      return !self.firstName && !self.lastName;\n    },\n\n    get isRootUser() {\n      return _.toLower(self.userType) === 'root';\n    },\n\n    get isActive() {\n      return _.toLower(self.status) === 'active';\n    },\n\n    get isInternalGuest() {\n      return self.userRole === 'internal-guest';\n    },\n\n    get isExternalGuest() {\n      return self.userRole === 'guest';\n    },\n\n    get isInternalResearcher() {\n      return self.userRole === 'researcher';\n    },\n\n    get isExternalResearcher() {\n      return self.userRole === 'external-researcher';\n    },\n\n    get isSystem() {\n      return self.id === '_system_';\n    },\n\n    isSame(uid) {\n      return self.uid === uid;\n    },\n\n    isSamePrincipal({ username, ns }) {\n      return self.username === username && self.ns === ns;\n    },\n\n    get id() {\n      return self.uid;\n    },\n\n    get principal() {\n      return { username: self.username, ns: self.ns };\n    },\n\n    get principalStr() {\n      return JSON.stringify(self.principal);\n    },\n\n    get hasProjects() {\n      return !_.isEmpty(self.projectId);\n    },\n\n    get hasCredentials() {\n      return self.isExternalResearcher && !_.isEmpty(self.encryptedCreds) && self.encryptedCreds !== 'N/A';\n    },\n\n    // TODO - this should not be a view, it should be moved to the actions section\n    //      - a better approach is to do unencryptedCreds as a view but then\n    //      have the call to store the pin in a separate method that is in the action\n    async unencryptedCreds(pin) {\n      try {\n        const creds = JSON.parse(await aesGcmDecrypt(self.encryptedCreds, pin));\n        // TODO Should we store the pin in the session?\n        storage.setItem(localStorageKeys.pinToken, pin);\n        return creds;\n      } catch (e) {\n        throw new Error('Invalid PIN. Please try again');\n      }\n    },\n\n    // A map of high level actions that the user is allowed to perform.\n    // Example:  { 'canCreateStudy': true/false, 'canCreateWorkspace': true/false }\n    //\n    // Note: actions that require a resource before the permission is determined, are NOT captured in this capability matrix.\n    get capabilities() {\n      const active = self.isActive;\n      const external = self.isExternalUser; // Either external guest or external user\n      const externalGuest = self.isExternalGuest;\n      const internalGuest = self.isInternalGuest;\n\n      const canCreateStudy = active && !external && !internalGuest;\n      const canCreateWorkspace = active && !externalGuest && !internalGuest;\n      const canSelectStudy = active && !externalGuest && !internalGuest;\n      const canViewDashboard = active && !external && !internalGuest;\n\n      return {\n        canCreateStudy,\n        canCreateWorkspace,\n        canSelectStudy,\n        canViewDashboard,\n      };\n    },\n  }));\n\nfunction getPrincipalObjFromPrincipalStr(principalStr) {\n  return JSON.parse(principalStr);\n}\n\nfunction getPrincipalStrFromPrincipalObj({ username, ns }) {\n  return JSON.stringify({ username, ns });\n}\n\nexport { User, getPrincipalObjFromPrincipalStr, getPrincipalStrFromPrincipalObj };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nconst barOptions = {\n  // see https://www.chartjs.org/docs/latest/configuration/legend.html\n  // see https://github.com/jerairrest/react-chartjs-2/blob/master/example/src/components/bar.js\n  // see https://stackoverflow.com/questions/36676263/chart-js-v2-hiding-grid-lines\n  // see https://github.com/jerairrest/react-chartjs-2\n  legend: {\n    display: false,\n  },\n  maintainAspectRatio: false,\n  scales: {\n    // see https://www.chartjs.org/docs/latest/charts/bar.html\n    xAxes: [\n      {\n        // barPercentage: 1,\n        // categoryPercentage: 1,\n        gridLines: {\n          display: false,\n        },\n      },\n    ],\n    yAxes: [\n      {\n        gridLines: {\n          display: false,\n        },\n      },\n    ],\n  },\n};\n\nfunction blueDatasets(label, data) {\n  return [\n    {\n      label: label || 'Label',\n      backgroundColor: 'rgba(33, 133, 208,0.2)',\n      borderColor: 'rgba(33, 133, 208,1)',\n      borderWidth: 1,\n      // hoverBackgroundColor: 'rgba(255,99,132,0.4)',\n      // hoverBorderColor: 'rgba(255,99,132,1)',\n      data: data || [1, 8, 5, 6, 3],\n    },\n  ];\n}\nexport { barOptions, blueDatasets };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\n\n// ==================================================================\n// Budget\n// ==================================================================\nconst Budget = types\n  .model('Budget', {\n    budgetLimit: '',\n    startDate: '',\n    endDate: '',\n    thresholds: types.array(types.number),\n    notificationEmail: '',\n  })\n  .actions(self => ({\n    setBudget(rawBudget) {\n      self.budgetLimit = rawBudget.budgetLimit;\n      self.startDate = rawBudget.startDate;\n      self.endDate = rawBudget.endDate;\n      self.thresholds = rawBudget.thresholds;\n      self.notificationEmail = rawBudget.notificationEmail;\n    },\n  }))\n\n  // eslint-disable-next-line no-unused-vars\n  .views(self => ({\n    // add view methods here\n  }));\n\n// eslint-disable-next-line import/prefer-default-export\nexport default Budget;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, applySnapshot } from 'mobx-state-tree';\nimport { uiEventBus } from '@aws-ee/base-ui/dist/models/SessionStore';\nimport { storage } from '@aws-ee/base-ui/dist/helpers/utils';\n\nimport { InstanceInfo } from './InstanceInfo';\nimport { getEnvironmentKeypair, getEnvironmentUrl, getEnvironmentPasswordData } from '../../helpers/api';\nimport SageMakerService from '../../helpers/sage-maker-service';\nimport localStorageKeys from '../constants/local-storage-keys';\n\n// ==================================================================\n// Environment\n// ==================================================================\nconst serviceCost = types.model({\n  amount: types.number,\n  unit: types.string,\n});\n\nconst environmentCost = types.model({\n  startDate: types.string,\n  cost: types.map(serviceCost),\n});\n\nconst Environment = types\n  .model('Environment', {\n    id: types.identifier,\n    rev: types.maybe(types.number),\n    description: '',\n    instanceInfo: types.optional(InstanceInfo, {}),\n    name: '',\n    status: '',\n    indexId: '',\n    projectId: '',\n    createdAt: '',\n    createdBy: '',\n    updatedAt: '',\n    updatedBy: '',\n    costs: types.optional(types.array(environmentCost), []),\n    fetchingUrl: types.optional(types.boolean, false),\n    error: types.maybeNull(types.string),\n    isExternal: types.optional(types.boolean, false),\n    stackId: types.maybeNull(types.string),\n    sharedWithUsers: types.optional(types.array(types.string), []),\n  })\n  .actions(self => ({\n    setEnvironment(rawEnvironment) {\n      // Note: if you have partial data vs full data, you need to replace the applySnapshot() with\n      // the appropriate logic\n\n      // Preserve the value of the fetchingUrl\n      const fetchingUrl = self.fetchingUrl;\n      applySnapshot(self, rawEnvironment);\n      self.fetchingUrl = fetchingUrl;\n    },\n\n    async getEnvironmentUrl(user) {\n      if (self.isExternal) {\n        if (!_.isEmpty(storage.getItem(localStorageKeys.pinToken))) {\n          const creds = await user.unencryptedCreds(storage.getItem(localStorageKeys.pinToken));\n          const sm = new SageMakerService(creds.accessKeyId, creds.secretAccessKey, creds.region);\n          return sm.getPresignedNotebookInstanceUrl(self.instanceInfo.NotebookInstanceName);\n        }\n        throw new Error('No PIN to decrypt User credientials');\n      } else {\n        self.setFetchingUrl(true);\n        return getEnvironmentUrl(self.id);\n      }\n    },\n\n    setFetchingUrl(value) {\n      self.fetchingUrl = value;\n    },\n\n    markAsTerminating() {\n      self.status = 'TERMINATING';\n    },\n\n    markAsStopping() {\n      self.status = 'STOPPING';\n    },\n\n    markAsStarting() {\n      self.status = 'STARTING';\n    },\n\n    async getKeyPair() {\n      return getEnvironmentKeypair(self.id, `${self.id}.pem`);\n    },\n\n    async getWindowsPassword() {\n      return Promise.all([self.getKeyPair(), getEnvironmentPasswordData(self.id)]);\n    },\n  }))\n\n  // eslint-disable-next-line no-unused-vars\n  .views(self => ({\n    // add view methods here\n    get isTerminated() {\n      return _.includes(['TERMINATING', 'TERMINATED', 'TERMINATING_FAILED'], this.status);\n    },\n\n    get isCompleted() {\n      return _.includes(['COMPLETED'], this.status);\n    },\n\n    get isStopped() {\n      return _.includes(['STOPPED'], this.status);\n    },\n\n    get isPending() {\n      return _.includes(['PENDING'], this.status);\n    },\n\n    get isError() {\n      return _.includes(['FAILED'], this.status);\n    },\n  }));\n\n// eslint-disable-next-line no-unused-vars\nfunction registerContextItems(appContext) {\n  uiEventBus.listenTo('environmentDeleted', {\n    id: 'Environment',\n    listener: async event => {\n      // event will be the environment object\n      event.markAsTerminating();\n    },\n  });\n  uiEventBus.listenTo('environmentStopping', {\n    id: 'Environment',\n    listener: async event => {\n      // event will be the environment object\n      event.markAsStopping();\n    },\n  });\n  uiEventBus.listenTo('environmentStarting', {\n    id: 'Environment',\n    listener: async event => {\n      // event will be the environment object\n      event.markAsStarting();\n    },\n  });\n}\n\nexport { Environment, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { action, decorate, observable, runInAction } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { Dropdown } from 'semantic-ui-react';\nimport c from 'classnames';\n\nimport Header from './Header';\nimport Description from './Description';\nimport ErrorPointer from './ErrorPointer';\n\n// expected props\n// - field (via props), this is the mobx form field object\n// - options (via props), an array of [ {text, value}, {text, value}, ...]\n// - onChange (via props), (optional) if provided, it will be given (value, field)\n// - className (via props)\n//\n// The following props are to support existing React Semantic UI props:\n// - selection (via props), default to false\n// - fluid (via props), default to false\n// - disabled (via props), default to false\n// - clearable (via props), default to false\n// - multiple (via props), default to false\n// - search (via props), default to false\n// - allowAdditions (via props), default to false\n// - className (via props), default to 'mb4'\n// - additionLabel (via props), default to 'Custom Value:'\nconst DEFAULT_SELECTION = false;\nconst DEFAULT_FLUID = false;\nconst DEFAULT_DISABLED = false;\nconst DEFAULT_CLEARABLE = false;\nconst DEFAULT_MULTIPLE = false;\nconst DEFAULT_SEARCH = false;\nconst DEFAULT_ALLOW_ADDITIONS = false;\nconst DEFAULT_CLASS_NAME = 'mb4';\nconst DEFAULT_ADDITION_LABEL = <i style={{ color: 'red' }}>Custom Value: </i>;\n\nclass DropDown extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.optionsInState = [];\n    });\n  }\n\n  onAddItem = (e, data = {}) => {\n    // Append the item to options that just got added\n    this.optionsInState = _.concat({ text: data.value, value: data.value }, this.optionsInState);\n  };\n\n  render() {\n    const {\n      field,\n      selection,\n      fluid,\n      disabled,\n      clearable,\n      multiple,\n      search,\n      allowAdditions,\n      additionLabel,\n      className,\n      options = [],\n      onChange,\n      dataTestId,\n    } = this.props;\n\n    const { id, value, sync, placeholder, error = '' } = field;\n    const hasError = !_.isEmpty(error); // IMPORTANT do NOT use field.hasError\n\n    const extra = field.extra || {};\n    extra.options = extra.options || [];\n\n    const mergeOptions = _.uniq([...this.optionsInState, ...extra.options, ...options]);\n\n    const isDisabled = field.disabled || disabled;\n    const disabledClass = isDisabled ? 'disabled' : '';\n    const errorClass = hasError ? 'error' : '';\n\n    /**\n     * A utility function to see if the given component attribute is passed as an argument when rendering this component\n     * or specified in the \"extra\" object.\n     * The function returns the attribute value in the following order of precedence\n     * 1. attribute value directly specified at the time of rendering the component (i.e., passed to the component), if the attribute was not passed then\n     * 2. attribute value specified in the \"extra\" object of the given field, if it was not passed in the extra object as well then\n     * 3. default attribute value\n     *\n     * @param attribName The name of the attribute\n     * @param attribValue The attribute value that was passed when rendering the component\n     * @param defaultAttribValue The default attribute value to use\n     * @returns {*}\n     */\n    const getValue = (attribName, attribValue, defaultAttribValue) => {\n      const fromExtra = extra && extra[attribName];\n      // use specified attribValue if it is passed. If not, then try to use attrib value from the \"extra\" object\n      let toUse = _.isNil(attribValue) ? fromExtra : attribValue;\n\n      // if the attrib is neither passed nor in extra then use default value\n      if (_.isNil(toUse)) {\n        toUse = defaultAttribValue;\n      }\n      return toUse;\n    };\n\n    const attrs = {\n      id,\n      value,\n\n      // applicable only when allowAdditions = true\n      onAddItem: this.onAddItem,\n      onChange: (e, data = {}) => {\n        sync(data.value);\n        field.validate({ showErrors: true });\n        if (onChange) onChange(data.value, field);\n      },\n      placeholder,\n      selection: getValue('selection', selection, DEFAULT_SELECTION),\n      clearable: getValue('clearable', clearable, DEFAULT_CLEARABLE),\n      multiple: getValue('multiple', multiple, DEFAULT_MULTIPLE),\n      search: getValue('search', search, DEFAULT_SEARCH),\n      fluid: getValue('fluid', fluid, DEFAULT_FLUID),\n      allowAdditions: getValue('allowAdditions', allowAdditions, DEFAULT_ALLOW_ADDITIONS),\n      disabled: getValue('disabled', disabled, DEFAULT_DISABLED),\n      additionLabel: getValue('additionLabel', additionLabel, DEFAULT_ADDITION_LABEL),\n      error: hasError,\n    };\n\n    return (\n      <div className={c(getValue('className', className, DEFAULT_CLASS_NAME), errorClass, disabledClass)}>\n        <Header field={field} />\n        <Description field={field} />\n        <Dropdown data-testid={dataTestId} className=\"field\" options={mergeOptions} {...attrs} />\n        <ErrorPointer field={field} />\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(DropDown, {\n  optionsInState: observable,\n  onAddItem: action,\n});\n\nexport default observer(DropDown);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types } from 'mobx-state-tree';\nimport { BaseStore } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { consolidateToMap } from '@aws-ee/base-ui/dist/helpers/utils';\n\nimport { EnvironmentConfiguration } from './EnvironmentConfiguration';\n\nconst EnvironmentConfigurationsStore = BaseStore.named('EnvironmentConfigurationsStore')\n  .props({\n    configurations: types.map(EnvironmentConfiguration),\n    heartbeatInterval: -1,\n  })\n  .actions(self => {\n    return {\n      async doLoad() {\n        const environmentConfigurations = await getEnvironmentConfigurations();\n\n        self.runInAction(() => {\n          consolidateToMap(self.configurations, environmentConfigurations, (exiting, newItem) => {\n            exiting.setEnvironmentConfiguration(newItem);\n          });\n        });\n      },\n    };\n  })\n\n  .views(self => ({\n    get empty() {\n      return self.configurations.size === 0;\n    },\n\n    get total() {\n      return self.configurations.size;\n    },\n\n    get list() {\n      const result = [];\n      self.configurations.forEach(configuration => result.push(configuration));\n\n      return _.sortBy(result, ['id']);\n    },\n\n    getConfiguration(id) {\n      return self.configurations.get(id);\n    },\n  }));\n\nasync function getEnvironmentConfigurations() {\n  return [];\n}\n\nfunction registerContextItems(appContext) {\n  appContext.environmentConfigurationsStore = EnvironmentConfigurationsStore.create({}, appContext);\n}\n\nexport { EnvironmentConfigurationsStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable max-classes-per-file */\nimport _ from 'lodash';\n\nclass EventBus {\n  constructor() {\n    this.listenersMap = {};\n  }\n\n  listenTo(channel, { id, listener }) {\n    const entries = this.listenersMap[channel] || [];\n    entries.push({ id, listener });\n\n    this.listenersMap[channel] = entries;\n  }\n\n  async fireEvent(channel, event) {\n    const keys = _.keys(this.listenersMap);\n\n    /* eslint-disable no-restricted-syntax, no-await-in-loop */\n    for (const key of keys) {\n      if (_.startsWith(key, channel)) {\n        const entries = this.listenersMap[key];\n        for (const entry of entries) {\n          await entry.listener(event, { entry, channel });\n        }\n      }\n    }\n  }\n  /* eslint-enable no-restricted-syntax, no-await-in-loop */\n  // TODO stopListening(id, channel) { }\n}\n\nconst uiEventBus = new EventBus();\n\n// A simple key/value store that only exists while the browser tab is open.\n// You can choose to store your component ui states in here when applicable.\nclass SessionStore {\n  constructor() {\n    this.map = new Map();\n  }\n\n  cleanup() {\n    this.map.clear();\n  }\n\n  // remove all keys that start with the prefix\n  removeStartsWith(prefix) {\n    // map api https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map\n    // for of https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of\n    const keys = this.map.keys();\n    /* eslint-disable no-restricted-syntax */\n    for (const key of keys) {\n      if (_.startsWith(key, prefix)) {\n        this.map.delete(key);\n      }\n    }\n    /* eslint-enable no-restricted-syntax */\n  }\n\n  get(key) {\n    return this.map.get(key);\n  }\n\n  set(key, value) {\n    this.map.set(key, value);\n  }\n}\n\nconst sessionStore = new SessionStore();\n\nfunction registerContextItems(appContext) {\n  appContext.sessionStore = sessionStore;\n  appContext.uiEventBus = uiEventBus;\n}\n\nexport { sessionStore, uiEventBus, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { EnvironmentConfigurationsStore } from '../models/environments/EnvironmentConfigurationsStore';\n\nconst getEstimatedCost = async (env, numberOfDaysToGetCostInfo) => {\n  const envConfig = EnvironmentConfigurationsStore.create();\n  await envConfig.load();\n  const allEnvConfigs = envConfig.list;\n  const config = _.find(allEnvConfigs, conf => {\n    // Hail EMR has spot pricing and on demand price. o we need to pick the correct EMR env config\n    if (env.instanceInfo.type === 'emr') {\n      if (env.instanceInfo.config.spotBidPrice) {\n        return (\n          conf.type === env.instanceInfo.type && conf.size === env.instanceInfo.size && conf.label.includes('Spot')\n        );\n      }\n      return (\n        conf.type === env.instanceInfo.type && conf.size === env.instanceInfo.size && conf.label.includes('On Demand')\n      );\n    }\n    return conf.type === env.instanceInfo.type && conf.size === env.instanceInfo.size;\n  });\n  const cost = {};\n  cost[config.type] = {\n    amount: config.totalPrice,\n    unit: 'USD',\n  };\n\n  const allCost = [];\n  for (let i = numberOfDaysToGetCostInfo; i > 0; i--) {\n    const day = new Date(Date.now() - i * 24 * 60 * 60 * 1000).toISOString().split('T')[0];\n    const costForDay = {\n      startDate: day,\n      cost,\n    };\n    allCost.push(costForDay);\n  }\n  return allCost;\n};\n\n// eslint-disable-next-line import/prefer-default-export\nexport { getEstimatedCost };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nconst _ = require('lodash');\nconst aws = require('aws-sdk');\n\nconst STACK_FAIL = [\n  'CREATE_FAILED',\n  'ROLLBACK_FAILED',\n  'DELETE_FAILED',\n  'UPDATE_ROLLBACK_FAILED',\n  'ROLLBACK_COMPLETE',\n  'UPDATE_ROLLBACK_COMPLETE',\n];\nconst STACK_SUCCESS = ['CREATE_COMPLETE', 'DELETE_COMPLETE', 'UPDATE_COMPLETE'];\n\nexport default class CfnService {\n  constructor(accessKeyId, secretAccessKey, region = 'us-east-1') {\n    if (accessKeyId) {\n      this.cfn = new aws.CloudFormation({\n        accessKeyId,\n        secretAccessKey,\n        region,\n        sslEnabled: true,\n      });\n    } else {\n      this.cfn = new aws.CloudFormation({\n        sslEnabled: true,\n      });\n    }\n  }\n\n  isDone(status) {\n    return STACK_FAIL.includes(status) || STACK_SUCCESS.includes(status);\n  }\n\n  static async validateCredentials(accessKeyId, secretAccessKey) {\n    const sts = new aws.STS({\n      accessKeyId,\n      secretAccessKey,\n      sslEnabled: true,\n    });\n\n    return sts.getCallerIdentity().promise();\n  }\n\n  async describeStack(stackName) {\n    const params = { StackName: stackName };\n\n    try {\n      const response = await this.cfn.describeStacks(params).promise();\n      const stack = _.get(response, 'Stacks[0]');\n      const status = _.get(stack, 'StackStatus', 'Unknown');\n      const statusReason = _.get(stack, 'StackStatusReason', 'Unknown');\n      const outputs = _.get(stack, 'Outputs', []);\n      const outputsNormalized = _.map(outputs, item => ({\n        key: item.OutputKey,\n        value: item.OutputValue,\n        description: item.Description,\n        exportName: item.ExportName,\n      }));\n\n      return {\n        status,\n        statusReason,\n        isDone: this.isDone(status),\n        isFailed: STACK_FAIL.includes(status),\n        outputs: outputsNormalized,\n      };\n    } catch (e) {\n      throw new Error(`${e.code}: ${e.message}`);\n    }\n  }\n\n  async createStack(stackName, cfnParams, templateUrl, description = '') {\n    const input = {\n      StackName: stackName,\n      Parameters: cfnParams,\n      Capabilities: ['CAPABILITY_IAM', 'CAPABILITY_NAMED_IAM'],\n      TemplateURL: templateUrl,\n      Tags: [\n        {\n          Key: 'Description',\n          Value: description,\n        },\n      ],\n    };\n\n    return this.cfn.createStack(input).promise();\n  }\n\n  async deleteStack(stackName) {\n    const input = {\n      StackName: stackName,\n    };\n\n    const response = await this.cfn.deleteStack(input).promise();\n\n    return response;\n  }\n}\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { decorate, observable, computed } from 'mobx';\n\nimport { isStoreLoading, isStoreReady, isStoreError } from './BaseStore';\nimport { swallowError } from '../helpers/utils';\n\n// A way to load multiple stores and get the errors, etc.\nclass Stores {\n  constructor(stores = []) {\n    const result = [];\n    _.forEach(stores, store => {\n      if (_.isEmpty(store) || _.isNil(store)) return;\n      result.push(store);\n    });\n\n    this.stores = result;\n  }\n\n  // only if they are not loaded already, you can force loading if you want\n  async load({ forceLoad = false } = {}) {\n    _.forEach(this.stores, store => {\n      if (!forceLoad && isStoreReady(store)) return;\n      swallowError(store.load());\n    });\n  }\n\n  get ready() {\n    let answer = true;\n    _.forEach(this.stores, store => {\n      answer = answer && isStoreReady(store);\n    });\n    return answer;\n  }\n\n  get loading() {\n    let answer = false;\n    _.forEach(this.stores, store => {\n      if (isStoreLoading(store)) {\n        answer = true;\n        return false; // to stop the loop\n      }\n      return undefined;\n    });\n\n    return answer;\n  }\n\n  get hasError() {\n    return !!this.error;\n  }\n\n  get error() {\n    let error;\n    _.forEach(this.stores, store => {\n      if (isStoreError(store)) {\n        error = store.error;\n        return false; // to stop the loop\n      }\n      return undefined;\n    });\n\n    return error;\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(Stores, {\n  stores: observable,\n  ready: computed,\n  loading: computed,\n  hasError: computed,\n  error: computed,\n});\n\nexport default Stores;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { createForm } from '../../helpers/form';\n\nconst addProjectFormFields = {\n  id: {\n    label: 'Project Name',\n    placeholder: 'Type name for this project',\n    rules: 'required|string|between:1,300',\n  },\n  indexId: {\n    label: 'Index ID',\n    rules: 'required|string',\n  },\n  description: {\n    label: 'Description',\n    placeholder: 'Type description for this project',\n    rules: 'string|between:1,3000',\n  },\n  projectAdmins: {\n    label: 'Project Admins',\n    placeholder: 'Users who automatically have full control of workspaces associated with this project',\n    explain: ' ',\n    rules: 'array',\n  },\n};\n\nfunction getAddProjectFormFields() {\n  return addProjectFormFields;\n}\n\nfunction getAddProjectForm() {\n  return createForm(addProjectFormFields);\n}\n\nexport { getAddProjectFormFields, getAddProjectForm };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { Step, Icon } from 'semantic-ui-react';\n\n// expected props\n// currentStep an instance of the CurrentStep model\nconst Component = observer(({ currentStep = {}, envTypeImmutable = false }) => {\n  let activeIndex;\n  const step = currentStep.step;\n\n  switch (step) {\n    case 'selectComputePlatform':\n    case 'selectEnvType':\n      activeIndex = 1;\n      break;\n    case 'selectComputeConfiguration':\n    case 'selectEnvConfig':\n      activeIndex = 2;\n      break;\n    default:\n      activeIndex = 0;\n  }\n\n  return (\n    <Step.Group widths={3}>\n      <Step active={activeIndex === 0} disabled={activeIndex < 0}>\n        <Icon name=\"search\" color=\"blue\" />\n        <Step.Content>\n          <Step.Title>Find &amp; Select Studies</Step.Title>\n          <Step.Description>Select the desired studies</Step.Description>\n        </Step.Content>\n      </Step>\n      {!envTypeImmutable && (\n        <Step active={activeIndex === 1} disabled={activeIndex < 1}>\n          <Icon name=\"server\" />\n          <Step.Content>\n            <Step.Title>Select Compute</Step.Title>\n            <Step.Description>Select a compute platform</Step.Description>\n          </Step.Content>\n        </Step>\n      )}\n      <Step active={activeIndex === 2} disabled={activeIndex < 2}>\n        <Icon name=\"hdd outline\" />\n        <Step.Content>\n          <Step.Title>Create Workspace</Step.Title>\n          <Step.Description>Create the workspace</Step.Description>\n        </Step.Content>\n      </Step>\n    </Step.Group>\n  );\n});\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable import/prefer-default-export */\nimport { types } from 'mobx-state-tree';\n\n// ==================================================================\n// CurrentStep\n// ==================================================================\nconst CurrentStep = types\n  .model('CurrentStep', {\n    step: '',\n  })\n\n  .actions(self => ({\n    setStep(step) {\n      self.step = step;\n    },\n  }));\n\nexport { CurrentStep };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { decorate, computed, runInAction, observable, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { Icon, Header, Segment, Button } from 'semantic-ui-react';\nimport { isStoreLoading, isStoreError, isStoreEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\n\nimport UserOnboarding from '../users/UserOnboarding';\nimport SelectComputePlatformStep from './SelectComputePlatformStep';\nimport ConfigureComputePlatformStep from './ConfigureComputePlatformStep';\n\n// expected props\n// - onPrevious (via props)\n// - onCompleted (via props) a function is called after a call to create an environment is performed\n// - studyIds (via props) (optional) an array of the selected study ids\n// - currentStep (via props) an instance of the CurrentStep model\n// - computePlatformsStore (via injection)\n// - clientInformationStore (via injection)\nclass ComputePlatformSetup extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.selectedPlatformId = undefined;\n      this.onboardingOpen = false;\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n    swallowError(this.computePlatformsStore.load());\n  }\n\n  get userStore() {\n    return this.props.userStore;\n  }\n\n  get computePlatformsStore() {\n    return this.props.computePlatformsStore;\n  }\n\n  get clientInformationStore() {\n    return this.props.clientInformationStore;\n  }\n\n  get currentStep() {\n    return this.props.currentStep;\n  }\n\n  setOnboarding = value => {\n    this.onboardingOpen = value;\n  };\n\n  handleConfigureCredentials = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.setOnboarding(true);\n  };\n\n  handleSelectComputePlatform = async platformId => {\n    this.selectedPlatformId = platformId;\n    const platformsStore = this.computePlatformsStore;\n    if (!platformsStore) return;\n\n    // We start the loading of the configurations for the selected platform\n    const platformStore = platformsStore.getComputePlatformStore(platformId);\n    await platformStore.load();\n\n    // We also try to figure out the ip address and if there is an error,\n    // then that is okay, we show an empty string for the cidr field\n    const clientInformationStore = this.clientInformationStore;\n    try {\n      await clientInformationStore.load();\n    } catch (error) {\n      // ignore intentionally\n    }\n\n    window.scrollTo(0, 0);\n    runInAction(() => {\n      this.currentStep.setStep('selectComputeConfiguration');\n    });\n  };\n\n  handlePrevious = () => {\n    const currentStep = this.currentStep;\n    if (currentStep.step === 'selectComputePlatform') {\n      this.props.onPrevious();\n      return;\n    }\n\n    this.currentStep.setStep('selectComputePlatform');\n  };\n\n  handleCompleted = async environment => {\n    return this.props.onCompleted(environment);\n  };\n\n  get studyIds() {\n    return this.props.studyIds;\n  }\n\n  render() {\n    const store = this.computePlatformsStore;\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = this.renderLoadingError();\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder className=\"mt2\" />;\n    } else if (isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else {\n      content = this.renderContent();\n    }\n\n    return (\n      <>\n        {content} {this.onboardingOpen && <UserOnboarding onclose={() => this.setOnboarding(false)} />}\n      </>\n    );\n  }\n\n  renderContent() {\n    const step = this.currentStep.step;\n    const platformId = this.selectedPlatformId;\n    const studyIds = this.studyIds;\n    const user = this.userStore.user;\n    const hasProjects = user.hasProjects;\n    const isExternalResearcher = user.isExternalResearcher;\n    const canCreateWorkspace = user.capabilities.canCreateWorkspace;\n    const hasCredentials = user.hasCredentials;\n    let content = null;\n\n    if (!canCreateWorkspace) {\n      return this.renderEmpty();\n    }\n\n    if (!isExternalResearcher && !hasProjects) {\n      return this.renderMissingProjects();\n    }\n\n    // Check if external and no credentials\n    if (isExternalResearcher && !hasCredentials) {\n      return this.renderMissingCredentials();\n    }\n\n    if (step === 'selectComputePlatform') {\n      content = (\n        <SelectComputePlatformStep onPrevious={this.handlePrevious} onNext={this.handleSelectComputePlatform} />\n      );\n    } else if (step === 'selectComputeConfiguration') {\n      content = (\n        <ConfigureComputePlatformStep\n          platformId={platformId}\n          studyIds={studyIds}\n          onPrevious={this.handlePrevious}\n          onCompleted={this.handleCompleted}\n        />\n      );\n    }\n\n    return content;\n  }\n\n  renderLoadingError() {\n    const store = this.computePlatformsStore;\n    return (\n      <>\n        <ErrorBox error={store.error} className=\"p0 mt2 mb3\" />\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <>\n        <Segment placeholder className=\"mt2\">\n          <Header icon className=\"color-grey\">\n            <Icon name=\"server\" />\n            No compute platform\n            <Header.Subheader>\n              There are no compute platform to choose from. Your role might be restricted. Please contact your\n              administrator.\n            </Header.Subheader>\n          </Header>\n        </Segment>\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderMissingProjects() {\n    return (\n      <>\n        <Segment placeholder className=\"mt2\">\n          <Header icon className=\"color-grey\">\n            <Icon name=\"lock\" />\n            Missing association with projects\n            <Header.Subheader>\n              You currently do not have permissions to use any projects for the workspace. please contact your\n              administrator.\n            </Header.Subheader>\n          </Header>\n        </Segment>\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderMissingCredentials() {\n    return (\n      <>\n        <Segment placeholder className=\"mt2\">\n          <Header icon className=\"color-grey\">\n            <Icon name=\"key\" />\n            No AWS credentials\n            <Header.Subheader>To manage research workspaces, click Configure AWS Credentials.</Header.Subheader>\n          </Header>\n          <div>\n            <Button\n              color=\"orange\"\n              size=\"medium\"\n              basic\n              onClick={this.handleConfigureCredentials}\n              style={{ maxWidth: '100%' }}\n            >\n              Configure AWS Credentials\n            </Button>\n          </div>\n        </Segment>\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderButtons() {\n    return (\n      <div className=\"mt3\">\n        <Button\n          floated=\"right\"\n          icon=\"right arrow\"\n          labelPosition=\"right\"\n          className=\"ml2\"\n          primary\n          content=\"Next\"\n          disabled\n        />\n        <Button\n          floated=\"right\"\n          icon=\"left arrow\"\n          labelPosition=\"left\"\n          className=\"ml2\"\n          content=\"Previous\"\n          onClick={this.handlePrevious}\n        />\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ComputePlatformSetup, {\n  handleSelectComputePlatform: action,\n  handlePrevious: action,\n  handleCompleted: action,\n  setOnboarding: action,\n  studyIds: computed,\n  userStore: computed,\n  computePlatformsStore: computed,\n  clientInformationStore: computed,\n  currentStep: computed,\n  selectedPlatformId: observable,\n  onboardingOpen: observable,\n});\n\nexport default inject('userStore', 'computePlatformsStore', 'clientInformationStore')(observer(ComputePlatformSetup));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { Card, Radio, Divider, Table } from 'semantic-ui-react';\nimport c from 'classnames';\nimport Header from '@aws-ee/base-ui/dist/parts/helpers/fields/Header';\nimport Description from '@aws-ee/base-ui/dist/parts/helpers/fields/Description';\nimport ErrorPointer from '@aws-ee/base-ui/dist/parts/helpers/fields/ErrorPointer';\nimport { nicePrice } from '@aws-ee/base-ui/dist/helpers/utils';\n\n// expected props\n// - configurations (via props) and array of the compute configurations MST\n// - formField (via props) an instance of the mobx form field\nclass SelectConfigurationCards extends React.Component {\n  get configurations() {\n    return this.props.configurations;\n  }\n\n  get configurationId() {\n    return this.formField.value;\n  }\n\n  get formField() {\n    return this.props.formField;\n  }\n\n  handleSelectConfigurationId = configId => {\n    this.formField.sync(configId);\n    this.formField.resetValidation();\n  };\n\n  render() {\n    const field = this.formField;\n    const { error = '' } = field;\n    const hasError = !_.isEmpty(error); // IMPORTANT do NOT use field.hasError\n    const isDisabled = field.disabled;\n    const disabledClass = isDisabled ? 'disabled' : '';\n    const errorClass = hasError ? 'error' : '';\n\n    return (\n      <div className={c('mb4', errorClass, disabledClass)}>\n        <Header field={field} />\n        <Description field={field} />\n        <ErrorPointer field={field} className=\"mb1\" />\n        {this.renderCards()}\n      </div>\n    );\n  }\n\n  renderCards() {\n    const disabled = this.formField.disabled;\n    const configurations = this.configurations;\n    const isSelected = config => config.id === this.configurationId;\n    const getAttrs = config => {\n      const attrs = {};\n      if (isSelected(config)) attrs.color = 'blue';\n      if (!disabled) attrs.onClick = () => this.handleSelectConfigurationId(config.id);\n\n      return attrs;\n    };\n\n    return (\n      <Card.Group stackable itemsPerRow={3} className=\"mt1\">\n        {_.map(configurations, config => (\n          <Card key={config.id} className={c('mb3', { 'cursor-pointer': !disabled })} {...getAttrs(config)}>\n            <Card.Content>\n              <Card.Header>\n                <Radio className=\"mr2\" checked={isSelected(config)} disabled={disabled} />\n                {config.title}\n                <Divider />\n              </Card.Header>\n              <Card.Description>\n                <div className=\"pr1 pl1 pb1\">\n                  {/* Yes, we are doing dangerouslySetInnerHTML, the content was already sanitized by showdownjs */}\n                  {/* eslint-disable-next-line react/no-danger */}\n                  <div dangerouslySetInnerHTML={{ __html: config.descHtml }} />\n                </div>\n              </Card.Description>\n            </Card.Content>\n            <Card.Content extra>{this.renderTableInfo(config)}</Card.Content>\n          </Card>\n        ))}\n      </Card.Group>\n    );\n  }\n\n  renderTableInfo(config) {\n    const priceTitle = item => {\n      const isSpot = _.get(item, 'priceInfo.type') === 'spot';\n      return isSpot ? 'Maximum price per day' : 'Price per day';\n    };\n    const region = item => _.get(item, 'priceInfo.region');\n    const price = item => {\n      const perDay = item.pricePerDay;\n      if (_.isUndefined(perDay) || (_.isString(perDay) && _.isEmpty(perDay))) return 'N/A';\n      return `$${nicePrice(perDay)}`;\n    };\n\n    return (\n      <Table basic=\"very\" size=\"small\">\n        <Table.Body>\n          {_.map(config.displayProps).map((property, propertyIndex) => {\n            return (\n              // eslint-disable-next-line react/no-array-index-key\n              <Table.Row key={propertyIndex} textAlign=\"center\">\n                <Table.Cell>{property.key}</Table.Cell>\n                <Table.Cell>{property.value}</Table.Cell>\n              </Table.Row>\n            );\n          })}\n          <Table.Row textAlign=\"center\">\n            <Table.Cell>\n              {priceTitle(config)}\n              <div className=\"color-grey fs-9\">{region(config)}</div>\n            </Table.Cell>\n            <Table.Cell verticalAlign=\"top\">{price(config)}</Table.Cell>\n          </Table.Row>\n        </Table.Body>\n      </Table>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(SelectConfigurationCards, {\n  configurations: computed,\n  configurationId: computed,\n  formField: computed,\n  handleSelectConfigurationId: action,\n});\n\nexport default inject()(observer(SelectConfigurationCards));\n","import React from 'react';\nimport { decorate, computed, runInAction, observable, action } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Icon, Header, Segment, Button } from 'semantic-ui-react';\nimport { isStoreLoading, isStoreError, isStoreEmpty } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\n\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport UserOnboarding from '../../users/UserOnboarding';\nimport SelectEnvTypeStep from './SelectEnvTypeStep';\nimport ConfigureEnvTypeStep from './ConfigureEnvTypeStep';\n\n// expected props\n// - onPrevious (via props)\n// - onCompleted (via props) a function is called after a call to create an environment is performed\n// - studyIds (via props) (optional) an array of the selected study ids\n// - envTypeId (via props) (optional) id of the env type\n// - envTypeImmutable (via props) (optional) flag indicating if env type is immutable and env type selection should be disallowed\n// - currentStep (via props) an instance of the CurrentStep model\n// - envTypesStore (via injection)\n// - clientInformationStore (via injection)\nclass ScEnvironmentSetup extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.stores = new Stores([this.envTypesStore, this.clientInformationStore]);\n      this.selectedTypeId = props.envTypeId;\n    });\n  }\n\n  componentDidMount() {\n    window.scrollTo(0, 0);\n    swallowError(this.stores.load());\n  }\n\n  get userStore() {\n    return this.props.userStore;\n  }\n\n  get envTypesStore() {\n    return this.props.envTypesStore;\n  }\n\n  get clientInformationStore() {\n    return this.props.clientInformationStore;\n  }\n\n  get currentStep() {\n    return this.props.currentStep;\n  }\n\n  setOnboarding = value => {\n    this.onboardingOpen = value;\n  };\n\n  handleConfigureCredentials = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    this.setOnboarding(true);\n  };\n\n  handleSelectEnvType = async envTypeId => {\n    this.selectedTypeId = envTypeId;\n    const envTypesStore = this.envTypesStore;\n    if (!envTypesStore) return;\n\n    // We start the loading of the configurations for the selected type\n    const configurationStore = this.envTypesStore.getEnvTypeConfigsStore(envTypeId);\n    await configurationStore.load();\n\n    window.scrollTo(0, 0);\n    runInAction(() => {\n      this.currentStep.setStep('selectEnvConfig');\n    });\n  };\n\n  goto(pathname) {\n    const goto = gotoFn(this);\n    goto(pathname);\n  }\n\n  handlePrevious = () => {\n    const currentStep = this.currentStep;\n    if (currentStep.step === 'selectEnvType' || this.props.envTypeImmutable) {\n      this.props.onPrevious();\n    } else {\n      this.currentStep.setStep('selectEnvType');\n    }\n  };\n\n  handleCompleted = async environment => {\n    return this.props.onCompleted(environment);\n  };\n\n  get studyIds() {\n    return this.props.studyIds;\n  }\n\n  render() {\n    const store = this.envTypesStore;\n    let content = null;\n\n    if (isStoreError(store)) {\n      content = this.renderLoadingError();\n    } else if (isStoreLoading(store)) {\n      content = <BasicProgressPlaceholder className=\"mt2\" />;\n    } else if (isStoreEmpty(store)) {\n      content = this.renderEmpty();\n    } else {\n      content = this.renderContent();\n    }\n\n    return (\n      <>\n        {content} {this.onboardingOpen && <UserOnboarding onclose={() => this.setOnboarding(false)} />}\n      </>\n    );\n  }\n\n  renderContent() {\n    const step = this.currentStep.step;\n    const typeId = this.selectedTypeId;\n    const studyIds = this.studyIds;\n    const user = this.userStore.user;\n    const hasProjects = user.hasProjects;\n    const isExternalResearcher = user.isExternalResearcher;\n    const canCreateWorkspace = user.capabilities.canCreateWorkspace;\n    const hasCredentials = user.hasCredentials;\n    let content = null;\n\n    if (!canCreateWorkspace) {\n      return this.renderEmpty();\n    }\n\n    if (!isExternalResearcher && !hasProjects) {\n      return this.renderMissingProjects();\n    }\n\n    // Check if external and no credentials\n    // TODO - service catalog (sc) workspaces don't support external researchers\n    if (isExternalResearcher && !hasCredentials) {\n      return this.renderMissingCredentials();\n    }\n\n    if (step === 'selectEnvType') {\n      content = <SelectEnvTypeStep onPrevious={this.handlePrevious} onNext={this.handleSelectEnvType} />;\n    } else if (step === 'selectEnvConfig') {\n      content = (\n        <ConfigureEnvTypeStep\n          envTypeId={typeId}\n          studyIds={studyIds}\n          onPrevious={this.handlePrevious}\n          onCompleted={this.handleCompleted}\n        />\n      );\n    }\n\n    return content;\n  }\n\n  renderLoadingError() {\n    const store = this.envTypesStore;\n    return (\n      <>\n        <ErrorBox error={store.error} className=\"p0 mt2 mb3\" />\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderEmpty() {\n    return (\n      <>\n        <Segment placeholder className=\"mt2\">\n          <Header icon className=\"color-grey\">\n            <Icon name=\"server\" />\n            No workspace types\n            <Header.Subheader>\n              There are no workspace types to choose from. Your role might be restricted. Please contact your\n              administrator.\n            </Header.Subheader>\n          </Header>\n        </Segment>\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderMissingProjects() {\n    return (\n      <>\n        <Segment placeholder className=\"mt2\">\n          <Header icon className=\"color-grey\">\n            <Icon name=\"lock\" />\n            Missing association with projects\n            <Header.Subheader>\n              You currently do not have permissions to use any projects for the workspace. please contact your\n              administrator.\n            </Header.Subheader>\n          </Header>\n        </Segment>\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderMissingCredentials() {\n    // IMPORTANT: service catalog workspaces do not support external researchers. This code\n    // is here to help make a decision if we keep it or remove it.\n    return (\n      <>\n        <Segment placeholder className=\"mt2\">\n          <Header icon className=\"color-grey\">\n            <Icon name=\"key\" />\n            No AWS credentials\n            <Header.Subheader>To manage research workspaces, click Configure AWS Credentials.</Header.Subheader>\n          </Header>\n          <div>\n            <Button\n              color=\"orange\"\n              size=\"medium\"\n              basic\n              onClick={this.handleConfigureCredentials}\n              style={{ maxWidth: '100%' }}\n            >\n              Configure AWS Credentials\n            </Button>\n          </div>\n        </Segment>\n        {this.renderButtons()}\n      </>\n    );\n  }\n\n  renderButtons() {\n    return (\n      <div className=\"mt3\">\n        <Button\n          floated=\"right\"\n          icon=\"right arrow\"\n          labelPosition=\"right\"\n          className=\"ml2\"\n          primary\n          content=\"Next\"\n          disabled\n        />\n        <Button\n          floated=\"right\"\n          icon=\"left arrow\"\n          labelPosition=\"left\"\n          className=\"ml2\"\n          content=\"Previous\"\n          onClick={this.handlePrevious}\n        />\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentSetup, {\n  handleSelectEnvType: action,\n  handlePrevious: action,\n  handleCompleted: action,\n  setOnboarding: action,\n  studyIds: computed,\n  userStore: computed,\n  envTypesStore: computed,\n  clientInformationStore: computed,\n  currentStep: computed,\n  selectedTypeId: observable,\n  onboardingOpen: observable,\n});\n\nexport default inject('userStore', 'envTypesStore', 'clientInformationStore')(withRouter(observer(ScEnvironmentSetup)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { Icon, Label } from 'semantic-ui-react';\nimport { observer } from 'mobx-react';\n\nclass EnvironmentStatusIcon extends React.Component {\n  getEnvironment() {\n    return this.props.environment;\n  }\n\n  render() {\n    const status = this.getEnvironment().status;\n    if (status === 'COMPLETED') {\n      return (\n        <Label basic size=\"mini\" color=\"green\">\n          Ready\n        </Label>\n      );\n    }\n    if (status === 'TERMINATED') {\n      return (\n        <Label basic size=\"mini\" color=\"red\">\n          Terminated\n        </Label>\n      );\n    }\n    if (status === 'FAILED' || status.endsWith('FAILED')) {\n      return (\n        <Label basic size=\"mini\" color=\"red\">\n          Error\n        </Label>\n      );\n    }\n    if (status === 'TERMINATING_FAILED') {\n      return (\n        <Label basic size=\"mini\" color=\"red\">\n          Failed to terminate\n        </Label>\n      );\n    }\n    if (status === 'TERMINATING') {\n      return (\n        <div>\n          <Label basic size=\"mini\">\n            Terminating\n            <Icon loading name=\"spinner\" size=\"large\" color=\"red\" className=\"ml1 mr1\" />\n          </Label>\n        </div>\n      );\n    }\n    if (status === 'STOPPING') {\n      return (\n        <div>\n          <Label basic size=\"mini\">\n            Stopping\n            <Icon loading name=\"spinner\" size=\"large\" color=\"red\" className=\"ml1 mr1\" />\n          </Label>\n        </div>\n      );\n    }\n    if (status === 'STOPPED') {\n      return (\n        <Label basic size=\"mini\" color=\"orange\">\n          Stopped\n        </Label>\n      );\n    }\n    if (status === 'STARTING') {\n      return (\n        <Label basic size=\"mini\">\n          Starting\n          <Icon loading name=\"spinner\" size=\"large\" color=\"yellow\" className=\"ml1 mr1\" />\n        </Label>\n      );\n    }\n    if (status === 'PENDING') {\n      return (\n        <Label basic size=\"mini\">\n          Pending\n          <Icon loading name=\"spinner\" size=\"large\" color=\"yellow\" className=\"ml1 mr1\" />\n        </Label>\n      );\n    }\n\n    // unknown state - should have returned\n    return (\n      <Label basic size=\"mini\">\n        Unknown State\n        <Icon loading name=\"spinner\" size=\"large\" color=\"red\" className=\"ml1 mr1\" />\n      </Label>\n    );\n  }\n}\n\nexport default observer(EnvironmentStatusIcon);\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { observer, inject } from 'mobx-react';\nimport { action, computed, decorate } from 'mobx';\n\nclass EnvironmentConnectButton extends React.Component {\n  getUrl = async environment => {\n    const { AuthorizedUrl } = await environment.getEnvironmentUrl(this.user);\n    return AuthorizedUrl;\n  };\n\n  handleConnectClick = async event => {\n    event.preventDefault();\n    event.stopPropagation();\n    const newTab = window.open('about:blank', '_blank');\n\n    const environment = this.props.environment;\n\n    const url = await this.getUrl(environment);\n    // Change to the notebook\n    newTab.location = url;\n    environment.setFetchingUrl(false);\n  };\n\n  render() {\n    const { as: As, userStore, user, environment, ...props } = this.props;\n    return <As onClick={this.handleConnectClick} {...props} />;\n  }\n\n  get user() {\n    return this.props.user || this.props.userStore.user;\n  }\n}\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(EnvironmentConnectButton, {\n  user: computed,\n  handleConnectClick: action,\n  getUrl: action,\n});\n\nexport default inject('userStore')(observer(EnvironmentConnectButton));\n","import React from 'react';\nimport { decorate, computed, action, observable, runInAction } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Button, Modal } from 'semantic-ui-react';\n\nimport { gotoFn } from '@aws-ee/base-ui/dist/helpers/routing';\nimport { displayError } from '@aws-ee/base-ui/dist/helpers/notification';\n\nimport ScEnvironmentConnections from './ScEnvironmentConnections';\n\n// expected props\n// - scEnvironment (via prop)\n// - showDetailButton (via prop)\n// - scEnvironmentsStore (via injection)\nclass ScEnvironmentButtons extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      // A flag to indicate if we are processing the call to trigger the terminate action\n      this.processing = false;\n      // A flag to indicate if the connections button is active\n      this.connectionsButtonActive = false;\n    });\n  }\n\n  get environment() {\n    return this.props.scEnvironment;\n  }\n\n  get envsStore() {\n    return this.props.scEnvironmentsStore;\n  }\n\n  handleViewDetail = () => {\n    const goto = gotoFn(this);\n    goto(`/workspaces/id/${this.environment.id}`);\n  };\n\n  handleTerminate = async () => {\n    await this.handleAction(async () => {\n      const store = this.envsStore;\n      await store.terminateScEnvironment(this.environment.id);\n    });\n  };\n\n  handleStop = async () => {\n    await this.handleAction(async () => {\n      const store = this.envsStore;\n      await store.stopScEnvironment(this.environment.id);\n    });\n  };\n\n  handleStart = async () => {\n    await this.handleAction(async () => {\n      const store = this.envsStore;\n      await store.startScEnvironment(this.environment.id);\n    });\n  };\n\n  canChangeState() {\n    return this.envsStore.canChangeState(this.environment.id);\n  }\n\n  handleAction = async fn => {\n    this.processing = true;\n    try {\n      await fn();\n    } catch (error) {\n      displayError(error);\n    } finally {\n      runInAction(() => {\n        this.processing = false;\n      });\n    }\n  };\n\n  handleToggle = () => {\n    this.connectionsButtonActive = !this.connectionsButtonActive;\n  };\n\n  render() {\n    const env = this.environment;\n    const state = env.state;\n    const processing = this.processing;\n    const showDetailButton = this.props.showDetailButton;\n    const connectionsButtonActive = this.connectionsButtonActive;\n    const canConnect = state.canConnect;\n    const canStart = state.canStart && this.canChangeState();\n    const canStop = state.canStop && this.canChangeState();\n\n    return (\n      <>\n        <div className=\"clearfix\" style={{ minHeight: '42px' }}>\n          {state.canTerminate && (\n            <Modal\n              trigger={\n                <Button\n                  data-testid=\"sc-env-terminate\"\n                  floated=\"right\"\n                  basic\n                  color=\"red\"\n                  size=\"mini\"\n                  className=\"mt1 mb1\"\n                  loading={processing}\n                >\n                  Terminate\n                </Button>\n              }\n              header=\"Are you sure?\"\n              content=\"This action can not be reverted.\"\n              actions={[\n                'Cancel',\n                { key: 'terminate', content: 'Terminate', negative: true, onClick: this.handleTerminate },\n              ]}\n              size=\"mini\"\n            />\n          )}\n          {canStart && (\n            <Button\n              data-testid=\"sc-env-start\"\n              floated=\"right\"\n              basic\n              color=\"green\"\n              size=\"mini\"\n              className=\"mt1 mb1 ml2\"\n              onClick={this.handleStart}\n              loading={processing}\n            >\n              Start\n            </Button>\n          )}\n          {canStop && (\n            <Button\n              data-testid=\"sc-env-stop\"\n              floated=\"right\"\n              basic\n              color=\"green\"\n              size=\"mini\"\n              className=\"mt1 mb1 ml2\"\n              onClick={this.handleStop}\n              loading={processing}\n            >\n              Stop\n            </Button>\n          )}\n\n          {canConnect && (\n            <Button\n              floated=\"left\"\n              basic\n              size=\"mini\"\n              className=\"mt1 mb1\"\n              toggle\n              active={connectionsButtonActive}\n              onClick={this.handleToggle}\n            >\n              Connections\n            </Button>\n          )}\n          {showDetailButton && (\n            <Button floated=\"left\" basic size=\"mini\" className=\"mt1 mb1 ml2\" onClick={this.handleViewDetail}>\n              View Detail\n            </Button>\n          )}\n        </div>\n        {canConnect && connectionsButtonActive && <ScEnvironmentConnections scEnvironment={env} />}\n      </>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentButtons, {\n  envsStore: computed,\n  environment: computed,\n  processing: observable,\n  connectionsButtonActive: observable,\n  handleViewDetail: action,\n  handleAction: action,\n  handleToggle: action,\n});\n\nexport default inject('scEnvironmentsStore')(withRouter(observer(ScEnvironmentButtons)));\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport c from 'classnames';\nimport { CopyToClipboard } from 'react-copy-to-clipboard';\nimport { Popup, Icon } from 'semantic-ui-react';\nimport { displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\n\n// expected props\n// - text (via props)\n// - message (via props) (a message to display when done copying to clip board \"optional\")\n// - size (via props) (the size of the copy icon)\n// - icon (via props) (the name of the icon, default to 'copy outline')\n// - className (via props)\nconst Component = observer(\n  ({ text = '', className = 'ml2 mt1', message = 'Copied to clipboard', size, name = 'copy outline' }) => {\n    const iconAttrs = { name };\n    if (size) iconAttrs.size = size;\n\n    return (\n      <Popup\n        content=\"Copy\"\n        trigger={\n          <CopyToClipboard\n            className={c(className)}\n            text={text}\n            style={{ cursor: 'pointer' }}\n            onCopy={() => displaySuccess(message, 'Done')}\n          >\n            <Icon {...iconAttrs} />\n          </CopyToClipboard>\n        }\n      />\n    );\n  },\n);\n\nexport default Component;\n","import _ from 'lodash';\nimport React from 'react';\nimport { decorate, computed } from 'mobx';\nimport { observer, inject } from 'mobx-react';\nimport { withRouter } from 'react-router-dom';\nimport { Label, Popup, Statistic, Placeholder } from 'semantic-ui-react';\n\nimport { isStoreError, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\nimport { swallowError, nicePrice } from '@aws-ee/base-ui/dist/helpers/utils';\n\n// expected props\n// - envId (via prop)\n// - scEnvironmentCostsStore  (via injection)\nclass ScEnvironmentCost extends React.Component {\n  componentDidMount() {\n    const costStore = this.getEnvCostStore();\n    if (!isStoreReady(costStore) && !isStoreError(costStore)) {\n      swallowError(costStore.load());\n    }\n  }\n\n  get costsStore() {\n    return this.props.scEnvironmentCostsStore;\n  }\n\n  get envId() {\n    return this.props.envId;\n  }\n\n  get envCost() {\n    const envId = this.envId;\n    return this.costsStore.getScEnvironmentCost(envId);\n  }\n\n  getEnvCostStore() {\n    const costsStore = this.costsStore;\n    const envId = this.envId;\n    return costsStore.getScEnvironmentCostStore(envId);\n  }\n\n  render() {\n    const envCost = this.envCost;\n    const isLoading = _.isUndefined(envCost);\n    const isError = !isLoading && !_.isEmpty(envCost.error);\n    const previousCost = !isLoading && !isError ? envCost.previousDayCost : 0;\n\n    if (isLoading) {\n      return (\n        <Placeholder>\n          <Placeholder.Line length=\"full\" />\n          <Placeholder.Line length=\"full\" />\n        </Placeholder>\n      );\n    }\n\n    return (\n      <>\n        <div className=\"center breakout\">\n          <Statistic color={isError ? 'red' : 'black'} size=\"mini\">\n            <Statistic.Value>{isError ? 'N/A' : `$${nicePrice(previousCost)}`}</Statistic.Value>\n            <Statistic.Label>Yesterday&apos;s Cost</Statistic.Label>\n          </Statistic>\n        </div>\n        {isError && this.renderErrorPopup(envCost.error)}\n      </>\n    );\n  }\n\n  renderErrorPopup(error) {\n    return (\n      <div className=\"mt2 center\">\n        <Popup\n          trigger={\n            <Label size=\"mini\" basic color=\"red\">\n              Show Error\n            </Label>\n          }\n          basic\n        >\n          <div className=\"color-red\">\n            <p>An error occurred while retrieving the cost information.</p>\n            <p>\n              If this workspace is provisioned in a new account, verify with your administer that the cost explorer\n              feature is enabled for the account.\n            </p>\n            <p>The system returned this error message:</p>\n            <p>{error}</p>\n          </div>\n        </Popup>\n      </div>\n    );\n  }\n}\n\n// see https://medium.com/@mweststrate/mobx-4-better-simpler-faster-smaller-c1fbc08008da\ndecorate(ScEnvironmentCost, {\n  costsStore: computed,\n  envId: computed,\n});\n\nexport default inject('scEnvironmentCostsStore')(withRouter(observer(ScEnvironmentCost)));\n","import _ from 'lodash';\nimport { types } from 'mobx-state-tree';\n\n// ====================================================================================================================================\n// Step\n// ====================================================================================================================================\nconst Step = types\n  .model('Step', {\n    key: types.string,\n    title: types.string,\n    desc: types.optional(types.string, ''),\n    isComplete: false,\n  })\n  .actions(self => ({\n    setComplete(isComplete) {\n      self.isComplete = isComplete;\n    },\n  }));\n\n// ====================================================================================================================================\n// Wizard\n// ====================================================================================================================================\nconst Wizard = types\n  .model('Wizard', {\n    steps: types.array(Step),\n    currentIdx: 0,\n  })\n  .actions(self => ({\n    next() {\n      if (self.hasNext) {\n        self.currentIdx += 1;\n      }\n    },\n    previous() {\n      if (self.hasPrevious) {\n        self.currentIdx -= 1;\n      }\n    },\n    goTo(stepKey) {\n      const stepIdx = _.findIndex(self.steps, { key: stepKey });\n      if (stepIdx >= 0) {\n        self.currentIdx = stepIdx;\n      }\n    },\n  }))\n  .views(self => ({\n    get currentStep() {\n      return self.steps[self.currentIdx];\n    },\n    get hasNext() {\n      return self.currentIdx < self.steps.length - 1;\n    },\n    get hasPrevious() {\n      return self.currentIdx > 0;\n    },\n\n    isStepActive(stepKey) {\n      return _.findIndex(self.steps, { key: stepKey }) === self.currentIdx;\n    },\n  }));\n\nfunction createWizard(steps, currentIdx = 0) {\n  return Wizard.create({\n    steps,\n    currentIdx,\n  });\n}\n\nexport default Wizard;\nexport { Wizard, createWizard };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { inject, Observer, observer } from 'mobx-react';\nimport { action, computed, decorate, observable, runInAction } from 'mobx';\nimport { Header, Icon, Step, Tab } from 'semantic-ui-react';\n\nimport Stores from '@aws-ee/base-ui/dist/models/Stores';\nimport { swallowError } from '@aws-ee/base-ui/dist/helpers/utils';\nimport ErrorBox from '@aws-ee/base-ui/dist/parts/helpers/ErrorBox';\nimport BasicProgressPlaceholder from '@aws-ee/base-ui/dist/parts/helpers/BasicProgressPlaceholder';\nimport { isStoreLoading, isStoreReady } from '@aws-ee/base-ui/dist/models/BaseStore';\n\nimport { createWizard } from '@aws-ee/base-ui/dist/models/Wizard';\nimport { displayError, displaySuccess } from '@aws-ee/base-ui/dist/helpers/notification';\nimport { sessionStore } from '@aws-ee/base-ui/dist/models/SessionStore';\nimport { getEnvTypeConfigForm } from '../../../models/forms/EnvTypeConfigForm';\nimport BasicInfoStep from './env-type-config-steps/BasicInfoStep';\nimport AccessControlStep from './env-type-config-steps/AccessControlStep';\nimport InputParamsStep from './env-type-config-steps/InputParamsStep';\nimport TagsStep from './env-type-config-steps/TagsStep';\n\nconst steps = [\n  {\n    key: 'basic_information',\n    title: 'Basic Information',\n    desc: 'Enter basic information',\n    isComplete: false,\n    stepComponent: BasicInfoStep,\n  },\n  {\n    key: 'access_control',\n    title: 'Access Control',\n    desc: 'Define who can access',\n    isComplete: false,\n    stepComponent: AccessControlStep,\n  },\n  {\n    key: 'input_params',\n    title: 'Input Parameters',\n    desc: 'Provide AWS CloudFormation Inputs',\n    isComplete: false,\n    stepComponent: InputParamsStep,\n  },\n  {\n    key: 'tags',\n    title: 'Tags',\n    desc: 'Specify Resource Tags',\n    isComplete: false,\n    stepComponent: TagsStep,\n  },\n];\nconst wizardTempStoreKeyPrefix = 'EnvTypeConfigEditor-TempStore';\n\nfunction clearState() {\n  sessionStore.removeStartsWith(wizardTempStoreKeyPrefix);\n}\n\nclass EnvTypeConfigEditor extends React.Component {\n  constructor(props) {\n    super(props);\n    runInAction(() => {\n      this.stores = new Stores([this.envTypeConfigsStore, this.userRolesStore]);\n      this.form = getEnvTypeConfigForm(props.envTypeConfig);\n      this.wizardModel = createWizard(_.map(steps, s => _.omit(s, 'stepComponent')));\n    });\n  }\n\n  componentDidMount() {\n    swallowError(this.stores.load());\n  }\n\n  render() {\n    const stores = this.stores;\n    let content = null;\n    if (stores.hasError) {\n      content = <ErrorBox error={stores.error} className=\"p0 mb3\" />;\n    } else if (isStoreLoading(stores)) {\n      content = <BasicProgressPlaceholder />;\n    } else if (isStoreReady(stores)) {\n      content = this.renderContent();\n    } else {\n      content = null;\n    }\n\n    return (\n      <div className=\"ml3 mt3 mr3 mb4\">\n        {this.renderTitle()}\n        {content}\n      </div>\n    );\n  }\n\n  renderTitle = () => {\n    const envTypConfig = this.envTypeConfig;\n    const isUpdating = this.isEditAction();\n    return (\n      <div className=\"mb3\">\n        <Header as=\"h3\" className=\"color-grey mt1 mb0\">\n          <Icon name=\"settings\" className=\"align-top\" />\n          <Header.Content className=\"left-align\">{isUpdating ? 'Edit' : 'Add'} Configuration</Header.Content>\n          {isUpdating && <Header.Subheader className=\"mt2\">{envTypConfig.name}</Header.Subheader>}\n        </Header>\n      </div>\n    );\n  };\n\n  renderContent = () => {\n    const isUpdating = this.isEditAction();\n    return (\n      // Render as tabs when updating configuration,\n      // Render as wizard when adding configuration\n      <>\n        {isUpdating ? (\n          this.renderStepTabs()\n        ) : (\n          <>\n            {this.renderStepProgress()}\n            {this.renderCurrentStep()}\n          </>\n        )}\n      </>\n    );\n  };\n\n  renderStepTabs = () => {\n    const stepPanes = _.map(this.wizardModel.steps, step => ({\n      menuItem: step.title,\n      render: () => <Observer>{() => this.renderEnvTypeConfigStep(step.key)}</Observer>,\n    }));\n    return <Tab className=\"mt3\" menu={{ secondary: true, pointing: true }} renderActiveOnly panes={stepPanes} />;\n  };\n\n  renderStepProgress = () => {\n    return (\n      <Step.Group ordered className=\"container\">\n        {_.map(this.wizardModel.steps, step => {\n          const stepAttribs = {\n            key: step.key,\n            completed: step.isComplete,\n            active: this.wizardModel.isStepActive(step.key),\n          };\n          return (\n            <Step {...stepAttribs}>\n              <Step.Content>\n                <Step.Title>{step.title}</Step.Title>\n                <Step.Description>{step.desc}</Step.Description>\n              </Step.Content>\n            </Step>\n          );\n        })}\n      </Step.Group>\n    );\n  };\n\n  renderCurrentStep = () => {\n    return this.renderEnvTypeConfigStep(this.wizardModel.currentStep.key);\n  };\n\n  renderEnvTypeConfigStep(stepKey) {\n    const step = _.find(steps, { key: stepKey });\n    const StepComponentClass = _.get(step, 'stepComponent');\n    return (\n      <StepComponentClass\n        form={this.form}\n        wizardModel={this.wizardModel}\n        onCancel={() => {\n          clearState();\n          this.props.onCancel();\n        }}\n        onSubmit={this.handleFormSubmission}\n        envTypeConfig={this.envTypeConfig}\n        envType={this.envType}\n        envTypeConfigsStore={this.envTypeConfigsStore}\n        onPrevious={this.handlePreviousClick}\n        // steps can store temporary information in session store with the following key prefix\n        // see InputParamsStep as an example, it needs to create a different mobx form specifically for cfn params\n        // the values entered for that form will wipe out on next/previous click as the component gets unmounted/mounted\n        // to preserve those values outside of the step component the step component can save the info in session store\n        // with this key prefix\n        // This component (i.e., EnvTypeConfigEditor) will take care of clearing session keys with this prefix upon\n        // completion or cancel\n        wizardTempStoreKeyPrefix={wizardTempStoreKeyPrefix}\n        action={this.getAction()}\n      />\n    );\n  }\n\n  handlePreviousClick = () => {\n    this.wizardModel.previous();\n  };\n\n  handleFormSubmission = async form => {\n    const existingEnvTypeConfig = this.envTypeConfig;\n    const isUpdating = this.isEditAction();\n\n    const {\n      id,\n      name,\n      desc,\n      estimatedCostInfo,\n      allowRoleIds,\n      denyRoleIds,\n      params: paramsJsonStr,\n      tags: tagsJsonStr,\n    } = form.values();\n\n    let existingParams;\n    let existingTags;\n    if (isUpdating) {\n      existingParams = existingEnvTypeConfig.params;\n      existingTags = existingEnvTypeConfig.tags;\n    }\n\n    // The params and tags fields are submitted as JSON string via the form\n    const params = !_.isEmpty(paramsJsonStr) ? JSON.parse(paramsJsonStr) : existingParams;\n\n    // The updatedTags below has [{name,value}] form. Translate it to [{key,value}]\n    const updatedTags = JSON.parse(tagsJsonStr || '[]') || [];\n    const fromNameValueToKeyValue = nameValue => ({ key: nameValue.key || nameValue.name, value: nameValue.value });\n    const tags = !_.isEmpty(tagsJsonStr) ? _.map(updatedTags, fromNameValueToKeyValue) : existingTags;\n\n    const envTypeConfig = {\n      ...(existingEnvTypeConfig || {}),\n      id,\n      name,\n      desc,\n      estimatedCostInfo,\n      allowRoleIds: allowRoleIds || [],\n      denyRoleIds: denyRoleIds || [],\n      params,\n      tags,\n    };\n\n    try {\n      if (!isUpdating && this.wizardModel.hasNext) {\n        // When creating configuration, do not submit to server just yet,\n        // show next screen if there is one\n        // Will submit to server at the end\n        return this.wizardModel.next();\n      }\n\n      let savedEnvTypeConfig;\n      if (isUpdating) {\n        savedEnvTypeConfig = await this.envTypeConfigsStore.updateEnvTypeConfig(envTypeConfig);\n        displaySuccess(`Successfully updated ${envTypeConfig.name} configuration`);\n      } else {\n        savedEnvTypeConfig = await this.envTypeConfigsStore.createEnvTypeConfig(envTypeConfig);\n      }\n      clearState();\n\n      this.props.onEnvTypeConfigSaveComplete(savedEnvTypeConfig);\n      return savedEnvTypeConfig;\n    } catch (error) {\n      displayError(error);\n    }\n    return undefined;\n  };\n\n  get envTypeConfigsStore() {\n    return this.props.envTypeConfigsStore;\n  }\n\n  get userRolesStore() {\n    return this.props.userRolesStore;\n  }\n\n  get envType() {\n    return this.props.envType;\n  }\n\n  get envTypeConfig() {\n    return this.props.envTypeConfig;\n  }\n\n  isEditAction() {\n    return this.getAction() === 'edit';\n  }\n\n  getAction() {\n    return this.props.action;\n  }\n}\n\ndecorate(EnvTypeConfigEditor, {\n  userRolesStore: computed,\n  envTypeConfigsStore: computed,\n  envTypeConfig: computed,\n  envType: computed,\n\n  handleFormSubmission: action,\n\n  stores: observable,\n});\nexport default inject('userRolesStore')(observer(EnvTypeConfigEditor));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types, getEnv, applySnapshot } from 'mobx-state-tree';\n\n// ====================================================================================================================================\n// Product -- Maps to AWS Service Catalog Product (only id and name)\n// ====================================================================================================================================\nconst Product = types.model('Product', {\n  productId: '',\n  name: '',\n});\n\n// ====================================================================================================================================\n// ProvisioningArtifact -- Maps to AWS Service Catalog Provisioning Artifact (a.k.a., Version)\n// ====================================================================================================================================\nconst ProvisioningArtifact = types.model('ProvisioningArtifact', {\n  id: '',\n  name: types.maybeNull(types.optional(types.string, '')),\n  description: types.maybeNull(types.optional(types.string, '')),\n  type: '',\n  createdTime: '',\n  active: false,\n  guidance: '',\n});\n\n// ====================================================================================================================================\n// ParamConstraint -- Maps to AWS Service Catalog Provisioning Artifact Parameter Constraints\n// ====================================================================================================================================\nconst ParamConstraint = types.model('ParamConstraint', {\n  AllowedValues: types.optional(types.array(types.optional(types.string, '')), []),\n});\n\n// ====================================================================================================================================\n// CfnParam -- Maps to AWS Service Catalog Provisioning Artifact Parameters - in turn maps to AWS CloudFormation Stack Input Parameters\n// ====================================================================================================================================\nconst CfnParam = types.model('CfnParam', {\n  ParameterKey: '',\n  ParameterType: '',\n  IsNoEcho: false,\n  Description: types.maybeNull(types.optional(types.string, '')),\n  ParameterConstraints: types.optional(ParamConstraint, {}),\n});\n\n// ====================================================================================================================================\n// EnvTypeCandidate\n// ====================================================================================================================================\nconst EnvTypeCandidate = types\n  .model('EnvTypeCandidate', {\n    id: types.identifier,\n    name: '',\n    desc: types.maybeNull(types.optional(types.string, '')),\n    isLatest: false,\n    product: types.optional(Product, {}),\n    provisioningArtifact: types.optional(ProvisioningArtifact, {}),\n    params: types.optional(types.array(CfnParam), []),\n  })\n  .actions(self => ({\n    setEnvTypeCandidate(envTypeCandidate) {\n      applySnapshot(self, envTypeCandidate);\n    },\n  }))\n  .views(self => ({\n    get descHtml() {\n      const showdown = getEnv(self).showdown;\n      return showdown.convert(self.desc);\n    },\n  }));\nexport default EnvTypeCandidate;\nexport { EnvTypeCandidate };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { configure } from 'mobx';\nimport 'mobx-react/batchingForReactDom';\nimport { initializeAppContext } from './app-context/app-context';\n\nimport * as serviceWorker from './service-worker';\nimport AppContainer from './AppContainer';\n\nfunction bootstrapApp({ renderAppContainer, renderError, renderProgress, pluginRegistry }) {\n  // Disabling service worker\n  serviceWorker.unregister();\n\n  // Enable mobx strict mode, changes to state must be contained in actions\n  configure({ enforceActions: 'always' });\n\n  // Initialize appContext object registering various Mobx stores etc\n  const appContext = initializeAppContext(pluginRegistry);\n\n  // Render page loading message\n  renderProgress();\n\n  // Trigger the app startup sequence\n  (async () => {\n    try {\n      await appContext.appRunner.run();\n      renderAppContainer(AppContainer, appContext);\n    } catch (err) {\n      console.log(err);\n      // TODO - check if the code = tokenExpired, then\n      // - render a notification error\n      // - call cleaner cleanup, this is IMPORTANT\n      // - render the app and skip the rest of the renderError logic\n      // - doing the above logic will help us have a smooth user experience\n      //   when the token has expired. NOTE: this might not be applicable for the\n      //   cases where the app requires midway before anything is displayed to the user\n      renderError(err);\n      try {\n        appContext.cleaner.cleanup();\n      } catch (error) {\n        // ignore\n        console.log(error);\n      }\n    }\n  })();\n}\n\nexport default bootstrapApp;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport React from 'react';\nimport { observer } from 'mobx-react';\nimport { TextArea } from 'semantic-ui-react';\nimport c from 'classnames';\n\nimport Header from './Header';\nimport Description from './Description';\nimport ErrorPointer from './ErrorPointer';\n\n// expected props\n// - field (via props), this is the mobx form field object\n// - className (via props)\n//\n// The following props are to support existing React Semantic UI props:\n// - rows (via props), number of rows\n// - disabled (via props), default to false\nconst Component = observer(({ field, disabled = false, className = 'mb4', rows = 5, dataTestId = '' }) => {\n  const { error = '' } = field;\n  const hasError = !_.isEmpty(error); // IMPORTANT do NOT use field.hasError\n  const isDisabled = field.disabled || disabled;\n  const disabledClass = isDisabled ? 'disabled' : '';\n  const errorClass = hasError ? 'error' : '';\n  const attrs = {\n    disabled: isDisabled,\n    rows,\n    ..._.omit(field.bind(), ['label']),\n  };\n\n  return (\n    <div className={c(className, errorClass, disabledClass)}>\n      <Header field={field} />\n      <Description field={field} />\n      <TextArea data-testid={dataTestId} className=\"field\" {...attrs} />\n      <ErrorPointer field={field} />\n    </div>\n  );\n});\n\nexport default Component;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\n\n/**\n * This is where we run the post initialization logic that is specific to Service Workbench.\n *\n * @param payload A free form object. This function expects a property named 'tokenInfo' to be available on the payload object.\n * @param appContext An application context object containing various Mobx Stores, Models etc.\n *\n * @returns {Promise<void>}\n */\nasync function postInit(payload, appContext) {\n  const tokenNotExpired = _.get(payload, 'tokenInfo.status') === 'notExpired';\n  if (!tokenNotExpired) return; // Continue only if we have a token that is not expired\n\n  const { userStore, usersStore, awsAccountsStore, userRolesStore, indexesStore, projectsStore } = appContext;\n\n  // TODO: Load these stores as needed instead of on startup\n  if (userStore.user.status === 'active') {\n    await Promise.all([\n      usersStore.load(),\n      awsAccountsStore.load(),\n      userRolesStore.load(),\n      indexesStore.load(),\n      projectsStore.load(),\n    ]);\n  }\n}\n\nconst plugin = {\n  postInit,\n};\n\nexport default plugin;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { logout } from '../helpers/api';\n\n/**\n * Called when user attempts to login explicitly (i.e., when the user explicitly initiates the login process).\n * Note that this method is ONLY invoked during explicit login initiation. For example, if the user has logged in before\n * and during the application initialization, the application detects the login automatically (due to presence of the\n * authorization token in local storage or url etc) this method is NOT called.\n *\n * Also, this method is called upon login attempt BEFORE the login process is actually complete.\n *\n * @returns {Promise<void>}\n */\nasync function loginInitiated() {\n  // No-op at the moment\n}\n\n/**\n * Called when the application detects that the user has logged in explicitly or implicitly.\n * Note that this is called even for implicit login detection. For example, if the user has logged in before and during\n * the application initialization, the application detects login automatically (due to presence of the authorization token\n * in local storage or url etc) this method is still called.\n *\n * Also, this method is called AFTER login is detected i.e., after the login process is complete.\n *\n * @param explicitLogin A flag indicating whether the login was detected as a result of explicit login attempt.\n * This flag will NOT be passed in situations where the application cannot determine with certainty if the detected login\n * was a result of explicit login or implicit login.\n *\n * @returns {Promise<void>}\n */\n// eslint-disable-next-line no-unused-vars\nasync function loginDetected({ explicitLogin } = {}) {\n  // No-op at the moment\n}\n\n/**\n * Called when user attempts to logout explicitly (i.e., when the user explicitly initiates the logout process).\n * Note that this method is only invoked during explicit logout initiation. For example, if the user has logged out before\n * and during the application initialization, the application detects that the user has logged out (due to absence of the\n * authorization token in local storage and url etc) this method is NOT called.\n *\n * @param autoLogout A flag indicating whether the logout was explicitly initiated due to an auto-logout action.\n * For example, if the application explicitly initiates an auto-logout sequence after detecting user inactivity for\n * certain period.\n *\n * @returns {Promise<void>}\n */\n// eslint-disable-next-line no-unused-vars\nasync function logoutInitiated({ autoLogout } = {}) {\n  // Call the logout API\n  await logout();\n}\n\n/**\n * Called when the application detects that the user has logged out explicitly or implicitly.\n * Note that this is called even for implicit logout detection. For example, if the user has logged out before\n * and during the application initialization, the application detects that the user has logged out (due to absence of the\n * authorization token in local storage and url etc) this method is still called.\n * (In this sense the \"log out detection\" is more of \"log in NOT detected\")\n *\n * Also, this method is called AFTER logout is detected i.e., after the logout process is complete\n * (and the authorization token(s) have been cleared from memory or local storage).\n *\n * @param explicitLogout A flag indicating whether the logout was detected as a result of explicit logout attempt.\n * This flag will NOT be passed in situations where the application cannot determine with certainty if the detected logout\n * was a result of explicit logout or implicit logout.\n * @param autoLogout A flag indicating whether the logout was explicitly initiated due to an auto-logout action.\n * For example, if the application explicitly initiates an auto-logout sequence after detecting user inactivity for\n * certain period.\n * This flag will NOT be passed in situations where the application cannot determine with certainty if the detected logout\n * was a result of explicit auto-logout or implicit logout.\n *\n * @returns {Promise<void>}\n */\n// eslint-disable-next-line no-unused-vars\nasync function logoutDetected({ explicitLogout, autoLogout } = {}) {\n  // No-op at the moment\n}\n\nconst plugin = {\n  loginInitiated,\n  loginDetected,\n\n  logoutInitiated,\n  logoutDetected,\n};\n\nexport default plugin;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport UserApplication from '../parts/UserApplication';\n\n// eslint-disable-next-line consistent-return, no-unused-vars\nfunction getAppComponent({ location, appContext }) {\n  const app = appContext.app || {};\n  // We are only going to return an App react component if the user is authenticated\n  // and not registered, otherwise we return undefined which means that the base ui\n  // plugin will provide its default App react component.\n  if (app.userAuthenticated && !app.userRegistered) {\n    return UserApplication;\n  }\n}\n\nconst plugin = {\n  getAppComponent,\n};\n\nexport default plugin;\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAC7gAAAAyCAYAAADMOZY9AAALTUlEQVR4Xu3aEVeEURiF0ZmVRVEWZVE0FmVRFkVZlEVDWZRFURZlURYNZUNZFGXhbZ1fcS7s7w+8Z+374bMcY+wsfAQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAoCywHGPsljc4T4AAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIEFgnc9zgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAIG2QAL3/fYI9wkQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAQAL3AwwECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQKAtkMD9sD3CfQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgkMD9CAMBAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEGgLJHA/bo9wnwABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIJHBfYSBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAm2BBO4n7RHuEyBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBBO6nGAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAQFsggftZe4T7BAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIEAggfs5BgIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAg0BZI4H7RHuE+AQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBBI4H6JgQABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQItAUSuF+1R7hPgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQSuF9jIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECbYEE7jftEe4TIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAIEE7rcYCBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIBAWyCB+7o9wn0CBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIJDA/Q4DAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBBoCyRwv2+PcJ8AAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECCRwf8BAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgTaAgncH9sj3CdAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgncnzAQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAIG2QAL35/YI9wkQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAQAL3FwwECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQKAtkMD9tT3CfQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgkMD9DQMBAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEGgLJHB/b49wnwABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIJHD/wECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBNoCCdw37RHuEyBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBBO6fGAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAQFsggfu2PcJ9AgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECCQwP0LAwECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQaAskcP9uj3CfAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgkcP/BQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIE2gIJ3H/bI9wnQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIJ3P8wECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgACBtkAC99Ee4T4BAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIEBC4+wcIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAYAoBgfsUz2AEAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECAjc/QMECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgMIWAwH2KZzCCAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBATu/gECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQmEJA4D7FMxhBgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgJ3/wABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQITCEgcJ/iGYwgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAYG7f4AAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIECBAgQIAAAQIEphAQuE/xDEYQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAwD8uL7OdGFnBBwAAAABJRU5ErkJggg==\"","import React from 'react';\nimport EnvTypeCardMetaActions from '../parts/environment-type-mgmt/EnvTypeCardMetaActions';\n\nfunction getEnvTypeCardMetaActions(payloadSoFar, envType) {\n  return [...(payloadSoFar || []), <EnvTypeCardMetaActions key={envType.id} envType={envType} />];\n}\n\nconst plugin = {\n  getEnvTypeCardMetaActions,\n};\n\nexport default plugin;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React from 'react';\nimport { inject, observer } from 'mobx-react';\nimport DefaultLoginScreen from './parts/Login';\n\nclass Wrapper extends React.Component {\n  renderLogin() {\n    return this.props.loginComp;\n  }\n\n  renderAuthenticated() {\n    const Comp = this.props.Comp;\n    const props = this.getWrappedCompProps({ authenticated: true });\n    return <Comp {...props} />;\n  }\n\n  render() {\n    const app = this.props.app;\n    let content = null;\n\n    if (app.userAuthenticated) {\n      content = this.renderAuthenticated();\n    } else {\n      content = this.renderLogin();\n    }\n\n    return content;\n  }\n\n  // private utility methods\n  getWrappedCompProps(additionalProps) {\n    const props = { ...this.props, ...additionalProps };\n    delete props.Comp;\n    delete props.loginComp;\n    return props;\n  }\n}\n\nconst WrapperComp = inject('app', 'assets')(observer(Wrapper));\n\nfunction withAuth(Comp, { loginComp } = { loginComp: <DefaultLoginScreen /> }) {\n  return function component(props) {\n    return <WrapperComp Comp={Comp} loginComp={loginComp} {...props} />;\n  };\n}\n\nexport default withAuth;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { observable } from 'mobx';\n\nimport { PluginRegistry } from '../models/PluginRegistry';\n\nconst appContext = observable({});\n\n/**\n * Initializes the given appContext (application context containing various MobX stores etc) by calling each plugin's\n * \"registerAppContextItems\" and \"postRegisterAppContextItems\" methods.\n *\n * @param {Object} pluginRegistry A registry that provides plugins registered by various addons for the specified extension point.\n * Each 'contextItems' plugin in the returned array is an object containing \"registerAppContextItems\" and \"postRegisterAppContextItems\" plugin methods.\n *\n * @returns {{intervalIds: {}, disposers: {}, pluginRegistry: {}}}\n */\nconst initializeAppContext = pluginRegistry => {\n  const registry = new PluginRegistry(pluginRegistry);\n  const appContextHolder = {\n    disposers: {},\n    intervalIds: {},\n    pluginRegistry: registry,\n    assets: {\n      images: {},\n    },\n  };\n\n  const registerAppContextItems = registry.getPluginsWithMethod('app-context-items', 'registerAppContextItems');\n  _.forEach(registerAppContextItems, plugin => {\n    plugin.registerAppContextItems(appContextHolder);\n  });\n\n  const postRegisterAppContextItems = registry.getPluginsWithMethod('app-context-items', 'postRegisterAppContextItems');\n  _.forEach(postRegisterAppContextItems, plugin => {\n    plugin.postRegisterAppContextItems(appContextHolder);\n  });\n\n  Object.assign(appContext, appContextHolder); // this is to ensure that it is the same appContext reference whether initializeAppContext is called or not\n  return appContextHolder;\n};\n\nexport { appContext, initializeAppContext };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable import/prefer-default-export */\nimport _ from 'lodash';\nimport { processSequentially } from '../helpers/utils';\n\nclass PluginRegistry {\n  constructor(registry) {\n    this.registry = registry;\n  }\n\n  getPlugins(extensionPoint) {\n    return this.registry.getPlugins(extensionPoint);\n  }\n\n  getPluginsWithMethod(extensionPoint, methodName) {\n    const registry = this.registry;\n    const plugins = registry.getPlugins(extensionPoint);\n    return _.filter(plugins, plugin => _.isFunction(plugin[methodName]));\n  }\n\n  async runPlugins(extensionPoint, methodName, ...args) {\n    const plugins = this.getPluginsWithMethod(extensionPoint, methodName);\n\n    // Each plugin needs to be executed in order. The plugin method may be return a promise we need to await\n    // it in sequence.\n    return processSequentially(plugins, plugin => plugin[methodName](...args));\n  }\n\n  /**\n   * A method to visit plugins that implement the specified method for the specified extension point.\n   * The method calls each plugin in the same order as registered in the plugin registry.\n   * It invokes the specified method on each plugin and passes a result returned by the previous plugin call.\n   * This gives each plugin a chance to contribute to the payload. Each plugin can inspect the given payload and return\n   * it \"as is\" or return a modified payload. The payload returned by the last plugin is considered the resultant payload\n   * and returned to the caller.\n   *\n   * @param extensionPoint Name of the extension point in the plugin registry mapped to corresponding plugins\n   *\n   * @param methodName Name of the plugin method to call. The plugin method will be invoked with the payload as the\n   * first argument followed by any other arguments specified by the \"args\".\n   *\n   * @param options Various options for this call\n   * @param options.payload Value of the initial payload to pass to the first plugin\n   * @param options.continueOnError Optional flag indicating if the method should continue (i.e., continue calling the\n   * next plugin) when a plugin throws error. Defaults to false.\n   * @param options.pluginInvokerFn An optional plugin invoker function that invokes plugin. Default plugin invoker\n   * calls the plugin method with the following arguments (payloadSoFar, ...args). The \"payloadSoFar\" is the payload\n   * collected so far from previous plugins. The \"...args\" are any other arguments passed to this method. The\n   * \"pluginInvokerFn\" can be used in cases where the plugin method signature does not match the \"(payloadSoFar, ...args)\"\n   * signature. A custom implementation of \"pluginInvokerFn\" can be passed in such cases to customize the way the\n   * plugin is called. The \"pluginInvokerFn\" is called with the following arguments \"(pluginPayload, plugin, method, ...args)\"\n   *\n   * @param args Any other arguments to pass to the plugins\n   *\n   * @returns {*}\n   */\n  visitPlugins(\n    extensionPoint,\n    methodName,\n    {\n      payload = {},\n      continueOnError = false,\n      pluginInvokerFn = (pluginPayload, plugin, method, ...args) => plugin[method](pluginPayload, ...args),\n    } = {},\n    ...args\n  ) {\n    const plugins = this.getPluginsWithMethod(extensionPoint, methodName);\n\n    let payloadSoFar = payload;\n    // eslint-disable-next-line no-restricted-syntax\n    for (const plugin of plugins) {\n      try {\n        payloadSoFar = pluginInvokerFn(payloadSoFar, plugin, methodName, ...args);\n      } catch (err) {\n        if (!continueOnError) {\n          throw err;\n        }\n      }\n    }\n    return payloadSoFar;\n  }\n}\n\nexport { PluginRegistry };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/),\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA',\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.',\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (response.status === 404 || (contentType != null && contentType.indexOf('javascript') === -1)) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport React, { Component } from 'react';\nimport _ from 'lodash';\nimport { withRouter } from 'react-router-dom';\nimport { inject, observer } from 'mobx-react';\nimport { getEnv } from 'mobx-state-tree';\nimport { Message, Container } from 'semantic-ui-react';\n\nimport { branding } from './helpers/settings';\n\n// expected props\n// - pluginRegistry (via injection)\n// - app (via injection)\n// - location (from react router)\nclass AppContainer extends Component {\n  componentDidMount() {\n    document.title = branding.page.title;\n    document.querySelector(\"link[rel='shortcut icon']\").href = this.props.assets.images.faviconIcon;\n    document.querySelector(\"link[rel='icon']\").href = this.props.assets.images.faviconImage;\n  }\n\n  render() {\n    const { location, pluginRegistry, app } = this.props;\n    let plugins = _.reverse(pluginRegistry.getPluginsWithMethod('app-component', 'getAppComponent') || []);\n    let App = this.renderError();\n\n    // We ask each plugin in reverse order if they have the App component\n    _.forEach(plugins, plugin => {\n      const result = plugin.getAppComponent({ location, appContext: getEnv(app) });\n      if (_.isUndefined(result)) return;\n      App = result;\n      // eslint-disable-next-line consistent-return\n      return false; // This will stop lodash from continuing the forEach loop\n    });\n\n    plugins = _.reverse(pluginRegistry.getPluginsWithMethod('app-component', 'getAutoLogoutComponent') || []);\n    let AutoLogout = () => <></>;\n    // We ask each plugin in reverse order if they have the AutoLogout component\n    _.forEach(plugins, plugin => {\n      const result = plugin.getAutoLogoutComponent({ location, appContext: getEnv(app) });\n      if (_.isUndefined(result)) return;\n      AutoLogout = result;\n      // eslint-disable-next-line consistent-return\n      return false; // This will stop lodash from continuing the forEach loop\n    });\n\n    return (\n      <>\n        <AutoLogout />\n        <App />\n      </>\n    );\n  }\n\n  renderError() {\n    return (\n      <Container>\n        <Message negative className=\"clearfix mt4\">\n          <Message.Header>A problem was encountered</Message.Header>\n          <p>No plugins provided the App react component!</p>\n        </Message>\n      </Container>\n    );\n  }\n}\n\nexport default inject('pluginRegistry', 'app', 'assets')(withRouter(observer(AppContainer)));\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\n/* eslint-disable no-await-in-loop */\nclass AppRunner {\n  constructor(appContext) {\n    this.appContext = appContext;\n  }\n\n  async run() {\n    const appContext = this.appContext;\n    const registry = appContext.pluginRegistry;\n    const initPlugins = registry.getPluginsWithMethod('initialization', 'init');\n    const payload = {};\n\n    // Ask each plugin to run init()\n    // eslint-disable-next-line no-restricted-syntax\n    for (const plugin of initPlugins) {\n      await plugin.init(payload, appContext);\n    }\n\n    // Did any plugin want to do an external redirect?\n    if (payload.externalRedirectUrl) {\n      window.location = payload.externalRedirectUrl;\n      return;\n    }\n\n    const postInitPlugins = registry.getPluginsWithMethod('initialization', 'postInit');\n    // Ask each plugin to run postInit()\n    // eslint-disable-next-line no-restricted-syntax\n    for (const plugin of postInitPlugins) {\n      await plugin.postInit(payload, appContext);\n    }\n\n    // Did any plugin want to do an external redirect?\n    if (payload.externalRedirectUrl) {\n      window.location = payload.externalRedirectUrl;\n      return;\n    }\n\n    const app = appContext.app;\n    await app.init(payload);\n  }\n}\n\nfunction registerContextItems(appContext) {\n  appContext.appRunner = new AppRunner(appContext);\n}\n\nexport { AppRunner, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { runInAction } from 'mobx';\n\nimport { forgetIdToken } from '../helpers/api';\n\n// An object that captures all the clean up logic when the app is done or no jwt token\n// is found.\nclass Cleaner {\n  constructor(appContext) {\n    this.appContext = appContext;\n  }\n\n  cleanup() {\n    const { disposers, intervalIds } = this.appContext;\n\n    // it is important that we start with cleaning the disposers, otherwise snapshots events will be fired\n    // for cleaned stores\n    let keys = _.keys(disposers);\n    _.forEach(keys, key => {\n      const fn = disposers[key];\n      if (_.isFunction(fn)) {\n        fn();\n      }\n      delete disposers[key];\n    });\n\n    keys = _.keys(intervalIds);\n    _.forEach(keys, key => {\n      const id = intervalIds[key];\n      if (!_.isNil(id)) {\n        clearInterval(id);\n      }\n      delete intervalIds[key];\n    });\n\n    runInAction(() => {\n      forgetIdToken();\n\n      _.forEach(this.appContext, obj => {\n        if (obj === this) return; // we don't want to end up in an infinite loop\n        if (_.isFunction(obj.cleanup)) {\n          obj.cleanup();\n        }\n      });\n    });\n  }\n}\n\nfunction registerContextItems(appContext) {\n  appContext.cleaner = new Cleaner(appContext);\n}\n\nexport { Cleaner, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport showdown from 'showdown';\n\nconst classMap = {\n  h1: 'ui large header clearfix',\n  h2: 'ui medium header clearfix',\n  ul: 'ui list undo-line-height',\n  li: 'ui item undo-line-height',\n  p: 'ui undo-line-height clearfix',\n  // img: 'ui fluid image'\n  img: 'ui left floated image clearfix mb2 mr2',\n};\n\nconst bindings = Object.keys(classMap).map(key => ({\n  type: 'output',\n  regex: new RegExp(`<${key}(.*)>`, 'g'),\n  replace: `<${key} class=\"${classMap[key]}\" $1>`,\n}));\n\n// A wrapper around the showdown.js library https://github.com/showdownjs/showdown\nclass Showdown {\n  constructor(appContext) {\n    this.appContext = appContext;\n    // see https://github.com/showdownjs/showdown/wiki/Add-default-classes-for-each-HTML-element\n    this.converter = new showdown.Converter({\n      extensions: [...bindings],\n    });\n    // this.converter.setFlavor('github');\n    this.converter.setFlavor('vanilla');\n\n    // options are available here https://github.com/showdownjs/showdown/wiki/Showdown-options\n    this.converter.setOption('parseImgDimensions', true);\n  }\n\n  convert(markdown, assets = {}) {\n    // example of markdown http://demo.showdownjs.com/\n    // we will append all the assets as image references (this is not efficient at all), when we\n    // have time we can the correct image src mapping in an extension\n    let extended = `${markdown}\\n\\n`;\n    _.forEach(assets, (url, name) => {\n      extended = `${extended}[${name}]: ${url}\\n`;\n    });\n\n    return this.converter.makeHtml(extended);\n  }\n}\n\nfunction registerContextItems(appContext) {\n  appContext.showdown = new Showdown(appContext);\n}\n\nexport { Showdown, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { getEnv, types } from 'mobx-state-tree';\n\nimport { BaseStore, isStoreReady } from '../BaseStore';\nimport ApiKeysStore from './ApiKeysStore';\n\nconst UserApiKeysStore = BaseStore.named('UserApiKeysStore')\n  .props({\n    // key = uid and value = ApiKeysStore for that user\n    userApiKeysStores: types.optional(types.map(ApiKeysStore), {}),\n  })\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n    return {\n      async doLoad() {\n        const userStore = getEnv(self).userStore;\n        if (!isStoreReady(userStore)) {\n          // Load current user information, if not loaded already\n          await userStore.load();\n        }\n\n        const currentUser = userStore.user;\n        const currentUserApiKeyStore = ApiKeysStore.create({ uid: currentUser.uid });\n        if (!isStoreReady(currentUserApiKeyStore)) {\n          // Load API keys for the current user\n          await currentUserApiKeyStore.load();\n        }\n\n        self.runInAction(() => {\n          // The put call below will automatically use the id from currentUserApiKeyStore\n          // (as it is marked \"types.identifier\") and add that as a key in the map and\n          // store the object as value against it\n          self.userApiKeysStores.put(currentUserApiKeyStore);\n        });\n      },\n      getApiKeysStore: uid => {\n        let entry = self.userApiKeysStores.get(uid);\n        if (!entry) {\n          self.userApiKeysStores.put(ApiKeysStore.create({ uid }));\n          entry = self.userApiKeysStores.get(uid);\n        }\n        return entry;\n      },\n      getCurrentUserApiKeysStore: () => {\n        const userStore = getEnv(self).userStore;\n        const currentUser = userStore.user;\n        return self.getApiKeysStore(currentUser.id);\n      },\n      cleanup: () => {\n        self.user = undefined;\n        superCleanup();\n      },\n    };\n  })\n  .views(self => ({\n    get empty() {\n      return self.userApiKeysStores.size === 0;\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.userApiKeysStore = UserApiKeysStore.create({}, appContext);\n}\n\nexport { UserApiKeysStore, registerContextItems };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\n\nimport { parseError } from '../helpers/utils';\n\nconst Err = types.model('Err', {\n  message: '',\n  code: '',\n  requestId: '',\n});\n\nconst toErr = error => {\n  const parsed = parseError(error);\n  return Err.create({\n    message: parsed.message || '',\n    code: parsed.code || '',\n    requestId: parsed.toErr || '',\n  });\n};\n\nexport { Err, toErr };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { types, getSnapshot } from 'mobx-state-tree';\n\n// ==================================================================\n// InputManifest\n// ==================================================================\nconst InputManifest = types\n  .model('InputManifest', {\n    sections: types.optional(types.array(types.frozen()), []),\n  })\n  .actions(_self => ({}))\n\n  .views(self => ({\n    // An array of all the input entries (excluding non-interactive ones). This is a convenient method that\n    // traverses the whole input manifest tree.\n    // [ { name, title, ... }, { name, title, ...} ]\n    get flattened() {\n      return _.flatten(_.map(self.sections, section => findEntries(section.children)));\n    },\n\n    get names() {\n      return _.map(self.flattened, entry => entry.name);\n    },\n\n    get empty() {\n      return self.flattened.length === 0;\n    },\n\n    getSectionFlattened(section = {}) {\n      return _.flatten(findEntries(section.children));\n    },\n  }));\n\n// ==================================================================\n// Helpers\n// ==================================================================\n\n// Does the entry represent an input that will interact with the user\nfunction isInteractive(entry) {\n  if (_.isUndefined(entry)) return false;\n  return _.isNil(entry.nonInteractive) || entry.nonInteractive === false;\n}\n\n// Condition is true if it is empty/undefined or if the lodash expression evaluates to the string \"true\"\nfunction isConditionTrue(condition, config) {\n  if (_.isEmpty(condition)) return true;\n  return _.template(condition)(config) === 'true';\n}\n\n// Given an inputManifestEntry returns a object that contains all the supported mobx form field props\n// For a list of all mobx form field props see https://foxhound87.github.io/mobx-react-form/docs/fields/defining-flat-fields/unified-properties.html\nfunction toMobxFormFieldProps(entry, value) {\n  if (!isInteractive(entry)) return {};\n  const map = {};\n  const add = (key, val) => {\n    if (!_.isUndefined(val)) map[key] = val;\n  };\n  const { name, title, placeholder, rules, extra = {}, desc, disabled, options, yesLabel, noLabel } = entry;\n\n  add('name', name);\n  add('value', _.isUndefined(value) ? entry.default : value);\n  add('label', title);\n  add('placeholder', placeholder);\n  add('rules', rules);\n  add('default', _.isUndefined(entry.default) ? value : entry.default);\n  add('extra', { ..._.cloneDeep(extra), explain: desc, options, yesLabel, noLabel });\n  add('disabled', disabled);\n\n  return map;\n}\n\n// Recursive function\n// input = an array of the input manifest section children or input manifest entry children\n// config = all names in inputManifest and their values (if they exist)\nfunction toMobxFormFields(input = [], config) {\n  const result = [];\n  if (input.length === 0) return result;\n  const queue = input.slice();\n\n  while (queue.length > 0) {\n    const entry = queue.shift();\n    const name = entry.name;\n    if (isInteractive(entry) && isConditionTrue(entry.condition, config)) {\n      const value = config[name];\n      const field = toMobxFormFieldProps(entry, value);\n      result.push(field);\n      const children = entry.children;\n      if (_.isObject(children)) {\n        const fields = toMobxFormFields(children, config); // recursive call\n        if (fields.length > 0) {\n          result.push(...fields);\n        }\n      }\n    }\n  }\n\n  return result;\n}\n\n// Given an instance of inputManifest, apply markdown on all 'desc' props and return\n// a new json object (NOT an instance of inputManifest)\nfunction applyMarkdown({ inputManifest, showdown, assets = {} }) {\n  const copy = _.cloneDeep(getSnapshot(inputManifest));\n\n  function transform(obj) {\n    if (_.isNil(obj)) return obj;\n    if (_.isArray(obj))\n      return _.map(obj, item => {\n        return transform(item);\n      });\n\n    if (!_.isObject(obj)) return obj;\n    const keys = Object.keys(obj);\n\n    keys.forEach(key => {\n      if (key !== 'desc') {\n        obj[key] = transform(obj[key]);\n        return;\n      }\n      const desc = obj[key];\n      if (_.isNil(desc)) return;\n      obj.desc = showdown.convert(desc, assets);\n    });\n\n    return obj;\n  }\n\n  copy.sections = transform(copy.sections);\n\n  return copy;\n}\n\n// Given an array of input entries, visit each one of them by passing the item\n// to the visitFn\nfunction visit(input = [], visitFn = obj => obj) {\n  const result = [];\n  if (input.length === 0) return result;\n  const queue = input.slice();\n\n  while (queue.length > 0) {\n    const entry = queue.shift();\n    result.push(visitFn(entry));\n    const children = entry.children;\n    if (_.isObject(children)) {\n      const entries = visit(children, visitFn); // recursive call\n      if (entries.length > 0) {\n        entries.forEach(field => {\n          result.push(visitFn(field));\n        });\n      }\n    }\n  }\n  return result;\n}\n\n// ==================================================================\n// Internal Helpers\n// ==================================================================\n\n// Find all names with their entries (such as titles). This is a recursive function.\n// Returns an array,  [ { name, title, ... }, { name, title, ...} ]\nfunction findEntries(input = []) {\n  const result = [];\n  if (input.length === 0) return result;\n  const queue = input.slice();\n\n  while (queue.length > 0) {\n    const entry = queue.shift();\n    if (isInteractive(entry)) {\n      result.push(entry);\n    }\n    const children = entry.children;\n    if (_.isObject(children)) {\n      const entries = findEntries(children); // recursive call\n      if (entries.length > 0) {\n        entries.forEach(field => {\n          result.push(field);\n        });\n      }\n    }\n  }\n  return result;\n}\n\nexport { InputManifest, isInteractive, toMobxFormFieldProps, isConditionTrue, toMobxFormFields, applyMarkdown, visit };\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { getEnv, types } from 'mobx-state-tree';\n\nimport { getApiKeys, createNewApiKey, revokeApiKey } from '../../helpers/api';\nimport { BaseStore } from '../BaseStore';\nimport ApiKey from './ApiKey';\n\nconst ApiKeysStore = BaseStore.named('ApiKeysStore')\n  .props({\n    uid: types.identifier,\n    apiKeys: types.optional(types.map(ApiKey), {}),\n  })\n  .actions(self => {\n    // save the base implementation of cleanup\n    const superCleanup = self.cleanup;\n    return {\n      async doLoad() {\n        // do not pass uid param when loading api keys for current user\n        const apiKeys = await getApiKeys(!self.isStoreForCurrentUser() && { uid: self.uid });\n        self.runInAction(() => {\n          const map = {};\n          apiKeys.forEach(apiKey => {\n            const apiKeyModel = ApiKey.create(apiKey);\n            map[apiKeyModel.id] = apiKeyModel;\n          });\n          self.apiKeys.replace(map);\n        });\n      },\n      async createNewApiKey() {\n        const apiKey = await createNewApiKey(!self.isStoreForCurrentUser() && { uid: self.uid });\n        self.runInAction(() => {\n          // The put call below will automatically use the id from ApiKey\n          // (as it is marked \"types.identifier\") and add that as a key in the map and\n          // store the object as value against it\n          self.apiKeys.put(ApiKey.create(apiKey));\n        });\n      },\n      async revokeApiKey(apiKeyId) {\n        const apiKey = await revokeApiKey(apiKeyId, !self.isStoreForCurrentUser() && { uid: self.uid });\n        self.runInAction(() => {\n          self.apiKeys.put(ApiKey.create(apiKey));\n        });\n      },\n      cleanup: () => {\n        self.user = undefined;\n        superCleanup();\n      },\n    };\n  })\n  .views(self => ({\n    get empty() {\n      return self.apiKeys.size === 0;\n    },\n    get list() {\n      const result = [];\n      // converting map self.apiKeys to result array\n      self.apiKeys.forEach(apiKey => result.push(apiKey));\n      return result;\n    },\n    isStoreForCurrentUser: () => {\n      const userStore = getEnv(self).userStore;\n      const currentUser = userStore.user;\n      return currentUser.uid === self.uid;\n    },\n  }));\n\n// Note: Do NOT register this in the global context, if you want to gain access to an instance\n//       use UserStore.apiKeysStore or UsersStore.getApiKeysStore(uid)\nexport default ApiKeysStore;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport { types } from 'mobx-state-tree';\nimport _ from 'lodash';\n\nconst ApiKey = types\n  .model('ApiKey', {\n    id: types.identifier,\n    uid: '',\n    updatedAt: '',\n    status: '',\n    createdAt: '',\n    expiryTime: 0,\n    key: types.optional(types.string, ''),\n  })\n  .views(self => ({\n    get effectiveStatus() {\n      if (self.status !== 'active') {\n        // if status it not active then the effective status is same as status (such as \"revoked\")\n        return self.status;\n      }\n      // if status is active then make sure it is not expired\n      if (self.expiryTime > 0 && _.now() > self.expiryTime) {\n        return 'expired';\n      }\n      return self.status;\n    },\n    get isActive() {\n      return self.effectiveStatus === 'active';\n    },\n    get isRevoked() {\n      return self.effectiveStatus === 'revoked';\n    },\n  }));\n\nexport default ApiKey;\n","/*\n *  Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\").\n *  You may not use this file except in compliance with the License.\n *  A copy of the License is located at\n *\n *  http://aws.amazon.com/apache2.0\n *\n *  or in the \"license\" file accompanying this file. This file is distributed\n *  on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\n *  express or implied. See the License for the specific language governing\n *  permissions and limitations under the License.\n */\n\nimport _ from 'lodash';\nimport { getEnv, types } from 'mobx-state-tree';\n\nimport jwtDecode from 'jwt-decode';\nimport { storage, getFragmentParam, removeFragmentParams } from '../../helpers/utils';\nimport { setIdToken } from '../../helpers/api';\n\nimport localStorageKeys from '../constants/local-storage-keys';\nimport { boom } from '../../helpers/errors';\n\nfunction removeTokensFromUrl() {\n  const newUrl = removeFragmentParams(document.location, ['id_token', 'access_token', 'token_type', 'expires_in']);\n  window.history.replaceState({}, document.title, newUrl);\n}\n\n// ==================================================================\n// Login model\n// ==================================================================\nconst Authentication = types\n  .model('Authentication', {\n    processing: false,\n    selectedAuthenticationProviderId: '',\n  })\n  .actions(self => ({\n    runInAction(fn) {\n      return fn();\n    },\n\n    // this method is called by the Cleaner\n    cleanup() {\n      if (self.selectedAuthenticationProvider) {\n        // give selected authentication provider a chance to do its own cleanup\n        self.selectedAuthenticationProvider.cleanup();\n      }\n      self.clearTokens();\n    },\n\n    clearTokens() {\n      _.forEach(localStorageKeys, keyValue => storage.removeItem(keyValue));\n    },\n\n    setSelectedAuthenticationProviderId(authenticationProviderId) {\n      self.selectedAuthenticationProviderId = authenticationProviderId;\n    },\n\n    async getIdToken() {\n      // The id token would be in URL in case of SAML redirection.\n      // The name of the token param is \"id_token\" in that case (instead of \"appIdToken\"), if the token is\n      // issued by Cognito.\n      // Also the id_token is returned via URL fragment i.e, with # instead of query param something like\n      // https://web.site.url/#id_token=blabla instead of\n      // https://web.site.url?idToken=blabla\n      // TODO: Make the retrieval of id token from query string param or fragment param (or any other mechanism)\n      // dynamic based on the authentication provider. Without that, the following code will only work for\n      // any auth providers that set id token either in local storage as \"appIdToken\" or deliver to us\n      // via URL fragment parameter as \"id_token\".\n      // This code will NOT work for auth providers issuing id token and delivering via any other mechanism.\n      const idTokenFromUrl = getFragmentParam(document.location, 'id_token');\n      if (idTokenFromUrl) removeTokensFromUrl(); // we remove the idToken from the url for a good security measure\n\n      const idTokenFromLocal = storage.getItem(localStorageKeys.appIdToken);\n\n      const idToken = idTokenFromUrl || idTokenFromLocal;\n      return idToken;\n    },\n\n    async getIdTokenInfo() {\n      const idToken = await self.getIdToken();\n\n      let tokenStatus = 'notFound';\n      let decodedIdToken;\n      if (idToken) {\n        try {\n          decodedIdToken = jwtDecode(idToken);\n          // Check if the token is expired\n          // decodedIdToken.exp is epoch time in SECONDS\n          // ( - See \"exp\" claim JWT RFC - https://tools.ietf.org/html/rfc7519#section-4.1.4 for details\n          //   - the claim is in \"NumericDate\" format.\n          //   - NumericDate is Epoch in Seconds - https://ldapwiki.com/wiki/NumericDate )\n          //\n          // Date.now() returns epoch time in MILLISECONDS\n          const expiresAt = _.get(decodedIdToken, 'exp', 0) * 1000;\n          if (Date.now() >= expiresAt) {\n            tokenStatus = 'expired';\n          } else {\n            tokenStatus = 'notExpired';\n          }\n        } catch (e) {\n          // the token may not be a well-formed JWT toekn in case of any error\n          // decoding it\n          tokenStatus = 'corrupted';\n        }\n      }\n      return {\n        idToken,\n        decodedIdToken,\n        status: tokenStatus,\n      };\n    },\n\n    async saveIdToken(idToken) {\n      storage.setItem(localStorageKeys.appIdToken, idToken);\n      const decodedIdToken = idToken && jwtDecode(idToken);\n      setIdToken(idToken, decodedIdToken);\n    },\n\n    async login({ username, password }) {\n      if (self.shouldCollectUserNamePassword) {\n        const result = await self.selectedAuthenticationProvider.login({\n          username,\n          password,\n          authenticationProviderId: self.selectedAuthenticationProviderId,\n        });\n        const { idToken } = result || {};\n        if (_.isEmpty(idToken)) {\n          throw boom.incorrectImplementation(\n            `There is a problem with the implementation of the server side code. The id token is not returned.`,\n          );\n        }\n\n        await self.saveIdToken(idToken);\n\n        const appRunner = getEnv(self).appRunner;\n        await appRunner.run();\n      } else {\n        // If we do no need to collect credentials from the user then just call login method of the selected authentication provider without any arguments\n        // The selected auth provider will then take care of rest of the login flow (such as redirecting to other identity provider etc)\n        await self.selectedAuthenticationProvider.login();\n      }\n    },\n    async logout({ autoLogout = false } = {}) {\n      self.cleanup();\n      return self.selectedAuthenticationProvider.logout({ autoLogout });\n    },\n  }))\n  .views(self => ({\n    get isCognitoUserPool() {\n      return self.selectedAuthenticationProvider.type === 'cognito_user_pool';\n    },\n    get selectedAuthenticationProvider() {\n      const authenticationProviderPublicConfigsStore = getEnv(self).authenticationProviderPublicConfigsStore;\n      return authenticationProviderPublicConfigsStore.toAuthenticationProviderFromId(\n        self.selectedAuthenticationProviderId,\n      );\n    },\n\n    get shouldCollectUserNamePassword() {\n      const selectedAuthenticationProvider = self.selectedAuthenticationProvider;\n      return selectedAuthenticationProvider && selectedAuthenticationProvider.credentialHandlingType === 'submit';\n    },\n  }));\n\nfunction registerContextItems(appContext) {\n  appContext.authentication = Authentication.create({}, appContext);\n}\n\nexport { Authentication, registerContextItems };\n","var map = {\n\t\"./ar\": 534,\n\t\"./ar.js\": 534,\n\t\"./az\": 535,\n\t\"./az.js\": 535,\n\t\"./be\": 536,\n\t\"./be.js\": 536,\n\t\"./bg\": 537,\n\t\"./bg.js\": 537,\n\t\"./bs\": 538,\n\t\"./bs.js\": 538,\n\t\"./ca\": 539,\n\t\"./ca.js\": 539,\n\t\"./cs\": 540,\n\t\"./cs.js\": 540,\n\t\"./cy\": 541,\n\t\"./cy.js\": 541,\n\t\"./da\": 542,\n\t\"./da.js\": 542,\n\t\"./de\": 543,\n\t\"./de.js\": 543,\n\t\"./el\": 544,\n\t\"./el.js\": 544,\n\t\"./en\": 392,\n\t\"./en.js\": 392,\n\t\"./es\": 545,\n\t\"./es.js\": 545,\n\t\"./et\": 546,\n\t\"./et.js\": 546,\n\t\"./eu\": 547,\n\t\"./eu.js\": 547,\n\t\"./fa\": 548,\n\t\"./fa.js\": 548,\n\t\"./fi\": 549,\n\t\"./fi.js\": 549,\n\t\"./fr\": 550,\n\t\"./fr.js\": 550,\n\t\"./hr\": 551,\n\t\"./hr.js\": 551,\n\t\"./hu\": 552,\n\t\"./hu.js\": 552,\n\t\"./id\": 553,\n\t\"./id.js\": 553,\n\t\"./it\": 554,\n\t\"./it.js\": 554,\n\t\"./ja\": 555,\n\t\"./ja.js\": 555,\n\t\"./ka\": 556,\n\t\"./ka.js\": 556,\n\t\"./ko\": 557,\n\t\"./ko.js\": 557,\n\t\"./lt\": 558,\n\t\"./lt.js\": 558,\n\t\"./lv\": 559,\n\t\"./lv.js\": 559,\n\t\"./mk\": 560,\n\t\"./mk.js\": 560,\n\t\"./mn\": 561,\n\t\"./mn.js\": 561,\n\t\"./ms\": 562,\n\t\"./ms.js\": 562,\n\t\"./nb_NO\": 563,\n\t\"./nb_NO.js\": 563,\n\t\"./nl\": 564,\n\t\"./nl.js\": 564,\n\t\"./pl\": 565,\n\t\"./pl.js\": 565,\n\t\"./pt\": 566,\n\t\"./pt.js\": 566,\n\t\"./pt_BR\": 567,\n\t\"./pt_BR.js\": 567,\n\t\"./ro\": 568,\n\t\"./ro.js\": 568,\n\t\"./ru\": 569,\n\t\"./ru.js\": 569,\n\t\"./se\": 570,\n\t\"./se.js\": 570,\n\t\"./sl\": 571,\n\t\"./sl.js\": 571,\n\t\"./sq\": 572,\n\t\"./sq.js\": 572,\n\t\"./sr\": 573,\n\t\"./sr.js\": 573,\n\t\"./sv\": 574,\n\t\"./sv.js\": 574,\n\t\"./tr\": 575,\n\t\"./tr.js\": 575,\n\t\"./ua\": 576,\n\t\"./ua.js\": 576,\n\t\"./uk\": 577,\n\t\"./uk.js\": 577,\n\t\"./vi\": 578,\n\t\"./vi.js\": 578,\n\t\"./zh\": 579,\n\t\"./zh.js\": 579,\n\t\"./zh_TW\": 580,\n\t\"./zh_TW.js\": 580\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 989;"],"sourceRoot":""}